#Include "PROTHEUS.CH"
#Include "TopConn.Ch"
#INCLUDE "SaldoSR.CH"
#INCLUDE "SALDOSP.CH"

#DEFINE QUEBR				1
#DEFINE CLIENT				2
#DEFINE TITUL				3
#DEFINE TIPO				4
#DEFINE NATUREZA			5
#DEFINE EMISSAO			6
#DEFINE VENCTO				7
#DEFINE VENCREA			8
#DEFINE BANC				9
#DEFINE VL_ORIG			10
#DEFINE VL_NOMINAL		11
#DEFINE VL_CORRIG			12
#DEFINE VL_VENCIDO		13
#DEFINE NUMBC				14
#DEFINE VL_JUROS			15
#DEFINE ATRASO				16
#DEFINE HISTORICO			17
#DEFINE VL_SOMA			18


#DEFINE QUEBR				1
#DEFINE FORNEC				2
#DEFINE TITUL				3
#DEFINE TIPO				4
#DEFINE NATUREZA			5
#DEFINE EMISSAO			6
#DEFINE VENCTO				7
#DEFINE VENCREA			8
#DEFINE VL_ORIG			9
#DEFINE VL_NOMINAL		10
#DEFINE VL_CORRIG			11
#DEFINE VL_VENCIDO		12
#DEFINE PORTADOR			13
#DEFINE VL_JUROS			14
#DEFINE ATRASO				15
#DEFINE HISTORICO			16
#DEFINE VL_SOMA			17

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³RGERCPT   ºAutor  ³Five Solutions      º Data ³  21/09/2011 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ Relatório Gerencial COMAFAL  - Regime de Competencia       º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ COMAFAL - PE, SP e RS.                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/

User Function RGerCpt

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Declaracao de Variaveis                                             ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

Local cDesc1         := "Este programa tem como objetivo imprimir relatorio "
Local cDesc2         := "de acordo com os parametros informados pelo usuario."
Local cDesc3         := "Resumo Gerencial COMAFAL"
Local cPict          := ""
Local titulo       := "Resumo Gerencial COMAFAL"
Local nLin         := 80

Local Cabec1       := ""//Mês                               Mês 01      Mês 02        Mês 03"
Local Cabec2       := ""
Local imprime      := .T.
Local aOrd := {}


Private aFatp1MP := {} //19/07/2009
Private aFatp2MP := {} //19/07/2009
Private aFatp3MP := {} //19/07/2009

Private aFatp4MP := {} //19/07/2009
Private aFatp5MP := {} //19/07/2009
Private aFatp6MP := {} //19/07/2009

Private nChamada := 0 //Ita-03/03/2008
Private nPAChamada := 0

Private cNomeMes := "" //Five Solutions - 28/05/2008

Private lEnd         := .F.
Private lAbortPrint  := .F.
Private CbTxt        := ""
Private limite           := 220
Private tamanho          := "G"
Private nomeprog         := "RGerCpt" // Coloque aqui o nome do programa para impressao no cabecalho
Private nTipo            := 15
Private aReturn          := { "Zebrado", 1, "Administracao", 1, 2, 1, "", 1}
Private nLastKey        := 0
Private cPerg       := "RGECPT"//"RGERCO"
//Private cPerg      	:= "CRF010"
Private cbtxt      := Space(10)
Private cbcont     := 00
Private CONTFL     := 01
Private m_pag      := 01
Private wnrel      := "RGerCpt" // Coloque aqui o nome do arquivo usado para impressao em disco
Private dDataDe    := CTOD("")
Private dDataAte   := CTOD("")
Private d2AnoMes   := ""
Private d3AnoMes   := ""
Private cAlmoxMP   := ""
Private cAlmoxPA   := ""

Private nCustTonel := 0 //Custo da Tonelada/Frete - Por Filial
If SM0->M0_CODFIL == '02'
   nCustTonel := 70
ElseIf SM0->M0_CODFIL == '03'
   nCustTonel := 140
ElseIf SM0->M0_CODFIL == '06'
   nCustTonel := ((3150)/100)  //R$ 31,50
EndIf

Private nLRel := 68 //75 //68 //Quantidade Máxima de Linhas por Página


Private dDtParam  := CTOD("")
Private d2DtParam := CTOD("")
Private d3DtParam := CTOD("")

//nRecDREFin

//CFOP´s de Vendas
Private cCFOPVenda  	    := "5101,6101,5102,6102,5103,6103,5104,6104,5105,6105,"
        cCFOPVenda  	    += "5106,6106,6107,6108,5109,6109,5110,6110,5111,6111,5112,6112,"
        cCFOPVenda  	    += "5113,6113,5114,6114,5115,6115,5116,6116,5117,6117,5118,6118,5119,6119,"
        cCFOPVenda  	    += "5120,6120,5122,6122,5123,6123"//,7101,7102,7105,7106,7127"


Private cCFOPDvVd   := "1201,2201,3201,1202,2202,3202" //devolucao de venda

Private cNatProd := "32102,32102001,32102002,32102003,32102004,32102005,32102006,32102007,32102008,32102009,32102010,
        cNatProd += "32102011,32102012,32102013,32102014,32102015,32102016,32102500,32102501,32102503,"
        cNatProd += "32104507,32104508,11250006,11250005,11250007,32104033,32104018,32104020"


//TOTAL DE GASTOS DA ÁREA COMERCIAL
Private cGGNatComl := "33101,33101001,33101002,33101003,33101004,33101005,33101006,33101007,33101008,33101009,33101010,33101011,33101012,"
        cGGNatComl += "33101013,33101014,33101015,33101016,33101017,33101018,33101019,33101020,33101021,33101022,33101023,33101025,"
        cGGNatComl += "33101026,33101027,33101028,33101029,33101030,33101031,33101032,33101033,33101034,33101035,33101036,33101037,33101038,"
        cGGNatComl += "33101039,33101040,33101041,33101042,33101045,33101046,33101047,33101048,33101049,33101050,33101051,33101052,33101053,"
        //Five Solutions - 11/12/2009 - Solicit.Patrícia, Retirar 33101056 - cGGNatComl += "33101054,33101055,33101056,33101057,33101058,33101500,33101501,33101502,33101503,33101504,33101505,33101506,33101507"
        cGGNatComl += "33101054,33101055,33101057,33101058,33101500,33101501,33101502,33101503,33101504,33101505,33101506,33101507"

//Naturezas de Gastos Gerais Mão de Obra

Private cNatGGMO   := "33101001,33101002,33101003,33101004,33101005,33101006,33101007,33101008,33101009,33101010,33101011,33101012,33101013,"
        cNatGGMO   += "33101014,33101015,33101016,33101030,33101034,33101035,33101046,33101500,33101501,33101503,33101504"



//DESPESA FIXA  - 2009
Private cDFNatGG   := "3101001,33101002,33101004,33101005,33101010,33101011,33101012,33101013,33101014,33101015,33101500"

//DESPESA PERIÓDICA - 2009
Private cDPNatGG   := "33101003,33101007,33101008,33101016,33101030,33101034,33101035,33101046,33101501,33101504" 

//DESPESA PERIÓDICA INDIRETA - Novo Conceito - 2009

Private cNtMOIPInd := "32103003,32103007,32103008,32103016,32103501,32104030,32104034,32104035,32104046,32104504" 

//Naturezas de Rescisões - 2009
Private cNResGG    := "33101009,33101503" 

//Naturezas de Premiações - 2009
Private cNtPremGG  := "33101006"

//Naturaza de Comissao - 2009
Private cNtComissao := "33101004"

//Natureza de Representação(Nova - 2009)
Private cNtRepresent := "33101507"

//Naturezas de Marketing - 2009
Private cNatMark   := "33101025,33101045"

//Naturezas co Despesas de Viagens - 2009
Private cNtDespV   := "33101019,33101057"

//Naturezas com Fretes de Vendas - 2009
Private cNtFrtVend := "33101505"

//Naturezas de Outras Despesas do Comercial
Private cNtOutDesp := "200205"


//Naturezas de Outras Naturezas Comercio - 2009
Private nOutNatGG  := "33101,33101018,33101020,33101021,33101022,33101028,33101029,33101031,33101032,33101033,33101036,33101037,"
        nOutNatGG  += "33101038,33101039,33101040,33101041,33101042,33101048,33101049,33101050,33101053,33101054,33101055,33101058,33101502,"
        nOutNatGG  += "33101506,33101507"

Private cNtGMtOrCml:= "33101,33101002,33101004,33101005,33101012,33101013,33101014,33101015,33101016,33101018,33101019,"
        cNtGMtOrCml+= "33101020,33101021,33101022,33101028,33101029,33101030,33101032,33101033,33101034,33101035,33101036,33101037,33101038,"
        cNtGMtOrCml+= "33101039,33101040,33101041,33101042,33101046,33101047,33101048,33101049,33101050,33101051,33101052,33101053,33101054,"
        //Five Solutions - 11/12/2009 - Solicit.Patrícia, Retirar 33101056 - cNtGMtOrCml+= "33101055,33101056,33101057,33101500,33101501,33101504" 
        cNtGMtOrCml+= "33101055,33101057,33101500,33101501,33101504" 

Private cCUSTPROD := "32102,32102001,32102002,32102003,32102004,32102005,32102006,32102007,32102008,32102009,32102010,
        cCUSTPROD += "32102011,32102012,32102013,32102014,32102015,32102016,32102500,32102501,32102503,"
        cCUSTPROD += "32104507,32104508,11250006,11250005,11250007,32104033,32104018,32104020"

//TOTAL DE GASTOS REALIZADOS PELA INDUSTRIA - 2010 - Novo grupo de naturezas.
Private cGASTGERIND := "11205,11205001,11205002,11205003,11205004,11205005,11205006,11205007,11205008,11205009,"
        cGASTGERIND += "11250,11250001,11250002,11250003,11250004,11250005,11250006,11250007,11250009,11250010,"
        cGASTGERIND += "11250011,321,32101,32101001,32101002,32101003,32101004,32101005,32101006,32102,32102001,"
        cGASTGERIND += "32102002,32102003,32102004,32102005,32102006,32102007,32102008,32102009,32102010,32102011,"
        cGASTGERIND += "32102012,32102013,32102014,32102015,32102016,32102500,32102501,32102502,32102503,32103,"
        cGASTGERIND += "32103001,32103002,32103003,32103004,32103005,32103006,32103007,32103008,32103009,32103010,"
        cGASTGERIND += "32103011,32103012,32103013,32103014,32103015,32103016,32103500,32103501,32103502,32103503,"
        cGASTGERIND += "32104,32104017,32104018,32104019,32104020,32104021,32104022,32104023,32104025,32104026,"
        cGASTGERIND += "32104027,32104028,32104029,32104030,32104031,32104032,32104033,32104034,"
        cGASTGERIND += "32104035,32104036,32104037,32104038,32104039,32104040,32104041,32104042,32104045,32104046,"
        cGASTGERIND += "32104047,32104048,32104049,32104050,32104051,"
        cGASTGERIND += "32104052,32104053,32104054,32104055,32104057,32104058,32104504,32104507,32104508,32104509,"
        cGASTGERIND += "32104511,32104512,32104513,34103,34103001,"
        cGASTGERIND += "34103002,34103003,34103004,34103005,34103006,34103007,34103008,34103009"        

//Natures de Gastos Totais com Ativo Imobilizado
Private cImobTotal := "200109,200110,200111,200306,200406,700309"

//TOTAL DE GASTOS REALIZADO COM MÁQUINAS E MOTORES
Private cNatMaqMot := "200111,200306,200406"
//TOTAL DE GASTOS REALIZADO COM IMOBILIZADO IMPORTADO 
Private cNatImpInd := "700309"
//TOTAL DE GASTOS REALIZADO COM IMOBILIZADO DA ÁREA DE INFORMÁTICA 
Private cNatInfInd := "200109"
//TOTAL DE GASTOS REALIZADO COM MÓVEIS E UTENSÍLIOS 
Private cMovUteInd := "200110"
//TOTAL DE INVESTIMENTOS REALIZADOS NA EMPRESA (SOMATÓRIO DAS NATUREZAS QUE POSSUEM GASTOS COM INVESTIMENTOS)
Private cInvTotInd := "200132,200135,200313,200322,200360,200361,200362,200363,200364,200365,200366,200367,200368,200369,200370,200372,200373,200374,200375,200376,200377"
//INVESTIMENTOS NAS EMPRESAS CABOMAR E COMAFAL-RS
Private cNtEmpresas:= "200135,200360"
//INVESTIMENTOS LANÇADOS NAS NATUREZAS DE MÁQUINAS E EQUIPAMENTOS 
Private cNtMaquinas:= "200361,200362,200363,200364,200369,200370,200375"
//VALOR DE FINAME LANÇADO NA NATUREZA 
Private cNtFiname := "200313"
//VALORES LANÇADOS REF. LEASING 
Private cNtLeasing:= "200132"
//SOMATÓRIO DAS NATUREZAS QUE POSSUEM DESPESAS REF. A BENFEITORIAS 
Private cNtBenfeit:= "200322, 200365,200366,200368,200372,200373,200374,200376,200377"
//VALORES LANÇADOS NA NATUREZA ISO 9001 - 2000  
Private cNtISO92  := "200367"
//SOMATÓRIO DAS NATUREZAS QUE POSSUEM GASTOS RELACIONADOS A MATERIA PRIMA 
Private cNtMPTotal:= "700303,700306,700307,700308,600201"
//Five Solutions 11/12/2009 - INCLUIR - 32101,32101001,32101003,32101004,32101005,32101006
        cNtMPTotal+= "32101,32101001,32101003,32101004,32101005,32101006"

//MATERIA PRIMA NACIONAL - 2009
Private cNtNacMP := "11250001"

//Naturezas AFRMM
Private cNtAFRMM := "32101001"

Private cNtARMAZ := "32101002" //Five Solutions Consultoria - 11/02/2010

//OPERAÇÃO PORTUÁRIA
Private cNtOpPort := "32101003"

//DESPACHANTE ADUANEIRO
Private cNtAduaDesp := "32101004"

//MATÉRIA PRIMA IMPORTADA   
//Private cNtImpMP := "700306"

//MATÉRIA PRIMA IMPORTADA   - 2009
Private cNtImpMP := "700306"  //Não houve atualização

//TRIBUTOS DA IMPORTAÇÃO  - 2009
Private cNtTrbImp:= "700307" //Não houve atualização


//DESPESAS DE IMPORTAÇÃO - 2009
Private cNtDespImp:="32101,32101005"

//FRETE IMPORTAÇÃO - 2009
Private cNtFrtImp:= "32101006"

//INSUMOS - 2009
Private cNtInsumos := "11250005"

Private cNtEmbalag := "11250007"

//DESPESAS COM MAO DE OBRA DIRETA(Novo Conceito - 2009)
Private cNtMaoObDInd := "32102,32102001,32102002,32102003,32102004,32102005,32102006,32102007,32102008,32102009,32102010,"
        cNtMaoObDInd += "32102011,32102012,32102013,32102014,32102015,32102016,32102500,32102501,32102503"

//DESPESA FIXA Indústria 
//Private cNtMODFInd:= "100303,100403,100305,100405,100306,100406,100307,100407,100311,100411,100312,100412"                 

//DESPESA FIXA Indústria Direta(Novo Conceito - 2009)
Private cNtMODFInd:= "32102,32102001,32102002,32102004,32102005,32102010,32102011,32102012,32102013,32102014,32102015,32102500"


//DESPESA FIXA Indústria Inireta(Novo Conceito - 2009)
Private cNtMOIFInd := "32103,32103001,32103002,32103004,32103005,32103010,32103011,32103012,32103013,32103014,32103015,32103500"

//DESPESA PERIÓDICA Indústria Direta(Novo Conceito - 2009)
Private cNtMODPInd:= "32102003,32102007,32102008,32102016,32102501" 


//RESCISÃO Indústria Direta(Novo Conceito - 2009)
Private cNtRecisDInd := "32102009,32102503"


//PREMIAÇÕES Indústria 
//Private cNtPremInd := "100302,100402,100313"

//PREMIAÇÕES Indústria Direta(Novo Conceito - 2009)
Private cNtPremDInd := "32102006" 

//RECISÕES INDIRETAS(Novo Conceito - 2009)
//Private cNtRecisDIInd := "32103009,32103503"
Private DIIndcNtRecis := "32103009,32103503"

//PREMIAÇÕES Indústria Indireta(Novo Conceito - 2009)
Private cNtPremDIInd := "32103006" 

//BENEFICIAMENTO  Indústria - 2009
Private cNtBenefInd:= "32104507,32104508"

//MANUTENÇÃO Indústria(Elétrica)
Private cNtELManuten:= "32104511"

//MANUTENÇÃO Indústria(Ferramental)
Private cNtFEManutenOI:= "32104512"

//MANUTENÇÃO Indústria(Mecânica)
Private cNtMEManuten:= "32104513"

//SERVIÇOS TERCEIRIZADOS Comércio(Novo - 2009)
Private cNtSerComTer:= "33101017,33101023,33101026,33101027,33101047,33101051,33101052"

//EPI Indústria - 2009 
Private cNtEPIInd := "11250006"

//ENERGIA Indústria - 2009
Private cNtEnergInd:= "32104033"

//AGUA  Indústria - 2009
Private cNtAguaInd := "32104018"

//ALUGUEL Indústria IMÓVEIS - 2009
Private cNtAlugInd := "32104020"

//CONSERVAÇÃO DE PREDIO Indústria - 2009 - Não houve modificação, não está sendo mais utilizado.
Private cNtCoPredInd:= "200321,200421"

//SERVIÇOS TERCEIRIZADOS Indústria - 2009
Private cNtSerTerInd:= "32104017,32104023,32104026,32104027,32104047,32104051,32104052"

//DESPESAS DE VIAGENS  Indústria - 2009
Private cNtDespViaIn:= "32104057"

//IMPOSTOS INDÚSTRIA - Novo Conceito - 2009
Private cNtImpostInd := "11205,11205001,11205002,11205003,11205004,11205005,11205006,11205007,11205008,11205009"

//OUTRAS DESPESAS DAS INDÚSTRIA - 2009
Private cNtOutDesInd := "11250,11250002,11250003,11250004,11250009,11250010,11250011,321,32102502,32103502,32104,32104019,"
        cNtOutDesInd += "32104021,32104022,32104025,32104028,32104029,32104031,32104032,32104036,32104037,32104038,32104039,32104040,32104041,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 32104056 - cNtOutDesInd += "32104042,32104045,32104048,32104049,32104050,32104053,32104054,32104055,32104056,32104057,32104058,32104509"
        cNtOutDesInd += "32104042,32104045,32104048,32104049,32104050,32104053,32104054,32104055,32104057,32104058,32104509"

//NATUREZAS DIVERSAS - Novo Conceito/Nome - 2009
Private cNtOutNatInd := "11250,11250002,11250003,11250004,11250009,11250010,11250011,321,32102502,32103502,32104,32104019,"
        cNtOutNatInd += "32104021,32104022,32104025,32104028,32104029,32104031,32104032,32104036,32104037,32104038,32104039,32104040,32104041,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 32104056 - cNtOutNatInd += "32104042,32104045,32104048,32104049,32104050,32104053,32104054,32104055,32104056,32104058,32104509" 
        cNtOutNatInd += "32104042,32104045,32104048,32104049,32104050,32104053,32104054,32104055,32104058,32104509," 
        cNtOutNatInd += "1125009" //Five Solutions Consultoria - 16/12/2009
//TOTAL DE GASTOS REALIZADOS NAS NATUREZAS QUE COMPÕE AS METAS DE ORÇAMENTO - INDÚSTRIA - 2009
        
Private cNtGstMtOrInd := "11250005,11250006,11250007,11250009,11250010,11250011,321,32102,32102002,32102004,32102005,32102012,"
        cNtGstMtOrInd += "32102013,32102014,32102015,32102016,32102500,32102501,32103,32103002,32103004,32103005,32103012,"
        cNtGstMtOrInd += "32103013,32103014,32103015,32103016,32103500,32103501,32104,32104018,32104019,32104020,32104021,32104022,32104028,"
        cNtGstMtOrInd += "32104029,32104030,32104032,32104033,32104034,32104035,32104036,32104037,32104038,32104039,32104040,32104041,32104042,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 32104056 - cNtGstMtOrInd += "32104046,32104047,32104048,32104049,32104050,32104051,32104052,32104053,32104054,32104055,32104056,32104057,32104504,"
        cNtGstMtOrInd += "32104046,32104047,32104048,32104049,32104050,32104051,32104052,32104053,32104054,32104055,32104057,32104504,"
        //cNtGstMtOrInd += "32104507,32104508,32104509,32104511,32104512,32104513"
        cNtGstMtOrInd += "32104509,32104511,32104512,32104513"

//TOTAL DE GASTOS REALIZADOS PELO ADMINISTRATIVO
//GASTOS GERAIS DO ADM - 2009
Private cGstGerADM  := "11101,11101001,11101002,11206,11206001,21101,21101001,21101002,"
        cGstGerADM  += "21101003,21101004,21101005,21101006,21101007,132,13201,13201001,13201002,13201003,13201004,13202,13202001,13202002,"
        cGstGerADM  += "13202003,13202004,13202005,33102,33102001,33102002,33102003,33102004,33102005,33102006,33102007,33102008,33102009,33102010,"
        cGstGerADM  += "33102011,33102012,33102013,33102014,33102015,33102016,33102017,33102018,33102019,33102020,33102021,33102022,33102023,"
        cGstGerADM  += "33102025,33102026,33102027,33102028,33102029,33102030,33102031,33102032,33102033,33102034,33102035,33102036,33102037,"
        cGstGerADM  += "33102038,33102039,33102040,33102041,33102042,33102045,33102046,33102047,33102048,33102049,33102050,33102051,33102052,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 33102056 e INCLUIR - cGstGerADM  += "33102053,33102054,33102055,33102056,33102057,33102058,33102500,33102501,33102502,33102503,33102504,33102505,33102506,"
        cGstGerADM  += "33102601,33102053,33102054,33102055,33102057,33102058,33102500,33102501,33102502,33102503,33102504,33102505,33102506,"
        cGstGerADM  += "33102600,34102,34102001,34102002,34102003,34102004,34102005,34102006"

//MAO DE OBRA ADM - 2009
Private cMOGstADM := "33102001,33102002,33102003,33102004,33102005,33102006,33102007,33102008,33102009,33102010,33102011,"
        cMOGstADM += "33102012,33102013,33102014,33102015,33102016,33102030,33102034,33102035,33102046,33102500,33102501,33102503,33102504"

//DESPESA FIXA ADM - 2009
Private cDFGstADM := "33102001,33102002,33102004,33102005,33102010,33102011,33102012,33102013,33102014,33102015,33102500"

//DESPESA PERIÓDICA ADM - 2009
Private cDPGstADM := "33102003,33102007,33102008,33102016,33102030,33102034,33102035,33102046,33102501,33102504" 

//RESCISÃO ADM - 2009
Private cResGstADM:= "33102009,33102503" 

//PREMIAÇÕES ADM - 2009
Private cPrmADMGst:= "33102006"  

//CAIXA GERAL ADM - Novo Conceito - 2009
Private cCaixaNtGr := "11101001"


//CAIXINHA - Novo Conceito - 2009
Private cCxnhaNtGr := "11101002"

//INVESTIMENTOS - Novo - 2009
Private cInvestNt := "11206001"

//EMPRÉSTIMOS - Novo 2009
//Tomados
Private cEmpTomNt := "21101001,21101003,21101005,21101007"
//Concedidos
Private cEmpConNt := "21101002,21101004,21101006"

//IMOBILIZADO(TOTAL) - Novo - 2009
//Bens Imóveis
Private cImbBINt := "13201,13201001,13201002,13201003,13201004"
//Bens Móveis
Private cImbBMNt := "13202,13202001,13202002,13202003,13202004,13202005"


//DEEPESAS FINANCEIRAS - Novo - 2009
Private cDPFiancNt := "34102,34102001,34102002,34102003,34102004,34102005,34102006"

Private cCapexcNt := "11206,11206001,132,13201,13201001,13201002,13201003,13201004,13202,13202001,13202002,13202003,13202004,13202005"

//DESPESAS DE VIAGENS ADM - 2009
Private cDspViaADM:= "33102057"


//OUTRAS DESPESAS ADM. 
Private cOutDADMGst:= "200123"

//SERVIÇOS TERCEIRIZADOS  ADM
Private cSrvTADMGst := "200103,200122,200124,200133"

//SERVIÇOS TERCEIRIZADOS  ADM - 2009 - Novo Conceito
Private cSrvTADMGst := "33102023,33102026,33102027,33102047,33102051,33102052"


//ADVPGADOS - Novo - 2009
Private cHonorAdvNt := "33102017,33102601" //Five Solutions 11/12/2009 - Solicit.Patrícia - INCLUIR 33102601

//DESPESAS JUDICIAIS 
Private cDespJdcNt  := "200106"
//RESCISÕES ACORDOS / ADV.  
Private cRescAcordNt:= "200130"

//OUTRAS NATUREZAS DO ADMINISTRATIVO FINANCEIRO - 2009
Private OutrasADM := "11101,11206,21101,132,33102,33102018,33102019,33102020,33102021,33102022,"
        OutrasADM += "33102025,33102028,33102029,33102031,33102032,33102033,33102036,33102037,33102038,33102039,33102040,33102041,33102042,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 33102056 - OutrasADM += "33102045,33102048,33102049,33102050,33102053,33102054,33102055,33102056,33102058,33102502,33102505,33102506,33102600"
        OutrasADM += "33102045,33102048,33102049,33102050,33102053,33102054,33102055,33102058,33102502,33102505,33102506,33102600"

        

//GASTOS METAS ORÇAMENTO ADM - 2009
Private AdmMetasOrc := "11101,11101002,33102,33102002,33102004,33102005,33102012,"
        AdmMetasOrc += "33102013,33102014,33102015,33102016,33102018,33102019,33102020,33102021,33102022,33102028,33102029,33102030,33102032,"
        AdmMetasOrc += "33102033,33102034,33102035,33102036,33102037,33102038,33102039,33102040,33102041,33102042,33102046,33102047,33102048,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 33102056 - AdmMetasOrc += "33102049,33102050,33102051,33102052,33102053,33102054,33102055,33102056,33102057,33102500,33102501,33102504,33102505,"
        AdmMetasOrc += "33102049,33102050,33102051,33102052,33102053,33102054,33102055,33102057,33102500,33102501,33102504,33102505,"
        AdmMetasOrc += "33102506"
        //Five Solutions Consultoria 05/11/2009(Solit.Patricia) - Retirado Natureza de Caixa Geral - 11101001,

        
//EMPRÉSTIMO ENTRE EMPRESAS 
Private cNtEmpEEmp := "700206"

//FUNDO FIXO "200143,200501,200502,200503,200504,200505,200506,200507,200508,200509,200510"
Private cNtFundFix := "200143,200501,200502,200503,200504,200505,200506,200507,200508,200509,200510"        

//Nova versão Naturezas - Patrícia 13/02/2008
//IMPOSTOS
 Private cNtImpCtrbTt := "200139,IRF,200211,200208,200142,700310,200138,ISS,200127,200126"

//INSS 
Private cNtINSS := "100115,200137,500103"

//FGTS - GRFC 
Private cNtFGTS := "100114,100122,100214,100222,100312,100317,100412,100417"

//CPMF
Private cNtCPMF := "200126" 

//IPTU  
Private cNtIPTU := "200127"

//IPI 
Private cNtIPI := "200208"

//PIS / COFINS  
Private cNtPISCOF := "200142"

//TRIBUTOS DIVERSOS  
Private cNtTribut := "700310"

//ICMS 
Private cNtICMS := "200211"

Private cNtISS := "200138,ISS"

//Nova versão Naturezas - Patrícia 13/02/2008
Private cNtIR := "200139,IRF"

//TODOS OS IMPOSTOS DA IMPORTAÇÃO  
Private cNtImpImport := "700307"


//Equalizando Relatório
Private cCFOPVdInt  	    := "'5101','6101','5102','6102','5103','6103','5104','6104','5105','6105',"
cCFOPVdInt  	    += "'5106','6106','6107','6108','5109','6109','5110','6110','5111','6111','5112','6112',"
cCFOPVdInt  	    += "'5113','6113','5114','6114','5115','6115','5116','6116','5117','6117','5118','6118','5119','6119',"
cCFOPVdInt  	    += "'5120','6120','5122','6122','5123','6123'"


//DESPESAS FINANCEIRAS IMPORTAÇÃO
cNtFINIMP  := "34103,34103001"
cNtFLAT    := "34103002"
cNtLIBOR   := "34103003"
cNtBANQUE  := "34103004"
cNtDISCREP := "34103005"
cNtIRIMPORT:= "34103006"
cNtIOFIMP  := "34103007"
cNtHPTREG  := "34103008"
cNtMNTEST  := "34103009"

//IMPOSTOS
cNtICMIMOB := "11205001"
cNtICMS1   := "11205,11205002"
cNtIPI     := "11205003"
cNtPIS     := "11205004"
cNtCOFI    := "11205005"
cNtCSLL    := "11205006"
cNtIRPJ    := "11205007"
cNtIRRF    := "11205008"
cNtII      := "11205009"

//Variaveis Privadas de Impressão
//Saldos em Aberto a Pagar

nSld1MPag := 0
nSld2MPag := 0
nSld3MPag := 0

nSld4MPag := 0
nSld5MPag := 0
nSld6MPag := 0

nSld1MAnt := 0
nSld2MAnt := 0
nSld3MAnt := 0

nSld4MAnt := 0
nSld5MAnt := 0
nSld6MAnt := 0

//Saldos em Aberto a Receber
nSld1MRec := 0
nSld2MRec := 0
nSld3MRec := 0

nSld4MRec := 0
nSld5MRec := 0
nSld6MRec := 0

// Variaveis do Fluxo do Contas a Receber
 nARe1M1a30  := 0
 nARe2M1a30  := 0
 nARe3M1a30  := 0

 nARe4M1a30  := 0
 nARe5M1a30  := 0
 nARe6M1a30  := 0
  
 nARe1M31a60 := 0
 nARe2M31a60 := 0
 nARe3M31a60 := 0

 nARe4M31a60 := 0
 nARe5M31a60 := 0
 nARe6M31a60 := 0
 
//Five Solutions Consultoria
//20 de agosto de 2008  
nARAc160dd := 0
nARAc260dd := 0
nARAc360dd := 0

nARAc460dd := 0
nARAc560dd := 0
nARAc660dd := 0

 nARe1M61a90 := 0
 nARe2M61a90 := 0
 nARe3M61a90 := 0
 nARe1M90M   := 0
 nARe2M90M   := 0
 nARe3M90M   := 0

//Variaveis de Clientes
nClAtv1Mes := 0
nClIna1Mes := 0
nClAtv2Mes := 0
nClIna2Mes := 0
nClAtv3Mes := 0

nClAtv4Mes := 0
nClAtv5Mes := 0
nClAtv6Mes := 0

nClIna3Mes := 0

nClIna4Mes := 0
nClIna5Mes := 0
nClIna6Mes := 0

nCliN01Mes := 0
nCliN02Mes := 0
nCliN03Mes := 0
nClAtd1Mes := 0
nClAtd2Mes := 0
nClAtd3Mes := 0

nCliN04Mes := 0
nCliN05Mes := 0
nCliN06Mes := 0
nClAtd4Mes := 0
nClAtd5Mes := 0
nClAtd6Mes := 0

//Prospects
nASC1Mes := 0
nASC2Mes := 0
nASC3Mes := 0

nASC4Mes := 0
nASC5Mes := 0
nASC6Mes := 0

//Prmiações
nPrm1DIIndVl := 0
nPrm2DIIndVl := 0
nPrm3DIIndVl := 0

nPrm4DIIndVl := 0
nPrm5DIIndVl := 0
nPrm6DIIndVl := 0

// Variaveis de Pedidos

nFatPd1QtMes := 0

nFatPd4QtMes := 0
nFatPd5QtMes := 0
nFatPd6QtMes := 0

nPdPen1QtMes := 0
nPdPen4QtMes := 0
nPdPen5QtMes := 0
nPdPen6QtMes := 0

nFatPd2QtMes := 0
nPdPen2QtMes := 0
nFatPd3QtMes := 0

nFatPd4QtMes := 0
nFatPd5QtMes := 0
nFatPd6QtMes := 0


nPdPen3QtMes := 0
nPdPen4QtMes := 0
nPdPen5QtMes := 0
nPdPen6QtMes := 0


nFtPd1VlrMes := 0

nFtPd4VlrMes := 0
nFtPd5VlrMes := 0
nFtPd6VlrMes := 0

nPdPen1VlrM  := 0

nPdPen4VlrM  := 0
nPdPen5VlrM  := 0
nPdPen6VlrM  := 0


nFtPd2VlrMes := 0
nPdPen2VlrM  := 0
nFtPd3VlrMes := 0
nPdPen3VlrM  := 0

nFtMAPd1Qt   := 0
nFtMAPd2Qt   := 0
nFtMAPd3Qt   := 0
nFtPd1MAVl   := 0
nFtPd2MAVl   := 0
nFtPd3MAVl   := 0

nFtMAPd4Qt   := 0
nFtMAPd5Qt   := 0
nFtMAPd6Qt   := 0
nFtPd4MAVl   := 0
nFtPd5MAVl   := 0
nFtPd6MAVl   := 0

nPdPen1MAQt  := 0
nPdPen2MAQt  := 0
nPdPen3MAQt  := 0
                 
nPdPen4MAQt  := 0
nPdPen5MAQt  := 0
nPdPen6MAQt  := 0

nPdPMA1VlM   := 0
nPdPMA2VlM   := 0
nPdPMA3VlM   := 0

nPdPMA4VlM   := 0
nPdPMA5VlM   := 0
nPdPMA6VlM   := 0

// Variaveis de Faturamento

nFat1MesBru := 0
nFat2MesBru := 0
nFat3MesBru := 0

nFat4MesBru := 0
nFat5MesBru := 0
nFat6MesBru := 0

//Variaveis dos Incentivos Fiscais
nInc1FisMP  := 0
nInc2FisMP  := 0
nInc3FisMP  := 0

nInc4FisMP  := 0
nInc5FisMP  := 0
nInc6FisMP  := 0

nTrfI1FisMP := 0
nTrfI2FisMP := 0
nTrfI3FisMP := 0

nTrfI4FisMP := 0
nTrfI5FisMP := 0
nTrfI6FisMP := 0

// Faturamento CIF / FOB
nFOB1MFt := 0
nFOB2MFt := 0
nFOB3MFt := 0

nFOB4MFt := 0
nFOB5MFt := 0
nFOB6MFt := 0

//DESPESAS FINANCEIRAS IMPORTAÇAÕ
nDFin1Imp := 0
nDFin2Imp := 0
nDFin3Imp := 0

nDFin4Imp := 0
nDFin5Imp := 0
nDFin6Imp := 0

nFIN1IMP := 0
nFIN2IMP := 0
nFIN3IMP := 0

nFIN4IMP := 0
nFIN5IMP := 0
nFIN6IMP := 0

n1FLAT   := 0
n2FLAT   := 0
n3FLAT   := 0

n4FLAT   := 0
n5FLAT   := 0
n6FLAT   := 0

n1LIBOR  := 0
n2LIBOR  := 0
n3LIBOR  := 0

n4LIBOR  := 0
n5LIBOR  := 0
n6LIBOR  := 0

n1BANQUE := 0
n2BANQUE := 0
n3BANQUE := 0

n4BANQUE := 0
n5BANQUE := 0
n6BANQUE := 0

n1DISCREP := 0
n2DISCREP := 0
n3DISCREP := 0

n4DISCREP := 0
n5DISCREP := 0
n6DISCREP := 0

n1IRImpor := 0
n2IRImpor := 0
n3IRImpor := 0

n4IRImpor := 0
n5IRImpor := 0
n6IRImpor := 0

n1OFImp := 0
n2OFImp := 0
n3OFImp := 0

n4OFImp := 0
n5OFImp := 0
n6OFImp := 0

n1HptReg := 0
n2HptReg := 0
n3HptReg := 0

n4HptReg := 0
n5HptReg := 0
n6HptReg := 0

n1MntEst := 0
n2MntEst := 0
n3MntEst := 0

n4MntEst := 0
n5MntEst := 0
n6MntEst := 0

//FRETES (Total)

//FRETE VENDAS - 2009
cNtVendFrt := "33101505"


//FRETE IMPORTAÇÃO '600201'
//cNtImporFrt := "600201"

//FRETE IMPORTAÇÃO 2009
//Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 32104506 e INCLUIR 32101006 - cNtImporFrt := "32104506"
cNtImporFrt := "32101006"

//FRETE EXPORTAÇÃO '600401'
//cNtExporFrt := "600401"

//FRETE EXPORTAÇÃO - 2009
cNtExporFrt := "33101506"

//FRETE BENEFICIAMENTO '600601'
//cNtBenefFrt := "600601"

//FRETE BENEFICIAMENTO - 2009
cNtBenefFrt := "32104508"

//FRETE TRANSFERENCIA '600501'
cNtTransfFrt := "600501"

//FRETE TRANSFERENCIA - 2009
cNtTransfFrt := "32104509"

//FRETE COMÉRCIO  '600303'
cNtComercFrt := "600303"

//FRETE COMÉRCIO - 2009
cNtComercFrt := "33101036"

//FRETE INDÚSTRIA '600301'
cNtIndusFrt := "600301"

//FRETE INDÚSTRIA - 2009
cNtIndusFrt := "32104036"

//FRETE ADMINISTRATIVO '600302'
//cNtAdminFrt := "600302"

//FRETE ADMINISTRATIVO - 2009
cNtAdminFrt := "33102036"

//Valores Pagos Ref. Fretes
n1FrtVeMVl := 0
n2FrtVeMVl := 0
n3FrtVeMVl := 0

n4FrtVeMVl := 0
n5FrtVeMVl := 0
n6FrtVeMVl := 0

n1FrtImpMVl := 0
n2FrtImpMVl := 0
n3FrtImpMVl := 0

n4FrtImpMVl := 0
n5FrtImpMVl := 0
n6FrtImpMVl := 0

n1FrtExpMVl := 0
n2FrtExpMVl := 0
n3FrtExpMVl := 0

n4FrtExpMVl := 0
n5FrtExpMVl := 0
n6FrtExpMVl := 0

n1FrtBenMVl := 0
n2FrtBenMVl := 0
n3FrtBenMVl := 0

n4FrtBenMVl := 0
n5FrtBenMVl := 0
n6FrtBenMVl := 0


n1FrtTrfMVl := 0
n2FrtTrfMVl := 0
n3FrtTrfMVl := 0

n4FrtTrfMVl := 0
n5FrtTrfMVl := 0
n6FrtTrfMVl := 0


n1FrtComMVl := 0
n2FrtComMVl := 0
n3FrtComMVl := 0

n4FrtComMVl := 0
n5FrtComMVl := 0
n6FrtComMVl := 0


n1FrtIndMVl := 0
n2FrtIndMVl := 0
n3FrtIndMVl := 0

n4FrtIndMVl := 0
n5FrtIndMVl := 0
n6FrtIndMVl := 0

n1FrtAdmMVl := 0
n2FrtAdmMVl := 0
n3FrtAdmMVl := 0

n4FrtAdmMVl := 0
n5FrtAdmMVl := 0
n6FrtAdmMVl := 0

nFt1MCIF := 0
nFt2MCIF := 0
nFt3MCIF := 0

nFt4MCIF := 0
nFt5MCIF := 0
nFt6MCIF := 0

nFt1MSDEF:= 0
nFt2MSDEF:= 0
nFt3MSDEF:= 0

nFt4MSDEF:= 0
nFt5MSDEF:= 0
nFt6MSDEF:= 0

aCFTList := {}

nVl1MesDev := 0
nVl2MesDev := 0
nVl3MesDev := 0
               
nVl4MesDev := 0
nVl5MesDev := 0
nVl6MesDev := 0
//Valor da Matéria Prima
nComp1VlMP := 0
nComp2VlMP := 0
nComp3VlMP := 0

//Custo da Matéria Prima
nVl1MCusMP   := 0
nVl2MCusMP   := 0
nVl3MCusMP   := 0

//Qtd. de Compra da Matéria Prima
nQt1CompMP   := 0
nQt2CompMP   := 0
nQt3CompMP   := 0

//Qtd. Mat.Prima Faturada
nQtd1FatMP   := 0
nQtd2FatMP   := 0
nQtd3FatMP   := 0


//Devoluções por Mat.Prima
aDev1MPCli  := {}
aDev2MPCli  := {}
aDev3MPCli  := {}

aDev4MPCli  := {}
aDev5MPCli  := {}
aDev6MPCli  := {}

aDev4MPCli  := {}
aDev5MPCli  := {}
aDev6MPCli  := {}


//Produção por Materia Prima
aProd1MP    := {}
aProd2MP    := {}
aProd3MP    := {}

aProd4MP    := {}
aProd5MP    := {}
aProd6MP    := {}

//Fechamento do Estoque por Materia Prima
aFech1MPEst := {}
aFech2MPEst := {}
aFech3MPEst := {}

aFech4MPEst := {}
aFech5MPEst := {}
aFech6MPEst := {}

//Fechamento do Estoque por Mat.Prima Especifico Sliter
aFch1MPSlt  := {}
aFch2MPSlt  := {}
aFch3MPSlt  := {}

aFch4MPSlt  := {}
aFch5MPSlt  := {}
aFch6MPSlt  := {}

//Custo Produto Acabado por Materia Prima
a1MPAMP := {}
a2MPAMP := {}
a3MPAMP := {}

a4MPAMP := {}
a5MPAMP := {}
a6MPAMP := {}

nCus1MesDev := 0
nCus2MesDev := 0
nCus3MesDev := 0

n1MesFtLiq  := 0
n2MesFtLiq  := 0
n3MesFtLiq  := 0

n4MesFtLiq  := 0
n5MesFtLiq  := 0
n6MesFtLiq  := 0

nCMP1Mes    := 0
nCMP2Mes    := 0
nCMP3Mes    := 0

nCMP4Mes    := 0
nCMP5Mes    := 0
nCMP6Mes    := 0

nMg1Mes := 0 
nMg2Mes := 0
nMg3Mes := 0

nMg4Mes := 0 
nMg5Mes := 0
nMg6Mes := 0

nProdTon1Mes := 0 
nProdTon2Mes := 0
nProdTon3Mes := 0

nProdTon4Mes := 0 
nProdTon5Mes := 0
nProdTon6Mes := 0


nVlr1MesBx := 0
nProd1Mes  := 0
nVlr2MesBx := 0
nProd2Mes  := 0
nVlr3MesBx := 0
nProd3Mes  := 0

nVlr4MesBx := 0
nProd4Mes  := 0
nVlr5MesBx := 0
nProd5Mes  := 0
nVlr6MesBx := 0
nProd6Mes  := 0
      
n1MTonelVen  := 0
n2MTonelVen  := 0
n3MTonelVen  := 0

n4MTonelVen  := 0
n5MTonelVen  := 0
n6MTonelVen  := 0

n4MTonelVen  := 0
n5MTonelVen  := 0
n6MTonelVen  := 0

nQtTon1MVen := 0
nQtTon1MAPd := 0
nQtTon2MVen := 0
nQtTon2MAPd := 0
nQtTon3MVen := 0
nQtTon3MAPd := 0

nQtTon4MVen := 0
nQtTon4MAPd := 0
nQtTon5MVen := 0
nQtTon5MAPd := 0
nQtTon6MVen := 0
nQtTon6MAPd := 0
            
nMatPrim1Mes :=0 
nMatPrim2Mes :=0 
nMatPrim3Mes :=0 

nMatPrim4Mes :=0 
nMatPrim5Mes :=0 
nMatPrim6Mes :=0 


nCus1MesFat := 0
n1MTonelVen := 0
nCus2MesFat := 0
n2MTonelVen := 0
nCus3MesFat := 0
n3MTonelVen := 0

nCus4MesFat := 0
n4MTonelVen := 0
nCus5MesFat := 0
n5MTonelVen := 0
nCus6MesFat := 0
n6MTonelVen := 0
      
nOutras := 0

nCMTon1Mes := 0 
nCMTon2Mes := 0 
nCMTon3Mes := 0 

nProdTon1Mes := 0
nMatPrim1Mes := 0
nProdTon2Mes := 0
nMatPrim2Mes := 0 
nProdTon3Mes := 0
nMatPrim3Mes := 0

nPMVen1Mes  := 0
nPMVen2Mes  := 0
nPMVen3Mes  := 0

nMgMed1Mes := 0
nMgMed2Mes := 0
nMgMed3Mes := 0

nPMVen1Mes := 0
nCMTon1Mes := 0
nPMVen2Mes := 0
nCMTon2Mes := 0
nPMVen3Mes := 0
nCMTon3Mes := 0

//Perdas
nPerd1Vlr  := 0
nPerd2Vlr  := 0
nPerd3Vlr  := 0

nPerd4Vlr  := 0
nPerd5Vlr  := 0
nPerd6Vlr  := 0

//Comissão

nVl1MComis := 0
nVl2MComis := 0
nVl3MComis := 0

nVl4MComis := 0
nVl5MComis := 0
nVl6MComis := 0

//Representação

nVl1MRepres := 0
nVl2MRepres := 0
nVl3MRepres := 0

nVl4MRepres := 0
nVl5MRepres := 0
nVl6MRepres := 0

//Gastos Gerais

nVl1MGGComl := 0
nVl2MGGComl := 0
nVl3MGGComl := 0

nVl4MGGComl := 0
nVl5MGGComl := 0
nVl6MGGComl := 0

nVl1MGGMO  := 0
nVl2MGGMO  := 0
nVl3MGGMO  := 0

nVl4MGGMO  := 0
nVl5MGGMO  := 0
nVl6MGGMO  := 0

nVl1MDFGG  := 0
nVl2MDFGG  := 0
nVl3MDFGG  := 0

nVl4MDFGG  := 0
nVl5MDFGG  := 0
nVl6MDFGG  := 0
      
nVl1MDPGG  := 0
nVl2MDPGG  := 0
nVl3MDPGG  := 0

nVl4MDPGG  := 0
nVl5MDPGG  := 0
nVl6MDPGG  := 0

nVl1MResGG  := 0
nVl2MResGG  := 0
nVl3MResGG  := 0

nVl4MResGG  := 0
nVl5MResGG  := 0
nVl6MResGG  := 0
      
nVl1MPrmGG  := 0
nVl2MPrmGG  := 0
nVl3MPrmGG  := 0

nVl4MPrmGG  := 0
nVl5MPrmGG  := 0
nVl6MPrmGG  := 0

nVl1MComis  := 0
nVl2MComis  := 0
nVl3MComis  := 0

nVl1MRepres := 0
nVl2MRepres := 0
nVl3MRepres := 0

nVl1MMktGG  := 0
nVl2MMktGG  := 0
nVl3MMktGG  := 0

nVl4MMktGG  := 0
nVl5MMktGG  := 0
nVl6MMktGG  := 0
      
nVl1MDVgGG  := 0
nVl2MDVgGG  := 0 
nVl3MDVgGG  := 0

nVl4MDVgGG  := 0
nVl5MDVgGG  := 0 
nVl6MDVgGG  := 0

nVl1MDFrtGG  := 0
nVl2MDFrtGG  := 0
nVl3MDFrtGG  := 0

nVl4MDFrtGG  := 0
nVl5MDFrtGG  := 0
nVl6MDFrtGG  := 0
      
nVl1MOutDGG  := 0
nVl2MOutDGG  := 0
nVl3MOutDGG  := 0
      
nVl1MONtGG  := 0
nVl2MONtGG  := 0
nVl3MONtGG  := 0
                
nVl4MONtGG  := 0
nVl5MONtGG  := 0
nVl6MONtGG  := 0

//Metas do Orçamento
/*
nMetasVlr  := 0
nMetasVlr  := 0
nMetasVlr  := 0
*/
      
nGst1MMtOrC  := 0
nGst2MMtOrC  := 0
nGst3MMtOrC  := 0

nGst4MMtOrC  := 0
nGst5MMtOrC  := 0
nGst6MMtOrC  := 0

//Faturamento Sucata

nVl1SUCMFat  := 0
nVl2SUCMFat  := 0
nVl3SUCMFat  := 0

nVl4SUCMFat  := 0
nVl5SUCMFat  := 0
nVl6SUCMFat  := 0
      
aTSUCList := {}
   
nVlM1CusSUC  := 0
nVlM2CusSUC := 0
nVlM3CusSUC := 0

nVlM4CusSUC  := 0
nVlM5CusSUC := 0
nVlM6CusSUC := 0
      
nMg1SUCMes := 0
nMg2SUCMes := 0
nMg3SUCMes := 0

nQt1MSUCVen := 0
nQt2MSUCVen  := 0
nQt3MSUCVen  := 0

nQt4MSUCVen := 0
nQt5MSUCVen  := 0
nQt6MSUCVen  := 0
      
nPMV1SUCM  := 0
nPMV2SUCM  := 0
nPMV3SUCM  := 0

// Variaveis Indústria


nProvd1M := 0
nProvd2M := 0
nProvd3M := 0

nProvd4M := 0
nProvd5M := 0
nProvd6M := 0


n1MTonelVen := 0
n2MTonelVen  := 0
n3MTonelVen  := 0

nProd1Mes := 0
nProd2Mes := 0
nProd3Mes := 0

aMaqPrdM := {}

nQtdFM1MEst := 0
nQtdFM2MEst := 0
nQtdFM3MEst := 0

nQtdFM4MEst := 0
nQtdFM5MEst := 0
nQtdFM6MEst := 0
      
nVlrFM1MEst  := 0
nVlrFM2MEst := 0
nVlrFM3MEst  := 0

nVlrFM4MEst  := 0
nVlrFM5MEst := 0
nVlrFM6MEst  := 0

//Materia Prima Sliter

nQt1MPSlit := 0
nQt2MPSlit := 0
nQt3MPSlit := 0

nQt4MPSlit := 0
nQt5MPSlit := 0
nQt6MPSlit := 0

nVl1MCSlit := 0
nVl2MCSlit := 0
nVl3MCSlit := 0

nVl4MCSlit := 0
nVl5MCSlit := 0
nVl6MCSlit := 0
      
nVM1MMP := 0
nVM2MMP := 0
nVM3MMP := 0

nVM4MMP := 0
nVM5MMP := 0
nVM6MMP := 0

nQt1PAM := 0
nQt2PAM := 0
nQt3PAM := 0

nQt4PAM := 0
nQt5PAM := 0
nQt6PAM := 0

nCs1PAM  := 0
nCs2PAM  := 0
nCs3PAM  := 0

nCs4PAM  := 0
nCs5PAM  := 0
nCs6PAM  := 0

nVM1MPA := 0
nVM2MPA := 0
nVM3MPA := 0

nVM4MPA := 0
nVM5MPA := 0
nVM6MPA := 0
      
nVlr1CusPro  := 0
nVlr2CusPro  := 0
nVlr3CusPro  := 0

nVlr4CusPro  := 0
nVlr5CusPro  := 0
nVlr6CusPro  := 0


// Gastos Gerais Indústria

nVGG1MInd  := 0
nVGG2MInd  := 0
nVGG3MInd  := 0

nVGG4MInd  := 0
nVGG5MInd  := 0
nVGG6MInd  := 0

nVImob1MTt := 0
nVImob2MTt := 0
nVImob3MTt := 0

nVImob4MTt := 0
nVImob5MTt := 0
nVImob6MTt := 0
      
nVMqMt1MTt  := 0
nVMqMt2MTt  := 0
nVMqMt3MTt  := 0

nVMqMt4MTt  := 0
nVMqMt5MTt  := 0
nVMqMt6MTt  := 0

nVlM1ImpInd  := 0
nVlM2ImpInd  := 0
nVlM3ImpInd  := 0

nVlM4ImpInd  := 0
nVlM5ImpInd  := 0
nVlM6ImpInd  := 0

nVlInfM1Ind  := 0
nVlInfM2Ind  := 0
nVlInfM3Ind  := 0

nVlInfM4Ind  := 0
nVlInfM5Ind  := 0
nVlInfM6Ind  := 0
      
nVlMU1MInd  := 0
nVlMU2MInd  := 0
nVlMU3MInd  := 0

nVlMU4MInd  := 0
nVlMU5MInd  := 0
nVlMU6MInd  := 0

nVl1MInvTt  := 0
nVl2MInvTt  := 0
nVl3MInvTt  := 0

nVl4MInvTt  := 0
nVl5MInvTt  := 0
nVl6MInvTt  := 0

nVl1MEmpInv  := 0
nVl2MEmpInv := 0
nVl3MEmpInv := 0

nVl4MEmpInv  := 0
nVl5MEmpInv := 0
nVl6MEmpInv := 0

nVlMq1MInv  := 0
nVlMq2MInv  := 0
nVlMq3MInv  := 0

nVlMq4MInv  := 0
nVlMq5MInv  := 0
nVlMq6MInv  := 0

nVlFin1MInv  := 0
nVlFin2MInv  := 0
nVlFin3MInv  := 0

nVlFin4MInv  := 0
nVlFin5MInv  := 0
nVlFin6MInv  := 0
      
nVlLea1MInv  := 0
nVlLea2MInv  := 0
nVlLea3MInv  := 0

nVlLea4MInv  := 0
nVlLea5MInv  := 0
nVlLea6MInv  := 0

nVlBenf1MI  := 0
nVlBenf2MI  := 0
nVlBenf3MI  := 0

nVlBenf4MI  := 0
nVlBenf5MI  := 0
nVlBenf6MI  := 0

nVlISO1MI  := 0
nVlISO2MI  := 0
nVlISO3MI  := 0

nVlISO4MI  := 0
nVlISO5MI  := 0
nVlISO6MI  := 0

nMP1MVlTt  := 0
nMP2MVlTt := 0
nMP3MVlTt := 0

nMP4MVlTt  := 0
nMP5MVlTt := 0
nMP6MVlTt := 0

nNacMP1MVl  := 0
nNacMP2MVl := 0
nNacMP3MVl := 0

nNacMP4MVl  := 0
nNacMP5MVl := 0
nNacMP6MVl := 0


nNMP1AFRMM := 0
nNMP2AFRMM := 0
nNMP3AFRMM := 0

nNMP4AFRMM := 0
nNMP5AFRMM := 0
nNMP6AFRMM := 0

//Amazenagem - Five Solutions Consultoria - 11/02/2010 - Novo Indicador Armazenagem
n1Amazena := 0
n2Amazena := 0
n3Amazena := 0

n4Amazena := 0
n5Amazena := 0
n6Amazena := 0


nNMP1OpPrt := 0
nNMP2OpPrt := 0
nNMP3OpPrt := 0

nNMP4OpPrt := 0
nNMP5OpPrt := 0
nNMP6OpPrt := 0

nNMP1DspAdu := 0
nNMP2DspAdu := 0
nNMP3DspAdu := 0

nNMP4DspAdu := 0
nNMP5DspAdu := 0
nNMP6DspAdu := 0

nImpMP1MVl  := 0
nImpMP2MVl := 0
nImpMP3MVl  := 0

nImpMP4MVl  := 0
nImpMP5MVl := 0
nImpMP6MVl  := 0

nTrbImp1MMP  := 0
nTrbImp2MMP := 0
nTrbImp3MMP  := 0

nTrbImp4MMP  := 0
nTrbImp5MMP := 0
nTrbImp6MMP  := 0

nDspImp1MMP  := 0
nDspImp2MMP  := 0
nDspImp3MMP  := 0

nDspImp4MMP  := 0
nDspImp5MMP  := 0
nDspImp6MMP  := 0

nFrtImp1MMP  := 0
nFrtImp2MMP := 0
nFrtImp3MMP := 0

nFrtImp4MMP  := 0
nFrtImp5MMP := 0
nFrtImp6MMP := 0

nInsVl1MInd  := 0
nInsVl2MInd := 0
nInsVl3MInd := 0

nInsVl4MInd  := 0
nInsVl5MInd := 0
nInsVl6MInd := 0

nEmb1DIIndVl := 0
nEmb2DIIndVl := 0
nEmb3DIIndVl := 0

nEmb4DIIndVl := 0
nEmb5DIIndVl := 0
nEmb6DIIndVl := 0

nDMOInd1MVl  := 0
nDMOInd2MVl := 0
nDMOInd3MVl := 0

nDMOInd4MVl  := 0
nDMOInd5MVl := 0
nDMOInd6MVl := 0

nFixMOD1MInd  := 0
nFixMOD2MInd := 0
nFixMOD3MInd := 0

nFixMOD4MInd  := 0
nFixMOD5MInd := 0
nFixMOD6MInd := 0

nFixMOI1MInd  := 0
nFixMOI2MInd := 0
nFixMOI3MInd := 0

nFixMOI4MInd  := 0
nFixMOI5MInd := 0
nFixMOI6MInd := 0

nPerMOD1MInd  := 0
nPerMOD2MInd := 0
nPerMOD3MInd  := 0

nPerMOD4MInd  := 0
nPerMOD5MInd := 0
nPerMOD6MInd  := 0

nPerMOI1MInd  := 0
nPerMOI2MInd := 0
nPerMOI3MInd  := 0

nPerMOI4MInd  := 0
nPerMOI5MInd := 0
nPerMOI6MInd  := 0
      
nRes1MDIndVl  := 0
nRes2MDIndVl := 0
nRes3MDIndVl := 0

nRes4MDIndVl  := 0
nRes5MDIndVl := 0
nRes6MDIndVl := 0

nRes1MIIndVl := 0
nRes2MIIndVl := 0
nRes3MIIndVl := 0

nRes4MIIndVl := 0
nRes5MIIndVl := 0
nRes6MIIndVl := 0
      
nPrm1DIndVl := 0
nPrm2DIndVl := 0
nPrm3DIndVl := 0

nPrm4DIndVl := 0
nPrm5DIndVl := 0
nPrm6DIndVl := 0

nBnf1IndVl  := 0
nBnf2IndVl := 0
nBnf3IndVl := 0

nBnf4IndVl  := 0
nBnf5IndVl := 0
nBnf6IndVl := 0

nMan1IndVl  := 0
nMan2IndVl  := 0
nMan3IndVl  := 0

nManEL1IndVl := 0
nManEL2IndVl := 0
nManEL3IndVl := 0

nManEL4IndVl := 0
nManEL5IndVl := 0
nManEL6IndVl := 0

nManFE1IndVl := 0
nManFE2IndVl := 0
nManFE3IndVl := 0

nManFE4IndVl := 0
nManFE5IndVl := 0
nManFE6IndVl := 0

nManME1IndVl := 0
nManME2IndVl := 0
nManME3IndVl := 0

nManME4IndVl := 0
nManME5IndVl := 0
nManME6IndVl := 0

//IMPOSTOS 
nImp1IndVl := 0
nImp2IndVl := 0
nImp3IndVl := 0

nImp4IndVl := 0
nImp5IndVl := 0
nImp6IndVl := 0

//Five Solutions Consultoria 11/02/2010 - Rateio dos Impostos
n1ICMSImob := 0
n2ICMSImob := 0
n3ICMSImob := 0

n4ICMSImob := 0
n5ICMSImob := 0
n6ICMSImob := 0

n1ICMPuro  := 0
n2ICMPuro  := 0
n3ICMPuro  := 0

n4ICMPuro  := 0
n5ICMPuro  := 0
n6ICMPuro  := 0

n1IPISo    := 0
n2IPISo    := 0
n3IPISo    := 0

n4IPISo    := 0
n5IPISo    := 0
n6IPISo    := 0


n1PISUnk   := 0
n2PISUnk   := 0
n3PISUnk   := 0

n4PISUnk   := 0
n5PISUnk   := 0
n6PISUnk   := 0

n1COFUnk   := 0
n2COFUnk   := 0
n3COFUnk   := 0

n4COFUnk   := 0
n5COFUnk   := 0
n6COFUnk   := 0

n1CSLUnk   := 0
n2CSLUnk   := 0
n3CSLUnk   := 0

n4CSLUnk   := 0
n5CSLUnk   := 0
n6CSLUnk   := 0

n1IRPJnk   := 0
n2IRPJnk   := 0
n3IRPJnk   := 0

n4IRPJnk   := 0
n5IRPJnk   := 0
n6IRPJnk   := 0

n1IRPFnk   := 0
n2IRPFnk   := 0
n3IRPFnk   := 0

n4IRPFnk   := 0
n5IRPFnk   := 0
n6IRPFnk   := 0

n1IINum    := 0
n2IINum    := 0
n3IINum    := 0

n4IINum    := 0
n5IINum    := 0
n6IINum    := 0

//------------------------------ Fim do Rateio dos Impostos

nSTc1IndVl := 0
nSTc2IndVl := 0
nSTc3IndVl := 0

nSTc4IndVl := 0
nSTc5IndVl := 0
nSTc6IndVl := 0

nSTc1ComVl  := 0
nSTc2ComVl := 0
nSTc3ComVl := 0

nSTc4ComVl  := 0
nSTc5ComVl := 0
nSTc6ComVl := 0

nEPI1IndVl  := 0
nEPI2IndVl := 0
nEPI3IndVl := 0

nEPI4IndVl  := 0
nEPI5IndVl := 0
nEPI6IndVl := 0

nEner1IndVl  := 0
nEner2IndVl := 0
nEner3IndVl := 0

nEner4IndVl  := 0
nEner5IndVl := 0
nEner6IndVl := 0

nAgua1IndVl := 0
nAgua2IndVl := 0
nAgua3IndVl := 0

nAgua4IndVl := 0
nAgua5IndVl := 0
nAgua6IndVl := 0

nAlg1IndVl  := 0
nAlg2IndVl  := 0
nAlg3IndVl  := 0

nAlg4IndVl  := 0
nAlg5IndVl  := 0
nAlg6IndVl  := 0

nCPr1IndVl  := 0
nCPr2IndVl  := 0
nCPr3IndVl  := 0

nDVg1IndVl  := 0
nDVg2IndVl  := 0
nDVg3IndVl  := 0

nDVg4IndVl  := 0
nDVg5IndVl  := 0
nDVg6IndVl  := 0
      
nODp1IndVl  := 0
nODp2IndVl  := 0
nODp3IndVl  := 0

nODp4IndVl  := 0
nODp5IndVl  := 0
nODp6IndVl  := 0

nDsbFx1Dsp  := 0
nDsbFx2Dsp  := 0
nDsbFx3Dsp  := 0

nDsbFx4Dsp  := 0
nDsbFx5Dsp  := 0
nDsbFx6Dsp  := 0

nDsbF1Ad    := 0
nDsbF2Ad    := 0
nDsbF3Ad    := 0

nDsbF4Ad    := 0
nDsbF5Ad    := 0
nDsbF6Ad    := 0

nONt1IndVl  := 0
nONt2IndVl  := 0
nONt3IndVl  := 0

nONt4IndVl  := 0
nONt5IndVl  := 0
nONt6IndVl  := 0

nGst1MtOrInd  := 0
nGst2MtOrInd := 0
nGst3MtOrInd := 0

nGst4MtOrInd  := 0
nGst5MtOrInd := 0
nGst6MtOrInd := 0

//Variaveis Administrativo - Financeiro

nPd1MTrvTt := 0
nPd2MTrvTt := 0
nPd3MTrvTt := 0

nPd4MTrvTt := 0
nPd5MTrvTt := 0
nPd6MTrvTt := 0

nPdTrv1MVlr:=0
nPdTrv1AntM:=0

nPdTrv2MVlr:=0
nPdTrv2AntM:=0

nPdTrv3MVlr:=0
nPdTrv3AntM:=0

nPdTrv4MVlr:=0
nPdTrv4AntM:=0

nPdTrv5MVlr:=0
nPdTrv5AntM:=0

nPdTrv6MVlr:=0
nPdTrv6AntM:=0


nTit1MTrvTt := 0
nTit2MTrvTt := 0
nTit3MTrvTt := 0

nTit1MTrvVlr:=0
nAntTit1MTrv:=0                  
nTit2MTrvVlr:=0
nAntTit2MTrv:=0
nTit3MTrvVlr:=0
nAntTit3MTrv:=0

// Títulos

nAPg1MTit := 0
nAPg2MTit := 0
nAPg3MTit  := 0

nAPg4MTit := 0
nAPg5MTit := 0
nAPg6MTit  := 0

nPg1MRealiz := 0
nPg2MRealiz := 0
nPg3MRealiz  := 0
      
nBx1MComp := 0
nBx2MComp := 0
nBx3MComp  := 0

nBx4MComp := 0
nBx5MComp := 0
nBx6MComp  := 0

nDBT1MCC := 0
nDBT2MCC := 0
nDBT3MCC := 0

nDBT4MCC := 0
nDBT5MCC := 0
nDBT6MCC := 0

nBx1MNorm := 0
nBx2MNorm := 0
nBx3MNorm := 0

nBx4MNorm := 0
nBx5MNorm := 0
nBx6MNorm := 0

nBx1MDevol := 0
nBx2MDevol := 0
nBx3MDevol  := 0

nBx4MDevol := 0
nBx5MDevol := 0
nBx6MDevol  := 0

nPgAb1MVlr := 0
nPgAb2MVlr := 0
nPgAb3MVlr := 0

nPgAb4MVlr := 0
nPgAb5MVlr := 0
nPgAb6MVlr := 0

nSld1MPag := 0
nSld2MPag := 0
nSld3MPag := 0

nSld1MAnt := 0
nSld2MAnt := 0
nSld3MAnt := 0

nTt1MAPG := 0
nTt2MAPG := 0
nTt3MAPG := 0

nAPg1M1a30:=0
nAPg1M31a60:=0

//Five Solutions Consultoria
//20 de agosto de 2008
//Limite de demonstração de prazo de títulos no fluxo de caixa, para "acima de 60 dias"
nAcm1M60dd := 0
nAcm2M60dd := 0
nAcm3M60dd := 0

nAcm4M60dd := 0
nAcm5M60dd := 0
nAcm6M60dd := 0

nAPg1M61a90:=0
nAPg1M90M:=0

nAPg2M1a30:=0
nAPg2M31a60:=0
nAPg2M61a90:=0
nAPg2M90M:=0

nAPg3M1a30:=0
nAPg4M1a30:=0
nAPg5M1a30:=0
nAPg6M1a30:=0

nAPg3M31a60:=0
nAPg4M31a60:=0
nAPg5M31a60:=0
nAPg6M31a60:=0

nAPg3M61a90:=0
nAPg4M61a90:=0
nAPg5M61a90:=0
nAPg6M61a90:=0

nAPg3M90M:=0
nAPg4M90M:=0
nAPg5M90M:=0
nAPg6M90M:=0

nARe1MTit := 0
nARe2MTit := 0
nARe3MTit := 0

nARe4MTit := 0
nARe5MTit := 0
nARe6MTit := 0

nRe1MRealiz := 0
nRe2MRealiz := 0
nRe3MRealiz := 0
      
nBxRE1MComp := 0
nBxRE2MComp := 0
nBxRE3MComp := 0

nBxRE4MComp := 0
nBxRE5MComp := 0
nBxRE6MComp := 0
      
nBx1MDvRE := 0
nBx2MDvRE := 0
nBx3MDvRE := 0

nBx4MDvRE := 0
nBx5MDvRE := 0
nBx6MDvRE := 0

nBxRE1MNorm := 0
nBxRE2MNorm := 0
nBxRE3MNorm := 0

nBxRE4MNorm := 0
nBxRE5MNorm := 0
nBxRE6MNorm := 0

nSld1MRec := 0
nSld2MRec := 0
nSld3MRec := 0

nPer1MInadpl := 0
nPer2MInadpl := 0
nPer3MInadpl := 0

nTt1MVc := 0
nTt2MVc := 0
nTt3MVc := 0

nAAtTt1MVc := 0
nAAtTt2MVc := 0
nAAtTt3MVc := 0

nAAtTt4MVc := 0
nAAtTt5MVc := 0
nAAtTt6MVc := 0

nA1ATt1MVc := 0
nA1ATt2MVc := 0
nA1ATt3MVc := 0

nA1ATt4MVc := 0
nA1ATt5MVc := 0
nA1ATt6MVc := 0

nA2ATt1MVc := 0
nA2ATt2MVc := 0
nA2ATt3MVc := 0

nA2ATt4MVc := 0
nA2ATt5MVc := 0
nA2ATt6MVc := 0

nAAntTt1MVc := 0
nAAntTt2MVc := 0
nAAntTt3MVc := 0

nAAntTt4MVc := 0
nAAntTt5MVc := 0
nAAntTt6MVc := 0


nTtFlx1MARE := 0
nTtFlx2MARE := 0
nTtFlx3MARE := 0

nARe1M1a30:=0
nARe1M31a60:=0
nARe1M61a90:=0
nARe1M90M:=0
nARe2M1a30:=0
nARe2M31a60:=0
nARe2M61a90:=0
nARe2M90M:=0
nARe3M1a30:=0
nARe3M31a60:=0
nARe3M61a90:=0
nARe3M90M:=0

// Gastos Gerais Adm/Fin
nVl1MAdmGG := 0
nVl2MAdmGG := 0
nVl3MAdmGG := 0

nVl4MAdmGG := 0
nVl5MAdmGG := 0
nVl6MAdmGG := 0

nVGG1MMOADM := 0
nVGG2MMOADM := 0
nVGG3MMOADM := 0

nVGG4MMOADM := 0
nVGG5MMOADM := 0
nVGG6MMOADM := 0

nVGG1MDFADM := 0
nVGG2MDFADM := 0
nVGG3MDFADM := 0

nVGG4MDFADM := 0
nVGG5MDFADM := 0
nVGG6MDFADM := 0

nVGG1MDPAD := 0
nVGG2MDPAD := 0
nVGG3MDPAD := 0

nVGG4MDPAD := 0
nVGG5MDPAD := 0
nVGG6MDPAD := 0

nVRes1MAdm := 0
nVRes2MAdm := 0
nVRes3MAdm := 0

nVRes4MAdm := 0
nVRes5MAdm := 0
nVRes6MAdm := 0


nVPrm1MAdm := 0
nVPrm2MAdm := 0
nVPrm3MAdm := 0

nVPrm4MAdm := 0
nVPrm5MAdm := 0
nVPrm6MAdm := 0

nVDVia1MAdm := 0
nVDVia2MAdm := 0
nVDVia3MAdm := 0

nVDVia4MAdm := 0
nVDVia5MAdm := 0
nVDVia6MAdm := 0

nVOut1MAdm := 0
nVOut2MAdm := 0
nVOut3MAdm := 0

nVOut4MAdm := 0
nVOut5MAdm := 0
nVOut6MAdm := 0

//Serviços Terceirizados
nVSvT1MAdm := 0
nVSvT2MAdm := 0
nVSvT3MAdm := 0

nVSvT4MAdm := 0
nVSvT5MAdm := 0
nVSvT6MAdm := 0

//Despesas Financeiras
nDsp1Fin := 0
nDsp2Fin := 0
nDsp3Fin := 0

nDsp4Fin := 0
nDsp5Fin := 0
nDsp6Fin := 0

nCap1ex  := 0
nCap2ex  := 0
nCap3ex  := 0

nCap4ex  := 0
nCap5ex  := 0
nCap6ex  := 0

nDp1Amor := 0
nDp2Amor := 0
nDp3Amor := 0
      
nDp4Amor := 0
nDp5Amor := 0
nDp6Amor := 0
      
nOut1MAdm := 0
nOut2MAdm := 0
nOut3MAdm := 0

nOut4MAdm := 0
nOut5MAdm := 0
nOut6MAdm := 0

nGMt1MAdm := 0
nGMt2MAdm := 0
nGMt3MAdm := 0

nGMt4MAdm := 0
nGMt5MAdm := 0
nGMt6MAdm := 0

nEmp1MAdmEE := 0
nEmp2MAdmEE := 0
nEmp3MAdmEE := 0

nEmp4MAdmEE := 0
nEmp5MAdmEE := 0
nEmp6MAdmEE := 0



//Caixa Geral - 2009
nCxGer1MAdm := 0
nCxGer2MAdm := 0
nCxGer3MAdm := 0

nCxGer4MAdm := 0
nCxGer5MAdm := 0
nCxGer6MAdm := 0

//Caixinha - 2009
nCxnha1MAdm := 0
nCxnha2MAdm := 0
nCxnha3MAdm := 0

nCxnha4MAdm := 0
nCxnha5MAdm := 0
nCxnha6MAdm := 0

//Investimentos
nInves1MAdm := 0
nInves2MAdm := 0
nInves3MAdm := 0

nInves4MAdm := 0
nInves5MAdm := 0
nInves6MAdm := 0

//Empréstimos Tomados
nEmpTom1MAdm := 0
nEmpTom2MAdm := 0
nEmpTom3MAdm := 0

nEmpTom4MAdm := 0
nEmpTom5MAdm := 0
nEmpTom6MAdm := 0

//Empréstimos Concedidos
nEmpCon1MAdm := 0
nEmpCon2MAdm := 0
nEmpCon3MAdm := 0

nEmpCon4MAdm := 0
nEmpCon5MAdm := 0
nEmpCon6MAdm := 0

//IMOBILIZADO(TOTAL)
//Bens Imóveis
nImbBI1MAdm := 0
nImbBI2MAdm := 0
nImbBI3MAdm := 0


nImbBI4MAdm := 0
nImbBI5MAdm := 0
nImbBI6MAdm := 0

//Bens Móveis
nImbBM1MAdm := 0
nImbBM2MAdm := 0
nImbBM3MAdm := 0

nImbBM4MAdm := 0
nImbBM5MAdm := 0
nImbBM6MAdm := 0

//Impostos e Contribuição (Total)

nImp1MCTt := 0
nImp2MCTt := 0
nImp3MCTt := 0

nImp4MCTt := 0
nImp5MCTt := 0
nImp6MCTt := 0

nV1MINSS := 0
nV2MINSS := 0
nV3MINSS := 0

nV4MINSS := 0
nV5MINSS := 0
nV6MINSS := 0

nV1MFGTS := 0
nV2MFGTS := 0
nV3MFGTS := 0

nV4MFGTS := 0
nV5MFGTS := 0
nV6MFGTS := 0

nV1MCPMF := 0
nV2MCPMF := 0
nV3MCPMF := 0

nV4MCPMF := 0
nV5MCPMF := 0
nV6MCPMF := 0

nV1MIPTU := 0
nV2MIPTU := 0
nV3MIPTU := 0

nV4MIPTU := 0
nV5MIPTU := 0
nV6MIPTU := 0

nV1MIPI := 0
nV2MIPI := 0
nV3MIPI := 0

nV4MIPI := 0
nV5MIPI := 0
nV6MIPI := 0

nV1MICMS := 0
nV2MICMS := 0
nV3MICMS := 0

nV4MICMS := 0
nV5MICMS := 0
nV6MICMS := 0

nV1MISS := 0
nV2MISS := 0
nV3MISS := 0

nV4MISS := 0
nV5MISS := 0
nV6MISS := 0

nV1MIRImp := 0
nV2MIRImp := 0
nV3MIRImp := 0

nV4MIRImp := 0
nV5MIRImp := 0
nV6MIRImp := 0

nV1MImpImport := 0
nV2MImpImport := 0
nV3MImpImport := 0


//Novas Linhas de Valores Acrescentadas - Solicitação Patrícia 14/02/2008

nHonor1MAdv := 0
nHonor2MAdv := 0
nHonor3MAdv := 0

nHonor4MAdv := 0
nHonor5MAdv := 0
nHonor6MAdv := 0

nDsp1MJudc := 0
nDsp2MJudc := 0
nDsp3MJudc := 0

nDsp4MJudc := 0
nDsp5MJudc := 0
nDsp6MJudc := 0

nRes1MAcAd := 0
nRes2MAcAd := 0
nRes3MAcAd := 0

nRes4MAcAd := 0
nRes5MAcAd := 0
nRes6MAcAd := 0
      
nFnd1MFixo := 0
nFnd2MFixo := 0
nFnd3MFixo := 0

nFnd4MFixo := 0
nFnd5MFixo := 0
nFnd6MFixo := 0

nPIS1MCOF := 0
nPIS2MCOF := 0
nPIS3MCOF := 0

nPIS4MCOF := 0
nPIS5MCOF := 0
nPIS6MCOF := 0

n1MTribut := 0
n2MTribut := 0
n3MTribut := 0

n4MTribut := 0
n5MTribut := 0
n6MTribut := 0

//Metas de Orçamentos

nCom1MMtOrc := 0 //Meta Orçamento Comércio Mês 1
nCom2MMtOrc := 0 //Meta Orçamento Comércio Mês 2
nCom3MMtOrc := 0 //Meta Orçamento Comércio Mês 3

nCom4MMtOrc := 0 //Meta Orçamento Comércio Mês 4
nCom5MMtOrc := 0 //Meta Orçamento Comércio Mês 5
nCom6MMtOrc := 0 //Meta Orçamento Comércio Mês 6

nInd1MMtOrc := 0 //Meta Orçamento Indústria Mês 1
nInd2MMtOrc := 0 //Meta Orçamento Indústria Mês 2
nInd3MMtOrc := 0 //Meta Orçamento Indústria Mês 3

nInd4MMtOrc := 0 //Meta Orçamento Indústria Mês 1
nInd5MMtOrc := 0 //Meta Orçamento Indústria Mês 2
nInd6MMtOrc := 0 //Meta Orçamento Indústria Mês 3

nAdm1MMtOrc := 0 //Meta Orçamento Administração Mês 1
nAdm2MMtOrc := 0 //Meta Orçamento Administração Mês 2
nAdm3MMtOrc := 0 //Meta Orçamento Administração Mês 3

nAdm4MMtOrc := 0 //Meta Orçamento Administração Mês 1
nAdm5MMtOrc := 0 //Meta Orçamento Administração Mês 2
nAdm6MMtOrc := 0 //Meta Orçamento Administração Mês 3

//Demonstrativo de Resultado

//Importação - Five - 25/11/2010
nEnt1MPFI := 0 //Five Solutions Consultoria - 25/10/2010
nEnt2MPFI := 0
nEnt3MPFI := 0

nEnt4MPFI := 0 //Five Solutions Consultoria - 25/10/2010
nEnt5MPFI := 0
nEnt6MPFI := 0

nFr1tMP   := 0
nFr2tMP   := 0
nFr3tMP   := 0

nFr4tMP   := 0
nFr5tMP   := 0
nFr6tMP   := 0

//Fretes
nVl1MsFrete := 0
nVl2MsFrete := 0
nVl3MsFrete := 0

nVl4MsFrete := 0
nVl5MsFrete := 0
nVl6MsFrete := 0

//Faturamento por Condição de Pagamento
nFat1AVista := 0
nFat2AVista := 0
nFat3AVista := 0

nFat4AVista := 0
nFat5AVista := 0
nFat6AVista := 0

nFat1APrazo := 0
nFat2APrazo := 0
nFat3APrazo := 0

nFat4APrazo := 0
nFat5APrazo := 0
nFat6APrazo := 0

//Impostos
nIPI1Valor := 0
nIPI2Valor := 0
nIPI3Valor := 0

nIPI4Valor := 0
nIPI5Valor := 0
nIPI6Valor := 0

nICM1Vlor  := 0
nICM2Vlor  := 0
nICM3Vlor  := 0

nICM4Vlor  := 0
nICM5Vlor  := 0
nICM6Vlor  := 0

//CALCULAR PIS (1,65%) E COFINS (7,60%) SOBRE O FATURAMENTO TOTAL DE VENDAS (LIVRO FISCAL DE SAÍDA)
nPIS1Valor := 0
nPIS2Valor := 0
nPIS3Valor := 0

nPIS4Valor := 0
nPIS5Valor := 0
nPIS6Valor := 0

nCOF1Valor := 0
nCOF2Valor := 0
nCOF3Valor := 0

nCOF4Valor := 0
nCOF5Valor := 0
nCOF6Valor := 0

//SALARIOS PRODUÇÃO: TODAS AS DESPESAS DA M.O. DA INDÚSTRIA INCLUINDO A SUA AREA ADMINISTRATIVA - 2009
Private cNtMOINDADM := "32102,32102001,32102002,32102003,32102004,32102005,32102006,32102007,32102008,32102009,32102010,"
        cNtMOINDADM += "32102011,32102012,32102013,32102014,32102015,32102016,32102500,32102501,32102503"
//SALARIO ADM INDUSTRIA
Private cNSlAdmId := "32103,32103001,32103002,32103003,32103004,32103005,32103006,32103007,32103008,32103009,32103010,32103011,32103012,32103013,32103014,32103015,32103016,32103500,32103501,32103503"

//DESPESAS FIXAS E DESEMBOLSAVEIS DO COMERCIAL
cNDFDsbls :=  "33101,33101001,33101002,33101003,33101005,33101006,33101007,33101008,33101009,33101010,33101011,"
cNDFDsbls +=  "33101012,33101013,33101014,33101015,33101016,33101017,33101018,33101019,33101020,33101021,33101022,"
cNDFDsbls +=  "33101023,33101025,33101026,33101027,33101028,33101029,33101030,33101032,33101033,33101034,33101035,"
cNDFDsbls +=  "33101036,33101037,33101038,33101039,33101040,33101041,33101042,33101045,33101046,33101047,33101048,"
cNDFDsbls +=  "33101049,33101050,33101051,33101052,33101053,33101054,33101055,33101057,33101058,33101500,33101501,"
cNDFDsbls +=  "33101502,33101503,33101504,33101506"
//DESPESAS FIXAS E DESEMBOLSAVEIS DO ADM
cAdFxDsb :=  "11101,11101001,11101002,33102,33102001,33102002,33102003,33102004,33102005,33102006,33102007,"
cAdFxDsb +=  "33102008,33102009,33102010,33102011,33102012,33102013,33102014,33102015,33102016,33102017,33102018,"
cAdFxDsb +=  "33102019,33102020,33102021,33102022,33102023,33102025,33102026,33102027,33102028,33102029,33102030,"
cAdFxDsb +=  "33102032,33102033,33102034,33102035,33102036,33102037,33102038,33102039,33102040,33102041,33102042,"
cAdFxDsb +=  "33102045,33102046,33102047,33102048,33102049,33102050,33102051,33102052,33102053,33102054,33102055,"
cAdFxDsb +=  "33102057,33102058,33102500,33102501,33102502,33102503,33102504,33102505,33102506,33102600,33102601"

nSalInd1Adm := 0
nSalInd2Adm := 0
nSalInd3Adm := 0

nSalInd4Adm := 0
nSalInd5Adm := 0
nSalInd6Adm := 0


//TODAS AS DESPESAS DO COMERCIAL (EXCLUI A NATUREZA DE EMPRÉSTIMO E REEMBOLSO A CLIENTE) - 2009
Private cDspCDER := "33101,33101001,33101002,33101003,33101004,33101005,33101006,33101007,33101008,33101009,33101010,33101011,33101012,"
        cDspCDER += "33101013,33101014,33101015,33101016,33101017,33101018,33101019,33101020,33101021,33101022,33101023,33101025,33101026,"
        cDspCDER += "33101027,33101028,33101029,33101030,33101031,33101032,33101033,33101034,33101035,33101036,33101037,33101038,33101039,"
        cDspCDER += "33101040,33101041,33101042,33101045,33101046,33101047,33101048,33101049,33101050,33101051,33101052,33101053,33101054,"
        //Five Solutions - 11/12/2009 - Solicit.Patrícia, Retirar 33101056 - cDspCDER += "33101055,33101056,33101057,33101058,33101500,33101501,33101502,33101503,33101504,33101505,33101506,33101507"
        cDspCDER += "33101055,33101057,33101058,33101500,33101501,33101502,33101503,33101504,33101505,33101506,33101507"

nDesp1ComDRE := 0
nDesp2ComDRE := 0
nDesp3ComDRE := 0

       
//TOTAL DE DESPESAS ADMINISTRATIVAS - 2009
Private cNtAdmDER := "11101,11101001,11101002,33102,33102001,33102002,33102003,33102004,"
        cNtAdmDER += "33102005,33102006,33102007,33102008,33102009,33102010,33102011,33102012,33102013,33102014,33102015,33102016,33102017,"
        cNtAdmDER += "33102018,33102019,33102020,33102021,33102022,33102023,33102025,33102026,33102027,33102028,33102029,33102030,33102031,"
        cNtAdmDER += "33102032,33102033,33102034,33102035,33102036,33102037,33102038,33102039,33102040,33102041,33102042,33102045,33102046,"
        //Five Solutions 11/12/2009 - Solicit.Patrícia - Retirar 33102056 - cNtAdmDER += "33102047,33102048,33102049,33102050,33102051,33102052,33102053,33102054,33102055,33102056,33102057,33102058,33102500,"
        cNtAdmDER += "33102047,33102048,33102049,33102050,33102051,33102052,33102053,33102054,33102055,33102057,33102058,33102500,"
        cNtAdmDER += "33102501,33102502,33102503,33102504,33102505,33102506,33102600"

nDsp1ADMDER := 0
nDsp2ADMDER := 0
nDsp3ADMDER := 0

//DESPESAS FINANCEIRAS - 2009
Private cNDpFinDER := "34102,34102001,34102002,34102003,34102004,34102005,34102006"


nDspFi1nsDER := 0
nDspFi2nsDER := 0
nDspFi3nsDER := 0

//RECEITAS FINANCEIRAS '200140'
//Private cNRctFinDRE := "200140"

//RECEITAS FINANCEIRAS - 2009
Private cNRctFinDRE := "34101,34101001,34101002,34101003,34101004"


nRecDR1EFin := 0
nRecDR2EFin := 0
nRecDR3EFin := 0

nRecDR4EFin := 0
nRecDR5EFin := 0
nRecDR6EFin := 0

//Variaveis que guardam Anos para Verificar Titulos Vencidos
Private cAnoAtu    := ""
Private cAno1Menos := ""
Private cAno2Menos := ""
Private cAnoAntes  := ""


//Definições das Metas do Orçamento Comercial

Private cString := "SA1"

dbSelectArea("SA1")
dbSetOrder(1)

AjustaSx1()
pergunte(cPerg,.F.)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Monta a interface padrao com o usuario...                           ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

wnrel := SetPrint(cString,NomeProg,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,.F.,Tamanho,,.F.)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Grupo de Perguntas - RGERCO                                         ³
//³ MV_PAR01 - Data De                                                  ³
//³ MV_PAR02 - Data Até                                                 ³
//³ MV_PAR03 - Custo - (1.Médio, 2.Reposição                            ³
//³ MV_PAR04 - Analítico - (1.Sim, 2.Não)                               ³
//³ MV_PAR05 - Depto - (1.Todos,2.Faturamento,3.Indústria,4.Financeiro  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ



cAlmoxMP  := Alltrim(MV_PAR10)
cAlmoxPA  := Alltrim(MV_PAR11)


dDataDe  := MV_PAR01
dDataAte := MV_PAR02
nDeptos  := MV_PAR05


lComercial := IIF(nDeptos == 1 .Or. nDeptos == 2,.T.,.F.)
lIndustria := IIF(nDeptos == 1 .Or. nDeptos == 3,.T.,.F.)
lAdmFin    := IIF(nDeptos == 1 .Or. nDeptos == 4,.T.,.F.)
lLogistica := IIF(nDeptos == 1 .Or. nDeptos == 5,.T.,.F.)

lDemonsRes := IIF(MV_PAR06 == 1,.T.,.F.)

//Parametros da Consolidação
Private lMitto := IF(MV_PAR12 == 1,.T.,.F.)  //Considera Movimentações da Micheletto

titulo := "Resumo Gerencial COMAFAL Período "+DtoC(dDataDe)+" a "+DtoC(dDataAte)+" Emp/Fil: "+Alltrim(SM0->M0_NOME)+"/"+Alltrim(SM0->M0_FILIAL)+If(lMitto,"  [com Mitto]","  [sem Mitto]")

n2ResMes := Val(Substr(DTOS(dDataDe),1,6)) + 1
d2AnoMes := Alltrim(Str(n2ResMes))
If Right(Alltrim(Str(n2ResMes)),2) == "13"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   d2AnoMes   := Alltrim(Str(cAno))+"01"
EndIf

n3ResMes := Val(Substr(DTOS(dDataDe),1,6)) + 2
d3AnoMes   := Alltrim(Str(n3ResMes))

If Right(Alltrim(Str(n3ResMes)),2) == "13"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   d3AnoMes   := Alltrim(Str(cAno))+"01"
EndIf

If Right(Alltrim(Str(n3ResMes)),2) == "14"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d2AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d3AnoMes   := Alltrim(Str(cAno))+"02"
   EndIf
EndIf

**********************************************************
n4ResMes := Val(Substr(DTOS(dDataDe),1,6)) + 3
d4AnoMes   := Alltrim(Str(n4ResMes))

If Right(Alltrim(Str(n4ResMes)),2) == "13"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   d4AnoMes   := Alltrim(Str(cAno))+"01"
EndIf

If Right(Alltrim(Str(n4ResMes)),2) == "14"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d4AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d4AnoMes   := Alltrim(Str(cAno))+"02"
   EndIf
EndIf

If Right(Alltrim(Str(n4ResMes)),2) == "15"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d4AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d4AnoMes   := Alltrim(Str(cAno))+"03"
   EndIf
EndIf
**********************************************************
n5ResMes := Val(Substr(DTOS(dDataDe),1,6)) + 4
d5AnoMes   := Alltrim(Str(n5ResMes))

If Right(Alltrim(Str(n5ResMes)),2) == "13"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   d5AnoMes   := Alltrim(Str(cAno))+"01"
EndIf

If Right(Alltrim(Str(n5ResMes)),2) == "14"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d5AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d5AnoMes   := Alltrim(Str(cAno))+"02"
   EndIf
EndIf

If Right(Alltrim(Str(n5ResMes)),2) == "15"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d5AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d5AnoMes   := Alltrim(Str(cAno))+"03"
   EndIf
EndIf

If Right(Alltrim(Str(n5ResMes)),2) == "16"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d5AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d5AnoMes   := Alltrim(Str(cAno))+"04"
   EndIf
EndIf
**********************************************************
n6ResMes := Val(Substr(DTOS(dDataDe),1,6)) + 5
d6AnoMes   := Alltrim(Str(n6ResMes))

If Right(Alltrim(Str(n6ResMes)),2) == "13"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   d6AnoMes   := Alltrim(Str(cAno))+"01"
EndIf

If Right(Alltrim(Str(n6ResMes)),2) == "14"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d6AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d6AnoMes   := Alltrim(Str(cAno))+"02"
   EndIf
EndIf

If Right(Alltrim(Str(n6ResMes)),2) == "15"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d6AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d6AnoMes   := Alltrim(Str(cAno))+"03"
   EndIf
EndIf

If Right(Alltrim(Str(n6ResMes)),2) == "16"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d6AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d6AnoMes   := Alltrim(Str(cAno))+"04"
   EndIf
EndIf

If Right(Alltrim(Str(n6ResMes)),2) == "17"
   cAno := Val(Substr(DTOS(dDataDe),1,4)) + 1
   If Right(d6AnoMes,2) == "01" //Five Solutions Consultoria - 11/02/2010
      d6AnoMes   := Alltrim(Str(cAno))+"05"
   EndIf
EndIf
**********************************************************
 //MsgInfo("d3AnoMes "+d3AnoMes)
//Parâmetros de Datas - 15/02/2008

dData02 := CTOD("01/"+Substr(d2AnoMes,5,2)+"/"+Substr(d2AnoMes,1,4))
dData03 := CTOD("01/"+Substr(d3AnoMes,5,2)+"/"+Substr(d3AnoMes,1,4))

dData04 := CTOD("01/"+Substr(d4AnoMes,5,2)+"/"+Substr(d4AnoMes,1,4))
dData05 := CTOD("01/"+Substr(d5AnoMes,5,2)+"/"+Substr(d5AnoMes,1,4))
dData06 := CTOD("01/"+Substr(d6AnoMes,5,2)+"/"+Substr(d6AnoMes,1,4))


If nLastKey == 27
	Return
Endif

SetDefault(aReturn,cString)

If nLastKey == 27
   Return
Endif

nTipo := If(aReturn[4]==1,15,18)


//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Processamento para seleção dos registros p/ impressão.              ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Processa({||RunSelRG()},"Selecionando Informações Gerenciais ...")

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Processamento. RPTSTATUS monta janela com a regua de processamento. ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

RptStatus({|| RunReport(Cabec1,Cabec2,Titulo,nLin) },Titulo)
Return

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºFuno    ³RUNREPORT º Autor ³ AP6 IDE            º Data ³  05/01/08   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDescrio ³ Funcao auxiliar chamada pela RPTSTATUS. A funcao RPTSTATUS º±±
±±º          ³ monta a janela com a regua de processamento.               º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ Programa principal                                         º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/

Static Function RunReport(Cabec1,Cabec2,Titulo,nLin)

Local nOrdem

dbSelectArea(cString)
dbSetOrder(1)

//Processa({||RunSelRG()},"Selecionando Informações Gerenciais ...")



//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ SETREGUA -> Indica quantos registros serao processados para a regua ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

//SetRegua(RecCount())

//dbGoTop()
lRoda := .T.
While lRoda//!EOF()

   //ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
   //³ Verifica o cancelamento pelo usuario...                             ³
   //ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

   If lAbortPrint
      @nLin,00 PSAY "*** CANCELADO PELO OPERADOR ***"
      Exit
   Endif

   //ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
   //³ Impressao do cabecalho do relatorio. . .                            ³
   //ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

   If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
   Endif

   If lComercial
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|COMERCIAL"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40        50        60        70        80        90       100       110       120       130       140       150       160       170       180       190       200       210       220
      //              01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
      //              |                                   |                             |                             |                              |      |MERCADO EXTERNO              |                              |
      //                                                                                                                                                    |MES 01                       |MES 02                        |MES 03
      //                                                                999,999,999,999               999,999,999,999                999,999,999,999                      999,999,999,999                999,999,999,999           999,999,999,999         
      //                                                                         999.99                        999.99                         999.99                               999.99                         999.99                    999.99
      //                                                                 999,999,999.99                999,999,999.99                 999,999,999.99                       999,999,999.99                 999,999,999.99            999,999,999.99 
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      //                       10        20        30        40        50        60        70        80        90       100       110       120       130       140       150       160       170       180       190       200       210       220
      //              01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
      //              |                                   |                             |                             |                              |      |MERCADO EXTERNO              |                              |
      //                                                                                                                                                    |MES 01                       |MES 02                        |MES 03
      //                                                                999,999,999,999               999,999,999,999                999,999,999,999                      999,999,999,999                999,999,999,999           999,999,999,999         

      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|""
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|CLIENTES                           |"
      @nLin,050 PSAY  (nClAtv1Mes + nClIna1Mes ) Picture "@E 999,999,999,999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY  (nClAtv2Mes + nClIna2Mes ) Picture "@E 999,999,999,999"
      @nLin,096 PSAY "|"
      @nLin,111 PSAY  (nClAtv3Mes + nClIna3Mes ) Picture "@E 999,999,999,999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY  (nClAtv4Mes + nClIna4Mes ) Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY  (nClAtv5Mes + nClIna5Mes ) Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY  (nClAtv6Mes + nClIna6Mes ) Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Prospects                       |"
      @nLin,050 PSAY nASC1Mes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nASC2Mes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nASC3Mes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY  nASC4Mes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY  nASC5Mes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY  nASC6Mes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      //                       10        20        30        40        50        60        70        80        90       100       110       120       130       140       150       160       170       180       190       200       210       220
      //              01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
      //              |                                   |                             |                             |                              |      |MERCADO EXTERNO              |                              |
      //                                                                                                                                                    |MES 01                       |MES 02                        |MES 03
      //                                                                999,999,999,999               999,999,999,999                999,999,999,999                      999,999,999,999                999,999,999,999           999,999,999,999         
      //                                                                         999.99                        999.99                         999.99                               999.99                         999.99                    999.99
      @nLin,000 PSAY "| * Novos                           |"
      @nLin,050 PSAY nCliN01Mes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nCliN02Mes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nCliN03Mes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nCliN04Mes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nCliN05Mes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nCliN06Mes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Ativos                          |"
      @nLin,050 PSAY nClAtv1Mes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nClAtv2Mes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nClAtv3Mes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nClAtv4Mes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nClAtv5Mes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nClAtv6Mes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Inativos                        |"
      @nLin,050 PSAY nClIna1Mes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nClIna2Mes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nClIna3Mes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nClIna4Mes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nClIna5Mes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nClIna6Mes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Atendidos                       |"
      @nLin,050 PSAY nClAtd1Mes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nClAtd2Mes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nClAtd3Mes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nClAtd4Mes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nClAtd5Mes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nClAtd6Mes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40        50        60        70        80        90       100       110       120       130       140       150       160       170       180       190       200       210       220
      //              01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
      //              |                                   |                             |                             |                              |      |MERCADO EXTERNO              |                              |
      //                                                                                                                                                    |MES 01                       |MES 02                        |MES 03
      //                                                                999,999,999,999               999,999,999,999                999,999,999,999                      999,999,999,999                999,999,999,999           999,999,999,999         
      //                                                                         999.99                        999.99                         999.99                               999.99                         999.99                    999.99

      @nLin,000 PSAY "| * % Atendimento                   |"      //"@E 999,999,999,999" 
      @nLin,059 PSAY (nClAtd1Mes / (nClAtv1Mes + nClIna1Mes))*100 Picture "@E 999.99" 
      @nLin,066 PSAY "|"
      @nLin,089 PSAY (nClAtd2Mes / (nClAtv2Mes + nClIna2Mes))*100 Picture "@E 999.99" 
      @nLin,096 PSAY "|"
      @nLin,120 PSAY (nClAtd3Mes / (nClAtv3Mes + nClIna3Mes))*100 Picture "@E 999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,157 PSAY (nClAtd4Mes / (nClAtv4Mes + nClIna4Mes))*100 Picture "@E 999.99"
      @nLin,164 PSAY "|"
      @nLin,188 PSAY (nClAtd5Mes / (nClAtv5Mes + nClIna5Mes))*100 Picture "@E 999.99"
      @nLin,195 PSAY "|"
      @nLin,211 PSAY (nClAtd6Mes / (nClAtv6Mes + nClIna6Mes))*100 Picture "@E 999.99"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PEDIDOS EMITIDOS                    "
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Quantidade (Mês)                |"
      /* Teste - Itacolomy Mariano - 15/01/2007
      @nLin,050 PSAY nPed1MesQt Picture "@E 999,999,999,999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nPed2MesQt Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nPed3MesQt Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY  (0) Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY  (0) Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY  (0) Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      */
      @nLin,050 PSAY (nFatPd1QtMes+nPdPen1QtMes) Picture "@E 999,999,999,999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY (nFatPd2QtMes+nPdPen2QtMes) Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY (nFatPd3QtMes+nPdPen3QtMes) Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY  (nFatPd4QtMes+nPdPen4QtMes) Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY  (nFatPd5QtMes+nPdPen5QtMes) Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY  (nFatPd6QtMes+nPdPen6QtMes) Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40        50        60        70        80        90       100       110       120       130       140       150       160       170       180       190       200       210       220
      //              01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
      //              |                                   |                             |                             |                              |      |MERCADO EXTERNO              |                              |
      //                                                                                                                                                    |MES 01                       |MES 02                        |MES 03
      //                                                                999,999,999,999               999,999,999,999                999,999,999,999                      999,999,999,999                999,999,999,999           999,999,999,999         
      //                                                                         999.99                        999.99                         999.99                               999.99                         999.99                    999.99
      //                                                                 999,999,999.99                999,999,999.99                 999,999,999.99                       999,999,999.99                 999,999,999.99            999,999,999.99 
      @nLin,000 PSAY "| * Valor R$ (Mês)                  |"
      /* Teste - Itacolomy Mariano - 15/01/2007
      @nLin,051 PSAY nPed1VlMes Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPed2VlMes Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPed3VlMes Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      */
      @nLin,051 PSAY (nFtPd1VlrMes+nPdPen1VlrM) Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY (nFtPd2VlrMes+nPdPen2VlrM) Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY (nFtPd3VlrMes+nPdPen3VlrM) Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nFtPd4VlrMes+nPdPen4VlrM) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nFtPd5VlrMes+nPdPen5VlrM) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nFtPd6VlrMes+nPdPen6VlrM) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PEDIDOS FATURADOS                   "
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Quantidade (Mês)                |"
      @nLin,050 PSAY nFatPd1QtMes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nFatPd2QtMes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nFatPd3QtMes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nFatPd4QtMes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nFatPd5QtMes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nFatPd6QtMes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Valor R$ (Mês)                  |"
      @nLin,051 PSAY nFtPd1VlrMes Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nFtPd2VlrMes Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nFtPd3VlrMes Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nFtPd4VlrMes Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nFtPd5VlrMes Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nFtPd6VlrMes Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PEDIDOS PENDENTES                   "
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Quantidade (Mês)                |"
      @nLin,050 PSAY nPdPen1QtMes Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nPdPen2QtMes Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nPdPen3QtMes Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nPdPen4QtMes Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nPdPen5QtMes Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nPdPen6QtMes Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Valor R$ (Mês)                  |"
      @nLin,051 PSAY nPdPen1VlrM Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPdPen2VlrM Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPdPen3VlrM Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPdPen4VlrM Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPdPen5VlrM Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPdPen6VlrM Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PEDIDOS FATURADOS                   "
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Quantidade (Meses Ant.)         |"
      @nLin,050 PSAY nFtMAPd1Qt Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nFtMAPd2Qt Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nFtMAPd3Qt Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nFtMAPd4Qt Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nFtMAPd5Qt Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nFtMAPd6Qt Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Valor R$ (Meses Ant.)           |"
      @nLin,051 PSAY nFtPd1MAVl Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nFtPd2MAVl Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nFtPd3MAVl Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nFtPd4MAVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nFtPd5MAVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nFtPd6MAVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PEDIDOS PENDENTES                   "
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Quantidade (Meses Ant.)         |"
      @nLin,050 PSAY nPdPen1MAQt Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nPdPen2MAQt Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nPdPen3MAQt Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nPdPen4MAQt Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nPdPen5MAQt Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nPdPen6MAQt Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Valor R$ (Meses Ant.)           |"
      @nLin,051 PSAY nPdPMA1VlM Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPdPMA2VlM Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPdPMA3VlM Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPdPMA4VlM Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPdPMA5VlM Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPdPMA6VlM Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|QTD. TOTAL PEDIDOS FATURADOS       |"
      @nLin,050 PSAY  (nFatPd1QtMes + nFtMAPd1Qt) Picture "@E 999,999,999,999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY  (nFatPd2QtMes + nFtMAPd2Qt) Picture "@E 999,999,999,999"
      @nLin,096 PSAY "|"
      @nLin,111 PSAY  (nFatPd3QtMes + nFtMAPd3Qt) Picture "@E 999,999,999,999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY  (nFatPd4QtMes + nFtMAPd4Qt) Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY  (nFatPd5QtMes + nFtMAPd5Qt) Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY  (nFatPd6QtMes + nFtMAPd6Qt) Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                  
      @nLin,000 PSAY "|VALOR TOTAL PEDIDOS FATURADOS      |"
      @nLin,051 PSAY (nFtPd1VlrMes + nFtPd1MAVl) Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY (nFtPd2VlrMes + nFtPd2MAVl) Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY (nFtPd3VlrMes + nFtPd3MAVl) Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY (nFtPd4VlrMes + nFtPd4MAVl) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY (nFtPd5VlrMes + nFtPd5MAVl) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY (nFtPd6VlrMes + nFtPd6MAVl) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                  
      @nLin,000 PSAY "|QTD. TOTAL PEDIDOS PENDENTES       |"
      @nLin,050 PSAY  (nPdPen1QtMes + nPdPen1MAQt) Picture "@E 999,999,999,999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY  (nPdPen2QtMes + nPdPen2MAQt) Picture "@E 999,999,999,999"
      @nLin,096 PSAY "|"
      @nLin,111 PSAY  (nPdPen3QtMes + nPdPen3MAQt) Picture "@E 999,999,999,999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nPdPen4QtMes + nPdPen4MAQt) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nPdPen5QtMes + nPdPen5MAQt) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nPdPen6QtMes + nPdPen6MAQt) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                  
      @nLin,000 PSAY "|VALOR TOTAL PEDIDOS PENDENTES      |"
      @nLin,051 PSAY (nPdPen1VlrM + nPdPMA1VlM) Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY (nPdPen2VlrM + nPdPMA2VlM) Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY (nPdPen3VlrM + nPdPMA3VlM) Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY (nPdPen4VlrM + nPdPMA4VlM) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY (nPdPen5VlrM + nPdPMA5VlM) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY (nPdPen6VlrM + nPdPMA6VlM) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"

      //Força Quebra de Página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|COMERCIAL (continuação ...)"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|FATURAMENTO BRUTO                  |"
      @nLin,051 PSAY  (nFat1MesBru) Picture "@E 999,999,999.99" //Faturamento Bruto menos Faturamento de Sucata
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (nFat2MesBru) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (nFat3MesBru) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nFat4MesBru) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nFat5MesBru) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nFat6MesBru) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|CONDIÇÃO DE FATURAMENTO"
      @nLin,219 PSAY "|"            
      
      For nFtBru := 1 To Len(aCFTList)
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|"+Substr(Posicione("SE4",1,xFilial("SE4")+aCFTList[nFtBru,1],"E4_DESCRI"),1,33)
         @nLin,036 PSAY "|"
         @nLin,051 PSAY  aCFTList[nFtBru,3] Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  aCFTList[nFtBru,4] Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  aCFTList[nFtBru,5] Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         
         @nLin,149 PSAY  aCFTList[nFtBru,6] Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  aCFTList[nFtBru,7] Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  aCFTList[nFtBru,8] Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
           
      Next nFtBru
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif

      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|DEVOLUÇÃO"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| *Valor                            |"
      @nLin,051 PSAY  nVl1MesDev Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVl2MesDev Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVl3MesDev Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      
      @nLin,149 PSAY  nVl4MesDev Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVl5MesDev Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVl6MesDev Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nCus1MesDev := 0
      For nDVMP := 1 To Len(aDev1MPCli)
         nCus1MesDev += aDev1MPCli[nDVMP,7]
      Next nDVMP

      nCus2MesDev := 0
      For nDVMP := 1 To Len(aDev2MPCli)
         nCus2MesDev += aDev2MPCli[nDVMP,7]
      Next nDVMP
            
      nCus3MesDev := 0
      For nDVMP := 1 To Len(aDev3MPCli)
         nCus3MesDev += aDev3MPCli[nDVMP,7]
      Next nDVMP
      
      nCus4MesDev := 0
      For nDVMP := 1 To Len(aDev4MPCli)
         nCus4MesDev += aDev4MPCli[nDVMP,7]
      Next nDVMP

      nCus5MesDev := 0
      For nDVMP := 1 To Len(aDev5MPCli)
         nCus5MesDev += aDev5MPCli[nDVMP,7]
      Next nDVMP

      nCus6MesDev := 0
      For nDVMP := 1 To Len(aDev6MPCli)
         nCus6MesDev += aDev6MPCli[nDVMP,7]
      Next nDVMP
                        
      @nLin,000 PSAY "| *Custo                            |"
      @nLin,051 PSAY  nCus1MesDev Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nCus2MesDev Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nCus3MesDev Picture "@E 999,999,999.99"
      
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nCus4MesDev Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nCus5MesDev Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nCus6MesDev Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      n1MesFtLiq := (nFat1MesBru - nVl1MesDev)
      n2MesFtLiq := (nFat2MesBru - nVl2MesDev)
      n3MesFtLiq := (nFat3MesBru - nVl3MesDev)
        
      n4MesFtLiq := (nFat4MesBru - nVl4MesDev)
      n5MesFtLiq := (nFat5MesBru - nVl5MesDev)
      n6MesFtLiq := (nFat6MesBru - nVl6MesDev)
          
      @nLin,000 PSAY "|FATURAMENTO LÍQUIDO                |"
      @nLin,051 PSAY  n1MesFtLiq Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2MesFtLiq Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3MesFtLiq Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      
      @nLin,149 PSAY  n4MesFtLiq Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5MesFtLiq Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6MesFtLiq Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nCMP1Mes := 0
      For nCMP := 1 To Len(aFatp1MP)
         nCMP1Mes += aFatp1MP[nCMP,7]
      Next nCMP

      nCMP2Mes := 0
      For nCMP := 1 To Len(aFatp2MP)
         nCMP2Mes += aFatp2MP[nCMP,7]
      Next nCMP

      nCMP3Mes := 0
      For nCMP := 1 To Len(aFatp3MP)
         nCMP3Mes += aFatp3MP[nCMP,7]
      Next nCMP
      
      nCMP4Mes := 0
      For nCMP := 1 To Len(aFatp4MP)
         nCMP4Mes += aFatp4MP[nCMP,7]
      Next nCMP

      nCMP5Mes := 0
      For nCMP := 1 To Len(aFatp5MP)
         nCMP5Mes += aFatp5MP[nCMP,7]
      Next nCMP

      nCMP6Mes := 0
      For nCMP := 1 To Len(aFatp6MP)
         nCMP6Mes += aFatp6MP[nCMP,7]
      Next nCMP
                                    
      @nLin,000 PSAY "|CUSTO M.P. VEND.                   |"
      @nLin,051 PSAY  nCMP1Mes Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nCMP2Mes Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nCMP3Mes Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      
      @nLin,149 PSAY  nCMP4Mes Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nCMP5Mes Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nCMP6Mes Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      nMg1Mes := (n1MesFtLiq / nCMP1Mes)
      nMg2Mes := (n2MesFtLiq / nCMP2Mes)
      nMg3Mes := (n3MesFtLiq / nCMP3Mes)
        
      nMg4Mes := (n4MesFtLiq / nCMP4Mes)
      nMg5Mes := (n5MesFtLiq / nCMP5Mes)
      nMg6Mes := (n6MesFtLiq / nCMP6Mes)
          
      @nLin,000 PSAY "|MARGEM                             |"
      @nLin,051 PSAY  ((nMg1Mes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  ((nMg2Mes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  ((nMg3Mes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|" 
      
      @nLin,149 PSAY  ((nMg4Mes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  ((nMg5Mes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  ((nMg6Mes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
      nProdTon1Mes := (nVlr1MesBx/nProd1Mes)      
      nProdTon2Mes := (nVlr2MesBx/nProd2Mes) 
      nProdTon3Mes := (nVlr3MesBx/nProd3Mes)

      nProdTon4Mes := (nVlr4MesBx/nProd4Mes)      
      nProdTon5Mes := (nVlr5MesBx/nProd5Mes) 
      nProdTon6Mes := (nVlr6MesBx/nProd6Mes)
      
      n1MTonelVen  := (nQtTon1MVen+nQtTon1MAPd)
      n2MTonelVen  := (nQtTon2MVen+nQtTon2MAPd)
      n3MTonelVen  := (nQtTon3MVen+nQtTon3MAPd)

      n4MTonelVen  := (nQtTon4MVen+nQtTon4MAPd)
      n5MTonelVen  := (nQtTon5MVen+nQtTon5MAPd)
      n6MTonelVen  := (nQtTon6MVen+nQtTon6MAPd)
      
      n4MTonelVen  := (nQtTon4MVen+nQtTon4MAPd)
      n5MTonelVen  := (nQtTon5MVen+nQtTon5MAPd)
      n6MTonelVen  := (nQtTon6MVen+nQtTon6MAPd)
            
     
      For nCMP := 1 To Len(aProd1MP)
         nMatPrim1Mes += aProd1MP[nCMP,7]
      Next nCMP

      For nCMP := 1 To Len(aProd2MP)
         nMatPrim2Mes += aProd2MP[nCMP,7]
      Next nCMP

      For nCMP := 1 To Len(aProd3MP)
         nMatPrim3Mes += aProd3MP[nCMP,7]
      Next nCMP

      For nCMP := 1 To Len(aProd4MP)
         nMatPrim4Mes += aProd4MP[nCMP,7]
      Next nCMP

      For nCMP := 1 To Len(aProd5MP)
         nMatPrim5Mes += aProd5MP[nCMP,7]
      Next nCMP

      For nCMP := 1 To Len(aProd6MP)
         nMatPrim6Mes += aProd6MP[nCMP,7]
      Next nCMP      

      nMatPrim1Mes := (nMatPrim1Mes / nProd1Mes)
      nMatPrim2Mes := (nMatPrim2Mes / nProd2Mes)
      nMatPrim3Mes := (nMatPrim3Mes / nProd3Mes)

      nMatPrim4Mes := (nMatPrim4Mes / nProd4Mes)
      nMatPrim5Mes := (nMatPrim5Mes / nProd5Mes)
      nMatPrim6Mes := (nMatPrim6Mes / nProd6Mes)
                  
      nCMTon1Mes := (nProdTon1Mes+nMatPrim1Mes)
      nCMTon2Mes := (nProdTon2Mes+nMatPrim2Mes) 
      nCMTon3Mes := (nProdTon3Mes+nMatPrim3Mes) 

      nCMTon4Mes := (nProdTon4Mes+nMatPrim4Mes)
      nCMTon5Mes := (nProdTon5Mes+nMatPrim5Mes) 
      nCMTon6Mes := (nProdTon6Mes+nMatPrim6Mes) 
            
      //Força quebra de página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      @nLin,000 PSAY "|COMERCIAL (continuação ...)"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
     
      //PREÇO MÉDIO (Venda) = FATURAMENTO BRUTO ( / ) DIVIDIDO PELA QTD. DE TONELADAS VENDIDAS 
      nPMVen1Mes := (nFat1MesBru/n1MTonelVen)
      nPMVen2Mes := (nFat2MesBru/n2MTonelVen)
      nPMVen3Mes := (nFat3MesBru/n3MTonelVen)

      nPMVen4Mes := (nFat4MesBru/n4MTonelVen)
      nPMVen5Mes := (nFat5MesBru/n5MTonelVen)
      nPMVen6Mes := (nFat6MesBru/n6MTonelVen)
            
      @nLin,000 PSAY "|PREÇO MÉDIO (Venda)                |"
      @nLin,051 PSAY nPMVen1Mes  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPMVen2Mes Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPMVen3Mes Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|CUSTO MÉDIO PROD (Ton)             |"
      @nLin,051 PSAY  nCMTon1Mes Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nCMTon2Mes Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nCMTon3Mes Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nCMTon4Mes Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nCMTon5Mes Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nCMTon6Mes Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Produção (Ton)                  |"
      @nLin,051 PSAY  nProdTon1Mes Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nProdTon2Mes Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nProdTon3Mes Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nProdTon4Mes Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nProdTon5Mes Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nProdTon6Mes Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //Matéria Prima (Ton) = (CUSTO APRESENTADO NO RELATÓRIO DE FATURAMENTO "NELSON") / (QUANTIDADE DE TONELADAS VENDIDAS) 
      
      @nLin,000 PSAY "| * Matéria Prima Prod (Ton)        |"
      @nLin,051 PSAY  nMatPrim1Mes Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nMatPrim2Mes Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nMatPrim3Mes Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nMatPrim4Mes Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nMatPrim5Mes Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nMatPrim6Mes Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //MARGEM MÉDIA = (PREÇO MEDIO) / (CUSTO MÉDIO)
      nMgMed1Mes := (nPMVen1Mes/nCMTon1Mes) 
      nMgMed2Mes := (nPMVen2Mes/nCMTon2Mes) 
      nMgMed3Mes := (nPMVen3Mes/nCMTon3Mes) 

      nMgMed4Mes := (nPMVen4Mes/nCMTon4Mes) 
      nMgMed5Mes := (nPMVen5Mes/nCMTon5Mes) 
      nMgMed6Mes := (nPMVen6Mes/nCMTon6Mes) 
            
      @nLin,000 PSAY "|MARGEM MÉDIA                       |"
      @nLin,051 PSAY ((nMgMed1Mes)-1)*100  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY ((nMgMed2Mes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY ((nMgMed3Mes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY ((nMgMed4Mes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY ((nMgMed5Mes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY ((nMgMed6Mes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
       
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|COMISSÃO"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Valor R$                        |"  //VALOR DA COMISSÃO '100203'
      @nLin,051 PSAY  nVl1MComis  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVl2MComis Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVl3MComis Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nVl4MComis Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVl5MComis Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVl6MComis Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Percentual (%)                  |"  //VALOR DA COMISSAO (/) DIVIDIDO PELO FATURAMENTO LIQUIDO
      @nLin,051 PSAY  (nVl1MComis/n1MesFtLiq)*100  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (nVl2MComis/n2MesFtLiq)*100 Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (nVl3MComis/n3MesFtLiq)*100 Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nVl4MComis/n4MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nVl5MComis/n5MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nVl6MComis/n6MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|REPRESENTAÇÃO"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Valor R$                        |"  //VALOR DA COMISSÃO '100203'
      @nLin,051 PSAY  nVl1MRepres  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVl2MRepres Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVl3MRepres Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nVl4MRepres Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVl5MRepres Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVl6MRepres Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Percentual (%)                  |"  //VALOR DA COMISSAO (/) DIVIDIDO PELO FATURAMENTO LIQUIDO
      @nLin,051 PSAY  (nVl1MRepres/n1MesFtLiq)*100  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (nVl2MRepres/n2MesFtLiq)*100 Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (nVl3MRepres/n3MesFtLiq)*100 Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nVl4MRepres/n4MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nVl5MRepres/n5MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nVl6MRepres/n6MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|TOTAL"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Valor R$                        |"  //VALOR DA COMISSÃO '100203'
      @nLin,051 PSAY  (nVl1MComis + nVl1MRepres)  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (nVl2MComis + nVl2MRepres) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (nVl3MComis + nVl3MRepres) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nVl4MComis + nVl4MRepres) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nVl5MComis + nVl5MRepres) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nVl6MComis + nVl6MRepres) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "| * Percentual (%)                  |"  //VALOR DA COMISSAO (/) DIVIDIDO PELO FATURAMENTO LIQUIDO
      @nLin,051 PSAY  ((nVl1MComis + nVl1MRepres)/n1MesFtLiq)*100  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  ((nVl2MComis + nVl2MRepres)/n2MesFtLiq)*100 Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  ((nVl3MComis + nVl3MRepres)/n3MesFtLiq)*100 Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  ((nVl4MComis + nVl4MRepres)/n4MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  ((nVl5MComis + nVl5MRepres)/n5MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  ((nVl6MComis + nVl6MRepres)/n6MesFtLiq)*100 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      nMta1Com := (4/100)     //Five Solutions Consultoria - 25/11/2010
      nMta2Com := (4/100)
      nMta3Com := (4/100)

      nMta4Com := (4/100)     //Five Solutions Consultoria - 25/11/2010
      nMta5Com := (4/100)
      nMta6Com := (4/100)
      
      @nLin,000 PSAY "| * Meta Comissão (%)               |"  //VALOR DA COMISSAO (/) DIVIDIDO PELO FATURAMENTO LIQUIDO
      @nLin,051 PSAY  nMta1Com  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nMta2Com Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nMta3Com Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nMta4Com Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nMta5Com Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nMta6Com Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
           
         @nLin,000 PSAY "|GASTOS GERAIS COML - MI            |"  //TOTAL DE GASTOS DA ÁREA COMERCIAL
         @nLin,051 PSAY  nVl1MGGComl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MGGComl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MGGComl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MGGComl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MGGComl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MGGComl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
      
         @nLin,000 PSAY "| * MÃO DE OBRA                     |" //SOMATÓRIO DE TODAS AS NATUREZAS COM GASTOS REFERENTE A MÃO DE OBRA
         @nLin,051 PSAY  nVl1MGGMO  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MGGMO Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MGGMO Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MGGMO Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MGGMO Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MGGMO Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|   ** Desp. Fixa                   |" //
         @nLin,051 PSAY  nVl1MDFGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MDFGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MDFGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MDFGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MDFGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MDFGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|   ** Desp. Period.                |" //
         @nLin,051 PSAY  nVl1MDPGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MDPGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MDPGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MDPGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MDPGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MDPGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
      
         @nLin,000 PSAY "|   ** Rescisões                    |" //
         @nLin,051 PSAY  nVl1MResGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MResGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MResGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MResGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MResGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MResGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
           
         @nLin,000 PSAY "|   ** Premiações                   |" //
         @nLin,051 PSAY  nVl1MPrmGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MPrmGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MPrmGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MPrmGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MPrmGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MPrmGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
     
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "| * MARKETING                       |" //
         @nLin,051 PSAY  nVl1MMktGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MMktGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MMktGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MMktGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MMktGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MMktGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
     
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "| * DESPESAS DE VIAGENS             |" //
         @nLin,051 PSAY  nVl1MDVgGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MDVgGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MDVgGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MDVgGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MDVgGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MDVgGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "| * FRETE DE VENDAS                 |" //
         @nLin,051 PSAY  nVl1MDFrtGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MDFrtGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MDFrtGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MDFrtGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MDFrtGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MDFrtGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
     
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  SERVIÇOS TERCEIRIZADOS           |"
         @nLin,051 PSAY nSTc1ComVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nSTc2ComVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nSTc3ComVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nSTc4ComVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nSTc5ComVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nSTc6ComVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "| * OUTRAS NATUREZAS                |" //
         @nLin,051 PSAY  nVl1MONtGG  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  nVl2MONtGG Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  nVl3MONtGG Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  nVl4MONtGG Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  nVl5MONtGG Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  nVl6MONtGG Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                  
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|VALOR META ORÇAMENTO COML.         |" //
      @nLin,051 PSAY  nCom1MMtOrc  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nCom2MMtOrc Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nCom3MMtOrc Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nCom4MMtOrc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nCom5MMtOrc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nCom6MMtOrc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|GASTOS META ORÇAMENTO COML.        |" //
      @nLin,051 PSAY  nGst1MMtOrC  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nGst2MMtOrC Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nGst3MMtOrC Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nGst4MMtOrC Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nGst5MMtOrC Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nGst6MMtOrC Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      

      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
      //Força Quebra de Página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|COMERCIAL (continuação ...)"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|FATURAMENTO SUCATA                 |" //
      @nLin,051 PSAY  nVl1SUCMFat  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVl2SUCMFat Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVl3SUCMFat Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nVl4SUCMFat Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVl5SUCMFat Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVl6SUCMFat Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|CONDIÇÃO DE FATURAMENTO            |" //
      
      For nFtSUC := 1 To Len(aTSUCList)
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|"+Substr(Posicione("SE4",1,xFilial("SE4")+aCFTList[nFtSUC,1],"E4_DESCRI"),1,33)
         @nLin,036 PSAY "|"
         @nLin,051 PSAY  aTSUCList[nFtSUC,3] Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY  aTSUCList[nFtSUC,4] Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY  aTSUCList[nFtSUC,5] Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY  aTSUCList[nFtSUC,6] Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY  aTSUCList[nFtSUC,7] Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY  aTSUCList[nFtSUC,8] Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
      Next nFtSUC
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      /************
      * Novo 2009 - 22/07/2009
      * Conceito para Custo Sucata
      * Custo Médio da Mat. Prima multiplicado pela Qt. de Sucata Vendida
      *********************************/
      
      nVlM1CusSUC := (nMatPrim1Mes * nQt1MSUCVen)
      nVlM2CusSUC := (nMatPrim2Mes * nQt2MSUCVen)
      nVlM3CusSUC := (nMatPrim3Mes * nQt3MSUCVen)

      nVlM4CusSUC := (nMatPrim4Mes * nQt4MSUCVen)
      nVlM5CusSUC := (nMatPrim5Mes * nQt5MSUCVen)
      nVlM6CusSUC := (nMatPrim6Mes * nQt6MSUCVen)
            
      @nLin,000 PSAY "|CUSTO SUCATA                       |" //
      @nLin,051 PSAY  nVlM1CusSUC  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVlM2CusSUC Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVlM3CusSUC Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nVlM4CusSUC Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVlM5CusSUC Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVlM6CusSUC Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      nMg1SUCMes := (nVl1SUCMFat / nVlM1CusSUC)
      nMg2SUCMes := (nVl2SUCMFat / nVlM2CusSUC)
      nMg3SUCMes := (nVl3SUCMFat / nVlM3CusSUC)

      nMg4SUCMes := (nVl4SUCMFat / nVlM4CusSUC)
      nMg5SUCMes := (nVl5SUCMFat / nVlM5CusSUC)
      nMg6SUCMes := (nVl6SUCMFat / nVlM6CusSUC)
      
      @nLin,000 PSAY "|MARGEM SUCATA                      |"
      @nLin,051 PSAY  ((nMg1SUCMes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  ((nMg2SUCMes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  ((nMg3SUCMes)-1)*100 Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  ((nMg4SUCMes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  ((nMg5SUCMes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  ((nMg6SUCMes)-1)*100 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
     
      //PREÇO MÉDIO) = FATURAMENTO ( / ) DIVIDIDO PELA QTD. DE TONELADAS
      nPMV1SUCM := (nVl1SUCMFat/nQt1MSUCVen)
      nPMV2SUCM := (nVl2SUCMFat/nQt2MSUCVen)
      nPMV3SUCM := (nVl3SUCMFat/nQt3MSUCVen)

      nPMV4SUCM := (nVl4SUCMFat/nQt4MSUCVen)
      nPMV5SUCM := (nVl5SUCMFat/nQt5MSUCVen)
      nPMV6SUCM := (nVl6SUCMFat/nQt6MSUCVen)
            
      @nLin,000 PSAY "|PREÇO MÉDIO                        |"
      @nLin,051 PSAY nPMV1SUCM  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPMV2SUCM Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPMV3SUCM Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPMV4SUCM Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPMV5SUCM Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPMV6SUCM Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|QTD. SUCATA VENDIDA                |"
      @nLin,050 PSAY nQt1MSUCVen Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nQt2MSUCVen Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nQt3MSUCVen Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nQt4MSUCVen Picture "@E 999,999,999.99"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nQt5MSUCVen Picture "@E 999,999,999.99"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nQt6MSUCVen Picture "@E 999,999,999.99"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
   EndIf //Fim da Condição para impressão dos dados da Análise Gerencial Comercial

   If lIndustria
   
      If lComercial
         //Força Quebra de Página
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
         @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      EndIf
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|INDÚSTRIA"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|QTD. TONELADAS"
      @nLin,219 PSAY"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Vendidas                        |"      
      @nLin,051 PSAY n1MTonelVen Picture "@E 99,999,999.999" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY n2MTonelVen Picture "@E 99,999,999.999" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY n3MTonelVen Picture "@E 99,999,999.999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY n4MTonelVen Picture "@E 99,999,999.999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY n5MTonelVen Picture "@E 99,999,999.999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY n6MTonelVen Picture "@E 99,999,999.999"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Produzidas                      |"      
      @nLin,051 PSAY nProd1Mes Picture "@E 99,999,999.999" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nProd2Mes Picture "@E 99,999,999.999" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nProd3Mes Picture "@E 99,999,999.999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nProd4Mes Picture "@E 99,999,999.999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nProd5Mes Picture "@E 99,999,999.999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nProd6Mes Picture "@E 99,999,999.999"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MATERIA PRIMA"
      @nLin,219 PSAY"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      

      nVlrFM1MEst := 0
      nVlrFM2MEst := 0 
      nVlrFM3MEst := 0

      nVlrFM4MEst := 0
      nVlrFM5MEst := 0 
      nVlrFM6MEst := 0
            
      nQtdFM1MEst := 0
      nQtdFM2MEst := 0
      nQtdFM3MEst := 0

      nQtdFM4MEst := 0
      nQtdFM5MEst := 0
      nQtdFM6MEst := 0
            
      nVM1MMP := 0
      nVM2MMP := 0
      nVM3MMP := 0

      nVM4MMP := 0
      nVM5MMP := 0
      nVM6MMP := 0
      
      For nFch := 1 To Len(aFech1MPEst)
         nVlrFM1MEst += aFech1MPEst[nFch,7]
         nQtdFM1MEst += aFech1MPEst[nFch,3]
      Next nFch
      nVM1MMP := (nVlrFM1MEst/nQtdFM1MEst)      

      For nFch := 1 To Len(aFech2MPEst)
         nVlrFM2MEst += aFech2MPEst[nFch,7]
         nQtdFM2MEst += aFech2MPEst[nFch,3]
      Next nFch
      nVM2MMP := (nVlrFM2MEst/nQtdFM2MEst)      
      
      For nFch := 1 To Len(aFech3MPEst)
         nVlrFM3MEst += aFech3MPEst[nFch,7]
         nQtdFM3MEst += aFech3MPEst[nFch,3]
      Next nFch
      nVM3MMP := (nVlrFM3MEst/nQtdFM3MEst)      

      For nFch := 1 To Len(aFech4MPEst)
         nVlrFM4MEst += aFech4MPEst[nFch,7]
         nQtdFM4MEst += aFech4MPEst[nFch,3]
      Next nFch
      nVM4MMP := (nVlrFM4MEst/nQtdFM4MEst)      

      For nFch := 1 To Len(aFech5MPEst)
         nVlrFM5MEst += aFech5MPEst[nFch,7]
         nQtdFM5MEst += aFech5MPEst[nFch,3]
      Next nFch
      nVM5MMP := (nVlrFM5MEst/nQtdFM5MEst)      

      For nFch := 1 To Len(aFech6MPEst)
         nVlrFM6MEst += aFech6MPEst[nFch,7]
         nQtdFM6MEst += aFech6MPEst[nFch,3]
      Next nFch
      nVM6MMP := (nVlrFM6MEst/nQtdFM6MEst)      
                  
      @nLin,000 PSAY "| * Qtd. Estoque                    |"      
//      Alert("Imprimindo o Valor nQtdFM1MEst "+Alltrim(Str(nQtdFM1MEst)))
      @nLin,050 PSAY nQtdFM1MEst Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nQtdFM2MEst Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nQtdFM3MEst Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nQtdFM4MEst Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nQtdFM5MEst Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nQtdFM6MEst Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"           
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
            
      @nLin,000 PSAY "| * Valor Estoque                   |"
      @nLin,051 PSAY nVlrFM1MEst  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nVlrFM2MEst Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nVlrFM3MEst Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVlrFM4MEst Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVlrFM5MEst Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVlrFM6MEst Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif

      @nLin,000 PSAY "| * Valor Médio MP (Ton)            |"
      @nLin,050 PSAY nVM1MMP  Picture "@E 999,999,999.999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nVM2MMP Picture "@E 999,999,999.999"
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nVM3MMP Picture "@E 999,999,999.999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVM4MMP Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVM5MMP Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVM6MMP Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"


      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MATERIA PRIMA(SLITER)"
      @nLin,219 PSAY"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| * Qtd. Estoque                    |"      
//      Alert("Imprimindo o Valor nQtdFM1MEst "+Alltrim(Str(nQtdFM1MEst)))
         
      @nLin,050 PSAY nQt1MPSlit Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nQt2MPSlit Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nQt3MPSlit Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nQt4MPSlit Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nQt5MPSlit Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nQt6MPSlit Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"           
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nVl1MCSlit := 0
      nVl2MCSlit := 0
      nVl3MCSlit := 0

      nVl4MCSlit := 0
      nVl5MCSlit := 0
      nVl6MCSlit := 0
      
      For nFhSlt := 1 To Len(aFch1MPSlt)
         nVl1MCSlit += aFch1MPSlt[nFhSlt,7]
      Next nFhSlt

      For nFhSlt := 1 To Len(aFch2MPSlt)
         nVl2MCSlit += aFch2MPSlt[nFhSlt,7]
      Next nFhSlt
      
      For nFhSlt := 1 To Len(aFch3MPSlt)
         nVl3MCSlit += aFch3MPSlt[nFhSlt,7]
      Next nFhSlt

      For nFhSlt := 1 To Len(aFch4MPSlt)
         nVl4MCSlit += aFch4MPSlt[nFhSlt,7]
      Next nFhSlt

      For nFhSlt := 1 To Len(aFch5MPSlt)
         nVl5MCSlit += aFch5MPSlt[nFhSlt,7]
      Next nFhSlt

      For nFhSlt := 1 To Len(aFch6MPSlt)
         nVl6MCSlit += aFch6MPSlt[nFhSlt,7]
      Next nFhSlt
                                    
      @nLin,000 PSAY "| * Valor Estoque                   |"
      @nLin,051 PSAY nVl1MCSlit  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nVl2MCSlit Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nVl3MCSlit Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVl4MCSlit Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVl5MCSlit Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVl6MCSlit Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      nSL1TVM := (nVl1MCSlit/nQt1MPSlit)      
      nSL2TVM := (nVl2MCSlit/nQt2MPSlit)      
      nSL3TVM := (nVl3MCSlit/nQt3MPSlit)      

      nSL4TVM := (nVl4MCSlit/nQt4MPSlit)      
      nSL5TVM := (nVl5MCSlit/nQt5MPSlit)      
      nSL6TVM := (nVl6MCSlit/nQt6MPSlit)      
            
      @nLin,000 PSAY "| * Valor Médio MP (Ton)            |"
      @nLin,050 PSAY nSL1TVM  Picture "@E 999,999,999.999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nSL2TVM Picture "@E 999,999,999.999"
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nSL3TVM Picture "@E 999,999,999.999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nSL4TVM Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nSL5TVM Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nSL6TVM Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"

      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PRODUTO ACABADO"
      @nLin,219 PSAY"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      

      nCs1PAM := 0
      nCs2PAM := 0
      nCs3PAM := 0

      nCs4PAM := 0
      nCs5PAM := 0
      nCs6PAM := 0
            
      nQt1PAM := 0
      nQt2PAM := 0
      nQt3PAM := 0

      nQt4PAM := 0
      nQt5PAM := 0
      nQt6PAM := 0
            
      nVM1MPA := 0
      nVM2MPA := 0
      nVM3MPA := 0

      nVM4MPA := 0
      nVM5MPA := 0
      nVM6MPA := 0
      
      For nPA := 1 To Len(a1MPAMP)
         nCs1PAM += a1MPAMP[nPA,7]
         nQt1PAM += a1MPAMP[nPA,3]
      Next nPA
      nVM1MPA := (nCs1PAM/nQt1PAM)      

      For nPA := 1 To Len(a2MPAMP)
         nCs2PAM += a2MPAMP[nPA,7]
         nQt2PAM += a2MPAMP[nPA,3]
      Next nPA
      nVM2MPA := (nCs2PAM/nQt2PAM)      
      
      For nPA := 1 To Len(a3MPAMP)
         nCs3PAM += a3MPAMP[nPA,7]
         nQt3PAM += a3MPAMP[nPA,3]
      Next nPA      
      nVM3MPA := (nCs3PAM/nQt3PAM)      

      For nPA := 1 To Len(a4MPAMP)
         nCs4PAM += a4MPAMP[nPA,7]
         nQt4PAM += a4MPAMP[nPA,3]
      Next nPA      
      nVM4MPA := (nCs4PAM/nQt4PAM)      

      For nPA := 1 To Len(a5MPAMP)
         nCs5PAM += a5MPAMP[nPA,7]
         nQt5PAM += a5MPAMP[nPA,3]
      Next nPA      
      nVM5MPA := (nCs5PAM/nQt5PAM)      

      For nPA := 1 To Len(a6MPAMP)
         nCs6PAM += a6MPAMP[nPA,7]
         nQt6PAM += a6MPAMP[nPA,3]
      Next nPA      
      nVM6MPA := (nCs6PAM/nQt6PAM)      
                        
      @nLin,000 PSAY "| * Qtd. Estoque                    |"      
      @nLin,050 PSAY nQt1PAM Picture "@E 999,999,999,999" 
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nQt2PAM Picture "@E 999,999,999,999" 
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nQt3PAM Picture "@E 999,999,999,999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,148 PSAY nQt4PAM Picture "@E 999,999,999,999"
      @nLin,164 PSAY "|"
      @nLin,179 PSAY nQt5PAM Picture "@E 999,999,999,999"
      @nLin,195 PSAY "|"
      @nLin,202 PSAY nQt6PAM Picture "@E 999,999,999,999"
      @nLin,219 PSAY "|"           
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      @nLin,000 PSAY "| * Valor Estoque                   |"
      @nLin,051 PSAY nCs1PAM  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nCs2PAM Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nCs3PAM Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nCs4PAM Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nCs5PAM Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nCs6PAM Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      /*
      nVM1MPA := (nCs1PAM/nQt1PAM)      
      nVM2MPA := (nCs2PAM/nQt2PAM)
      nVM3MPA := (nCs3PAM/nQt3PAM)
      */
      @nLin,000 PSAY "| * Valor Médio PA (Ton)            |"
      @nLin,050 PSAY nVM1MPA  Picture "@E 999,999,999.999"
      @nLin,066 PSAY "|"
      @nLin,080 PSAY nVM2MPA Picture "@E 999,999,999.999"
      @nLin,096 PSAY "|"
      @nLin,111 PSAY nVM3MPA Picture "@E 999,999,999.999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVM4MPA Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVM5MPA Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVM6MPA Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
      If lComercial
         //Força Quebra de Página
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
         @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      EndIf
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|INDÚSTRIA (Continuação)"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|PRODUTIVIDADE Kg/H                 |"
      @nLin,051 PSAY (nProd1Mes / nProvd1M)  Picture "@E 99,999,999.999"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY (nProd2Mes / nProvd2M) Picture "@E 99,999,999.999"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY (nProd3Mes / nProvd3M) Picture "@E 99,999,999.999"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY (nProd4Mes / nProvd4M) Picture "@E 99,999,999.999" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY (nProd5Mes / nProvd5M) Picture "@E 99,999,999.999" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY (nProd6Mes / nProvd6M) Picture "@E 99,999,999.999" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      

      @nLin,000 PSAY "|CUSTO DE PRODUÇÃO                  |"
      @nLin,051 PSAY nVlr1CusPro  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nVlr2CusPro Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nVlr3CusPro Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVlr4CusPro Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVlr5CusPro Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVlr6CusPro Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|GASTOS GERAIS IND.                 |"
      @nLin,051 PSAY nVGG1MInd  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nVGG2MInd Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nVGG3MInd Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVGG4MInd Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVGG5MInd Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVGG6MInd Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nDFin1Imp := nFIN1IMP+n1FLAT+n1LIBOR+n1BANQUE+n1DISCREP+n1IRImpor+n1OFImp+n1HptReg+n1MntEst
      nDFin2Imp := nFIN2IMP+n2FLAT+n2LIBOR+n2BANQUE+n2DISCREP+n2IRImpor+n2OFImp+n2HptReg+n2MntEst
      nDFin3Imp := nFIN3IMP+n3FLAT+n3LIBOR+n3BANQUE+n3DISCREP+n3IRImpor+n3OFImp+n3HptReg+n3MntEst

      nDFin4Imp := nFIN4IMP+n4FLAT+n4LIBOR+n4BANQUE+n4DISCREP+n4IRImpor+n4OFImp+n4HptReg+n4MntEst
      nDFin5Imp := nFIN5IMP+n5FLAT+n5LIBOR+n5BANQUE+n5DISCREP+n5IRImpor+n5OFImp+n5HptReg+n5MntEst
      nDFin6Imp := nFIN6IMP+n6FLAT+n6LIBOR+n6BANQUE+n6DISCREP+n6IRImpor+n6OFImp+n6HptReg+n6MntEst
            
      
	      @nLin,000 PSAY "|DESPESAS FINANCEIRAS IMPORTAÇÃO    |"
	      @nLin,051 PSAY nDFin1Imp  Picture "@E 999,999,999.99"
	      @nLin,066 PSAY "|"
	      @nLin,081 PSAY nDFin2Imp Picture "@E 999,999,999.99"
	      @nLin,096 PSAY "|"
	      @nLin,112 PSAY nDFin3Imp Picture "@E 999,999,999.99"
	      @nLin,127 PSAY "|"
	      @nLin,134 PSAY "|"
	      @nLin,149 PSAY nDFin4Imp Picture "@E 999,999,999.99" 
	      @nLin,164 PSAY "|"
	      @nLin,180 PSAY nDFin5Imp Picture "@E 999,999,999.99" 
	      @nLin,195 PSAY "|"
	      @nLin,203 PSAY nDFin6Imp Picture "@E 999,999,999.99" 
	      @nLin,219 PSAY "|"      
	      nLin ++
	      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
	         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
	         nLin := 8
	      Endif
       
         @nLin,000 PSAY "|    ** FINIMP                      |"
         @nLin,051 PSAY nFIN1IMP  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nFIN2IMP Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nFIN3IMP Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nFIN4IMP Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nFIN5IMP Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nFIN6IMP Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** FLAT                        |"
         @nLin,051 PSAY n1FLAT    Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2FLAT Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3FLAT Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4FLAT Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5FLAT Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6FLAT Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    ** LIBOR                       |"
         @nLin,051 PSAY n1LIBOR   Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2LIBOR Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3LIBOR Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4LIBOR Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5LIBOR Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6LIBOR Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    ** BANQUEIRO                   |"
         @nLin,051 PSAY n1BANQUE  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2BANQUE Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3BANQUE Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4BANQUE Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5BANQUE Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6BANQUE Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** DISCREPÂNCIA                |"
         @nLin,051 PSAY n1DISCREP  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2DISCREP Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3DISCREP Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4DISCREP Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5DISCREP Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6DISCREP Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** IR - IMPORTAÇÃO             |"
         @nLin,051 PSAY n1IRImpor  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2IRImpor Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3IRImpor Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4IRImpor Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5IRImpor Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6IRImpor Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** IOF - IMPORTAÇÃO            |"
         @nLin,051 PSAY n1OFImp    Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2OFImp Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3OFImp Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4OFImp Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5OFImp Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6OFImp Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** HIPOTECA - REGISTRO         |"
         @nLin,051 PSAY n1HptReg    Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2HptReg Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3HptReg Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4HptReg Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5HptReg Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6HptReg Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** MONITORAMENTO ESTOQUE       |"
         @nLin,051 PSAY n1MntEst    Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2MntEst Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3MntEst Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4MntEst Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5MntEst Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6MntEst Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
      
      //Five Solutions Consultoria - 11/02/2010 - Inserido Grupo de Impostos neste ponto após DESPESAS FINANCEIRAS IMPORTAÇÃO
      nImp1IndVl := n1ICMSImob+n1ICMPuro+n1IPISo+n1PISUnk+n1COFUnk+n1CSLUnk+n1IRPJnk+n1IRPFnk+n1IINum
      nImp2IndVl := n2ICMSImob+n2ICMPuro+n2IPISo+n2PISUnk+n2COFUnk+n2CSLUnk+n2IRPJnk+n2IRPFnk+n2IINum
      nImp3IndVl := n3ICMSImob+n3ICMPuro+n3IPISo+n3PISUnk+n3COFUnk+n3CSLUnk+n3IRPJnk+n3IRPFnk+n3IINum
      
      nImp4IndVl := n4ICMSImob+n4ICMPuro+n4IPISo+n4PISUnk+n4COFUnk+n4CSLUnk+n4IRPJnk+n4IRPFnk+n4IINum
      nImp5IndVl := n5ICMSImob+n5ICMPuro+n5IPISo+n5PISUnk+n5COFUnk+n5CSLUnk+n5IRPJnk+n5IRPFnk+n5IINum
      nImp6IndVl := n6ICMSImob+n6ICMPuro+n6IPISo+n6PISUnk+n6COFUnk+n6CSLUnk+n6IRPJnk+n6IRPFnk+n6IINum
            
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|  IMPOSTOS                         |"
      @nLin,051 PSAY nImp1IndVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nImp2IndVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nImp3IndVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nImp4IndVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nImp5IndVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nImp6IndVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif

      //Five - 09/03/2011 - If (n1ICMSImob+n2ICMSImob+n3ICMSImob) > 0
       
         @nLin,000 PSAY "|    ** ICMS S/ Imobilizado         |"
         @nLin,051 PSAY n1ICMSImob    Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2ICMSImob Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3ICMSImob Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4ICMSImob Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5ICMSImob Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6ICMSImob Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      //Five - 09/03/2011 - EndIf                                    

      //Five - 09/03/2011 - If (n1ICMPuro+n3ICMPuro+n3ICMPuro) > 0
       
         @nLin,000 PSAY "|    ** ICMS                        |"
         @nLin,051 PSAY n1ICMPuro     Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2ICMPuro Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3ICMPuro Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4ICMPuro Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5ICMPuro Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6ICMPuro Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      //Five - 09/03/2011 - EndIf                                          

      //Five - 09/03/2011 - If (n1IPISo+n2IPISo+n3IPISo) > 0
       
         @nLin,000 PSAY "|    ** IPI                         |"
         @nLin,051 PSAY n1IPISo Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2IPISo Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3IPISo Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4IPISo Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5IPISo Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6IPISo Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      //Five - 09/03/2011 - EndIf                                          


      //Five - 09/03/2011 - If (n1PISUnk+n2PISUnk+n3PISUnk) > 0
       
         @nLin,000 PSAY "|    ** PIS                         |"
         @nLin,051 PSAY n1PISUnk Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2PISUnk Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3PISUnk Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4PISUnk Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5PISUnk Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6PISUnk Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    ** COFINS                      |"
         @nLin,051 PSAY n1COFUnk Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2COFUnk Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3COFUnk Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4COFUnk Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5COFUnk Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6COFUnk Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      

         @nLin,000 PSAY "|    ** CSLL                        |"
         @nLin,051 PSAY n1CSLUnk Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2CSLUnk Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3CSLUnk Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4CSLUnk Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5CSLUnk Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6CSLUnk Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** IRPJ                        |"
         @nLin,051 PSAY n1IRPJnk Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2IRPJnk Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3IRPJnk Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4IRPJnk Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5IRPJnk Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6IRPJnk Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
        
         @nLin,000 PSAY "|    ** IRPF                        |"
         @nLin,051 PSAY n1IRPFnk Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2IRPFnk Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3IRPFnk Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4IRPFnk Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5IRPFnk Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6IRPFnk Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
       
         @nLin,000 PSAY "|    ** II                          |"
         @nLin,051 PSAY n1IINum  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2IINum Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3IINum Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4IINum Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5IINum Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6IINum Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      

      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      //Five Solutions Consultoria - 11/02/2010 - Inserido Grupo MATERIA PRIMA (Total) logo após do Grupo IMPOSTOS
      //Acrescentado Indicador Amazenagem
      
      nMP1MVlTt := nNacMP1MVl+nImpMP1MVl+nTrbImp1MMP+nDspImp1MMP+nFrtImp1MMP+nNMP1AFRMM+nNMP1OpPrt+nNMP1DspAdu+n1Amazena
      nMP2MVlTt := nNacMP2MVl+nImpMP2MVl+nTrbImp2MMP+nDspImp2MMP+nFrtImp2MMP+nNMP2AFRMM+nNMP2OpPrt+nNMP2DspAdu+n2Amazena
      nMP3MVlTt := nNacMP3MVl+nImpMP3MVl+nTrbImp3MMP+nDspImp3MMP+nFrtImp3MMP+nNMP3AFRMM+nNMP3OpPrt+nNMP3DspAdu+n3Amazena

      nMP4MVlTt := nNacMP4MVl+nImpMP4MVl+nTrbImp4MMP+nDspImp4MMP+nFrtImp4MMP+nNMP4AFRMM+nNMP4OpPrt+nNMP4DspAdu+n4Amazena
      nMP5MVlTt := nNacMP5MVl+nImpMP5MVl+nTrbImp5MMP+nDspImp5MMP+nFrtImp5MMP+nNMP5AFRMM+nNMP5OpPrt+nNMP5DspAdu+n5Amazena
      nMP6MVlTt := nNacMP6MVl+nImpMP6MVl+nTrbImp6MMP+nDspImp6MMP+nFrtImp6MMP+nNMP6AFRMM+nNMP6OpPrt+nNMP6DspAdu+n6Amazena
             
      @nLin,000 PSAY "|  MATERIA PRIMA (Total)            |"
      @nLin,051 PSAY nMP1MVlTt  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nMP2MVlTt Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nMP3MVlTt Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nMP4MVlTt Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nMP5MVlTt Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nMP6MVlTt Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
         @nLin,000 PSAY "|    ** Materia Prima               |"
         @nLin,051 PSAY nNacMP1MVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nNacMP2MVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nNacMP3MVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nNacMP4MVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nNacMP5MVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nNacMP6MVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
           nLin := 8
         Endif       
      

      //Five Solutions Consultoria - 11/12/2009 - INCLUIDO INDICADORES 
      //"	**AFRMM (Incluir o nome e a natureza - 32101001)
      //"	**OPERAÇÃO PORTUÁRIA (Incluir o nome e a natureza -32101003)
      //"	**DESPACHANTE ADUANEIRO (Incluir o nome e a natureza -32101004)

      //Five - 09/03/2011 - If (nNMP1AFRMM+nNMP2AFRMM+nNMP3AFRMM) > 0

         @nLin,000 PSAY "|    ** Marinha Mercante            |" //AFRMM
         @nLin,051 PSAY nNMP1AFRMM  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nNMP2AFRMM Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nNMP3AFRMM Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nNMP4AFRMM Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nNMP5AFRMM Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nNMP6AFRMM Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
           nLin := 8
         Endif       

         @nLin,000 PSAY "|    ** Armazenagem                 |"          
         @nLin,051 PSAY n1Amazena   Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY n2Amazena Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY n3Amazena Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY n4Amazena Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY n5Amazena Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY n6Amazena Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
           nLin := 8
         Endif       

         @nLin,000 PSAY "|    ** Operação Portuária          |"
         @nLin,051 PSAY nNMP1OpPrt  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nNMP2OpPrt Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nNMP3OpPrt Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nNMP4OpPrt Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nNMP5OpPrt Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nNMP6OpPrt Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
           nLin := 8
         Endif       

         @nLin,000 PSAY "|    ** Despachante Aduaneiro       |"
         @nLin,051 PSAY nNMP1DspAdu  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nNMP2DspAdu Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nNMP3DspAdu Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nNMP4DspAdu Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nNMP5DspAdu Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nNMP6DspAdu Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
           nLin := 8
         Endif       
      
         @nLin,000 PSAY "|    ** M.P. Importada              |"
         @nLin,051 PSAY nImpMP1MVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nImpMP2MVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nImpMP3MVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nImpMP4MVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nImpMP5MVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nImpMP6MVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    ** Tributos Importação         |"
         @nLin,051 PSAY nTrbImp1MMP  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nTrbImp2MMP Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nTrbImp3MMP Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nTrbImp4MMP Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nTrbImp5MMP Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nTrbImp6MMP Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    ** Despesas Importação         |"
         @nLin,051 PSAY nDspImp1MMP  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nDspImp2MMP Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nDspImp3MMP Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nDspImp4MMP Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nDspImp5MMP Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nDspImp6MMP Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    ** Frete Importação            |"
         @nLin,051 PSAY nFrtImp1MMP  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nFrtImp2MMP Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nFrtImp3MMP Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nFrtImp4MMP Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nFrtImp5MMP Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nFrtImp6MMP Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      //Itacolomy Mariano - 11/03/2008
      //Ao invés de usar query para calcular soma da mão de obra, somarei as variáveis
      nDMOInd1MVl := (nFixMOD1MInd+nPerMOD1MInd+nRes1MDIndVl+nPrm1DIndVl)
      nDMOInd2MVl := (nFixMOD2MInd+nPerMOD2MInd+nRes2MDIndVl+nPrm2DIndVl)
      nDMOInd3MVl := (nFixMOD3MInd+nPerMOD3MInd+nRes3MDIndVl+nPrm3DIndVl)

      nDMOInd4MVl := (nFixMOD4MInd+nPerMOD4MInd+nRes4MDIndVl+nPrm4DIndVl)
      nDMOInd5MVl := (nFixMOD5MInd+nPerMOD5MInd+nRes5MDIndVl+nPrm5DIndVl)
      nDMOInd6MVl := (nFixMOD6MInd+nPerMOD6MInd+nRes6MDIndVl+nPrm6DIndVl)
      
      nMPMO1IndAdm := nDMOInd1MVl
      nMPMO2IndAdm := nDMOInd2MVl
      nMPMO3IndAdm := nDMOInd3MVl

      nMPMO4IndAdm := nDMOInd4MVl
      nMPMO5IndAdm := nDMOInd5MVl
      nMPMO6IndAdm := nDMOInd6MVl
            
      @nLin,000 PSAY "|  MÃO DE OBRA DIRETA               |"
      @nLin,051 PSAY nDMOInd1MVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nDMOInd2MVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nDMOInd3MVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nDMOInd4MVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nDMOInd5MVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nDMOInd6MVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
     
         @nLin,000 PSAY "|    * Desp. Fixa                   |"
         @nLin,051 PSAY nFixMOD1MInd  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nFixMOD2MInd Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nFixMOD3MInd Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nFixMOD4MInd Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nFixMOD5MInd Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nFixMOD6MInd Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    * Desp. Period.                |"
         @nLin,051 PSAY nPerMOD1MInd  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nPerMOD2MInd Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nPerMOD3MInd Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nPerMOD4MInd Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nPerMOD5MInd Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nPerMOD6MInd Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    * Rescisões                    |"
         @nLin,051 PSAY nRes1MDIndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nRes2MDIndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nRes3MDIndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nRes4MDIndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nRes5MDIndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nRes6MDIndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    * Premiações                   |"
         @nLin,051 PSAY nPrm1DIndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nPrm2DIndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nPrm3DIndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nPrm4DIndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nPrm5DIndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nPrm6DIndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      //Five - 09/03/2011 - EndIf
      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
******************************************************************************************************************
      //Itacolomy Mariano - 14/07/2008
      //Novo Conceito - 2009
      nIMOInd1MVl := (nFixMOI1MInd+nPerMOI1MInd+nRes1MIIndVl+nPrm1DIIndVl)
      nIMOInd2MVl := (nFixMOI2MInd+nPerMOI2MInd+nRes2MIIndVl+nPrm2DIIndVl)
      nIMOInd3MVl := (nFixMOI3MInd+nPerMOI3MInd+nRes3MIIndVl+nPrm3DIIndVl)

      nIMOInd4MVl := (nFixMOI4MInd+nPerMOI4MInd+nRes4MIIndVl+nPrm4DIIndVl)
      nIMOInd5MVl := (nFixMOI5MInd+nPerMOI5MInd+nRes5MIIndVl+nPrm5DIIndVl)
      nIMOInd6MVl := (nFixMOI6MInd+nPerMOI6MInd+nRes6MIIndVl+nPrm6DIIndVl)
      
      nSalInd1M := nIMOInd1MVl
      nSalInd2M := nIMOInd2MVl
      nSalInd3M := nIMOInd3MVl

      nSalInd4M := nIMOInd4MVl
      nSalInd5M := nIMOInd5MVl
      nSalInd6M := nIMOInd6MVl
            
      @nLin,000 PSAY "|  MÃO DE OBRA INDIRETA             |"
      @nLin,051 PSAY nIMOInd1MVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nIMOInd2MVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nIMOInd3MVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nIMOInd4MVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nIMOInd5MVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nIMOInd6MVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
     
         @nLin,000 PSAY "|    * Desp. Fixa                   |"
         @nLin,051 PSAY nFixMOI1MInd  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nFixMOI2MInd Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nFixMOI3MInd Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nFixMOI4MInd Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nFixMOI5MInd Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nFixMOI6MInd Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    * Desp. Period.                |"
         @nLin,051 PSAY nPerMOI1MInd  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nPerMOI2MInd Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nPerMOI3MInd Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nPerMOI4MInd Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nPerMOI5MInd Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nPerMOI6MInd Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    * Rescisões                    |"
         @nLin,051 PSAY nRes1MIIndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nRes2MIIndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nRes3MIIndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nRes4MIIndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nRes5MIIndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nRes6MIIndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|    * Premiações                   |"
         @nLin,051 PSAY nPrm1DIIndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nPrm2DIIndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nPrm3DIIndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nPrm4DIIndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nPrm5DIIndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nPrm6DIIndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  BENEFICIAMENTO                   |"
         @nLin,051 PSAY nBnf1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nBnf2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nBnf3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nBnf4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nBnf5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nBnf6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif

         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  INSUMOS                          |"
         @nLin,051 PSAY nInsVl1MInd  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nInsVl2MInd Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nInsVl3MInd Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nInsVl4MInd Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nInsVl5MInd Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nInsVl6MInd Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|"+Replicate("=",218)+"|" //Five Solutions Consultoria - 11/12/2009
         
      //Força Quebra de Página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|INDÚSTRIA (continuação ...)"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
     
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  EMBALAGEM                        |"
         @nLin,051 PSAY nEmb1DIIndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nEmb2DIIndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nEmb3DIIndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nEmb4DIIndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nEmb5DIIndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nEmb6DIIndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  EPI                              |"
         @nLin,051 PSAY nEPI1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nEPI2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nEPI3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nEPI4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nEPI5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nEPI6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
      nMan1IndVl := (nManEL1IndVl+nManFE1IndVl+nManME1IndVl)
      nMan2IndVl := (nManEL2IndVl+nManFE2IndVl+nManME2IndVl)
      nMan3IndVl := (nManEL3IndVl+nManFE3IndVl+nManME3IndVl)

      nMan4IndVl := (nManEL4IndVl+nManFE4IndVl+nManME4IndVl)
      nMan5IndVl := (nManEL5IndVl+nManFE5IndVl+nManME5IndVl)
      nMan6IndVl := (nManEL6IndVl+nManFE6IndVl+nManME6IndVl)
      
     
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  MANUTENÇÃO                       |"
         @nLin,051 PSAY nMan1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nMan2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nMan3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nMan4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nMan5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nMan6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         
            
            @nLin,000 PSAY "|  * Elétrica                       |"
            @nLin,051 PSAY nManEL1IndVl  Picture "@E 999,999,999.99"
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nManEL2IndVl Picture "@E 999,999,999.99"
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nManEL3IndVl Picture "@E 999,999,999.99"
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nManEL4IndVl Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nManEL5IndVl Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nManEL6IndVl Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif
            
            
            @nLin,000 PSAY "|  * Ferramental                    |"
            @nLin,051 PSAY nManFE1IndVl  Picture "@E 999,999,999.99"
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nManFE2IndVl Picture "@E 999,999,999.99"
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nManFE3IndVl Picture "@E 999,999,999.99"
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nManFE4IndVl Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nManFE5IndVl Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nManFE6IndVl Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif
            
            @nLin,000 PSAY "|  * Mecânica                       |"
            @nLin,051 PSAY nManME1IndVl  Picture "@E 999,999,999.99"
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nManME2IndVl Picture "@E 999,999,999.99"
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nManME3IndVl Picture "@E 999,999,999.99"
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nManME4IndVl Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nManME5IndVl Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nManME6IndVl Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif
            
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         
         @nLin,000 PSAY "|  ENERGIA                          |"
         @nLin,051 PSAY nEner1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nEner2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nEner3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nEner4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nEner5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nEner6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         
         @nLin,000 PSAY "|  ÁGUA                             |"
         @nLin,051 PSAY nAgua1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nAgua2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nAgua3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nAgua4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nAgua5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nAgua6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                                                      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif

         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         
         @nLin,000 PSAY "|  ALUGUEL IMÓVEIS                  |"
         @nLin,051 PSAY nAlg1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nAlg2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nAlg3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nAlg4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nAlg5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nAlg6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  SERVIÇOS TERCEIRIZADOS           |"
         @nLin,051 PSAY nSTc1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nSTc2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nSTc3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nSTc4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nSTc5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nSTc6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  DESPESAS DE VIAGENS              |"
         @nLin,051 PSAY nDVg1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nDVg2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nDVg3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nDVg4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nDVg5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nDVg6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
         @nLin,000 PSAY "|  NATUREZAS DIVERSAS               |"
         @nLin,051 PSAY nONt1IndVl  Picture "@E 999,999,999.99"
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nONt2IndVl Picture "@E 999,999,999.99"
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nONt3IndVl Picture "@E 999,999,999.99"
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nONt4IndVl Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nONt5IndVl Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nONt6IndVl Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"            
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      //Five - 09/03/2011 - EndIf
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|  VALOR META ORÇAMENTO IND.        |"
      @nLin,051 PSAY nInd1MMtOrc  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nInd2MMtOrc Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nInd3MMtOrc Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nInd4MMtOrc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nInd5MMtOrc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nInd6MMtOrc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|  GASTOS METAS ORÇAMENTO IND.      |"
      @nLin,051 PSAY nGst1MtOrInd  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nGst2MtOrInd Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nGst3MtOrInd Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nGst4MtOrInd Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nGst5MtOrInd Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nGst6MtOrInd Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"      

   EndIf //Fim da Condição para impressão dos dados da Análise Gerencial Industrial
   
   If lAdmFin
      
      If lComercial .Or. lIndustria
         //Força Quebra de Página
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
         @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      EndIf
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|ADMINISTRATIVO - FINANCEIRO"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      //                       10        20        30        40
      //              01234567890123456789012345678901234567890
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      nPd1MTrvTt := (nPdTrv1MVlr+nPdTrv1AntM)                  
      nPd2MTrvTt := (nPdTrv2MVlr+nPdTrv2AntM)                  
      nPd3MTrvTt := (nPdTrv3MVlr+nPdTrv3AntM)                  

      nPd4MTrvTt := (nPdTrv4MVlr+nPdTrv4AntM)                  
      nPd5MTrvTt := (nPdTrv5MVlr+nPdTrv5AntM)                  
      nPd6MTrvTt := (nPdTrv6MVlr+nPdTrv6AntM)                  
            
      @nLin,000 PSAY "|PEDIDOS NA TRAVA (Total)           |"
      @nLin,051 PSAY nPd1MTrvTt Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPd2MTrvTt Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPd3MTrvTt Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPd4MTrvTt Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPd5MTrvTt Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPd6MTrvTt Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Mês Atual                      |"
      @nLin,051 PSAY nPdTrv1MVlr Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPdTrv2MVlr Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPdTrv3MVlr Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Mêses Anteriores               |"
      @nLin,051 PSAY nPdTrv1AntM Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPdTrv2AntM Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPdTrv3AntM Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      nTit1MTrvTt := (nTit1MTrvVlr+nAntTit1MTrv)                  
      nTit2MTrvTt := (nTit2MTrvVlr+nAntTit2MTrv)
      nTit3MTrvTt := (nTit3MTrvVlr+nAntTit3MTrv)
      
      @nLin,000 PSAY "|TITULOS NA TRAVA (Total)           |"
      @nLin,051 PSAY nTit1MTrvTt Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nTit2MTrvTt Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nTit3MTrvTt Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Mês Atual                      |"
      @nLin,051 PSAY nTit1MTrvVlr Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nTit2MTrvVlr Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nTit3MTrvVlr Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Mêses Anteriores               |"
      @nLin,051 PSAY nAntTit1MTrv Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAntTit2MTrv Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAntTit3MTrv Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|TITULOS A PAGAR (Mês)              |"
      @nLin,051 PSAY nAPg1MTit Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAPg2MTit Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAPg3MTit Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAPg4MTit Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAPg5MTit Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAPg6MTit Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //Ita 03/03/2008 - Novo Conceito p/Pagamentos Realizados
      nPg1MRealiz := (nBx1MComp+nDBT1MCC+nBx1MNorm+nBx1MDevol)
      nPg2MRealiz := (nBx2MComp+nDBT2MCC+nBx2MNorm+nBx2MDevol)
      nPg3MRealiz := (nBx3MComp+nDBT3MCC+nBx3MNorm+nBx3MDevol)

      nPg4MRealiz := (nBx4MComp+nDBT4MCC+nBx4MNorm+nBx4MDevol)
      nPg5MRealiz := (nBx5MComp+nDBT5MCC+nBx5MNorm+nBx5MDevol)
      nPg6MRealiz := (nBx6MComp+nDBT6MCC+nBx6MNorm+nBx6MDevol)
            
      @nLin,000 PSAY "|PAGAMENTOS REALIZADOS (Mês)        |"
      @nLin,051 PSAY nPg1MRealiz Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPg2MRealiz Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPg3MRealiz Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPg4MRealiz Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPg5MRealiz Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPg6MRealiz Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|COMPENSAÇÃO                        |"
      @nLin,051 PSAY nBx1MComp Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nBx2MComp Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nBx3MComp Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nBx4MComp Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nBx5MComp Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nBx6MComp Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|DEBITO CC                          |"
      @nLin,051 PSAY nDBT1MCC Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nDBT2MCC Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nDBT3MCC Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nDBT4MCC Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nDBT5MCC Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nDBT6MCC Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|NORMAL                             |"
      @nLin,051 PSAY nBx1MNorm Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nBx2MNorm Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nBx3MNorm Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nBx4MNorm Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nBx5MNorm Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nBx6MNorm Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|DEVOLUÇÃO                          |"
      @nLin,051 PSAY nBx1MDevol Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nBx2MDevol Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nBx3MDevol Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nBx4MDevol Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nBx5MDevol Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nBx6MDevol Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      nPgAb1MVlr := (nSld1MPag+nSld1MAnt)
      nPgAb2MVlr := (nSld2MPag+nSld2MAnt)
      nPgAb3MVlr := (nSld3MPag+nSld3MAnt)

      nPgAb4MVlr := (nSld4MPag+nSld4MAnt)
      nPgAb5MVlr := (nSld5MPag+nSld5MAnt)
      nPgAb6MVlr := (nSld6MPag+nSld6MAnt)
            
      @nLin,000 PSAY "|PAGAMENTOS EM ABERTO (Total)       |"
      @nLin,051 PSAY nPgAb1MVlr Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPgAb2MVlr Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPgAb3MVlr Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPgAb4MVlr Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPgAb5MVlr Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPgAb6MVlr Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Mês Atual                      |"
      @nLin,051 PSAY nSld1MPag Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nSld2MPag Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nSld3MPag Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nSld4MPag Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nSld5MPag Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nSld6MPag Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Mêses Anteriores               |"
      @nLin,051 PSAY nSld1MAnt Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nSld2MAnt Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nSld3MAnt Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nSld4MAnt Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nSld5MAnt Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nSld6MAnt Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //Titulos A Pagar Total
      
      nTt1MAPG := (nAPg1M1a30+nAPg1M31a60+nAcm1M60dd)
      nTt2MAPG := (nAPg2M1a30+nAPg2M31a60+nAcm2M60dd)
      nTt3MAPG := (nAPg3M1a30+nAPg3M31a60+nAcm3M60dd)

      nTt4MAPG := (nAPg4M1a30+nAPg4M31a60+nAcm4M60dd)
      nTt5MAPG := (nAPg5M1a30+nAPg5M31a60+nAcm5M60dd)
      nTt6MAPG := (nAPg6M1a30+nAPg6M31a60+nAcm6M60dd)
            
      @nLin,000 PSAY "|TITULOS A PAGAR (Total)            |"
      @nLin,051 PSAY nTt1MAPG Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nTt2MAPG Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nTt3MAPG Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nTt4MAPG Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nTt5MAPG Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nTt6MAPG Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * 01 a 30 dias                   |"
      @nLin,051 PSAY nAPg1M1a30 Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAPg2M1a30 Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAPg3M1a30 Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAPg4M1a30 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAPg5M1a30 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAPg6M1a30 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * 31 a 60 dias                   |"
      @nLin,051 PSAY nAPg1M31a60 Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAPg2M31a60 Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAPg3M31a60 Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAPg4M31a60 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAPg5M31a60 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAPg6M31a60 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
//AkiIta
      @nLin,000 PSAY "|  * acima de 60 dias               |"
      @nLin,051 PSAY nAcm1M60dd  Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAcm2M60dd Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAcm3M60dd Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAcm4M60dd Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAcm5M60dd Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAcm6M60dd Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      

      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|TITULOS A RECEBER (Mês)            |"
      @nLin,051 PSAY nARe1MTit Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nARe2MTit Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nARe3MTit Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nARe4MTit Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nARe5MTit Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nARe6MTit Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //Ita 03/03/2008 - Novo Conceito p/ Calcular Titulos Recebidos
      
      nRe1MRealiz := (nBxRE1MComp+nBx1MDvRE+nBxRE1MNorm)
      nRe2MRealiz := (nBxRE2MComp+nBx2MDvRE+nBxRE2MNorm)
      nRe3MRealiz := (nBxRE3MComp+nBx3MDvRE+nBxRE3MNorm)

      nRe4MRealiz := (nBxRE4MComp+nBx4MDvRE+nBxRE4MNorm)
      nRe5MRealiz := (nBxRE5MComp+nBx5MDvRE+nBxRE5MNorm)
      nRe6MRealiz := (nBxRE6MComp+nBx6MDvRE+nBxRE6MNorm)
            
      @nLin,000 PSAY "|TITULOS RECEBIDOS (Mês)            |"
      @nLin,051 PSAY nRe1MRealiz Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nRe2MRealiz Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nRe3MRealiz Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nRe4MRealiz Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nRe5MRealiz Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nRe6MRealiz Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|COMPENSAÇÃO                        |"
      @nLin,051 PSAY nBxRE1MComp Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nBxRE2MComp Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nBxRE3MComp Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nBxRE4MComp Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nBxRE5MComp Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nBxRE6MComp Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|DEVOLUÇÃO                          |"
      @nLin,051 PSAY nBx1MDvRE Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nBx1MDvRE Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nBx1MDvRE Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nBx4MDvRE Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nBx5MDvRE Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nBx6MDvRE Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|NORMAL                             |"
      @nLin,051 PSAY nBxRE1MNorm Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nBxRE2MNorm Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nBxRE3MNorm Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nBxRE4MNorm Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nBxRE5MNorm Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nBxRE6MNorm Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|TITULOS EM ABERTO (Mês)            |"
      @nLin,051 PSAY nSld1MRec Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nSld2MRec Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nSld3MRec Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nSld4MRec Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nSld5MRec Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nSld6MRec Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      nPer1MInadpl := (nSld1MRec/nRe1MRealiz) * 100
      nPer2MInadpl := (nSld2MRec/nRe2MRealiz) * 100
      nPer3MInadpl := (nSld3MRec/nRe3MRealiz) * 100

      nPer4MInadpl := (nSld4MRec/nRe4MRealiz) * 100
      nPer5MInadpl := (nSld5MRec/nRe5MRealiz) * 100
      nPer6MInadpl := (nSld6MRec/nRe6MRealiz) * 100
            
      @nLin,000 PSAY "|% INADIPLÊNCIA (Mês)               |"
      @nLin,051 PSAY nPer1MInadpl Picture "@E 99,999,999.999" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPer2MInadpl Picture "@E 99,999,999.999" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPer3MInadpl Picture "@E 99,999,999.999" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPer4MInadpl Picture "@E 99,999,999.999" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPer5MInadpl Picture "@E 99,999,999.999" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPer6MInadpl Picture "@E 99,999,999.999" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      nTt1MVc := (nAAtTt1MVc+nA1ATt1MVc+nA2ATt1MVc+nAAntTt1MVc)
      nTt2MVc := (nAAtTt2MVc+nA1ATt2MVc+nA2ATt2MVc+nAAntTt2MVc)
      nTt3MVc := (nAAtTt3MVc+nA1ATt3MVc+nA2ATt3MVc+nAAntTt3MVc) 

      nTt4MVc := (nAAtTt4MVc+nA1ATt4MVc+nA2ATt4MVc+nAAntTt4MVc)
      nTt5MVc := (nAAtTt5MVc+nA1ATt5MVc+nA2ATt5MVc+nAAntTt5MVc)
      nTt6MVc := (nAAtTt6MVc+nA1ATt6MVc+nA2ATt6MVc+nAAntTt6MVc) 
            
      @nLin,000 PSAY "|TITULOS VENCIDOS (Total)           |"
      @nLin,051 PSAY nTt1MVc Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nTt2MVc Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nTt3MVc Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nTt4MVc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nTt5MVc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nTt6MVc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * "+cAnoAtu+"                           |"
      @nLin,051 PSAY nAAtTt1MVc Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAAtTt2MVc Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAAtTt3MVc Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAAtTt4MVc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAAtTt5MVc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAAtTt6MVc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * "+cAno1Menos+"                           |"
      @nLin,051 PSAY nA1ATt1MVc Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nA1ATt2MVc Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nA1ATt3MVc Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nA1ATt4MVc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nA1ATt5MVc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nA1ATt6MVc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * "+cAno2Menos+"                           |"
      @nLin,051 PSAY nA2ATt1MVc Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nA2ATt2MVc Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nA2ATt3MVc Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nA2ATt4MVc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nA2ATt5MVc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nA2ATt6MVc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Anteriores                    |"
      @nLin,051 PSAY nAAntTt1MVc Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAAntTt2MVc Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAAntTt3MVc Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAAntTt4MVc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAAntTt5MVc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAAntTt6MVc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
      //Força Quebra de Página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|ADMINISTRATIVO - FINANCEIRO (Continuação)"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //Titulos A Receber Fluxo
      

      nTtFlx1MARE := (nARe1M1a30+nARe1M31a60+nARAc160dd)
      nTtFlx2MARE := (nARe2M1a30+nARe2M31a60+nARAc260dd)
      nTtFlx3MARE := (nARe3M1a30+nARe3M31a60+nARAc360dd)

      nTtFlx4MARE := (nARe4M1a30+nARe4M31a60+nARAc460dd)
      nTtFlx5MARE := (nARe5M1a30+nARe5M31a60+nARAc560dd)
      nTtFlx6MARE := (nARe6M1a30+nARe6M31a60+nARAc660dd)
                  
      @nLin,000 PSAY "|TITULOS A RECEBER (FLUXO)          |"
      @nLin,051 PSAY nTtFlx1MARE Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nTtFlx2MARE Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nTtFlx3MARE Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nTtFlx4MARE Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nTtFlx5MARE Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nTtFlx6MARE Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * 01 a 30 dias                   |"
      @nLin,051 PSAY nARe1M1a30 Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nARe2M1a30 Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nARe3M1a30 Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nARe4M1a30 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nARe5M1a30 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nARe6M1a30 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * 31 a 60 dias                   |"
      @nLin,051 PSAY nARe1M31a60 Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nARe2M31a60 Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nARe3M31a60 Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nARe4M31a60 Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nARe5M31a60 Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nARe6M31a60 Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * acima de 60 dias               |"
      @nLin,051 PSAY nARAc160dd  Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nARAc260dd Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nARAc360dd Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nARAc460dd Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nARAc560dd Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nARAc660dd Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      

      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif

      nImp1MCTt := (nV1MIRImp+nV1MICMS+nV1MIPI+nPIS1MCOF+n1MTribut+nV1MISS+nV1MIPTU+nV1MCPMF)
      nImp2MCTt := (nV2MIRImp+nV2MICMS+nV2MIPI+nPIS2MCOF+n2MTribut+nV2MISS+nV2MIPTU+nV2MCPMF)
      nImp3MCTt := (nV3MIRImp+nV3MICMS+nV3MIPI+nPIS3MCOF+n3MTribut+nV3MISS+nV3MIPTU+nV3MCPMF)

      nImp4MCTt := (nV4MIRImp+nV4MICMS+nV4MIPI+nPIS4MCOF+n4MTribut+nV4MISS+nV4MIPTU+nV4MCPMF)
      nImp5MCTt := (nV5MIRImp+nV5MICMS+nV5MIPI+nPIS5MCOF+n5MTribut+nV5MISS+nV5MIPTU+nV5MCPMF)
      nImp6MCTt := (nV6MIRImp+nV6MICMS+nV6MIPI+nPIS6MCOF+n6MTribut+nV6MISS+nV6MIPTU+nV6MCPMF)
      
      nVGG1MMOADM := (nVGG1MDFADM+nVGG1MDPAD+nVRes1MAdm+nVPrm1MAdm) 
      nVGG2MMOADM := (nVGG2MDFADM+nVGG2MDPAD+nVRes2MAdm+nVPrm2MAdm)
      nVGG3MMOADM := (nVGG3MDFADM+nVGG3MDPAD+nVRes3MAdm+nVPrm3MAdm)

      nVGG4MMOADM := (nVGG4MDFADM+nVGG4MDPAD+nVRes4MAdm+nVPrm4MAdm) 
      nVGG5MMOADM := (nVGG5MDFADM+nVGG5MDPAD+nVRes5MAdm+nVPrm5MAdm)
      nVGG6MMOADM := (nVGG6MDFADM+nVGG6MDPAD+nVRes6MAdm+nVPrm6MAdm)
      
      @nLin,000 PSAY "|GASTOS GERAIS ADM.                 |"
      @nLin,051 PSAY nVl1MAdmGG Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nVl2MAdmGG Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nVl3MAdmGG Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVl4MAdmGG  Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVl5MAdmGG  Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVl6MAdmGG  Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      @nLin,000 PSAY "|MÃO DE OBRA                        |"
      @nLin,051 PSAY nVGG1MMOADM Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nVGG2MMOADM Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nVGG3MMOADM Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nVGG4MMOADM Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nVGG5MMOADM Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nVGG6MMOADM Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
         @nLin,000 PSAY "|  * Desp. Fixa                     |"
         @nLin,051 PSAY nVGG1MDFADM Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVGG2MDFADM Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVGG3MDFADM Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVGG4MDFADM Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVGG5MDFADM Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVGG6MDFADM Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|  * Periódica                      |"
         @nLin,051 PSAY nVGG1MDPAD Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVGG2MDPAD Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVGG3MDPAD Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVGG4MDPAD Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVGG5MDPAD Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVGG6MDPAD Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                                          
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|  * Rescisão                       |"
         @nLin,051 PSAY nVRes1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVRes2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVRes3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVRes4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVRes5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVRes6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                                          
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|  * Premiações                     |"
         @nLin,051 PSAY nVPrm1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVPrm2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVPrm3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVPrm4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVPrm5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVPrm6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"                                          
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  CAIXA GERAL                      |"
         @nLin,051 PSAY nCxGer1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nCxGer2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nCxGer3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nCxGer4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nCxGer5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nCxGer6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif

      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  CAIXINHA                         |"
         @nLin,051 PSAY nCxnha1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nCxnha2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nCxnha3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nCxnha4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nCxnha5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nCxnha6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif

         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  INVESTIMENTOS                    |"
         @nLin,051 PSAY nInves1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nInves2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nInves3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nInves4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nInves5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nInves6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif

      nEmprst1MAdm := nEmpTom1MAdm + nEmpCon1MAdm
      nEmprst2MAdm := nEmpTom2MAdm + nEmpCon2MAdm
      nEmprst3MAdm := nEmpTom3MAdm + nEmpCon3MAdm

      nEmprst4MAdm := nEmpTom4MAdm + nEmpCon4MAdm
      nEmprst5MAdm := nEmpTom5MAdm + nEmpCon5MAdm
      nEmprst6MAdm := nEmpTom6MAdm + nEmpCon6MAdm      
     
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  EMPRÉSTIMOS                      |"
         @nLin,051 PSAY nEmprst1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nEmprst2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nEmprst3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nEmprst4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nEmprst5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nEmprst6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         

            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif
            @nLin,000 PSAY "|  * Tomados                        |"
            @nLin,051 PSAY nEmpTom1MAdm Picture "@E 999,999,999.99" 
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nEmpTom2MAdm Picture "@E 999,999,999.99" 
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nEmpTom3MAdm Picture "@E 999,999,999.99" 
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nEmpTom4MAdm Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nEmpTom5MAdm Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nEmpTom6MAdm Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif

            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif
            @nLin,000 PSAY "|  * Concedidos                     |"
            @nLin,051 PSAY nEmpCon1MAdm Picture "@E 999,999,999.99" 
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nEmpCon2MAdm Picture "@E 999,999,999.99" 
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nEmpCon3MAdm Picture "@E 999,999,999.99" 
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nEmpCon4MAdm Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nEmpCon5MAdm Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nEmpCon6MAdm Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif         
      
      nImbTt1MAdm := nImbBI1MAdm+nImbBM1MAdm
      nImbTt2MAdm := nImbBI2MAdm+nImbBM2MAdm
      nImbTt3MAdm := nImbBI3MAdm+nImbBM3MAdm

      nImbTt4MAdm := nImbBI4MAdm+nImbBM4MAdm
      nImbTt5MAdm := nImbBI5MAdm+nImbBM5MAdm
      nImbTt6MAdm := nImbBI6MAdm+nImbBM6MAdm      
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  IMOBILIZADO(TOTAL)               |"
         @nLin,051 PSAY nImbTt1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nImbTt2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nImbTt3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nImbTt4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nImbTt5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nImbTt6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         
            @nLin,000 PSAY "|  * Bens Imóveis                   |"
            @nLin,051 PSAY nImbBI1MAdm Picture "@E 999,999,999.99" 
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nImbBI2MAdm Picture "@E 999,999,999.99" 
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nImbBI3MAdm Picture "@E 999,999,999.99" 
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nImbBI4MAdm Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nImbBI5MAdm Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nImbBI6MAdm Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif         

            @nLin,000 PSAY "|  * Bens Móveis                    |"
            @nLin,051 PSAY nImbBM1MAdm Picture "@E 999,999,999.99" 
            @nLin,066 PSAY "|"
            @nLin,081 PSAY nImbBM2MAdm Picture "@E 999,999,999.99" 
            @nLin,096 PSAY "|"
            @nLin,112 PSAY nImbBM3MAdm Picture "@E 999,999,999.99" 
            @nLin,127 PSAY "|"
            @nLin,134 PSAY "|"
            @nLin,149 PSAY nImbBM4MAdm Picture "@E 999,999,999.99" 
            @nLin,164 PSAY "|"
            @nLin,180 PSAY nImbBM5MAdm Picture "@E 999,999,999.99" 
            @nLin,195 PSAY "|"
            @nLin,203 PSAY nImbBM6MAdm Picture "@E 999,999,999.99" 
            @nLin,219 PSAY "|"      
            nLin ++
            If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
               Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
               nLin := 8
            Endif         
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  DESPESAS DE VIAGENS              |"
         @nLin,051 PSAY nVDVia1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVDVia2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVDVia3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVDVia4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVDVia5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVDVia6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         //@nLin,000 PSAY "|  HONORÁRIOS ADVOCATÍCIOS          |"
         @nLin,000 PSAY "|  ADVOGADOS                        |"
         @nLin,051 PSAY nHonor1MAdv Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nHonor2MAdv Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nHonor3MAdv Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nHonor4MAdv Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nHonor5MAdv Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nHonor6MAdv Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  SERVIÇOS TERCEIRIZADOS           |"
         @nLin,051 PSAY nVSvT1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVSvT2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVSvT3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVSvT4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVSvT5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVSvT6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif

         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  DESPESAS FINANCEIRAS             |"
         @nLin,051 PSAY nDsp1Fin Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nDsp2Fin Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nDsp3Fin Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nDsp4Fin Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nDsp5Fin Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nDsp6Fin Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  DESPESAS JUDICIAIS               |"
         @nLin,051 PSAY nDsp1MJudc Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nDsp2MJudc Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nDsp3MJudc Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nDsp4MJudc Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nDsp5MJudc Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nDsp6MJudc Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  RESCISÕES ACORDOS/ADV            |"
         @nLin,051 PSAY nRes1MAcAd Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nRes2MAcAd Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nRes3MAcAd Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nRes4MAcAd Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nRes5MAcAd Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nRes6MAcAd Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|EMPRÉSTIMOS ENTRE EMPRESAS         |"
         @nLin,051 PSAY nEmp1MAdmEE Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nEmp2MAdmEE Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nEmp3MAdmEE Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nEmp4MAdmEE Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nEmp5MAdmEE Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nEmp6MAdmEE Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif      
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  OUTRAS DESPESAS ADM.             |"
         @nLin,051 PSAY nVOut1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nVOut2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nVOut3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nVOut4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nVOut5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nVOut6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
         @nLin,000 PSAY "|"
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
         @nLin,000 PSAY "|  OUTRAS NATUREZAS                 |"
         @nLin,051 PSAY nOut1MAdm Picture "@E 999,999,999.99" 
         @nLin,066 PSAY "|"
         @nLin,081 PSAY nOut2MAdm Picture "@E 999,999,999.99" 
         @nLin,096 PSAY "|"
         @nLin,112 PSAY nOut3MAdm Picture "@E 999,999,999.99" 
         @nLin,127 PSAY "|"
         @nLin,134 PSAY "|"
         @nLin,149 PSAY nOut4MAdm Picture "@E 999,999,999.99" 
         @nLin,164 PSAY "|"
         @nLin,180 PSAY nOut5MAdm Picture "@E 999,999,999.99" 
         @nLin,195 PSAY "|"
         @nLin,203 PSAY nOut6MAdm Picture "@E 999,999,999.99" 
         @nLin,219 PSAY "|"      
         nLin ++
         If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
            Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
            nLin := 8
         Endif
      
      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|VALOR META ORÇAMENTO ADM           |"
      @nLin,051 PSAY nAdm1MMtOrc Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nAdm2MMtOrc Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nAdm3MMtOrc Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nAdm4MMtOrc Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nAdm5MMtOrc Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nAdm6MMtOrc Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|GASTOS METAS ORÇAMENTO ADM         |"
      @nLin,051 PSAY nGMt1MAdm Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nGMt2MAdm Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nGMt3MAdm Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nGMt4MAdm Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nGMt5MAdm Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nGMt6MAdm Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
      //Força Quebra de Página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|LOGISTICA"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MERCADO INTERNO                     "
      //@nLin,134 PSAY "|MERCADO EXTERNO                     "
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|MES                                |"
      @nLin,037 PSAY fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,066 PSAY "|"
      @nLin,067 PSAY fNomeMes(Right(d2AnoMes,2))
      @nLin,096 PSAY "|"
      @nLin,097 PSAY fNomeMes(Right(d3AnoMes,2))
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,135 PSAY fNomeMes(Right(d4AnoMes,2))//fNomeMes(Alltrim(StrZero(Month(dDataDe),2)))
      @nLin,164 PSAY "|"
      @nLin,165 PSAY fNomeMes(Right(d5AnoMes,2))
      @nLin,195 PSAY "|"
      @nLin,196 PSAY fNomeMes(Right(d6AnoMes,2))
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|FOB - Faturamento                  |" //
      @nLin,051 PSAY  nFOB1MFt  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nFOB2MFt Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nFOB3MFt Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nFOB4MFt Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nFOB5MFt Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nFOB6MFt Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|CIF"
      @nLin,219 PSAY "|" //
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Faturamento                    |" //
      @nLin,051 PSAY  nFt1MCIF  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nFt2MCIF Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nFt3MCIF Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nFt4MCIF Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nFt5MCIF Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nFt6MCIF Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Frete                          |" //
      @nLin,051 PSAY  nVl1MsFrete  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVl2MsFrete Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVl3MsFrete Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nVl4MsFrete Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVl5MsFrete Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVl6MsFrete Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      nPer1MCIF := (nVl1MsFrete/nFt1MCIF) * 100
      nPer2MCIF := (nVl2MsFrete/nFt2MCIF) * 100
      nPer3MCIF := (nVl3MsFrete/nFt3MCIF) * 100

      nPer4MCIF := (nVl4MsFrete/nFt4MCIF) * 100
      nPer5MCIF := (nVl5MsFrete/nFt5MCIF) * 100
      nPer6MCIF := (nVl6MsFrete/nFt6MCIF) * 100
            
      @nLin,000 PSAY "|  * Percentual (%) Frete           |" //
      @nLin,051 PSAY  nPer1MCIF  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nPer2MCIF Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nPer3MCIF Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nPer4MCIF Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nPer5MCIF Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nPer6MCIF Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif

      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|FATURAMENTO S/ DEF. FRETE          |" //
      @nLin,051 PSAY  nFt1MSDEF  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nFt2MSDEF Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nFt3MSDEF Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nFt4MSDEF Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nFt5MSDEF Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nFt6MSDEF Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
***********************************************************************
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|FRETE IMPORTAÇÃO"
      @nLin,219 PSAY "|" //
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Entrada MP                     |" //
      @nLin,051 PSAY  nEnt1MPFI  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nEnt2MPFI Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nEnt3MPFI Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nEnt4MPFI Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nEnt5MPFI Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nEnt6MPFI Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Frete MP                       |" //
      @nLin,051 PSAY  nFr1tMP  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nFr2tMP Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nFr3tMP Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nFr4tMP Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nFr5tMP Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nFr6tMP Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      nPc1FImp := (nFr1tMP/nEnt1MPFI) * 100
      nPc2FImp := (nFr2tMP/nEnt2MPFI) * 100
      nPc3FImp := (nFr3tMP/nEnt3MPFI) * 100

      nPc4FImp := (nFr4tMP/nEnt4MPFI) * 100
      nPc5FImp := (nFr5tMP/nEnt5MPFI) * 100
      nPc6FImp := (nFr6tMP/nEnt6MPFI) * 100
            
      @nLin,000 PSAY "|  * Percentual (%) Frete           |" //
      @nLin,051 PSAY  nPc1FImp  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nPc2FImp Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nPc3FImp Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nPc4FImp Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nPc5FImp Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nPc6FImp Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
***********************************************************************      

      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      n1MTotFrtPg := (n1FrtVeMVl+n1FrtImpMVl+n1FrtExpMVl+n1FrtBenMVl+n1FrtTrfMVl+n1FrtComMVl+n1FrtIndMVl+n1FrtAdmMVl)
      n2MTotFrtPg := (n2FrtVeMVl+n2FrtImpMVl+n2FrtExpMVl+n2FrtBenMVl+n2FrtTrfMVl+n2FrtComMVl+n2FrtIndMVl+n2FrtAdmMVl)
      n3MTotFrtPg := (n3FrtVeMVl+n3FrtImpMVl+n3FrtExpMVl+n3FrtBenMVl+n3FrtTrfMVl+n3FrtComMVl+n3FrtIndMVl+n3FrtAdmMVl)

      n4MTotFrtPg := (n4FrtVeMVl+n4FrtImpMVl+n4FrtExpMVl+n4FrtBenMVl+n4FrtTrfMVl+n4FrtComMVl+n4FrtIndMVl+n4FrtAdmMVl)
      n5MTotFrtPg := (n5FrtVeMVl+n5FrtImpMVl+n5FrtExpMVl+n5FrtBenMVl+n5FrtTrfMVl+n5FrtComMVl+n5FrtIndMVl+n5FrtAdmMVl)
      n6MTotFrtPg := (n6FrtVeMVl+n6FrtImpMVl+n6FrtExpMVl+n6FrtBenMVl+n6FrtTrfMVl+n6FrtComMVl+n6FrtIndMVl+n6FrtAdmMVl)
      
      @nLin,000 PSAY "|FRETES (Total)                     |" //
      @nLin,051 PSAY  n1MTotFrtPg  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2MTotFrtPg Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3MTotFrtPg Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4MTotFrtPg Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5MTotFrtPg Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6MTotFrtPg Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Vendas                         |" //
      @nLin,051 PSAY  n1FrtVeMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtVeMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtVeMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtVeMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtVeMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtVeMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Importação                     |" //
      @nLin,051 PSAY  n1FrtImpMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtImpMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtImpMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtImpMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtImpMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtImpMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Exportação                     |" //
      @nLin,051 PSAY  n1FrtExpMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtExpMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtExpMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtExpMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtExpMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtExpMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                        
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Beneficiamento                 |" //
      @nLin,051 PSAY  n1FrtBenMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtBenMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtBenMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtBenMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtBenMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtBenMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Transferência                  |" //
      @nLin,051 PSAY  n1FrtTrfMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtTrfMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtTrfMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtTrfMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtTrfMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtTrfMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Comercio                       |" //
      @nLin,051 PSAY  n1FrtComMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtComMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtComMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtComMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtComMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtComMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Indústria                      |" //
      @nLin,051 PSAY  n1FrtIndMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtIndMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtIndMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtIndMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtIndMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtIndMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Administrativo                 |" //
      @nLin,051 PSAY  n1FrtAdmMVl  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  n2FrtAdmMVl Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  n3FrtAdmMVl Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  n4FrtAdmMVl Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  n5FrtAdmMVl Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  n6FrtAdmMVl Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"

   EndIf //Fim da Condição para impressão dos dados da Análise Gerencial Administrativo/Financeira
   
   If lDemonsRes
      
      //Força Quebra de Página
      Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
      nLin := 8
      
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|DEMONSTRATIVO DE RESULTADO"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //SOMATÓRIO DAS VENDAS DO MI + SUCATA + ME
      @nLin,000 PSAY "|RECEITA BRUTA                      |" //
      @nLin,051 PSAY  (nFat1MesBru + nVl1SUCMFat)  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (nFat2MesBru + nVl2SUCMFat) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (nFat3MesBru + nVl3SUCMFat) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nFat4MesBru + nVl4SUCMFat) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nFat5MesBru + nVl5SUCMFat) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nFat6MesBru + nVl6SUCMFat) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //SOMATÓRIO DAS VENDAS DO MI + SUCATA
      @nLin,000 PSAY "|  Mercado Interno (Total)          |" //
      @nLin,051 PSAY  (nFat1MesBru + nVl1SUCMFat)  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (nFat2MesBru + nVl2SUCMFat) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (nFat3MesBru + nVl3SUCMFat) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (nFat4MesBru + nVl4SUCMFat) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (nFat5MesBru + nVl5SUCMFat) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (nFat6MesBru + nVl6SUCMFat) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //TODAS AS VENDAS DO MI QUE POSSUEM A CONDIÇÃO DE FATURAMENTO "ANTECIPADO"
      @nLin,000 PSAY "|    * Vendas a Vista               |" //
      @nLin,051 PSAY  nFat1AVista  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nFat2AVista Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nFat3AVista Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nFat4AVista Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nFat5AVista Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nFat6AVista Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //TODAS AS CONDIÇÕES DE VENDAS DO MI COM EXCESSÃO "ANTECIPADO"
      @nLin,000 PSAY "|    * Vendas a Prazo               |" //
      @nLin,051 PSAY  nFat1APrazo  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nFat2APrazo Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nFat3APrazo Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nFat4APrazo Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nFat5APrazo Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nFat6APrazo Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //TODAS AS CONDIÇÕES DE VENDA DA SUCATA
      @nLin,000 PSAY "|    * Sucata                       |" //
      @nLin,051 PSAY  nVl1SUCMFat  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nVl2SUCMFat Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nVl3SUCMFat Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nVl4SUCMFat Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nVl5SUCMFat Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nVl6SUCMFat Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //SOMATÓRIO DAS VENDAS DO MI + SUCATA
      @nLin,000 PSAY "|  Mercado Externo (Total)          |" //
      @nLin,051 PSAY  (0)  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //TODAS AS VENDAS DO MI QUE POSSUEM A CONDIÇÃO DE FATURAMENTO "ANTECIPADO"
      @nLin,000 PSAY "|    * Vendas a Vista               |" //
      @nLin,051 PSAY  0  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //TODAS AS CONDIÇÕES DE VENDAS DO MI COM EXCESSÃO "ANTECIPADO"
      @nLin,000 PSAY "|    * Vendas a Prazo               |" //
      @nLin,051 PSAY  0  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|    * Sucata                       |" //
      @nLin,051 PSAY  (0)Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"
      nLin ++
      //TODAS AS DEDUÇÕES DE VENDAS (IMPOSTOS,  DEVOLUÇÕES, OUTRAS DEDUÇÕES )

      /* Manutenção efetuada pouco antes da impressão em São Paulo/SP - Solicitação: Patrícia
      Zerado os impostos para evitar subtração na materia prima.*/
      
      //Five Solutions Consultoria - Reativado Impostos do DRE - Patricia: 10/03/2010 - DRE
      
      nImp1SVend := (nIPI1Valor+nICM1Vlor+nPIS1Valor+nCOF1Valor)
      nImp2SVend := (nIPI2Valor+nICM2Vlor+nPIS2Valor+nCOF2Valor)
      nImp3SVend := (nIPI3Valor+nICM3Vlor+nPIS3Valor+nCOF3Valor)

      nImp4SVend := (nIPI4Valor+nICM4Vlor+nPIS4Valor+nCOF4Valor)
      nImp5SVend := (nIPI5Valor+nICM5Vlor+nPIS5Valor+nCOF5Valor)
      nImp6SVend := (nIPI6Valor+nICM6Vlor+nPIS6Valor+nCOF6Valor)
            
      
      nImp1SVend := (nIPI1Valor+nICM1Vlor+nPIS1Valor+nCOF1Valor)
      nImp2SVend := (nIPI2Valor+nICM2Vlor+nPIS2Valor+nCOF2Valor)
      nImp3SVend := (nIPI3Valor+nICM3Vlor+nPIS3Valor+nCOF3Valor)

      nImp4SVend := (nIPI4Valor+nICM4Vlor+nPIS4Valor+nCOF4Valor)
      nImp5SVend := (nIPI5Valor+nICM5Vlor+nPIS5Valor+nCOF5Valor)
      nImp6SVend := (nIPI6Valor+nICM6Vlor+nPIS6Valor+nCOF6Valor)
            
      nDevol1M  := (nVl1MesDev)
      nDevol2M  := (nVl2MesDev)
      nDevol3M  := (nVl3MesDev)

      nDevol4M  := (nVl4MesDev)
      nDevol5M  := (nVl5MesDev)
      nDevol6M  := (nVl6MesDev)
            
      nDed1MVend := (nImp1SVend+nDevol1M)
      nDed2MVend := (nImp2SVend+nDevol2M)
      nDed3MVend := (nImp3SVend+nDevol3M)

      nDed4MVend := (nImp4SVend+nDevol4M)
      nDed5MVend := (nImp5SVend+nDevol5M)
      nDed6MVend := (nImp6SVend+nDevol6M)
      
      @nLin,000 PSAY "|(-)DEDUÇÕES DE VENDAS              |" //
      @nLin,049 PSAY  "("+Transform(nDed1MVend,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nDed2MVend,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nDed3MVend,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nDed4MVend,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nDed5MVend,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nDed6MVend,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //SOMATÓRIO DOS IMPOSTOS QUE INCIDEM NAS N.F.'S DE VENDAS
      @nLin,000 PSAY "|  Impostos Indiretos               |" //
      @nLin,049 PSAY  "("+Transform(nImp1SVend,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nImp2SVend,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nImp3SVend,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nImp4SVend,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nImp5SVend,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nImp6SVend,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //VALOR DO ICMS LANÇADO NAS N.F.'S DE VENDAS (LIVRO FISCAL DE SAÍDA) 
      @nLin,000 PSAY "|    * ICMS                         |" //
      @nLin,049 PSAY  "("+Transform(nICM1Vlor,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nICM2Vlor,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nICM3Vlor,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nICM4Vlor,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nICM5Vlor,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nICM6Vlor,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //VALOR DO IPI LANÇADO NAS N.F.'S DE VENDAS (LIVRO FISCAL DE SAÍDA)
      @nLin,000 PSAY "|    * IPI                          |" //
      @nLin,049 PSAY  "("+Transform(nIPI1Valor,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nIPI2Valor,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nIPI3Valor,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nIPI4Valor,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nIPI5Valor,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nIPI6Valor,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //CALCULAR PIS (1,65%) E COFINS (7,60%) SOBRE O FATURAMENTO TOTAL DE VENDAS (LIVRO FISCAL DE SAÍDA)
      @nLin,000 PSAY "|    * PIS+COFINS                   |" //
      @nLin,049 PSAY  "("+Transform((nPIS1Valor+nCOF1Valor),"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform((nPIS2Valor+nCOF2Valor),"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform((nPIS3Valor+nCOF3Valor),"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform((nPIS4Valor+nCOF4Valor),"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform((nPIS5Valor+nCOF5Valor),"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform((nPIS6Valor+nCOF6Valor),"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //DEVOLUÇÕES DO MI E ME REGISTRADAS PELO LIVRO FISCAL DE ENTRADA 
      
      @nLin,000 PSAY "|  Devoluções                       |" //
      @nLin,049 PSAY  "("+Transform(nDevol1M,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nDevol2M,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nDevol3M,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nDevol4M,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nDevol5M,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nDevol6M,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //DEVOLUÇÕES DO MI REGISTRADAS PELO LIVRO FISCAL DE ENTRADA 
      @nLin,000 PSAY "|    * Mercado Interno              |" //
      @nLin,049 PSAY  "("+Transform(nVl1MesDev,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nVl2MesDev,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nVl3MesDev,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nVl4MesDev,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nVl5MesDev,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nVl6MesDev,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //DEVOLUÇÕES DO ME REGISTRADAS PELO LIVRO FISCAL DE ENTRADA 
      @nLin,000 PSAY "|    * Mercado Externo              |" //
      @nLin,051 PSAY  (0)  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  (0) Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //RECEITA LIQUIDA = RECEITA BRUTA (-) DEDUÇÕES DE VENDAS
      NRecLi1Mquida := ((nFat1MesBru + nVl1SUCMFat) - (nDed1MVend))
      NRecLi2Mquida := ((nFat2MesBru + nVl2SUCMFat) - (nDed2MVend))
      NRecLi3Mquida := ((nFat3MesBru + nVl3SUCMFat) - (nDed3MVend))      

      NRecLi4Mquida := ((nFat4MesBru + nVl4SUCMFat) - (nDed4MVend))
      NRecLi5Mquida := ((nFat5MesBru + nVl5SUCMFat) - (nDed5MVend))
      NRecLi6Mquida := ((nFat6MesBru + nVl6SUCMFat) - (nDed6MVend))      
      
      //@nLin,000 PSAY "|RECEITA LÍQUIDA DE VENDAS          |" //
      @nLin,000 PSAY "|RECEITA LÍQUIDA-Antes do Incentivo |" //
      @nLin,051 PSAY  NRecLi1Mquida  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  NRecLi2Mquida Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  NRecLi3Mquida Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  NRecLi4Mquida Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  NRecLi5Mquida Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  NRecLi6Mquida Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      @nLin,000 PSAY "|Receita de Incentivo Fiscal MP     |" //
      @nLin,051 PSAY  nInc1FisMP  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nInc2FisMP Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nInc3FisMP Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nInc4FisMP Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nInc5FisMP Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nInc6FisMP Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"                  
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      nLin ++
      @nLin,000 PSAY "|Transferencia Incentivo Fiscal MP  |" //
      @nLin,051 PSAY  nTrfI1FisMP Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nTrfI2FisMP Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nTrfI3FisMP Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nTrfI4FisMP Picture "@E 999,999,999.99"
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nTrfI5FisMP Picture "@E 999,999,999.99"
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nTrfI6FisMP Picture "@E 999,999,999.99"
      @nLin,219 PSAY "|"                  
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //RECEITA LIQUIDA (Depois do Incentivo) = RECEITA LÍQUIDA (Antes do Incentivo) (+) Receita de Incentivo Fiscal (-) Transferencia de Incentivo
      nRc1LqDpIctv := NRecLi1Mquida + nInc1FisMP - nTrfI1FisMP
      nRc2LqDpIctv := NRecLi2Mquida + nInc2FisMP - nTrfI2FisMP
      nRc3LqDpIctv := NRecLi3Mquida + nInc3FisMP - nTrfI3FisMP

      nRc4LqDpIctv := NRecLi4Mquida + nInc4FisMP - nTrfI4FisMP
      nRc5LqDpIctv := NRecLi5Mquida + nInc5FisMP - nTrfI5FisMP
      nRc6LqDpIctv := NRecLi6Mquida + nInc6FisMP - nTrfI6FisMP
      
      @nLin,000 PSAY "|RECEITA LÍQUIDA-Depois do Incentivo|" //
      @nLin,051 PSAY  nRc1LqDpIctv  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nRc2LqDpIctv Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nRc3LqDpIctv Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nRc4LqDpIctv Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nRc5LqDpIctv Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nRc6LqDpIctv Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nMPCst1M := (nCMP1Mes+nVlM1CusSUC+nCus1MesDev) // - nImp1SVend
      nMPCst2M := (nCMP2Mes+nVlM2CusSUC+nCus2MesDev) // - nImp2SVend
      nMPCst3M := (nCMP3Mes+nVlM3CusSUC+nCus3MesDev) // - nImp3SVend

      nMPCst4M := (nCMP4Mes+nVlM4CusSUC+nCus4MesDev) // - nImp1SVend
      nMPCst5M := (nCMP5Mes+nVlM5CusSUC+nCus5MesDev) // - nImp2SVend
      nMPCst6M := (nCMP6Mes+nVlM6CusSUC+nCus6MesDev) // - nImp3SVend
      
      n1CstVariav := nMPCst1M + nBnf1IndVl + nInsVl1MInd + nEmb1DIIndVl + nEner1IndVl + nAgua1IndVl
      n2CstVariav := nMPCst2M + nBnf2IndVl + nInsVl2MInd + nEmb2DIIndVl + nEner2IndVl + nAgua2IndVl
      n3CstVariav := nMPCst3M + nBnf3IndVl + nInsVl3MInd + nEmb3DIIndVl + nEner3IndVl + nAgua3IndVl

      n4CstVariav := nMPCst4M + nBnf4IndVl + nInsVl4MInd + nEmb4DIIndVl + nEner4IndVl + nAgua4IndVl
      n5CstVariav := nMPCst5M + nBnf5IndVl + nInsVl5MInd + nEmb5DIIndVl + nEner5IndVl + nAgua5IndVl
      n6CstVariav := nMPCst6M + nBnf6IndVl + nInsVl6MInd + nEmb6DIIndVl + nEner6IndVl + nAgua6IndVl
            
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "| Custo Variavel                    |" //
      @nLin,049 PSAY  "("+Transform(n1CstVariav,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(n2CstVariav,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(n3CstVariav,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(n4CstVariav,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(n5CstVariav,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(n6CstVariav,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
            
      @nLin,000 PSAY "|   * Materia Prima                 |" //
      //@nLin,051 PSAY  nMP1MVlTt  Picture "@E 999,999,999.99"
      @nLin,049 PSAY  "("+Transform(nMPCst1M,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      //@nLin,081 PSAY  nMP2MVlTt Picture "@E 999,999,999.99"
      @nLin,079 PSAY  "("+Transform(nMPCst2M,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      //@nLin,112 PSAY  nMP3MVlTt Picture "@E 999,999,999.99"
      @nLin,110 PSAY  "("+Transform(nMPCst3M,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nMPCst4M,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nMPCst5M,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nMPCst6M,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|   * Beneficiamento                |" //
      @nLin,049 PSAY  "("+Transform(nBnf1IndVl,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nBnf2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nBnf3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nBnf4IndVl,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nBnf5IndVl,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nBnf6IndVl,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //INSUMOS '200308','200408','200312','200412'
      @nLin,000 PSAY "|   * Insumos                       |" //
      @nLin,049 PSAY  "("+Transform(nInsVl1MInd,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nInsVl2MInd,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nInsVl3MInd,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nInsVl4MInd,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nInsVl5MInd,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nInsVl6MInd,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|   * Embalagem                     |" //
      @nLin,049 PSAY  "("+Transform(nEmb1DIIndVl,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nEmb2DIIndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nEmb3DIIndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nEmb4DIIndVl,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nEmb5DIIndVl,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nEmb6DIIndVl,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|   * Energia Elétrica              |" //
      @nLin,049 PSAY  "("+Transform(nEner1IndVl,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nEner2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nEner3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nEner4IndVl,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nEner5IndVl,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nEner6IndVl,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //AGUA '200310','200410'
      @nLin,000 PSAY "|   * Água                          |" //
      @nLin,049 PSAY  "("+Transform(nAgua1IndVl,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nAgua2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nAgua3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nAgua4IndVl,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nAgua5IndVl,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nAgua6IndVl,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"                                                      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif            
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      n1DspVariav := nVl1MsFrete + nVl1MComis + nVl1MRepres 
      n2DspVariav := nVl2MsFrete + nVl2MComis + nVl2MRepres 
      n3DspVariav := nVl3MsFrete + nVl3MComis + nVl3MRepres 

      n4DspVariav := nVl4MsFrete + nVl4MComis + nVl4MRepres 
      n5DspVariav := nVl5MsFrete + nVl5MComis + nVl5MRepres 
      n6DspVariav := nVl6MsFrete + nVl6MComis + nVl6MRepres 
            
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      @nLin,000 PSAY "| Despesa Variável                  |" //
      @nLin,049 PSAY  "("+Transform(n1DspVariav,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(n2DspVariav,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(n3DspVariav,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(n4DspVariav,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(n5DspVariav,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(n6DspVariav,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Frete Vendas                   |" //
      @nLin,049 PSAY  "("+Transform(nVl1MsFrete,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nVl2MsFrete,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nVl3MsFrete,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nVl4MsFrete,"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nVl5MsFrete,"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nVl6MsFrete,"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Comissão/Representação         |" //
      @nLin,049 PSAY  "("+Transform((nVl1MComis + nVl1MRepres),"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform((nVl2MComis + nVl2MRepres),"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform((nVl3MComis + nVl3MRepres),"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform((nVl4MComis + nVl4MRepres),"@E 999,999,999.99")+")"
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform((nVl5MComis + nVl5MRepres),"@E 999,999,999.99")+")"
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform((nVl6MComis + nVl6MRepres),"@E 999,999,999.99")+")"
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif            
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif            
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif            

      //SOMATÓRIO DOS CUSTOS DIRETOS E INDIRETOS 
      
      nCust1oDir := (nMPCst1M+nMPMO1IndAdm+nBnf1IndVl+nInsVl1MInd+nEmb1DIIndVl)
      nCust2oDir := (nMPCst2M+nMPMO2IndAdm+nBnf2IndVl+nInsVl2MInd+nEmb2DIIndVl)
      nCust3oDir := (nMPCst3M+nMPMO3IndAdm+nBnf3IndVl+nInsVl3MInd+nEmb3DIIndVl)

      nCust4oDir := (nMPCst4M+nMPMO4IndAdm+nBnf4IndVl+nInsVl4MInd+nEmb4DIIndVl)
      nCust5oDir := (nMPCst5M+nMPMO5IndAdm+nBnf5IndVl+nInsVl5MInd+nEmb5DIIndVl)
      nCust6oDir := (nMPCst6M+nMPMO6IndAdm+nBnf6IndVl+nInsVl6MInd+nEmb6DIIndVl)
            
      nInd1MCusto := (nSalInd1M+nMan1IndVl+nSTc1IndVl+nEPI1IndVl+nEner1IndVl+nAgua1IndVl+nAlg1IndVl+nODp1IndVl)
      nInd2MCusto := (nSalInd2M+nMan2IndVl+nSTc2IndVl+nEPI2IndVl+nEner2IndVl+nAgua2IndVl+nAlg2IndVl+nODp2IndVl)
      nInd3MCusto := (nSalInd3M+nMan3IndVl+nSTc3IndVl+nEPI3IndVl+nEner3IndVl+nAgua3IndVl+nAlg3IndVl+nODp3IndVl)

      nInd4MCusto := (nSalInd4M+nMan4IndVl+nSTc4IndVl+nEPI4IndVl+nEner4IndVl+nAgua4IndVl+nAlg4IndVl+nODp4IndVl)
      nInd5MCusto := (nSalInd5M+nMan5IndVl+nSTc5IndVl+nEPI5IndVl+nEner5IndVl+nAgua5IndVl+nAlg5IndVl+nODp5IndVl)
      nInd6MCusto := (nSalInd6M+nMan6IndVl+nSTc6IndVl+nEPI6IndVl+nEner6IndVl+nAgua6IndVl+nAlg6IndVl+nODp6IndVl)
            
      nCPV1M := (nCust1oDir+nInd1MCusto) 
      nCPV2M := (nCust2oDir+nInd2MCusto) 
      nCPV3M := (nCust3oDir+nInd3MCusto) 
      
      nCPV4M := (nCust4oDir+nInd4MCusto) 
      nCPV5M := (nCust5oDir+nInd5MCusto) 
      nCPV6M := (nCust6oDir+nInd6MCusto) 
      

      //Five Solutions Consultoria - 02/08/2010
      //LUCRO BRUTO = (RECEITA LIQUIDA + Incentivos Fiscais) (-) (MENOS CUSTRO PRODUTO VENDIDO + Transferências de Incentivos Fiscais)
      nLcr1MBrut := ((NRecLi1Mquida+nInc1FisMP) - (nCPV1M+nTrfI1FisMP))
      nLcr2MBrut := ((NRecLi2Mquida+nInc2FisMP) - (nCPV2M+nTrfI2FisMP))
      nLcr3MBrut := ((NRecLi3Mquida+nInc3FisMP) - (nCPV3M+nTrfI3FisMP))

      nLcr4MBrut := ((NRecLi4Mquida+nInc4FisMP) - (nCPV4M+nTrfI4FisMP))
      nLcr5MBrut := ((NRecLi5Mquida+nInc5FisMP) - (nCPV5M+nTrfI5FisMP))
      nLcr6MBrut := ((NRecLi6Mquida+nInc6FisMP) - (nCPV6M+nTrfI6FisMP))
      
      //MARGEM DE CONTRIBUIÇÃO = RECEITA LIQUIDA(Depois do Incentivo (-) MENOS CUSTO VARIÁVEL E (-) MENOS DESPESA VARIÁVEL            
      
      nMg1CtrbLC := nRc1LqDpIctv - n1CstVariav - n1DspVariav
      nMg2CtrbLC := nRc2LqDpIctv - n2CstVariav - n2DspVariav
      nMg3CtrbLC := nRc3LqDpIctv - n3CstVariav - n3DspVariav

      nMg4CtrbLC := nRc4LqDpIctv - n4CstVariav - n4DspVariav
      nMg5CtrbLC := nRc5LqDpIctv - n5CstVariav - n5DspVariav
      nMg6CtrbLC := nRc6LqDpIctv - n6CstVariav - n6DspVariav
      
      @nLin,000 PSAY "|MARGEM DE CONTRIBUIÇÃO(Lucro Bruto)|" //
      @nLin,051 PSAY nMg1CtrbLC  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nMg2CtrbLC Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nMg3CtrbLC Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nMg4CtrbLC Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nMg5CtrbLC Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nMg6CtrbLC Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nPer1MrgCtrb := (nMg1CtrbLC / nRc1LqDpIctv) * 100
      nPer2MrgCtrb := (nMg2CtrbLC / nRc2LqDpIctv) * 100
      nPer3MrgCtrb := (nMg3CtrbLC / nRc3LqDpIctv) * 100
      
      nPer4MrgCtrb := (nMg4CtrbLC / nRc4LqDpIctv) * 100
      nPer5MrgCtrb := (nMg5CtrbLC / nRc5LqDpIctv) * 100
      nPer6MrgCtrb := (nMg6CtrbLC / nRc6LqDpIctv) * 100
      
      @nLin,000 PSAY "|% Margem de Contribuição           |" //
      @nLin,051 PSAY nPer1MrgCtrb  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nPer2MrgCtrb Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nPer3MrgCtrb Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nPer4MrgCtrb Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nPer5MrgCtrb Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nPer6MrgCtrb Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //SOMATÓRIO (Custos Desemb. Ind) + (Despesas Desemb. Coml) + (Despesas Desemb. Adm.) + (Despesas Financeiras)

      nDsb1CusInd := nMPMO1IndAdm + nSalInd1Adm + nSTc1ComVl + nMan1IndVl + nEPI1IndVl + nAlg1IndVl + nODp1IndVl
      nDsb2CusInd := nMPMO2IndAdm + nSalInd2Adm + nSTc2ComVl + nMan2IndVl + nEPI2IndVl + nAlg2IndVl + nODp2IndVl
      nDsb3CusInd := nMPMO3IndAdm + nSalInd3Adm + nSTc3ComVl + nMan3IndVl + nEPI3IndVl + nAlg3IndVl + nODp3IndVl

      nDsb4CusInd := nMPMO4IndAdm + nSalInd4Adm + nSTc4ComVl + nMan4IndVl + nEPI4IndVl + nAlg4IndVl + nODp4IndVl
      nDsb5CusInd := nMPMO5IndAdm + nSalInd5Adm + nSTc5ComVl + nMan5IndVl + nEPI5IndVl + nAlg5IndVl + nODp5IndVl
      nDsb6CusInd := nMPMO6IndAdm + nSalInd6Adm + nSTc6ComVl + nMan6IndVl + nEPI6IndVl + nAlg6IndVl + nODp6IndVl
      
      nDsb1CsIndDp := nDsb1CusInd + nDsbFx1Dsp + nDsbF1Ad + nDsp1Fin
      nDsb2CsIndDp := nDsb2CusInd + nDsbFx2Dsp + nDsbF2Ad + nDsp2Fin
      nDsb3CsIndDp := nDsb3CusInd + nDsbFx3Dsp + nDsbF3Ad + nDsp3Fin

      nDsb4CsIndDp := nDsb4CusInd + nDsbFx4Dsp + nDsbF4Ad + nDsp4Fin
      nDsb5CsIndDp := nDsb5CusInd + nDsbFx5Dsp + nDsbF5Ad + nDsp5Fin
      nDsb6CsIndDp := nDsb6CusInd + nDsbFx6Dsp + nDsbF6Ad + nDsp6Fin
                                                          
      @nLin,000 PSAY "|(-) Custos e Despesas Fixas Desemb.|" //
      @nLin,049 PSAY "("+Transform(nDsb1CsIndDp,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nDsb2CsIndDp,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nDsb3CsIndDp,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nDsb4CsIndDp,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nDsb5CsIndDp,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nDsb6CsIndDp,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      @nLin,000 PSAY "|Custos Fixos Desembolsáveis (Ind.) |" //
      @nLin,049 PSAY "("+Transform(nDsb1CusInd ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nDsb2CusInd,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nDsb3CusInd,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nDsb4CusInd,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nDsb5CusInd,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nDsb6CusInd,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|   * Salarios Produção             |" //
      @nLin,049 PSAY  "("+Transform(nMPMO1IndAdm ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nMPMO2IndAdm,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nMPMO3IndAdm,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nMPMO4IndAdm,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nMPMO5IndAdm,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nMPMO6IndAdm,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|   * Salarios - Adm.Indústria      |" //
      @nLin,049 PSAY  "("+Transform(nSalInd1Adm ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nSalInd2Adm,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nSalInd3Adm,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nSalInd4Adm,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nSalInd5Adm,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nSalInd6Adm,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"                  
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Serviços Terceirizados         |"
      @nLin,049 PSAY "("+Transform(nSTc1ComVl ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nSTc2ComVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nSTc3ComVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nSTc4ComVl,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nSTc5ComVl,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nSTc6ComVl,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * Manutenção                     |"
      @nLin,049 PSAY "("+Transform(nMan1IndVl ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nMan2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nMan3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nMan4IndVl,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nMan5IndVl,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nMan6IndVl,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|  * EPI                            |"
      @nLin,049 PSAY "("+Transform(nEPI1IndVl ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nEPI2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nEPI3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nEPI4IndVl,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nEPI5IndVl,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nEPI6IndVl,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif         
      @nLin,000 PSAY "|   * Aluguél                       |" //
      @nLin,049 PSAY  "("+Transform(nAlg1IndVl ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nAlg2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nAlg3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nAlg4IndVl,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nAlg5IndVl,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nAlg6IndVl,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif         
      @nLin,000 PSAY "|   * Outros Custos Indústria       |" //
      @nLin,049 PSAY  "("+Transform(nODp1IndVl ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nODp2IndVl,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nODp3IndVl,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nODp4IndVl,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nODp5IndVl,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nODp6IndVl,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                                               
      @nLin,000 PSAY "|Despesas Fixas Desembol (Comercial)|" //
      @nLin,049 PSAY  "("+Transform(nDsbFx1Dsp ,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nDsbFx2Dsp,"@E 999,999,999.99")+")"
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nDsbFx3Dsp,"@E 999,999,999.99")+")"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nDsbFx4Dsp,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nDsbFx5Dsp,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nDsbFx6Dsp,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"                        
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                                               
      @nLin,000 PSAY "|Despesas Fixas Desembolsaveis(Adm) |" //
      @nLin,049 PSAY  "("+Transform(nDsbF1Ad ,"@E 999,999,999.99")+")" 
      @nLin,066 PSAY "|"
      @nLin,079 PSAY  "("+Transform(nDsbF2Ad,"@E 999,999,999.99")+")" 
      @nLin,096 PSAY "|"
      @nLin,110 PSAY  "("+Transform(nDsbF3Ad,"@E 999,999,999.99")+")" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY  "("+Transform(nDsbF4Ad,"@E 999,999,999.99")+")"  
      @nLin,164 PSAY "|"
      @nLin,178 PSAY  "("+Transform(nDsbF5Ad,"@E 999,999,999.99")+")"  
      @nLin,195 PSAY "|"
      @nLin,201 PSAY  "("+Transform(nDsbF6Ad,"@E 999,999,999.99")+")"  
      @nLin,219 PSAY "|"                        
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      @nLin,000 PSAY "|Despesas Financeiras               |"
      @nLin,049 PSAY "("+Transform(nDsp1Fin,"@E 999,999,999.99")+")"  
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nDsp2Fin,"@E 999,999,999.99")+")"  
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nDsp3Fin,"@E 999,999,999.99")+")"  
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nDsp4Fin,"@E 999,999,999.99")+")"  
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nDsp5Fin,"@E 999,999,999.99")+")"  
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nDsp6Fin,"@E 999,999,999.99")+")"  
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                                               
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif                                               
      //EBITDA =MARGEM DE CONTRIBUIÇÃO (-) CUSTOS E DESPESA FIXA DESEMBOLSÁVEL
      
      nEBT1DA := nMg1CtrbLC - nDsb1CusInd - nDsbF1Ad
      nEBT2DA := nMg2CtrbLC - nDsb2CusInd - nDsbF2Ad
      nEBT3DA := nMg3CtrbLC - nDsb3CusInd - nDsbF3Ad

      nEBT4DA := nMg4CtrbLC - nDsb4CusInd - nDsbF4Ad
      nEBT5DA := nMg5CtrbLC - nDsb5CusInd - nDsbF5Ad
      nEBT6DA := nMg6CtrbLC - nDsb6CusInd - nDsbF6Ad
      
      @nLin,000 PSAY "| EBITDA                            |"
      @nLin,051 PSAY nEBT1DA Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nEBT2DA Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nEBT3DA Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nEBT4DA Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nEBT5DA Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nEBT6DA Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      nDp1Amor := 0
      nDp2Amor := 0
      nDp3Amor := 0
      
      nDp4Amor := 0
      nDp5Amor := 0
      nDp6Amor := 0
      
      @nLin,000 PSAY "|(-)Depreciação e Amortização       |"
      @nLin,051 PSAY  nDp1Amor  Picture "@E 999,999,999.99"
      @nLin,066 PSAY "|"
      @nLin,081 PSAY  nDp2Amor Picture "@E 999,999,999.99"
      @nLin,096 PSAY "|"
      @nLin,112 PSAY  nDp3Amor Picture "@E 999,999,999.99"
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY  nDp4Amor Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY  nDp5Amor Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY  nDp6Amor Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"            
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //EBIT = EBITDA (-) DEPRECIAÇÃO E AMORTIZAÇÃO
      nEB1DA := nEBT1DA - nDp1Amor
      nEB2DA := nEBT2DA - nDp2Amor
      nEB3DA := nEBT3DA - nDp3Amor

      nEB4DA := nEBT4DA - nDp4Amor
      nEB5DA := nEBT5DA - nDp5Amor
      nEB6DA := nEBT6DA - nDp6Amor
      
      @nLin,000 PSAY "| EBIT(Lucro Operacional)           |"
      @nLin,051 PSAY nEB1DA Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nEB2DA Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nEB3DA Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nEB4DA Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nEB5DA Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nEB6DA Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      

      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //SE O "EBIT" DER POSITIVO INCLUIR ESTA FORMULA =((EBIT*15%)+(EBIT-20000)*10%)
      /*
      nIR1EBT := If(nEB1DA > 0,(nEB1DA * (15/100)),((nEB1DA-20000)*(10/100)))
      nIR2EBT := If(nEB2DA > 0,(nEB2DA * (15/100)),((nEB2DA-20000)*(10/100)))
      nIR3EBT := If(nEB3DA > 0,(nEB3DA * (15/100)),((nEB3DA-20000)*(10/100)))
      
      nIR4EBT := If(nEB4DA > 0,(nEB4DA * (15/100)),((nEB4DA-20000)*(10/100)))
      nIR5EBT := If(nEB5DA > 0,(nEB5DA * (15/100)),((nEB5DA-20000)*(10/100)))
      nIR6EBT := If(nEB6DA > 0,(nEB6DA * (15/100)),((nEB6DA-20000)*(10/100)))
      */

      nIR1EBT := If(nEB1DA > 0,(nEB1DA * (15/100)),0)
      nIR2EBT := If(nEB2DA > 0,(nEB2DA * (15/100)),0)
      nIR3EBT := If(nEB3DA > 0,(nEB3DA * (15/100)),0)
      
      nIR4EBT := If(nEB4DA > 0,(nEB4DA * (15/100)),0)
      nIR5EBT := If(nEB5DA > 0,(nEB5DA * (15/100)),0)
      nIR6EBT := If(nEB6DA > 0,(nEB6DA * (15/100)),0)
            
      @nLin,000 PSAY "| IR                                |"
      @nLin,049 PSAY "("+Transform(nIR1EBT,"@E 999,999,999.99")+")"
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nIR2EBT,"@E 999,999,999.99")+")" 
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nIR3EBT,"@E 999,999,999.99")+")" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nIR4EBT,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nIR5EBT,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nIR6EBT,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"      
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //SE O "EBIT" DER POSITIVO CALCULAR 9% (NOVE POR CENTO)
      nCSL1EBT := If(nEB1DA > 0,(nEB1DA * (9/100)),0)
      nCSL2EBT := If(nEB2DA > 0,(nEB2DA * (9/100)),0)
      nCSL3EBT := If(nEB3DA > 0,(nEB3DA * (9/100)),0)
      
      nCSL4EBT := If(nEB4DA > 0,(nEB4DA * (9/100)),0)
      nCSL5EBT := If(nEB5DA > 0,(nEB5DA * (9/100)),0)
      nCSL6EBT := If(nEB6DA > 0,(nEB6DA * (9/100)),0)
      
      @nLin,000 PSAY "| CSLL                              |"
      @nLin,049 PSAY "("+Transform(nCSL1EBT,"@E 999,999,999.99")+")" 
      @nLin,066 PSAY "|"
      @nLin,079 PSAY "("+Transform(nCSL2EBT,"@E 999,999,999.99")+")" 
      @nLin,096 PSAY "|"
      @nLin,110 PSAY "("+Transform(nCSL3EBT,"@E 999,999,999.99")+")" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,147 PSAY "("+Transform(nCSL4EBT,"@E 999,999,999.99")+")" 
      @nLin,164 PSAY "|"
      @nLin,178 PSAY "("+Transform(nCSL5EBT,"@E 999,999,999.99")+")" 
      @nLin,195 PSAY "|"
      @nLin,201 PSAY "("+Transform(nCSL6EBT,"@E 999,999,999.99")+")" 
      @nLin,219 PSAY "|"      
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      //NOPLAT = EBIT (-) IR E (-) CSLL
      nNO1PLAT := nEB1DA - nIR1EBT - nCSL1EBT
      nNO2PLAT := nEB2DA - nIR2EBT - nCSL2EBT
      nNO3PLAT := nEB3DA - nIR3EBT - nCSL3EBT
      
      nNO4PLAT := nEB3DA - nIR4EBT - nCSL4EBT
      nNO5PLAT := nEB5DA - nIR5EBT - nCSL5EBT
      nNO6PLAT := nEB6DA - nIR6EBT - nCSL6EBT
      
      @nLin,000 PSAY "| NOPLAT                            |"
      @nLin,051 PSAY nNO1PLAT Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nNO2PLAT Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nNO3PLAT Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nNO4PLAT Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nNO5PLAT Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nNO6PLAT Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|(+) Depreciação e Amortização      |"
      @nLin,051 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      

      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      

      nOcCndGer := 0
      nMdCndGer := 0
      For iMs := 1 To Len(aCFTList)
         If aCFTList[iMs,3] > 0
            cCndSel    := aCFTList[iMs,1]
            nQtdCnd    := aCFTList[iMs,9]
            aMedCond   := fPrzMedio(cCndSel)
            nCndQtdPc  := aMedCond[2]
            nCndPrzTot := aMedCond[1]            
            nMddaCond  := nQtdCnd * (nCndPrzTot / nCndQtdPc)
            
            nMdCndGer += nMddaCond 
            nOcCndGer += nQtdCnd

         EndIf
      Next iMs
      nCclo1DRec := ( nMdCndGer / nOcCndGer )

      nOcCndGer := 0
      nMdCndGer := 0
      For iMs := 1 To Len(aCFTList)
         If aCFTList[iMs,4] > 0
            cCndSel    := aCFTList[iMs,1]
            nQtdCnd    := aCFTList[iMs,9]
            aMedCond   := fPrzMedio(cCndSel)
            nCndQtdPc  := aMedCond[2]
            nCndPrzTot := aMedCond[1]            
            nMddaCond  := nQtdCnd * (nCndPrzTot / nCndQtdPc)
            
            nMdCndGer += nMddaCond 
            nOcCndGer += nQtdCnd

         EndIf
      Next iMs
      nCclo2DRec := ( nMdCndGer / nOcCndGer )

      nOcCndGer := 0
      nMdCndGer := 0
      For iMs := 1 To Len(aCFTList)
         If aCFTList[iMs,5] > 0
            cCndSel    := aCFTList[iMs,1]
            nQtdCnd    := aCFTList[iMs,9]
            aMedCond   := fPrzMedio(cCndSel)
            nCndQtdPc  := aMedCond[2]
            nCndPrzTot := aMedCond[1]            
            nMddaCond  := nQtdCnd * (nCndPrzTot / nCndQtdPc)
            
            nMdCndGer += nMddaCond 
            nOcCndGer += nQtdCnd

         EndIf
      Next iMs
      nCclo3DRec := ( nMdCndGer / nOcCndGer )

      nOcCndGer := 0
      nMdCndGer := 0
      For iMs := 1 To Len(aCFTList)
         If aCFTList[iMs,6] > 0
            cCndSel    := aCFTList[iMs,1]
            nQtdCnd    := aCFTList[iMs,9]
            aMedCond   := fPrzMedio(cCndSel)
            nCndQtdPc  := aMedCond[2]
            nCndPrzTot := aMedCond[1]            
            nMddaCond  := nQtdCnd * (nCndPrzTot / nCndQtdPc)
            
            nMdCndGer += nMddaCond 
            nOcCndGer += nQtdCnd

         EndIf
      Next iMs
      nCclo4DRec := ( nMdCndGer / nOcCndGer )
                        
      nOcCndGer := 0
      nMdCndGer := 0
      For iMs := 1 To Len(aCFTList)
         If aCFTList[iMs,7] > 0
            cCndSel    := aCFTList[iMs,1]
            nQtdCnd    := aCFTList[iMs,9]
            aMedCond   := fPrzMedio(cCndSel)
            nCndQtdPc  := aMedCond[2]
            nCndPrzTot := aMedCond[1]            
            nMddaCond  := nQtdCnd * (nCndPrzTot / nCndQtdPc)
            
            nMdCndGer += nMddaCond 
            nOcCndGer += nQtdCnd

         EndIf
      Next iMs
      nCclo5DRec := ( nMdCndGer / nOcCndGer )

      nOcCndGer := 0
      nMdCndGer := 0
      For iMs := 1 To Len(aCFTList)
         If aCFTList[iMs,8] > 0
            cCndSel    := aCFTList[iMs,1]
            nQtdCnd    := aCFTList[iMs,9]
            aMedCond   := fPrzMedio(cCndSel)
            nCndQtdPc  := aMedCond[2]
            nCndPrzTot := aMedCond[1]            
            nMddaCond  := nQtdCnd * (nCndPrzTot / nCndQtdPc)
            
            nMdCndGer += nMddaCond 
            nOcCndGer += nQtdCnd

         EndIf
      Next iMs
      nCclo6DRec := ( nMdCndGer / nOcCndGer )
            
      @nLin,000 PSAY "|Ciclo Financeiro(dias de receita)  |"
      @nLin,051 PSAY nCclo1DRec Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nCclo2DRec Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nCclo3DRec Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nCclo4DRec Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nCclo5DRec Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nCclo6DRec Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nRLM1Dia := nRc1LqDpIctv / 30
      nRLM2Dia := nRc2LqDpIctv / 30
      nRLM3Dia := nRc3LqDpIctv / 30
      
      nRLM4Dia := nRc4LqDpIctv / 30
      nRLM5Dia := nRc5LqDpIctv / 30
      nRLM6Dia := nRc6LqDpIctv / 30
      
      @nLin,000 PSAY "|Receita Líquida Média Dia          |"
      @nLin,051 PSAY nRLM1Dia Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nRLM2Dia Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nRLM3Dia Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nRLM4Dia Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nRLM5Dia Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nRLM6Dia Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      //Ciclo Financeiro * Receita Líquida
      //NCG - Necessidade de Capital de Giro
      nNCG1Mes := (nCclo1DRec * nRLM1Dia)
      nNCG2Mes := (nCclo2DRec * nRLM2Dia)
      nNCG3Mes := (nCclo3DRec * nRLM3Dia)
      nNCG4Mes := (nCclo4DRec * nRLM4Dia)
      nNCG5Mes := (nCclo5DRec * nRLM5Dia)
      nNCG6Mes := (nCclo6DRec * nRLM6Dia)
      
      @nLin,000 PSAY "|NCG                                |"
      @nLin,051 PSAY nNCG1Mes Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nNCG2Mes Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nNCG3Mes Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nNCG4Mes Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nNCG5Mes Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nNCG6Mes Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      

      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif     
      
      nDlta1NCG := nNCG1Mes
      nDlta2NCG := (nNCG2Mes - nNCG1Mes)
      nDlta3NCG := (nNCG3Mes - nNCG2Mes)
      
      nDlta4NCG := (nNCG4Mes - nNCG3Mes)
      nDlta5NCG := (nNCG5Mes - nNCG4Mes)
      nDlta6NCG := (nNCG6Mes - nNCG5Mes)
      
      @nLin,000 PSAY "|(-)/\NCG                            |"
      @nLin,051 PSAY nDlta1NCG Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nDlta2NCG Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nDlta3NCG Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nDlta4NCG Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nDlta5NCG Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nDlta6NCG Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      nFlxCx1Oper := (nNO1PLAT - nDlta1NCG) 
      nFlxCx2Oper := (nNO2PLAT - nDlta2NCG) 
      nFlxCx3Oper := (nNO3PLAT - nDlta3NCG) 
      
      nFlxCx4Oper := (nNO4PLAT - nDlta4NCG) 
      nFlxCx5Oper := (nNO5PLAT - nDlta5NCG) 
      nFlxCx6Oper := (nNO6PLAT - nDlta6NCG) 
      
      @nLin,000 PSAY "|FLUXO DE CAIXA OPERACIONAL         |"
      @nLin,051 PSAY nFlxCx1Oper Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nFlxCx2Oper Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nFlxCx3Oper Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nFlxCx4Oper Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nFlxCx5Oper Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nFlxCx6Oper Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      @nLin,000 PSAY "|(-) CAPEX(Investimentos)           |"
      @nLin,051 PSAY nCap1ex Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nCap2ex Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nCap3ex Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nCap4ex Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nCap5ex Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nCap6ex Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      
      //VALOR TERMINAL = NOPLAT (/) WACC
      
      nWA1CC     := 1
      nWA2CC     := 1
      nWA3CC     := 1
      
      nWA4CC     := 1
      nWA5CC     := 1
      nWA6CC     := 1

      nRes1Invst := (nNO1PLAT / nWA1CC) 
      nRes2Invst := (nNO2PLAT / nWA2CC) 
      nRes3Invst := (nNO3PLAT / nWA3CC) 
      
      nRes4Invst := (nNO4PLAT / nWA4CC) 
      nRes5Invst := (nNO5PLAT / nWA5CC) 
      nRes6Invst := (nNO6PLAT / nWA6CC) 
      
      @nLin,000 PSAY "|(+)Valor Residual do Investimento  |"
      @nLin,051 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY (0) Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"
      @nLin,219 PSAY "|"      
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif
      
      //FLUXO DE CAIXA = FLUXO OPERACIONAL + CAPEX + VALOR RESIDUAL
      nOpFl1xoLv := (nFlxCx1Oper + nCap1ex)
      nOpFl2xoLv := (nFlxCx2Oper + nCap2ex)
      nOpFl3xoLv := (nFlxCx3Oper + nCap3ex)
      
      nOpFl4xoLv := (nFlxCx4Oper + nCap4ex)
      nOpFl5xoLv := (nFlxCx5Oper + nCap5ex)
      nOpFl6xoLv := (nFlxCx6Oper + nCap6ex)
      
      @nLin,000 PSAY "|FLUXO DE CAIXA OPERACIONAL LIVRE   |"
      @nLin,051 PSAY nOpFl1xoLv Picture "@E 999,999,999.99" 
      @nLin,066 PSAY "|"
      @nLin,081 PSAY nOpFl2xoLv Picture "@E 999,999,999.99" 
      @nLin,096 PSAY "|"
      @nLin,112 PSAY nOpFl3xoLv Picture "@E 999,999,999.99" 
      @nLin,127 PSAY "|"
      @nLin,134 PSAY "|"
      @nLin,149 PSAY nOpFl4xoLv Picture "@E 999,999,999.99" 
      @nLin,164 PSAY "|"
      @nLin,180 PSAY nOpFl5xoLv Picture "@E 999,999,999.99" 
      @nLin,195 PSAY "|"
      @nLin,203 PSAY nOpFl6xoLv Picture "@E 999,999,999.99" 
      @nLin,219 PSAY "|"      
                                    
      nLin ++
      If nLin > nLRel //55 // Salto de Página. Neste caso o formulario tem 55 linhas...
         Cabec(Titulo,Cabec1,Cabec2,NomeProg,Tamanho,nTipo)
         nLin := 8
      Endif      
      @nLin,000 PSAY "|"+Replicate("=",218)+"|"
      
   EndIf
   
   nLin ++ // Avanca a linha de impressao

   //dbSkip() // Avanca o ponteiro do registro no arquivo
   lRoda := .F. //Força saída do Laço de Impressão.
   
EndDo

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Finaliza a execucao do relatorio...                                 ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

SET DEVICE TO SCREEN

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Se impressao em disco, chama o gerenciador de impressao...          ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

If aReturn[5]==1
   dbCommitAll()
   SET PRINTER TO
   OurSpool(wnrel)
Endif

MS_FLUSH()
Return


//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³                                     F U N Ç Õ E S   G E N É R I C A S                                                        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ


Static Function AjustaSx1

Local aArea := GetArea()

//PutSx1(cGrupo,cOrdem,cPergunt  ,"","",cVar    ,cTipo,nTamanho,nDecimal,nPresel,cGSC,cValid,cF3,cGrpSxg,"",cVar01    ,cDef01 ,"","",cCnt01,cDef02       ,"","",cDef03     ,"","",cDef04      ,"","",cDef05,"","",aHelpPor,"","",cHelp)
  PutSx1(cPerg ,"01","Data de ?" ,"","","mv_ch1","D"  ,8       ,0       ,0      ,"G" ,""    ,"" ,""     ,"","MV_PAR01",""     ,"","",""    ,""           ,"","",""         ,"","",""          ,"","","","","")
  PutSx1(cPerg ,"02","Data ate ?","","","mv_ch2","D"  ,8       ,0       ,0      ,"G" ,""    ,"" ,""     ,"","MV_PAR02",""     ,"","",""    ,""           ,"","",""         ,"","",""          ,"","","","","")
  PutSx1(cPerg ,"03","Custo ?"   ,"","","mv_ch3","C"  ,1       ,0       ,0      ,"C" ,""    ,"" ,""     ,"","MV_PAR03","Medio","","",""    ,"Reposicao"  ,"","","Calculado","","",""          ,"","","","","")
  PutSx1(cPerg ,"04","Analitico?","","","mv_ch4","C"  ,1       ,0       ,0      ,"C" ,""    ,"" ,""     ,"","MV_PAR04","Sim"  ,"","",""    ,"Nao"        ,"","",""         ,"","",""          ,"","","","","")
  PutSx1(cPerg ,"05","Depto.?"   ,"","","mv_ch5","C"  ,1       ,0       ,0      ,"C" ,""    ,"" ,""     ,"","MV_PAR05","Todos","","",""    ,"Faturamento","","","Industria","","","Financeiro","","","Gerencial","","")

RestArea(aArea)

Return(.T.)

Static Function fNomeMes(cMes)
   cNomeMes := ""
   If cMes == "01"
      cNomeMes := "JANEIRO"
   ElseIf cMes == "02"
      cNomeMes := "FEVEREIRO"
   ElseIf cMes == "03"
      cNomeMes := "MARÇO"
   ElseIf cMes == "04"
      cNomeMes := "ABRIL"
   ElseIf cMes == "05"
      cNomeMes := "MAIO"
   ElseIf cMes == "06"
      cNomeMes := "JUNHO"
   ElseIf cMes == "07"
      cNomeMes := "JULHO"
   ElseIf cMes == "08"
      cNomeMes := "AGOSTO"
   ElseIf cMes == "09"
      cNomeMes := "SETEMBBRO"
   ElseIf cMes == "10"
      cNomeMes := "OUTUBRO"
   ElseIf cMes == "11"
      cNomeMes := "NOVEMBRO"
   ElseIf cMes == "12"
      cNomeMes := "DEZEMBRO"
   EndIf
Return(cNomeMes)

Static Function RunSelRG

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Área de Instruções SQL - Querys.                                    ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

If lComercial .Or. lIndustria

   /**************
   * Calculando Clientes (Comercial)
   * Conceitos COMAFAL
   * Clientes Novos: São aqueles cujo a data de cadastro(A1_DTCAD-Customizado) refere-se ao mês analizado.
   * Clientes Ativos: São os clientes novos que nunca compraram, somados aos clientes que compraram nos últimos 
   *                  três(3) meses.
   * Clientes Inativos: São aqueles que não compraram nos últimos 3 meses.
   * Clientes Atendidos: São aqueles que compraram no mês analizado.
   ***************/
   
   ProcRegua(12) //6) 
   
   //For nMes := 1 To 6   // De 1 a 3(Clientes Novos) - De 4 a 6(Clientes Atendidos)
   For nMes := 1 To 12   // De 1 a 6(Clientes Novos) - De 7 a 12(Clientes Atendidos)
   //A partir do discutido durante a reunião do dia 08/04/2008 na COMAFAL/SP esses clientes,Clientes Novos,
   //terão novo conceito, serão os clientes, cuja primeira compra seja dento do mês em análise.
   //A decisão foi tomada pelo Sr. Gilmar Filho em conjunto com os presentes na reunião.

      
      IncProc("Calc. Clientes Novos/Atendidos, Processo "+Alltrim(Str(nMes))+" / 12 ")//9 ")
      
      If nMes <= 6 //3
         cQrySD2 := "SELECT COUNT(DISTINCT SA1.A1_COD+SA1.A1_LOJA) AS CLIENTES"
      ElseIf nMes >= 7 //4
         cQrySD2 := "SELECT COUNT(DISTINCT SD2.D2_CLIENTE+SD2.D2_LOJA) AS CLIENTES"
      EndIf
      
      If nMes <= 6 //3
         cQrySD2 += " FROM "+RetSQLName("SA1")+" SA1"
         cQrySD2 += " WHERE SA1.A1_FILIAL = '"+xFilial("SA1")+"'"
         If !lMitto
            cQrySD2 += "   AND SA1.A1_COD <> '006629'" //Five Solutions Consultoria - 04/11/2009
         EndIf
         //cQrySD2 += "   AND SA1.A1_FILIAL NOT IN "+FormatIn(cDelFil,",")
      Else
         cQrySD2 += " FROM "+RetSQLName("SD2")+" SD2"
         cQrySD2 += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
         If !lMitto
            cQrySD2 += "   AND SD2.D2_CLIENTE <> '006629'"
         EndIf
      EndIf
      
      /*Comentado para adotar o novo conceito, logo abaixo, adotado na reunião do dia 08/04/2008
      If nMes <= 3 
         If nMes == 1
            cQrySD2 += "   AND SUBSTRING(SA1.A1_DTCAD,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
         ElseIf nMes == 2
            cQrySD2 += "   AND SUBSTRING(SA1.A1_DTCAD,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
         ElseIf nMes == 3
            cQrySD2 += "   AND SUBSTRING(SA1.A1_DTCAD,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
         EndIf
      EndIf
      */
      If nMes <= 6 //3 
         If nMes == 1
            cQrySD2 += "   AND SUBSTRING(SA1.A1_PRICOM,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
         ElseIf nMes == 2
            cQrySD2 += "   AND SUBSTRING(SA1.A1_PRICOM,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
         ElseIf nMes == 3
            cQrySD2 += "   AND SUBSTRING(SA1.A1_PRICOM,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
         ElseIf nMes == 4
            cQrySD2 += "   AND SUBSTRING(SA1.A1_PRICOM,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
         ElseIf nMes == 5
            cQrySD2 += "   AND SUBSTRING(SA1.A1_PRICOM,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
         ElseIf nMes == 6
            cQrySD2 += "   AND SUBSTRING(SA1.A1_PRICOM,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
         EndIf
      EndIf      
      
      
      If nMes >= 7 //4
         If nMes == 7
            cQrySD2 += "   AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
         ElseIf nMes == 8
            cQrySD2 += "   AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
         ElseIf nMes == 9
            cQrySD2 += "   AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
         ElseIf nMes == 10
            cQrySD2 += "   AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
         ElseIf nMes == 11
            cQrySD2 += "   AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
         ElseIf nMes == 12
            cQrySD2 += "   AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
         EndIf
      EndIf
      
      
      If nMes <= 6 //3
         cQrySD2 += "   AND SA1.D_E_L_E_T_ <> '*'"
      Else
         //Filtra CFOPs de Vendas - Conforme Solicitação de Patrícia(Auditoria COMAFAL)
         cQrySD2 += "   AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
         cQrySD2 += "   AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
         
         cQrySD2 += "   AND SD2.D_E_L_E_T_ <> '*'"
      EndIf
      


         MemoWrite("C:\TEMP\CliNovos_Atendidos"+Alltrim(Str(nMes))+".SQL",cQrySD2)
      
      TCQuery cQrySD2 NEW ALIAS "TCLI"
   
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("TCLI")
            nCliN01Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 2
            DbSelectArea("TCLI")
            nCliN02Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 3
            DbSelectArea("TCLI")
            nCliN03Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 4
            DbSelectArea("TCLI")
            nCliN04Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 5
            DbSelectArea("TCLI")
            nCliN05Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 6
            DbSelectArea("TCLI")
            nCliN06Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf
                           
      //ElseIf nMes >= 4 .And. nMes <= 6
      ElseIf nMes >= 7 .And. nMes <= 12
         If nMes == 7
            DbSelectArea("TCLI")
            nClAtd1Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 8
            DbSelectArea("TCLI")
            nClAtd2Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf

         If nMes == 9
            DbSelectArea("TCLI")
            nClAtd3Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf   

         If nMes == 10
            DbSelectArea("TCLI")
            nClAtd4Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf   
         
         If nMes == 11
            DbSelectArea("TCLI")
            nClAtd5Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf   

         If nMes == 12
            DbSelectArea("TCLI")
            nClAtd6Mes := TCLI->CLIENTES
            DbCloseArea()
         EndIf   
                           
      EndIf

   Next nMes
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3 //Clientes Ativos
      
      IncProc("Calc. Clientes Ativos, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQrySA1 := "SELECT COUNT(*) AS CLIENTES"
      cQrySA1 += " FROM "+RetSQLName("SA1")+" SA1"
      cQrySA1 += " WHERE SA1.A1_FILIAL = '"+xFilial("SA1")+"'"
      //cQrySA1 += "   AND SA1.A1_FILIAL NOT IN "+FormatIn(cDelFil,",")
      If !lMitto
         cQrySA1 += "   AND SA1.A1_COD <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQrySA1 += " AND (SELECT COUNT(*)"
      cQrySA1 += "      FROM "+RetSQLName("SD2")+" SD2"
      cQrySA1 += "      WHERE "//Five Solutions 14/07/2008 - SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
      If nMes == 1
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dDataDe) - 90)+"' AND '"+DTOS(LastDay(dDataDe))+"'"
      ElseIf nMes == 2
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData02) - 90)+"' AND '"+DTOS(LastDay(dData02))+"'"
      ElseIf nMes == 3
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData03) - 90)+"' AND '"+DTOS(LastDay(dData03))+"'"
      ElseIf nMes == 4
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData04) - 90)+"' AND '"+DTOS(LastDay(dData04))+"'"
      ElseIf nMes == 5
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData05) - 90)+"' AND '"+DTOS(LastDay(dData05))+"'"
      ElseIf nMes == 6
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData06) - 90)+"' AND '"+DTOS(LastDay(dData06))+"'"
      EndIf
      //Filtra CFOPs de Vendas - Conforme Solicitação de Patrícia(Auditoria COMAFAL)
      cQrySA1 += "        AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQrySA1 += "        AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      cQrySA1 += "        AND SD2.D2_CLIENTE = SA1.A1_COD"
      cQrySA1 += "        AND SD2.D2_LOJA = SA1.A1_LOJA"
      cQrySA1 += "        AND SD2.D_E_L_E_T_ <> '*') > 0 "
      
      If nMes == 1
         cQrySA1 += "     AND SUBSTRING(SA1.A1_DTCAD,1,6) < '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQrySA1 += "     AND SUBSTRING(SA1.A1_DTCAD,1,6) < '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQrySA1 += "     AND SUBSTRING(SA1.A1_DTCAD,1,6) < '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQrySA1 += "     AND SUBSTRING(SA1.A1_DTCAD,1,6) < '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQrySA1 += "     AND SUBSTRING(SA1.A1_DTCAD,1,6) < '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQrySA1 += "     AND SUBSTRING(SA1.A1_DTCAD,1,6) < '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf

      
      cQrySA1 += " AND SA1.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\CliAtivos"+Alltrim(Str(nMes))+".SQL",cQrySA1)
      
      TCQuery cQrySA1 NEW ALIAS "TCLI"
      
         If nMes == 1
            DbSelectArea("TCLI")
            nClAtv1Mes := TCLI->CLIENTES
            //Acrescentando Clientes Novos aos Clientes Ativos
            //Ita - Comentado em decorrencia do novo conceito(08/04/08) - nClAtv1Mes += nCliN01Mes
            DbCloseArea()
         EndIf

         If nMes == 2
            DbSelectArea("TCLI")
            nClAtv2Mes := TCLI->CLIENTES
            //Acrescentando Clientes Novos aos Clientes Ativos
            //Ita - Comentado em decorrencia do novo conceito(08/04/08) - nClAtv2Mes += nCliN02Mes
            DbCloseArea()
         EndIf

         If nMes == 3
            DbSelectArea("TCLI")
            nClAtv3Mes := TCLI->CLIENTES
            //Acrescentando Clientes Novos aos Clientes Ativos
            //Ita - Comentado em decorrencia do novo conceito(08/04/08) - nClAtv3Mes += nCliN03Mes
            DbCloseArea()
         EndIf   

         If nMes == 4
            DbSelectArea("TCLI")
            nClAtv4Mes := TCLI->CLIENTES
            //Acrescentando Clientes Novos aos Clientes Ativos
            //Ita - Comentado em decorrencia do novo conceito(08/04/08) - nClAtv3Mes += nCliN03Mes
            DbCloseArea()
         EndIf   

         If nMes == 5
            DbSelectArea("TCLI")
            nClAtv5Mes := TCLI->CLIENTES
            //Acrescentando Clientes Novos aos Clientes Ativos
            //Ita - Comentado em decorrencia do novo conceito(08/04/08) - nClAtv3Mes += nCliN03Mes
            DbCloseArea()
         EndIf   

         If nMes == 6
            DbSelectArea("TCLI")
            nClAtv6Mes := TCLI->CLIENTES
            //Acrescentando Clientes Novos aos Clientes Ativos
            //Ita - Comentado em decorrencia do novo conceito(08/04/08) - nClAtv3Mes += nCliN03Mes
            DbCloseArea()
         EndIf                     
   Next nMes  

      ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3 //Clientes Ativos Sem Compras
   //A partir do discutido durante a reunião do dia 08/04/2008 na COMAFAL/SP esses clientes,Ativos Sem Compras,
   //serão denominados "Prospects" e terão uma linha exclusiva de apresentação de sua quantidade.
   //A decisão foi tomada pelo Sr. Gilmar Filho em conjunto com os presentes na reunião.
      
      //IncProc("Calc.Cli.Ativos s/Compras, Processo "+Alltrim(Str(nMes))+" / 3")
      IncProc("Calc. Prospects, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQrySA1 := "SELECT COUNT(*) AS CLIENTES"
      cQrySA1 += " FROM "+RetSQLName("SA1")+" SA1"
      cQrySA1 += " WHERE SA1.A1_FILIAL = '"+xFilial("SA1")+"'"
      //cQrySA1 += "   AND SA1.A1_FILIAL NOT IN "+FormatIn(cDelFil,",")
      If !lMitto
         cQrySA1 += "   AND SA1.A1_COD <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf

     
      If nMes == 1
         cQrySA1 += " AND SA1.A1_DTCAD BETWEEN '"+DTOS(LastDay(dDataDe) - 90)+"' AND '"+DTOS(LastDay(dDataDe))+"'"
      ElseIf nMes == 2
         cQrySA1 += " AND SA1.A1_DTCAD BETWEEN '"+DTOS(LastDay(dData02) - 90)+"' AND '"+DTOS(LastDay(dData02))+"'"
      ElseIf nMes == 3
         cQrySA1 += " AND SA1.A1_DTCAD BETWEEN '"+DTOS(LastDay(dData03) - 90)+"' AND '"+DTOS(LastDay(dData03))+"'"
      ElseIf nMes == 4
         cQrySA1 += " AND SA1.A1_DTCAD BETWEEN '"+DTOS(LastDay(dData04) - 90)+"' AND '"+DTOS(LastDay(dData04))+"'"
      ElseIf nMes == 5
         cQrySA1 += " AND SA1.A1_DTCAD BETWEEN '"+DTOS(LastDay(dData05) - 90)+"' AND '"+DTOS(LastDay(dData05))+"'"
      ElseIf nMes == 6
         cQrySA1 += " AND SA1.A1_DTCAD BETWEEN '"+DTOS(LastDay(dData06) - 90)+"' AND '"+DTOS(LastDay(dData06))+"'"
      EndIf      
      cQrySA1 += " AND SUBSTRING(SA1.A1_PRICOM,1,3) = '   ' AND SUBSTRING(SA1.A1_ULTCOM,1,3) = '   '" //Nunca Comprou (Teste para evitar considerar SD2)
      
      cQrySA1 += " AND SA1.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\CliASC"+Alltrim(Str(nMes))+".SQL",cQrySA1)
      
      TCQuery cQrySA1 NEW ALIAS "TCLI"
      
      If nMes == 1
         DbSelectArea("TCLI")
         nASC1Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf

      If nMes == 2
         DbSelectArea("TCLI")
         nASC2Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf

      If nMes == 3
         DbSelectArea("TCLI")
         nASC3Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   

      If nMes == 4
         DbSelectArea("TCLI")
         nASC4Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   

      If nMes == 5
         DbSelectArea("TCLI")
         nASC5Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   

      If nMes == 6
         DbSelectArea("TCLI")
         nASC6Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   
                  
   Next nMes  
   
   //Acrescentando Clientes Ativos Sem Compras aos Clientes Ativos
   //Ita - Comentado em decorrencia do novo conceito(08/04/08)
   //nClAtv1Mes += nASC1Mes
   //nClAtv2Mes += nASC2Mes
   //nClAtv3Mes += nASC3Mes

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3 //Clientes Inativos
      
      IncProc("Calc. Clientes Inativos, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQrySA1 := "SELECT COUNT(*) AS CLIENTES"
      cQrySA1 += " FROM "+RetSQLName("SA1")+" SA1"
      cQrySA1 += " WHERE SA1.A1_FILIAL = '"+xFilial("SA1")+"'"
      //cQrySA1 += "   AND SA1.A1_FILIAL NOT IN "+FormatIn(cDelFil,",")
      If !lMitto
         cQrySA1 += "   AND SA1.A1_COD <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQrySA1 += " AND (SELECT COUNT(*)"
      cQrySA1 += "      FROM "+RetSQLName("SD2")+" SD2"
      cQrySA1 += "      WHERE "//Five Solutions - 14/07/2008 - SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
      If nMes == 1
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dDataDe) - 90)+"' AND '"+DTOS(LastDay(dDataDe))+"'"
      ElseIf nMes == 2
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData02) - 90)+"' AND '"+DTOS(LastDay(dData02))+"'"
      ElseIf nMes == 3
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData03) - 90)+"' AND '"+DTOS(LastDay(dData03))+"'"
      ElseIf nMes == 4
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData04) - 90)+"' AND '"+DTOS(LastDay(dData04))+"'"
      ElseIf nMes == 5
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData05) - 90)+"' AND '"+DTOS(LastDay(dData05))+"'"
      ElseIf nMes == 6
         cQrySA1 += "     SD2.D2_EMISSAO BETWEEN '"+DTOS(LastDay(dData06) - 90)+"' AND '"+DTOS(LastDay(dData06))+"'"
      EndIf
      //Filtra CFOPs de Vendas - Conforme Solicitação de Patrícia(Auditoria COMAFAL)
      cQrySA1 += "        AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQrySA1 += "        AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      cQrySA1 += "        AND SD2.D2_CLIENTE = SA1.A1_COD"
      cQrySA1 += "        AND SD2.D2_LOJA = SA1.A1_LOJA"
      cQrySA1 += "        AND SD2.D_E_L_E_T_ <> '*') = 0 "
      
      If nMes == 1
         cQrySA1 += " AND SA1.A1_DTCAD < '"+DTOS(LastDay(dDataDe) - 90)+"'"
      ElseIf nMes == 2
         cQrySA1 += " AND SA1.A1_DTCAD < '"+DTOS(LastDay(dData02) - 90)+"'"
      ElseIf nMes == 3
         cQrySA1 += " AND SA1.A1_DTCAD < '"+DTOS(LastDay(dData03) - 90)+"'"
      ElseIf nMes == 4
         cQrySA1 += " AND SA1.A1_DTCAD < '"+DTOS(LastDay(dData04) - 90)+"'"
      ElseIf nMes == 5
         cQrySA1 += " AND SA1.A1_DTCAD < '"+DTOS(LastDay(dData05) - 90)+"'"
      ElseIf nMes == 6
         cQrySA1 += " AND SA1.A1_DTCAD < '"+DTOS(LastDay(dData06) - 90)+"'"
      EndIf
      
      cQrySA1 += " AND SA1.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\CliInativos"+Alltrim(Str(nMes))+".SQL",cQrySA1)
      
      TCQuery cQrySA1 NEW ALIAS "TCLI"
      
      If nMes == 1
         DbSelectArea("TCLI")
         nClIna1Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf

      If nMes == 2
         DbSelectArea("TCLI")
         nClIna2Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf

      If nMes == 3
         DbSelectArea("TCLI")
         nClIna3Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   

      If nMes == 4
         DbSelectArea("TCLI")
         nClIna4Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   

      If nMes == 5
         DbSelectArea("TCLI")
         nClIna5Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   

      If nMes == 6
         DbSelectArea("TCLI")
         nClIna6Mes := TCLI->CLIENTES
         DbCloseArea()
      EndIf   
                  
   Next nMes  

   /**************
   * Calculando Pedidos (Quantidade/Valor)
   ***************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Pedidos, Processo "+Alltrim(Str(nMes))+" / 6")
      
      //Pedidos Emitidos - Quantidade
      cQrySC5 := "SELECT COUNT(DISTINCT SC5.C5_NUM) AS PEDIDOS" 
      cQrySC5 += " FROM "+RetSQLName("SC5")+" SC5,"+RetSQLName("SC6")+" SC6"
      cQrySC5 += " WHERE SC5.C5_FILIAL = '"+xFilial("SC5")+"'"
      //cQrySC5 += "   AND SC5.C5_FILIAL NOT IN "+FormatIn(cDelFil,",")
      If !lMitto
         cQrySC5 += "   AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQrySC5 += " AND SC6.C6_FILIAL = '"+xFilial("SC6")+"'"
      //cQrySC5 += " AND SC5.C5_FILIAL = SC6.C6_FILIAL "
      cQrySC5 += " AND SC5.C5_NUM = SC6.C6_NUM"
      cQrySC5 += " AND SC6.C6_CF IN "+FormatIn(cCFOPVenda,",")
      If nMes == 1
         cQrySC5 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQrySC5 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQrySC5 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQrySC5 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQrySC5 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQrySC5 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQrySC5 += " AND SC5.D_E_L_E_T_ <> '*'"
      cQrySC5 += " AND SC6.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\PedEmitidos.SQL",cQrySC5)
      
      TCQuery cQrySC5 NEW ALIAS "TSC5"
      
      //Pedidos Emitidos - Valor
      cQrySC6 := "SELECT SUM(C6_VALOR) AS VLRPED" 
      cQrySC6 += " FROM "+RetSQLName("SC5")+" SC5,"+RetSQLName("SC6")+" SC6"
      cQrySC6 += " WHERE SC5.C5_FILIAL = '"+xFilial("SC5")+"'"
      //cQrySC6 += "   AND SC5.C5_FILIAL NOT IN "+FormatIn(cDelFil,",")
      If !lMitto
         cQrySC6 += "   AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQrySC6 += "   AND SC6.C6_FILIAL = '"+xFilial("SC6")+"'"
      //cQrySC6 += "   AND SC5.C5_FILIAL = SC6.C6_FILIAL "
      cQrySC6 += "   AND SC5.C5_NUM = SC6.C6_NUM"
      cQrySC6 += "   AND SC6.C6_CF IN "+FormatIn(cCFOPVenda,",")
      If nMes == 1
         cQrySC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQrySC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQrySC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQrySC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQrySC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQrySC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQrySC6 += " AND SC5.D_E_L_E_T_ <> '*'"
      cQrySC6 += " AND SC6.D_E_L_E_T_ <> '*'"
      
      TCQuery cQrySC6 NEW ALIAS "TSC6"

      //Pedidos Faturados(Mês) - Quantidade 
      cQuery := "SELECT SUBSTRING(SD2.D2_EMISSAO,1,6),COUNT(DISTINCT D2_PEDIDO) AS PEDFAT FROM " 
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2,"+RetSQLName("SC5")+" SC5"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"'  AND  SD2.D_E_L_E_T_ = ' ' " // = '"+xFilial("SD2")+"'
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SC5.C5_FILIAL = '"+xFilial("SC5")+"' AND  SC5.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      //cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas - 20/0702009 - Alterado Grupo de Sucata de 80 p/ 40
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      cQuery += " AND SD2.D2_PEDIDO = SC5.C5_NUM"
      
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      
      MemoWrite("C:\TEMP\PedFaturaMesQtd.SQL",cQrySD2)
      
      TCQuery cQuery NEW ALIAS "TSD2"
      
      //Pedidos Faturados(Mês) - Valor
      cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO,SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS VLRFATPED,SUM(D2_QUANT) AS QTDFATPED FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2,"+RetSQLName("SC5")+" SC5"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SC5.C5_FILIAL = '"+xFilial("SC5")+"' AND  SC5.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      
      //cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas - Ret.Cometário Patrícia 22/07/09
      
      
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      cQuery += " AND SD2.D2_PEDIDO = SC5.C5_NUM"
      
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6) ASC"
      
      MemoWrite("C:\TEMP\PedFaturaMesVlr"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "T2SD2"
      
      //Pedidos Pendentes(Mês) - Quantidade 
      cQry2SC6 := "SELECT COUNT(DISTINCT SC6.C6_NUM) AS PEDPEND" 
      cQry2SC6 += " FROM "+RetSQLName("SC5")+" SC5,"+RetSQLName("SC6")+" SC6"
      cQry2SC6 += " WHERE SC5.C5_FILIAL = '"+xFilial("SC5")+"'"
      cQry2SC6 += "   AND SC6.C6_FILIAL = '"+xFilial("SC6")+"'"
      If !lMitto
         cQry2SC6 += "   AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQry2SC6 += "   AND SC5.C5_NUM = SC6.C6_NUM"
      cQry2SC6 += "   AND SC6.C6_CF IN "+FormatIn(cCFOPVenda,",")
      cQry2SC6 += "   AND (SUBSTRING(SC6.C6_NOTA,1,3) = '   ' OR (SUBSTRING(SC6.C6_NOTA,1,3) <> '   ' AND (SELECT SUBSTRING(SF2.F2_EMISSAO,1,6)"
      cQry2SC6 += "                                                                                         FROM "+RetSQLName("SF2")+" SF2"
      cQry2SC6 += "                                                                                        WHERE SF2.F2_FILIAL = '"+xFilial("SF2")+"'"
      cQry2SC6 += "                                                                                          AND SF2.F2_DOC = SC6.C6_NOTA"
      cQry2SC6 += "                                                                                          AND SF2.F2_SERIE = SC6.C6_SERIE"
      If nMes == 1
         cQry2SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dDataDe),1,6)+"'))"
         cQry2SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQry2SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData02),1,6)+"'))" 
         cQry2SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQry2SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData03),1,6)+"'))"  
         cQry2SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQry2SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData04),1,6)+"'))"  
         cQry2SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQry2SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData05),1,6)+"'))"  
         cQry2SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQry2SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData06),1,6)+"'))"  
         cQry2SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQry2SC6 += " AND SC5.D_E_L_E_T_ <> '*'"
      cQry2SC6 += " AND SC6.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\PedPenQtd.SQL",cQry2SC6)
      
      TCQuery cQry2SC6 NEW ALIAS "T2SC6"

      //Pedidos Pendentes(Mês) - Valor 
      cQry3SC6 := "SELECT SUM(SC6.C6_VALOR) AS VLRPEDPEND" 
      cQry3SC6 += " FROM "+RetSQLName("SC5")+" SC5,"+RetSQLName("SC6")+" SC6"
      cQry3SC6 += " WHERE SC5.C5_FILIAL = '"+xFilial("SC5")+"'"
      cQry3SC6 += "   AND SC6.C6_FILIAL = '"+xFilial("SC6")+"'"
      If !lMitto
         cQry2SC6 += "   AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQry3SC6 += "   AND SC5.C5_NUM = SC6.C6_NUM"
      cQry3SC6 += "   AND SC6.C6_CF IN "+FormatIn(cCFOPVenda,",")
      cQry3SC6 += "   AND (SUBSTRING(SC6.C6_NOTA,1,3) = '   ' OR (SUBSTRING(SC6.C6_NOTA,1,3) <> '   ' AND (SELECT SUBSTRING(SF2.F2_EMISSAO,1,6)"
      cQry3SC6 += "                                                                                         FROM "+RetSQLName("SF2")+" SF2"
      cQry3SC6 += "                                                                                        WHERE SF2.F2_FILIAL = '"+xFilial("SF2")+"'"
      cQry3SC6 += "                                                                                          AND SF2.F2_DOC = SC6.C6_NOTA"
      cQry3SC6 += "                                                                                          AND SF2.F2_SERIE = SC6.C6_SERIE"
      If nMes == 1
         cQry3SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dDataDe),1,6)+"'))" 
         cQry3SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQry3SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData02),1,6)+"'))"  
         cQry3SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQry3SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData03),1,6)+"'))"    
         cQry3SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQry3SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData04),1,6)+"'))"    
         cQry3SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQry3SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData05),1,6)+"'))"    
         cQry3SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQry3SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData06),1,6)+"'))"    
         cQry3SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQry3SC6 += " AND SC5.D_E_L_E_T_ <> '*'"
      cQry3SC6 += " AND SC6.D_E_L_E_T_ <> '*'"
      
      TCQuery cQry3SC6 NEW ALIAS "T3SC6"


      //Pedidos Faturados - Quantidade(Meses Anteriores)
      cQuery := "SELECT  SUBSTRING(SD2.D2_EMISSAO,1,6),COUNT(DISTINCT D2_PEDIDO) AS PEDMAFAT FROM " 
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2,"+RetSQLName("SC5")+" SC5"
      cQuery += " WHERE SD2.D2_FILIAL  = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL  = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL  = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SC5.C5_FILIAL  = '"+xFilial("SC5")+"' AND  SC5.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      //cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      cQuery += " AND SD2.D2_PEDIDO = SC5.C5_NUM"
      
      
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      
      MemoWrite("C:\TEMP\PedFatQtdMesAnt"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "TXSD2"
      
      //Pedidos Faturados - Valor(Meses Anteriores)
      cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO,SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS VLRMAFATPED,SUM(D2_QUANT) AS QTDMAFTPED FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2,"+RetSQLName("SC5")+" SC5"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL  = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL  = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SC5.C5_FILIAL = '"+xFilial("SC5")+"' AND  SC5.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      
      //cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas - Ret. Comentário - Patrícia 22/07/09
      
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      cQuery += " AND SD2.D2_PEDIDO = SC5.C5_NUM"
      
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         cQuery += " AND  SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6) ASC"
      
      MemoWrite("C:\TEMP\PedFaturaMesAntVlr"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "T4SD2"

      //Pedidos Pendentes - Quantidade(Meses Anteriores) 
      cQry4SC6 := "SELECT COUNT(DISTINCT SC6.C6_NUM) AS PEDMAPEND" 
      cQry4SC6 += " FROM "+RetSQLName("SC5")+" SC5,"+RetSQLName("SC6")+" SC6"
      cQry4SC6 += " WHERE SC5.C5_FILIAL = '"+xFilial("SC5")+"'"
      cQry4SC6 += "   AND SC6.C6_FILIAL = '"+xFilial("SC6")+"'"
      If !lMitto
         cQry4SC6 += "   AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQry4SC6 += "   AND SC5.C5_NUM = SC6.C6_NUM"
      cQry4SC6 += "   AND SC6.C6_CF IN "+FormatIn(cCFOPVenda,",")
      cQry4SC6 += "   AND SUBSTRING(SC5.C5_NOTA,1,3) <> 'XXX'" 
      //Ita - 03/03/2008 - Novo Conceito p/Calcular Quantidade dos Pedidos Pendentes
      //cQry4SC6 += "   AND SUBSTRING(SC6.C6_NOTA,1,3) = '   '"
      cQry4SC6 += "   AND (SUBSTRING(SC6.C6_NOTA,1,3) = '   ' OR (SUBSTRING(SC6.C6_NOTA,1,3) <> '   ' AND SUBSTRING(SC6.C6_NOTA,1,3) <> 'XXX' AND (SELECT SUBSTRING(SF2.F2_EMISSAO,1,6)"
      cQry4SC6 += "                                                                                         FROM "+RetSQLName("SF2")+" SF2"
      cQry4SC6 += "                                                                                        WHERE SF2.F2_FILIAL = '"+xFilial("SF2")+"'"
      cQry4SC6 += "                                                                                          AND SF2.F2_DOC = SC6.C6_NOTA"
      cQry4SC6 += "                                                                                          AND SF2.F2_SERIE = SC6.C6_SERIE"
      If nMes == 1
         cQry4SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dDataDe),1,6)+"'))"  
         cQry4SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQry4SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData02),1,6)+"'))"   
         cQry4SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQry4SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData03),1,6)+"'))"    
         cQry4SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQry4SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData04),1,6)+"'))"    
         cQry4SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQry4SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData05),1,6)+"'))"    
         cQry4SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQry4SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData06),1,6)+"'))"    
         cQry4SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQry4SC6 += " AND SC5.D_E_L_E_T_ <> '*'"
      cQry4SC6 += " AND SC6.D_E_L_E_T_ <> '*'"
      
      TCQuery cQry4SC6 NEW ALIAS "T4SC6"

      //Pedidos Pendentes - Valor(Meses Anteriores) 
      cQry5SC6 := "SELECT SUM(SC6.C6_VALOR) AS VLRPMAPEND" 
      cQry5SC6 += " FROM "+RetSQLName("SC5")+" SC5,"+RetSQLName("SC6")+" SC6"
      cQry5SC6 += " WHERE SC5.C5_FILIAL  = '"+xFilial("SC5")+"'"
      cQry5SC6 += "   AND SC6.C6_FILIAL = '"+xFilial("SC6")+"'"
      If !lMitto
         cQry5SC6 += "   AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQry5SC6 += "   AND SC5.C5_NUM = SC6.C6_NUM"
      cQry5SC6 += "   AND SC6.C6_CF IN "+FormatIn(cCFOPVenda,",")
      cQry5SC6 += "   AND SUBSTRING(SC5.C5_NOTA,1,3) <> 'XXX'" 
      
      //Ita - 03/03/2008 - Novo Conceito p/Calcular Valor dos Pedidos Pendentes
      //cQry5SC6 += "   AND SUBSTRING(SC6.C6_NOTA,1,3) = '   '"
      cQry5SC6 += "   AND (SUBSTRING(SC6.C6_NOTA,1,3) = '   ' OR (SUBSTRING(SC6.C6_NOTA,1,3) <> '   ' AND SUBSTRING(SC6.C6_NOTA,1,3) <> 'XXX' AND (SELECT SUBSTRING(SF2.F2_EMISSAO,1,6)"
      cQry5SC6 += "                                                                                         FROM "+RetSQLName("SF2")+" SF2"
      cQry5SC6 += "                                                                                        WHERE SF2.F2_FILIAL = '"+xFilial("SF2")+"'"
      cQry5SC6 += "                                                                                          AND SF2.F2_DOC = SC6.C6_NOTA"
      cQry5SC6 += "                                                                                          AND SF2.F2_SERIE = SC6.C6_SERIE"
      If nMes == 1
         cQry5SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dDataDe),1,6)+"'))" 
         cQry5SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQry5SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData02),1,6)+"'))"    
         cQry5SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQry5SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData03),1,6)+"'))"     
         cQry5SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQry5SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData04),1,6)+"'))"     
         cQry5SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQry5SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData05),1,6)+"'))"     
         cQry5SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQry5SC6 += "                                                                                          AND SF2.D_E_L_E_T_ <> '*') > '"+Substr(DTOS(dData06),1,6)+"'))"     
         cQry5SC6 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) < '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      
      cQry5SC6 += " AND SC5.D_E_L_E_T_ <> '*'"
      cQry5SC6 += " AND SC6.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\PedPenMesesAnt"+Alltrim(Str(nMes))+".SQL",cQry5SC6)
      
      TCQuery cQry5SC6 NEW ALIAS "T5SC6"

      If nMes == 1
         DbSelectArea("TSC5")
         nPed1MesQt := TSC5->PEDIDOS
         DbCloseArea()
         DbSelectArea("TSC6")
         nPed1VlMes := TSC6->VLRPED
         DbCloseArea()
         DbSelectArea("TSD2")
         nFatPd1QtMes := TSD2->PEDFAT //Pedidos Faturados - Quantidade
         DbCloseArea()
         DbSelectArea("T2SD2") //Pedidos Faturados - Valor
         nFtPd1VlrMes := T2SD2->VLRFATPED
         nQtTon1MVen  := T2SD2->QTDFATPED
         DbCloseArea()
         DbSelectArea("T2SC6")
         nPdPen1QtMes := T2SC6->PEDPEND //Pedidos Pendentes - Quantidade
         DbCloseArea()
         DbSelectArea("T3SC6")
         nPdPen1VlrM := T3SC6->VLRPEDPEND //Pedidos Pendentes - Valor
         DbCloseArea()
         DbSelectArea("TXSD2")
         nFtMAPd1Qt := TXSD2->PEDMAFAT //Pedidos Faturados - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T4SD2")
         nFtPd1MAVl := T4SD2->VLRMAFATPED //Pedidos Faturados - Valor(Meses Anteriores)
         nQtTon1MAPd:= T4SD2->QTDMAFTPED
         DbCloseArea()
         DbSelectArea("T4SC6")
         nPdPen1MAQt := T4SC6->PEDMAPEND //Pedidos Pendentes - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T5SC6")
         nPdPMA1VlM := T5SC6->VLRPMAPEND //Pedidos Pendentes - Valor(Meses Anteriores)
         DbCloseArea()
      EndIf

      If nMes == 2
         DbSelectArea("TSC5")
         nPed2MesQt := TSC5->PEDIDOS
         DbCloseArea()
         DbSelectArea("TSC6")
         nPed2VlMes := TSC6->VLRPED
         DbCloseArea()
         DbSelectArea("TSD2")
         nFatPd2QtMes := TSD2->PEDFAT
         DbCloseArea()
         DbSelectArea("T2SD2")
         nFtPd2VlrMes := T2SD2->VLRFATPED
         nQtTon2MVen  := T2SD2->QTDFATPED
         DbCloseArea()
         DbSelectArea("T2SC6")
         nPdPen2QtMes := T2SC6->PEDPEND
         DbCloseArea()
         DbSelectArea("T3SC6")
         nPdPen2VlrM := T3SC6->VLRPEDPEND
         DbCloseArea()
         DbSelectArea("TXSD2")
         nFtMAPd2Qt := TXSD2->PEDMAFAT //Pedidos Faturados - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T4SD2")
         nFtPd2MAVl := T4SD2->VLRMAFATPED
         nQtTon2MAPd:= T4SD2->QTDMAFTPED
         DbCloseArea()
         DbSelectArea("T4SC6")
         nPdPen2MAQt := T4SC6->PEDMAPEND
         DbCloseArea()
         DbSelectArea("T5SC6")
         nPdPMA2VlM := T5SC6->VLRPMAPEND
         DbCloseArea()
      EndIf

      If nMes == 3
         DbSelectArea("TSC5")
         nPed3MesQt := TSC5->PEDIDOS
         DbCloseArea()
         DbSelectArea("TSC6")
         nPed3VlMes := TSC6->VLRPED
         DbCloseArea()
         DbSelectArea("TSD2")
         nFatPd3QtMes := TSD2->PEDFAT
         DbCloseArea()
         DbSelectArea("T2SD2")
         nFtPd3VlrMes := T2SD2->VLRFATPED
         nQtTon3MVen  := T2SD2->QTDFATPED
         DbCloseArea()
         DbSelectArea("T2SC6")
         nPdPen3QtMes := T2SC6->PEDPEND
         DbCloseArea()
         DbSelectArea("T3SC6")
         nPdPen3VlrM := T3SC6->VLRPEDPEND
         DbCloseArea()
         DbSelectArea("TXSD2")
         nFtMAPd3Qt := TXSD2->PEDMAFAT //Pedidos Faturados - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T4SD2")
         nFtPd3MAVl := T4SD2->VLRMAFATPED
         nQtTon3MAPd:= T4SD2->QTDMAFTPED
         DbCloseArea()
         DbSelectArea("T4SC6")
         nPdPen3MAQt := T4SC6->PEDMAPEND
         DbCloseArea()
         DbSelectArea("T5SC6")
         nPdPMA3VlM := T5SC6->VLRPMAPEND
         DbCloseArea()
      EndIf   

      If nMes == 4
         DbSelectArea("TSC5")
         nPed4MesQt := TSC5->PEDIDOS
         DbCloseArea()
         DbSelectArea("TSC6")
         nPed4VlMes := TSC6->VLRPED
         DbCloseArea()
         DbSelectArea("TSD2")
         nFatPd4QtMes := TSD2->PEDFAT
         DbCloseArea()
         DbSelectArea("T2SD2")
         nFtPd4VlrMes := T2SD2->VLRFATPED
         nQtTon4MVen  := T2SD2->QTDFATPED
         DbCloseArea()
         DbSelectArea("T2SC6")
         nPdPen4QtMes := T2SC6->PEDPEND
         DbCloseArea()
         DbSelectArea("T3SC6")
         nPdPen4VlrM := T3SC6->VLRPEDPEND
         DbCloseArea()
         DbSelectArea("TXSD2")
         nFtMAPd4Qt := TXSD2->PEDMAFAT //Pedidos Faturados - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T4SD2")
         nFtPd4MAVl := T4SD2->VLRMAFATPED
         nQtTon4MAPd:= T4SD2->QTDMAFTPED
         DbCloseArea()
         DbSelectArea("T4SC6")
         nPdPen4MAQt := T4SC6->PEDMAPEND
         DbCloseArea()
         DbSelectArea("T5SC6")
         nPdPMA4VlM := T5SC6->VLRPMAPEND
         DbCloseArea()
      EndIf   

      If nMes == 5
         DbSelectArea("TSC5")
         nPed5MesQt := TSC5->PEDIDOS
         DbCloseArea()
         DbSelectArea("TSC6")
         nPed5VlMes := TSC6->VLRPED
         DbCloseArea()
         DbSelectArea("TSD2")
         nFatPd5QtMes := TSD2->PEDFAT
         DbCloseArea()
         DbSelectArea("T2SD2")
         nFtPd5VlrMes := T2SD2->VLRFATPED
         nQtTon5MVen  := T2SD2->QTDFATPED
         DbCloseArea()
         DbSelectArea("T2SC6")
         nPdPen5QtMes := T2SC6->PEDPEND
         DbCloseArea()
         DbSelectArea("T3SC6")
         nPdPen5VlrM := T3SC6->VLRPEDPEND
         DbCloseArea()
         DbSelectArea("TXSD2")
         nFtMAPd5Qt := TXSD2->PEDMAFAT //Pedidos Faturados - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T4SD2")
         nFtPd5MAVl := T4SD2->VLRMAFATPED
         nQtTon5MAPd:= T4SD2->QTDMAFTPED
         DbCloseArea()
         DbSelectArea("T4SC6")
         nPdPen5MAQt := T4SC6->PEDMAPEND
         DbCloseArea()
         DbSelectArea("T5SC6")
         nPdPMA5VlM := T5SC6->VLRPMAPEND
         DbCloseArea()
      EndIf   

      If nMes == 6
         DbSelectArea("TSC5")
         nPed6MesQt := TSC5->PEDIDOS
         DbCloseArea()
         DbSelectArea("TSC6")
         nPed6VlMes := TSC6->VLRPED
         DbCloseArea()
         DbSelectArea("TSD2")
         nFatPd6QtMes := TSD2->PEDFAT
         DbCloseArea()
         DbSelectArea("T2SD2")
         nFtPd6VlrMes := T2SD2->VLRFATPED
         nQtTon6MVen  := T2SD2->QTDFATPED
         DbCloseArea()
         DbSelectArea("T2SC6")
         nPdPen6QtMes := T2SC6->PEDPEND
         DbCloseArea()
         DbSelectArea("T3SC6")
         nPdPen6VlrM := T3SC6->VLRPEDPEND
         DbCloseArea()
         DbSelectArea("TXSD2")
         nFtMAPd6Qt := TXSD2->PEDMAFAT //Pedidos Faturados - Quantidade(Meses Anteriores)
         DbCloseArea()
         DbSelectArea("T4SD2")
         nFtPd6MAVl := T4SD2->VLRMAFATPED
         nQtTon6MAPd:= T4SD2->QTDMAFTPED
         DbCloseArea()
         DbSelectArea("T4SC6")
         nPdPen6MAQt := T4SC6->PEDMAPEND
         DbCloseArea()
         DbSelectArea("T5SC6")
         nPdPMA6VlM := T5SC6->VLRPMAPEND
         DbCloseArea()
      EndIf   
                     
   Next nMes
   
   /********************************
   * FATURAMENTO BRUTO
   *********************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Faturamento Bruto, Processo "+Alltrim(Str(nMes))+" / 6")

      cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO,SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS TVALBRUTO,SUM(D2_X_CST2) AS CUSTOMP FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
     
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
         
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6) ASC"
            
      MemoWrite("C:\TEMP\FatBrutTot"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "CFT1"
      
      If nMes == 1
         DbSelectArea("CFT1")
            nFat1MesBru := CFT1->TVALBRUTO
            nCus1MesFat := CFT1->CUSTOMP
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("CFT1")
            nFat2MesBru := CFT1->TVALBRUTO
            nCus2MesFat := CFT1->CUSTOMP
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("CFT1")
            nFat3MesBru := CFT1->TVALBRUTO
            nCus3MesFat := CFT1->CUSTOMP
         DbCloseArea()
         
      ElseIf nMes == 4
         DbSelectArea("CFT1")
            nFat4MesBru := CFT1->TVALBRUTO
            nCus4MesFat := CFT1->CUSTOMP
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("CFT1")
            nFat5MesBru := CFT1->TVALBRUTO
            nCus5MesFat := CFT1->CUSTOMP
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("CFT1")
            nFat6MesBru := CFT1->TVALBRUTO
            nCus6MesFat := CFT1->CUSTOMP
         DbCloseArea()
         
      EndIf
      
   Next nMes
   
   aCFTList := {}
   
   //Aadd(aCFTList, {CFT->F2_COND,"X",IIF(nMes==1,CFT->VALBRUTO,0),IIF(nMes==2,CFT->VALBRUTO,0),IIF(nMes==3,CFT->VALBRUTO,0),IIF(nMes==4,CFT->VALBRUTO,0),IIF(nMes==5,CFT->VALBRUTO,0),IIF(nMes==6,CFT->VALBRUTO,0)})
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3  //Faturamento Bruto por Condição de Faturamento(Pagamento)
      
      IncProc("Calc. Fat.Bruto p/Cond.Pg, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      //Exemlo do Faturamento Bruto - cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO,SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS TVALBRUTO,SUM(D2_X_CST2) AS CUSTOMP FROM "
      //Faturamento po Condição, Antes - cQuery := " SELECT SF2.F2_COND, SUM(SD2.D2_TOTAL+SD2.D2_VALIPI+SD2.D2_ICMSRET+SD2.D2_VALFRE+SD2.D2_SEGURO+SD2.D2_DESPESA) AS VALBRUTO FROM "
      cQuery := " SELECT SF2.F2_COND, SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS VALBRUTO,COUNT(*) nOCORCP FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         
      EndIf
            
      cQuery += " GROUP BY SF2.F2_COND"
      cQuery += " ORDER BY SF2.F2_COND ASC"
            
      MemoWrite("C:\TEMP\FatBrutCndPg"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "CFT"
      
      If nMes == 1
         TCSetField("CFT","VALBRUTO","N",14,02)
         TCSetField("CFT","nOCORCP","N",10,00)
      EndIf
      
      DbSelectArea("CFT")
      While !Eof()
         nPos := aScan(aCFTList, {|x| x[1] == CFT->F2_COND})
         If nPos == 0
            Aadd(aCFTList, {CFT->F2_COND,"X",IIF(nMes==1,CFT->VALBRUTO,0),IIF(nMes==2,CFT->VALBRUTO,0),IIF(nMes==3,CFT->VALBRUTO,0),IIF(nMes==4,CFT->VALBRUTO,0),IIF(nMes==5,CFT->VALBRUTO,0),IIF(nMes==6,CFT->VALBRUTO,0),CFT->nOCORCP})
         Else
            aCFTList[nPos,(nMes+2)] := CFT->VALBRUTO
         EndIf
         DbSelectArea("CFT")
         DbSkip()
      EndDo
      DbSelectArea("CFT")
      DbCloseArea()
      
   Next nMes
   
   //Acrescenta demais Condições de Pagamentos que ainda não foram utilizadas nas vendas - Especifico Rel.por Competencia
   cQrySE4 := " SELECT E4_CODIGO "
   cQrySE4 += "   FROM "+RetSQLName("SE4")
   cQrySE4 += "  WHERE E4_FILIAL = '"+xFilial("SE4")+"'"
   cQrySE4 += "    AND SUBSTRING(E4_CODIGO,1,1) = 'V'"
   cQrySE4 += "    AND D_E_L_E_T_ <> '*'"
   
   MemoWrite("CondicoesdeVendas.SQL",cQrySE4)
   MemoWrite("C:\TEMP\CondicoesdeVendas.SQL",cQrySE4)
   TCQuery cQrySE4 NEW ALIAS "TMSE4"
   DbSelectArea("TMSE4")
   While TMSE4->(!Eof())
      If aScan(aCFTList,{|x| x[1] == TMSE4->E4_CODIGO}) == 0
         Aadd(aCFTList, {TMSE4->E4_CODIGO,"X",0,0,0,0,0,0,0})
      EndIf
      DbSelectArea("TMSE4")
      DbSkip()
   EndDo
   DbSelectArea("TMSE4")
   DbCloseArea()

   /**************************
   * 
   *         Novo 2009
   * Faturamento Bruto por Matéria Prima
   *
   **************************************/
   ProcRegua(6) //3)
   aFatp1MP := {}
   aFatp2MP := {}
   aFatp3MP := {}
   
   aFatp4MP := {}
   aFatp5MP := {}
   aFatp6MP := {}   
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Faturamento Bruto p/Mat.Prima, Processo "+Alltrim(Str(nMes))+" / 6")

      cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO,SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP,SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS TVALBRUTO,SUM(D2_QUANT) QTDFAT,SUM(D2_X_CST2) AS CUSTOMP FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
     
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
         
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6) ASC"
            
      MemoWrite("C:\TEMP\FatBrutTot_MatPrima"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "CFT1"
      
      If nMes == 1
         DbSelectArea("CFT1")
         While !Eof()   
            nFat1MPBru := CFT1->TVALBRUTO
            nCus1MPFat := CFT1->CUSTOMP
            nQtd1FatMP  := CFT1->QTDFAT
            If aScan(aFatp1MP,{|x| x[1] == CFT1->GRUPOMP}) == 0
               cGrpMP := CFT1->GRUPOMP
               aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,1)
            EndIf
            DbSelectArea("CFT1")
            DbSkip()
         EndDo
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("CFT1")
         While !Eof()
            nFat2MPBru := CFT1->TVALBRUTO
            nCus2MPFat := CFT1->CUSTOMP
            nQtd2FatMP  := CFT1->QTDFAT
            cGrpMP := CFT1->GRUPOMP
            If aScan(aFatp2MP,{|x| x[1] == CFT1->GRUPOMP}) == 0
               aAdd(aFatp2MP,{CFT1->GRUPOMP,nFat2MPBru,nQtd2FatMP,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,1)
            EndIf
            DbSelectArea("CFT1")
            DbSkip()
         EndDo
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("CFT1")
         While !Eof()
            nFat3MPBru := CFT1->TVALBRUTO
            nCus3MPFat := CFT1->CUSTOMP
            nQtd3FatMP  := CFT1->QTDFAT
            cGrpMP := CFT1->GRUPOMP
            If aScan(aFatp3MP,{|x| x[1] == CFT1->GRUPOMP}) == 0
               aAdd(aFatp3MP,{CFT1->GRUPOMP,nFat3MPBru,nQtd3FatMP,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,1)
            EndIf
            DbSelectArea("CFT1")
            DbSkip()
         EndDo
         DbCloseArea()
      
      ElseIf nMes == 4
         DbSelectArea("CFT1")
         While !Eof()
            nFat4MPBru := CFT1->TVALBRUTO
            nCus4MPFat := CFT1->CUSTOMP
            nQtd4FatMP  := CFT1->QTDFAT
            cGrpMP := CFT1->GRUPOMP
            If aScan(aFatp4MP,{|x| x[1] == CFT1->GRUPOMP}) == 0
               aAdd(aFatp4MP,{CFT1->GRUPOMP,nFat4MPBru,nQtd4FatMP,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,1)
            EndIf
            DbSelectArea("CFT1")
            DbSkip()
         EndDo
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("CFT1")
         While !Eof()
            nFat5MPBru := CFT1->TVALBRUTO
            nCus5MPFat := CFT1->CUSTOMP
            nQtd5FatMP  := CFT1->QTDFAT
            cGrpMP := CFT1->GRUPOMP
            If aScan(aFatp5MP,{|x| x[1] == CFT1->GRUPOMP}) == 0
               aAdd(aFatp5MP,{CFT1->GRUPOMP,nFat5MPBru,nQtd5FatMP,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,1)
            EndIf
            DbSelectArea("CFT1")
            DbSkip()
         EndDo
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("CFT1")
         While !Eof()
            nFat6MPBru := CFT1->TVALBRUTO
            nCus6MPFat := CFT1->CUSTOMP
            nQtd6FatMP  := CFT1->QTDFAT
            cGrpMP := CFT1->GRUPOMP
            If aScan(aFatp6MP,{|x| x[1] == CFT1->GRUPOMP}) == 0
               aAdd(aFatp6MP,{CFT1->GRUPOMP,nFat6MPBru,nQtd6FatMP,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,1)
            EndIf
            DbSelectArea("CFT1")
            DbSkip()
         EndDo
         DbCloseArea()
      
      EndIf
      
   Next nMes   
   
   /**************************
   * Devolução de Clientes
   *
   **************************/   
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Devoluções de Clientes, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := "SELECT SUBSTRING(SD1.D1_DTDIGIT,1,6) AS EMISSAO, SUM(SD1.D1_TOTAL+SD1.D1_VALIPI+SD1.D1_DESPESA) AS VLRDEVOL, SUM(SD2.D2_X_CST2) AS CUSDEVOL "
      cQuery += "FROM "+RetSqlName('SD1')+" SD1 LEFT OUTER JOIN "+RetSQLName("SD2")+" SD2 ON"
      cQuery += " SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
      cQuery += " AND SD1.D1_NFORI = SD2.D2_DOC"
      cQuery += " AND SD1.D1_SERIORI = SD2.D2_SERIE"
      cQuery += " AND SD1.D1_COD = SD2.D2_COD"
      cQuery += " AND SD1.D1_ITEMORI = SD2.D2_ITEM"
      cQuery += " AND SD2.D_E_L_E_T_ <> '*' "
      If !lMitto
         cQuery += " AND SD2.D2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " WHERE "
      cQuery += " SD1.D1_FILIAL = '"+xFilial("SD1")+"'"
      
      If nMes == 1
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf

      cQuery += " AND SD1.D1_TIPO = 'D' AND "
      //cQuery += " SD1.D1_CF IN ('1201','2201','1202','2202') AND "
      cQuery += " SD1.D1_NFORI <> ' ' AND "
      cQuery += " SD1.D_E_L_E_T_ <> '*' "
      
      cQuery += " GROUP BY SUBSTRING(SD1.D1_DTDIGIT,1,6) "
      cQuery += " ORDER BY SUBSTRING(SD1.D1_DTDIGIT,1,6) ASC "
   
      //If nMes == 1
         MemoWrite("C:\TEMP\DevolucaoVlr"+Alltrim(Str(nMes))+".SQL",cQuery)
      //EndIf
      
      TCQuery cQuery NEW ALIAS "NFDEV"
      
      If nMes == 1
         DbSelectArea("NFDEV")
         nVl1MesDev := NFDEV->VLRDEVOL
         nCus1MesDev := NFDEV->CUSDEVOL
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("NFDEV")
         nVl2MesDev := NFDEV->VLRDEVOL
         nCus2MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 3
         DbSelectArea("NFDEV")
         nVl3MesDev := NFDEV->VLRDEVOL
         nCus3MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 4
         DbSelectArea("NFDEV")
         nVl4MesDev := NFDEV->VLRDEVOL
         nCus4MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 5
         DbSelectArea("NFDEV")
         nVl5MesDev := NFDEV->VLRDEVOL
         nCus5MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 6
         DbSelectArea("NFDEV")
         nVl6MesDev := NFDEV->VLRDEVOL
         nCus6MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      EndIf      
      
   Next nMes

   /*******************************
   * Custo das Devoluções de Clientes por Mat.Prima
   * Novo 2009
   *************************************************/   
   
   ProcRegua(6)
   
   For nMes := 1 To 6
      
      IncProc("Calc.Custo Devoluções de Clientes p/MP, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := "SELECT SUBSTRING(SD1.D1_DTDIGIT,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP,"
      cQuery += "       SUM(SD1.D1_QUANT) QTDDEVMP"
      cQuery += "  FROM "+RetSQLName("SB1")+" SB1,"+RetSqlName('SD1')+" SD1"
      cQuery += "  LEFT OUTER JOIN "+RetSQLName("SD2")+" SD2 ON"
      cQuery += "  SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
      cQuery += "  AND SD1.D1_NFORI = SD2.D2_DOC"
      cQuery += "  AND SD1.D1_SERIORI = SD2.D2_SERIE"
      cQuery += "  AND SD1.D1_COD = SD2.D2_COD"
      cQuery += "  AND SD1.D1_ITEMORI = SD2.D2_ITEM"
      cQuery += "  AND SD2.D_E_L_E_T_ <> '*' "
      If !lMitto
         cQuery += "  AND SD2.D2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " WHERE SD1.D1_FILIAL = '"+xFilial("SD1")+"'"
      cQuery += "   AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'
      cQuery += "   AND SD1.D1_COD = SB1.B1_COD"
      
      If nMes == 1
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf

      cQuery += " AND SD1.D1_TIPO = 'D'"
      cQuery += " AND SD1.D1_CF IN ('1201','2201','1202','2202')"
      cQuery += " AND SD1.D1_NFORI <> ' ' "
      cQuery += " AND SD1.D_E_L_E_T_ <> '*' "
      cQuery += " AND SB1.D_E_L_E_T_ <> '*' "
      
      cQuery += " GROUP BY SUBSTRING(SD1.D1_DTDIGIT,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) "
      cQuery += " ORDER BY SUBSTRING(SD1.D1_DTDIGIT,1,6) DESC "
   
      //If nMes == 1
         MemoWrite("C:\TEMP\DevolucaoporMatPrima"+Alltrim(Str(nMes))+".SQL",cQuery)
      //EndIf
      
      TCQuery cQuery NEW ALIAS "NFDEV"
      
      If nMes == 1
         DbSelectArea("NFDEV")
         While !Eof()
            cGrpMP   := NFDEV->GRUPOMP
            nQtdMPDv := NFDEV->QTDDEVMP
            If aScan(aDev1MPCli,{|x| x[1] == cGrpMP}) == 0
             //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0}) 
               aAdd(aDev1MPCli,{cGrpMP     ,0         ,nQtdMPDv  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,2)
            EndIf
            DbSelectArea("NFDEV")
            DbSkip()
         EndDo
         DbSelectArea("NFDEV")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("NFDEV")
         While !Eof()
            cGrpMP   := NFDEV->GRUPOMP
            nQtdMPDv := NFDEV->QTDDEVMP
            If aScan(aDev2MPCli,{|x| x[1] == cGrpMP}) == 0
             //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0}) 
               aAdd(aDev2MPCli,{cGrpMP     ,0         ,nQtdMPDv  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,2)
            EndIf
            DbSelectArea("NFDEV")
            DbSkip()
         EndDo
         DbSelectArea("NFDEV")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("NFDEV")
         While !Eof()
            cGrpMP   := NFDEV->GRUPOMP
            nQtdMPDv := NFDEV->QTDDEVMP
            If aScan(aDev3MPCli,{|x| x[1] == cGrpMP}) == 0
             //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0}) 
               aAdd(aDev3MPCli,{cGrpMP     ,0         ,nQtdMPDv  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,2)
            EndIf
            DbSelectArea("NFDEV")
            DbSkip()
         EndDo
         DbSelectArea("NFDEV")
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("NFDEV")
         While !Eof()
            cGrpMP   := NFDEV->GRUPOMP
            nQtdMPDv := NFDEV->QTDDEVMP
            If aScan(aDev4MPCli,{|x| x[1] == cGrpMP}) == 0
             //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0}) 
               aAdd(aDev4MPCli,{cGrpMP     ,0         ,nQtdMPDv  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,2)
            EndIf
            DbSelectArea("NFDEV")
            DbSkip()
         EndDo
         DbSelectArea("NFDEV")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("NFDEV")
         While !Eof()
            cGrpMP   := NFDEV->GRUPOMP
            nQtdMPDv := NFDEV->QTDDEVMP
            If aScan(aDev5MPCli,{|x| x[1] == cGrpMP}) == 0
             //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0}) 
               aAdd(aDev5MPCli,{cGrpMP     ,0         ,nQtdMPDv  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,2)
            EndIf
            DbSelectArea("NFDEV")
            DbSkip()
         EndDo
         DbSelectArea("NFDEV")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("NFDEV")
         While !Eof()
            cGrpMP   := NFDEV->GRUPOMP
            nQtdMPDv := NFDEV->QTDDEVMP
            If aScan(aDev6MPCli,{|x| x[1] == cGrpMP}) == 0
             //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0}) 
               aAdd(aDev6MPCli,{cGrpMP     ,0         ,nQtdMPDv  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,2)
            EndIf
            DbSelectArea("NFDEV")
            DbSkip()
         EndDo
         DbSelectArea("NFDEV")
         DbCloseArea()
      EndIf      
      
   Next nMes
   
   /**************************
   * Devolução de Clientes
   * Exclusivo Frete
   **************************/   

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Devol.Clientes Fretes, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := "SELECT SUBSTRING(SF1.F1_DTDIGIT,1,6) AS EMISSAO, SUM(SF1.F1_FRETE)AS VLRDVFRT "
      cQuery += "FROM "+RetSqlName('SF1')+" SF1" 
      cQuery += " WHERE " 
      cQuery += " SF1.F1_FILIAL = '"+xFilial("SF1")+"'"
      If !lMitto
         cQuery += " AND SF1.F1_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SF1.F1_TIPO = 'D' "
      cQuery += " AND (SELECT COUNT(*)
      cQuery += "        FROM "+RetSqlName('SD1')+" SD1 LEFT OUTER JOIN "+RetSQLName("SD2")+" SD2 ON "
      cQuery += "        SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
      cQuery += "         AND SD1.D1_NFORI = SD2.D2_DOC"
      cQuery += "         AND SD1.D1_SERIORI = SD2.D2_SERIE"
      cQuery += "         AND SD1.D1_COD = SD2.D2_COD"
      cQuery += "         AND SD1.D1_ITEMORI = SD2.D2_ITEM"
      cQuery += "         AND SD2.D_E_L_E_T_ <> '*'"

      cQuery += "       WHERE SD1.D1_FILIAL = '"+xFilial("SD1")+"'"

      cQuery += "         AND SD1.D1_DOC = SF1.F1_DOC"
      cQuery += "         AND SD1.D1_SERIE = SF1.F1_SERIE"
      cQuery += "         AND SD1.D1_TIPO = 'D' AND "
      cQuery += "         SD1.D1_CF IN ('1201','2201','1202','2202') AND "
      cQuery += "         SD1.D1_NFORI <> ' '"
      If nMes == 1
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQuery += "         AND SD1.D_E_L_E_T_ <> '*' ) > 0"

   
      If nMes == 1
         cQuery += " AND SUBSTRING(SF1.F1_DTDIGIT,1,6)  = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQuery += " AND SUBSTRING(SF1.F1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQuery += " AND SUBSTRING(SF1.F1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQuery += " AND SUBSTRING(SF1.F1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData04),1,6)+"'"         
      ElseIf nMes == 5
         cQuery += " AND SUBSTRING(SF1.F1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQuery += " AND SUBSTRING(SF1.F1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf

      cQuery += " AND SF1.D_E_L_E_T_ <> '*' "
      cQuery += " GROUP BY SUBSTRING(SF1.F1_DTDIGIT,1,6) "
      cQuery += " ORDER BY SUBSTRING(SF1.F1_DTDIGIT,1,6) ASC "
   
      If nMes == 1
         MemoWrite("C:\TEMP\DevolucaoVlr.SQL",cQuery)
      EndIf
      
      TCQuery cQuery NEW ALIAS "NFDEV"
      
      If nMes == 1
         DbSelectArea("NFDEV")
         nVl1MesDev += NFDEV->VLRDVFRT
         //nCus1MesDev := NFDEV->CUSDEVOL
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("NFDEV")
         nVl2MesDev += NFDEV->VLRDVFRT
         //nCus2MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 3
         DbSelectArea("NFDEV")
         nVl3MesDev += NFDEV->VLRDVFRT
         //nCus3MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 4
         DbSelectArea("NFDEV")
         nVl4MesDev += NFDEV->VLRDVFRT
         //nCus3MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 5
         DbSelectArea("NFDEV")
         nVl5MesDev += NFDEV->VLRDVFRT
         //nCus3MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      ElseIf nMes == 6
         DbSelectArea("NFDEV")
         nVl6MesDev += NFDEV->VLRDVFRT
         //nCus3MesDev := NFDEV->CUSDEVOL
         DbCloseArea()         
      EndIf      
      
   Next nMes


   /**************************
   *
   * Produção
   *
   ***************************/

  
   /*******************************
   * Produção por Mês(Quantidade)
   ********************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Produção, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQrySD3 := " SELECT SUBSTRING(D3_EMISSAO,1,6) AS EMISSAO, SUM(D3_QUANT) AS PRODUZIDO"
      cQrySD3 += " FROM "+RetSqlName('SD3')+" SD3" //,"+RetSQLName("SH6")+" SH6"
      cQrySD3 += " WHERE SD3.D3_FILIAL = '"+xFilial("SD3")+"'"
      //cQrySD3 += "   AND SH6.H6_FILIAL = '"+xFilial("SH6")+"'  "
      If nMes == 1
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      //cQrySD3 += " AND SD3.D3_CF = 'PR0'"
      cQrySD3 += " AND SD3.D3_TM = '300'"
      //Comentado - 2009 - cQrySD3 += " AND SD3.D3_LOCAL = '01'"
      cQrySD3 += " AND SD3.D3_TIPO = 'PA'"
      cQrySD3 += " AND SD3.D3_ESTORNO = ' '"
      
      cQrySD3 += " AND SUBSTRING(SD3.D3_GRUPO,1,3) IN ('31','33','34')"//Five Solutions - 09/07/2010
      
      cQrySD3 += " AND SD3.D_E_L_E_T_ = ' '  "
      //cQrySD3 += " AND SH6.D_E_L_E_T_ = ' '  "
      cQrySD3 += " GROUP BY SUBSTRING(SD3.D3_EMISSAO,1,6) "
      cQrySD3 += " ORDER BY SUBSTRING(SD3.D3_EMISSAO,1,6) ASC "
      
      TCQuery cQrySD3 NEW ALIAS "PSD3"
      
      If nMes == 1
         DbSelectArea("PSD3")
         nProd1Mes := PSD3->PRODUZIDO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("PSD3")
         nProd2Mes := PSD3->PRODUZIDO
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("PSD3")
         nProd3Mes := PSD3->PRODUZIDO
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("PSD3")
         nProd4Mes := PSD3->PRODUZIDO
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("PSD3")
         nProd5Mes := PSD3->PRODUZIDO
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("PSD3")
         nProd6Mes := PSD3->PRODUZIDO
         DbCloseArea()
      EndIf
      
   Next nMes


   /*********************************
   * Novo Conceito 2009 - Custo Médio
   * Produção por Mês(Quantidade por Matéria Prima)
   ************************************************/
   
   ProcRegua(6) //3)
   aProd1MP := {}
   aProd2MP := {}
   aProd3MP := {}

   aProd4MP := {}
   aProd5MP := {}
   aProd6MP := {}
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Produção p/Custo Médio, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQrySD3 := " SELECT SUBSTRING(D3_EMISSAO,1,6) AS EMISSAO, SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP,SUM(D3_QUANT) AS PRODUZIDO"
      cQrySD3 += " FROM "+RetSqlName('SD3')+" SD3,"+RetSQLName("SB1")+" SB1"
      cQrySD3 += " WHERE SD3.D3_FILIAL = '"+xFilial("SD3")+"'"
      cQrySD3 += "   AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'
      cQrySD3 += "   AND SD3.D3_COD = SB1.B1_COD "
      If nMes == 1
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQrySD3 += " AND SUBSTRING(SD3.D3_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQrySD3 += " AND SD3.D3_TM = '300'"
      cQrySD3 += " AND SD3.D3_TIPO = 'PA'""
      cQrySD3 += " AND SD3.D3_ESTORNO = ' '"
      
      cQrySD3 += " AND SD3.D_E_L_E_T_ = ' '  "
      cQrySD3 += " AND SB1.D_E_L_E_T_ = ' '  "

      cQrySD3 += " GROUP BY SUBSTRING(SD3.D3_EMISSAO,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) "
      cQrySD3 += " ORDER BY SUBSTRING(SD3.D3_EMISSAO,1,6) ASC "
      
      MemoWrite("C:\TEMP\ProdMatPrima.SQL",cQrySD3)
      
      TCQuery cQrySD3 NEW ALIAS "PSD3"
      
      If nMes == 1
         DbSelectArea("PSD3")
         While !Eof()
            cGrpMP   := PSD3->GRUPOMP
            nQtdMPro := PSD3->PRODUZIDO
            If aScan(aProd1MP,{|x| x[1] == cGrpMP}) == 0
               aAdd(aProd1MP,{cGrpMP     ,0         ,nQtdMPro  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,3)
            EndIf
            DbSelectArea("PSD3")
            DbSkip()
         EndDo
         DbSelectArea("PSD3")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("PSD3")
         While !Eof()
            cGrpMP   := PSD3->GRUPOMP
            nQtdMPro := PSD3->PRODUZIDO
            If aScan(aProd2MP,{|x| x[1] == cGrpMP}) == 0
               aAdd(aProd2MP,{cGrpMP     ,0         ,nQtdMPro  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,3)
            EndIf
            DbSelectArea("PSD3")
            DbSkip()
         EndDo
         DbSelectArea("PSD3")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("PSD3")
         While !Eof()
            cGrpMP   := PSD3->GRUPOMP
            nQtdMPro := PSD3->PRODUZIDO
            If aScan(aProd3MP,{|x| x[1] == cGrpMP}) == 0
               aAdd(aProd3MP,{cGrpMP     ,0         ,nQtdMPro  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,3)
            EndIf
            DbSelectArea("PSD3")
            DbSkip()
         EndDo
         DbSelectArea("PSD3")
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("PSD3")
         While !Eof()
            cGrpMP   := PSD3->GRUPOMP
            nQtdMPro := PSD3->PRODUZIDO
            If aScan(aProd4MP,{|x| x[1] == cGrpMP}) == 0
               aAdd(aProd4MP,{cGrpMP     ,0         ,nQtdMPro  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,3)
            EndIf
            DbSelectArea("PSD3")
            DbSkip()
         EndDo
         DbSelectArea("PSD3")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("PSD3")
         While !Eof()
            cGrpMP   := PSD3->GRUPOMP
            nQtdMPro := PSD3->PRODUZIDO
            If aScan(aProd5MP,{|x| x[1] == cGrpMP}) == 0
               aAdd(aProd5MP,{cGrpMP     ,0         ,nQtdMPro  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,3)
            EndIf
            DbSelectArea("PSD3")
            DbSkip()
         EndDo
         DbSelectArea("PSD3")
         DbCloseArea()      
      ElseIf nMes == 6
         DbSelectArea("PSD3")
         While !Eof()
            cGrpMP   := PSD3->GRUPOMP
            nQtdMPro := PSD3->PRODUZIDO
            If aScan(aProd6MP,{|x| x[1] == cGrpMP}) == 0
               aAdd(aProd6MP,{cGrpMP     ,0         ,nQtdMPro  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,3)
            EndIf
            DbSelectArea("PSD3")
            DbSkip()
         EndDo
         DbSelectArea("PSD3")
         DbCloseArea()
      EndIf
      
   Next nMes
   
   /*************************
   *
   * Baixas
   *
   *************************/
   // Obtem os registros a serem processados
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Baixas, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLBAIXAS "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += " AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNatProd,",")
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      TCQuery cQuery NEW ALIAS "TSE5"
      
      If nMes == 1
         DbSelectArea("TSE5")
         nVlr1MesBx := TSE5->VLBAIXAS
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TSE5")
         nVlr2MesBx := TSE5->VLBAIXAS
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("TSE5")
         nVlr3MesBx := TSE5->VLBAIXAS
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("TSE5")
         nVlr4MesBx := TSE5->VLBAIXAS
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("TSE5")
         nVlr5MesBx := TSE5->VLBAIXAS
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("TSE5")
         nVlr6MesBx := TSE5->VLBAIXAS
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * COMISSÃO
   *
   ************************/
   ProcRegua(12) //6)
   
   For nMes := 1 To 12 //6
   
      IncProc("Calc. Comissões, Processo "+Alltrim(Str(nMes))+" / 12")
      
      If nMes <= 6
         
         cQuery := " SELECT SUM((SE1.E1_VALOR * (SE1.E1_COMIS1/100))) AS VLCOMIS"
         cQuery += " FROM " + RetSqlName("SE1")+" SE1"
         cQuery += " WHERE SE1.E1_FILIAL = '"+xFilial("SE1")+"'"
         cQuery += "   AND SUBSTRING(SE1.E1_VEND1,1,1) <> 'R'" //Funcionarios
         If !lMitto
            cQuery += "   AND SE1.E1_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
         EndIf
         
         If nMes == 1 
            cQuery += "   AND SUBSTRING(SE1.E1_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
         ElseIf nMes == 2
            cQuery += "   AND SUBSTRING(SE1.E1_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
         ElseIf nMes == 3
            cQuery += "   AND SUBSTRING(SE1.E1_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
         ElseIf nMes == 4
            cQuery += "   AND SUBSTRING(SE1.E1_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
         ElseIf nMes == 5
            cQuery += "   AND SUBSTRING(SE1.E1_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
         ElseIf nMes == 6
            cQuery += "   AND SUBSTRING(SE1.E1_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
         EndIf
         
         cQuery += "   AND SE1.D_E_L_E_T_ <> '*'"
         
         TCQuery cQuery NEW ALIAS "TSRD"

         If nMes == 1
            DbSelectArea("TSRD")
            nVl1MComis := TSRD->VLCOMIS
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TSRD")
            nVl2MComis := TSRD->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("TSRD")
            nVl3MComis := TSRD->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("TSRD")
            nVl4MComis := TSRD->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("TSRD")
            nVl5MComis := TSRD->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("TSRD")
            nVl6MComis := TSRD->VLCOMIS
            DbCloseArea()
         EndIf
         
      Else
      
         cQuery := " SELECT SUM((SE1.E1_VALOR * (SE1.E1_COMIS1/100))) AS VLCOMIS "
         cQuery += " FROM " + RetSqlName("SE1")+" SE1 "
         cQuery += " WHERE SE1.E1_FILIAL = '"+xFilial("SE1")+"'"
         cQuery += "   AND SUBSTRING(SE1.E1_VEND1,1,1) = 'R'" //Representantes
         If !lMitto
            cQuery += "   AND SE1.E1_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
         EndIf
      
         If nMes == 7
            cQuery += "    AND  SUBSTRING(SE1.E1_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
         ElseIf nMes == 8
            cQuery += "    AND  SUBSTRING(SE1.E1_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
         ElseIf nMes == 9
            cQuery += "    AND  SUBSTRING(SE1.E1_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
         ElseIf nMes == 10
            cQuery += "    AND  SUBSTRING(SE1.E1_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
         ElseIf nMes == 11
            cQuery += "    AND  SUBSTRING(SE1.E1_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
         ElseIf nMes == 12
            cQuery += "    AND  SUBSTRING(SE1.E1_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
         EndIf
         
         cQuery += "  AND SE1.D_E_L_E_T_ = ' '"
      
         TCQuery cQuery NEW ALIAS "TSE5"
      
         If nMes == 7
            DbSelectArea("TSE5")
            nVl1MRepres := TSE5->VLCOMIS
            DbCloseArea()
         ElseIf nMes == 8
            DbSelectArea("TSE5")
            nVl2MRepres := TSE5->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 9
            DbSelectArea("TSE5")
            nVl3MRepres := TSE5->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 10
            DbSelectArea("TSE5")
            nVl4MRepres := TSE5->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 11
            DbSelectArea("TSE5")
            nVl5MRepres := TSE5->VLCOMIS
            DbCloseArea()
         ElseIf nMEs == 12
            DbSelectArea("TSE5")
            nVl6MRepres := TSE5->VLCOMIS
            DbCloseArea()
         EndIf
      
      EndIf
      
   Next nMes

   /************************
   *
   * GASTOS GERAIS
   *
   ************************/
   
   ProcRegua(72) //36)
   
   For nMes := 1 To 72 //36 //De 1 a 3 Gastos Gerais(cGGNatComl), 
                       //4 a 6 Gastos Gerais Mão de Obra.(cNatGGMO)
                       //7 a 9 Despesas Fixas
                      //10 a 12 Despesas Periódicas
                      //13 a 15 Rescisões
                      //16 a 18 Premiações
                      //19 a 21 Marketing
                      //22 a 24 Despesas co Viagens
                      //25 a 27 Fretes de Vendas
                      //28 a 30 Outras Despesas do Comercial
                      //31 a 33 Outras Naturezas
                      //34 a 36 Serviços Terceirizados
                      
      IncProc(" Calc.Gastos Gerais Coml. Proc. "+Alltrim(Str(nMes))+" / 72")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLGGCOML "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += " AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7  .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49 .Or. nMes == 55 .Or. nMes == 61  .Or. nMes == 67 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8  .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50 .Or. nMes == 56 .Or. nMes == 62 .Or. nMes == 68 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9  .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51 .Or. nMes == 57 .Or. nMes == 63 .Or. nMes == 69 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10  .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52 .Or. nMes == 58 .Or. nMes == 64 .Or. nMes == 70 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11  .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53 .Or. nMes == 59 .Or. nMes == 65 .Or. nMes == 71 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12  .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54 .Or. nMes == 60 .Or. nMes == 66 .Or. nMes == 72 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
      
      If nMes <= 6 //3
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cGGNatComl,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNatGGMO,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDFNatGG,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDPNatGG,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNResGG,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtPremGG,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNatMark,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtDespV,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFrtVend,",")
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtOutDesp,",")
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(nOutNatGG,",")
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtSerComTer,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      If nMes <= 6 //== 1 .Or. nMes == 4
         MemoWrite("C:\TEMP\GastosGer"+Alltrim(Str(nMes))+".SQL",cQuery)
      EndIf
      
      
      TCQuery cQuery NEW ALIAS "TSE5"
      
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("TSE5")
            nVl1MGGComl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TSE5")
            nVl2MGGComl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("TSE5")
            nVl3MGGComl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("TSE5")
            nVl4MGGComl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("TSE5")
            nVl5MGGComl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("TSE5")
            nVl6MGGComl := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("TSE5")
            nVl1MGGMO := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("TSE5")
            nVl2MGGMO := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 9 //6
            DbSelectArea("TSE5")
            nVl3MGGMO := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 10 //6
            DbSelectArea("TSE5")
            nVl4MGGMO := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 11
            DbSelectArea("TSE5")
            nVl5MGGMO := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 12
            DbSelectArea("TSE5")
            nVl6MGGMO := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("TSE5")
            nVl1MDFGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("TSE5")
            nVl2MDFGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 15 //9
            DbSelectArea("TSE5")
            nVl3MDFGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 16
            DbSelectArea("TSE5")
            nVl4MDFGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 17
            DbSelectArea("TSE5")
            nVl5MDFGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 18
            DbSelectArea("TSE5")
            nVl6MDFGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            DbSelectArea("TSE5")
            nVl1MDPGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 20 //11
            DbSelectArea("TSE5")
            nVl2MDPGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 21 //12
            DbSelectArea("TSE5")
            nVl3MDPGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 22
            DbSelectArea("TSE5")
            nVl4MDPGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 23
            DbSelectArea("TSE5")
            nVl5MDPGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 24
            DbSelectArea("TSE5")
            nVl6MDPGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            DbSelectArea("TSE5")
            nVl1MResGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 26 //14
            DbSelectArea("TSE5")
            nVl2MResGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 27 //15
            DbSelectArea("TSE5")
            nVl3MResGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 28
            DbSelectArea("TSE5")
            nVl4MResGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 29
            DbSelectArea("TSE5")
            nVl5MResGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 30
            DbSelectArea("TSE5")
            nVl6MResGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         If nMes == 31 //16
            DbSelectArea("TSE5")
            nVl1MPrmGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 32 //17
            DbSelectArea("TSE5")
            nVl2MPrmGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 33 //18
            DbSelectArea("TSE5")
            nVl3MPrmGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 34
            DbSelectArea("TSE5")
            nVl4MPrmGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 35
            DbSelectArea("TSE5")
            nVl5MPrmGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 36
            DbSelectArea("TSE5")
            nVl6MPrmGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         If nMes == 37 //19
            DbSelectArea("TSE5")
            nVl1MMktGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 38 //20
            DbSelectArea("TSE5")
            nVl2MMktGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 39 //21
            DbSelectArea("TSE5")
            nVl3MMktGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 40
            DbSelectArea("TSE5")
            nVl4MMktGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 41
            DbSelectArea("TSE5")
            nVl5MMktGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 42
            DbSelectArea("TSE5")
            nVl6MMktGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         If nMes == 43 //22
            DbSelectArea("TSE5")
            nVl1MDVgGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 44 //23
            DbSelectArea("TSE5")
            nVl2MDVgGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 45 //24
            DbSelectArea("TSE5")
            nVl3MDVgGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 46
            DbSelectArea("TSE5")
            nVl4MDVgGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 47
            DbSelectArea("TSE5")
            nVl5MDVgGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 48
            DbSelectArea("TSE5")
            nVl6MDVgGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         If nMes == 49 //25
            DbSelectArea("TSE5")
            nVl1MDFrtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 50 //26
            DbSelectArea("TSE5")
            nVl2MDFrtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 51 //27
            DbSelectArea("TSE5")
            nVl3MDFrtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 52
            DbSelectArea("TSE5")
            nVl4MDFrtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 53
            DbSelectArea("TSE5")
            nVl5MDFrtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 54
            DbSelectArea("TSE5")
            nVl6MDFrtGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         If nMes == 55 //28
            DbSelectArea("TSE5")
            nVl1MOutDGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 56 //29
            DbSelectArea("TSE5")
            nVl2MOutDGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 57 //30
            DbSelectArea("TSE5")
            nVl3MOutDGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 58
            DbSelectArea("TSE5")
            nVl4MOutDGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 59
            DbSelectArea("TSE5")
            nVl5MOutDGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 60
            DbSelectArea("TSE5")
            nVl6MOutDGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         If nMes == 61 //31
            DbSelectArea("TSE5")
            nVl1MONtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 62 //32
            DbSelectArea("TSE5")
            nVl2MONtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 63 //33
            DbSelectArea("TSE5")
            nVl3MONtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 64
            DbSelectArea("TSE5")
            nVl4MONtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 65
            DbSelectArea("TSE5")
            nVl5MONtGG := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 66
            DbSelectArea("TSE5")
            nVl6MONtGG := TSE5->VLGGCOML
            DbCloseArea()
         EndIf
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         If nMes == 67 //34
            DbSelectArea("TSE5")
            nSTc1ComVl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 68 //35
            DbSelectArea("TSE5")
            nSTc2ComVl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 69 //36
            DbSelectArea("TSE5")
            nSTc3ComVl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 70
            DbSelectArea("TSE5")
            nSTc4ComVl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 71
            DbSelectArea("TSE5")
            nSTc5ComVl := TSE5->VLGGCOML
            DbCloseArea()
         ElseIf nMes == 72
            DbSelectArea("TSE5")
            nSTc6ComVl := TSE5->VLGGCOML
            DbCloseArea()
         EndIf      
      EndIf
      
   Next nMes

  
   /************************
   *
   * GASTOS META ORCAMENTO COML (ORÇADO)
   *
   ************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Gastos Metas/Orc Comercio(Orçado) Proc. "+Alltrim(Str(nMes))+" / 6")
      
      If nMes == 1
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dDataDe),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VLORCMTORC "
      ElseIf nMes == 2
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData02),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VLORCMTORC "
      ElseIf nMes == 3
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData03),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VLORCMTORC "
      ElseIf nMes == 4
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData04),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VLORCMTORC "
      ElseIf nMes == 5
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData05),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VLORCMTORC "
      ElseIf nMes == 6
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData06),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VLORCMTORC "
      EndIf
      
      cQuery += " FROM " + RetSqlName("SE7")+" SE7 "
      
      If nMes == 1
         _xANO := ALLTRIM(STR(YEAR(dDataDe)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 2 
         _xANO := ALLTRIM(STR(YEAR(dData02)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 3 
         _xANO := ALLTRIM(STR(YEAR(dData03)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 4
         _xANO := ALLTRIM(STR(YEAR(dData04)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 5
         _xANO := ALLTRIM(STR(YEAR(dData05)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 6
         _xANO := ALLTRIM(STR(YEAR(dData06)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      EndIf
      
      cQuery += "  AND SE7.E7_FILIAL = '"+xFilial("SE7")+"'"
      cQuery += "  AND SE7.E7_NATUREZ IN "+FormatIn(cNtGMtOrCml,",")
      cQuery += "  AND SE7.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\MtOrçadoComercio"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "OMOC"
      

      
      If nMes == 1
         DbSelectArea("OMOC")
         nCom1MMtOrc := OMOC->VLORCMTORC
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("OMOC")
         nCom2MMtOrc := OMOC->VLORCMTORC
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("OMOC")
         nCom3MMtOrc := OMOC->VLORCMTORC
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("OMOC")
         nCom4MMtOrc := OMOC->VLORCMTORC
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("OMOC")
         nCom5MMtOrc := OMOC->VLORCMTORC
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("OMOC")
         nCom6MMtOrc := OMOC->VLORCMTORC
         DbCloseArea()
      EndIf

   Next nMes

   /************************
   *
   * GASTOS META ORCAMENTO COML (REALIZADO)
   *
   ************************/
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3 
                      
      IncProc("Gastos Metas/Orc Comercio(Realizado) Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLGMTORC "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += " AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf

      cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtGMtOrCml,",")
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      TCQuery cQuery NEW ALIAS "TSE5"
      
      If nMes == 1
         DbSelectArea("TSE5")
         nGst1MMtOrC := TSE5->VLGMTORC
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TSE5")
         nGst2MMtOrC := TSE5->VLGMTORC
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TSE5")
         nGst3MMtOrC := TSE5->VLGMTORC
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TSE5")
         nGst4MMtOrC := TSE5->VLGMTORC
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TSE5")
         nGst5MMtOrC := TSE5->VLGMTORC
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TSE5")
         nGst6MMtOrC := TSE5->VLGMTORC
         DbCloseArea()
      EndIf
         
   Next nMes

   /****************************
   *
   * FATURAMENTO SUCATA
   *
   * Obs: Conforme orientação do Sr. Arimatéia, selecionamentos os produtos Sucata pelo
   *      Grupo 80.
   *
   ****************************/
  
   /********************************
   * FATURAMENTO ESPECIFICO SUCATA
   *********************************/
   aTSUCList := {}
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Fat.Especifico Sucata, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS VLRSUCAT, SUM(D2_X_CST2) AS CUSTOMPSUC FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) = '40'" //Só Faturamento Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
     
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      

      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6) ASC"
      
      If nMes == 1
         MemoWrite("C:\TEMP\FatCusSucata.SQL",cQuery)
      EndIf
      
      TCQuery cQuery NEW ALIAS "TSUC"

      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("TSUC")
            nVl1SUCMFat := TSUC->VLRSUCAT
            nVlM1CusSUC := TSUC->CUSTOMPSUC
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TSUC")
            nVl2SUCMFat := TSUC->VLRSUCAT
            nVlM2CusSUC := TSUC->CUSTOMPSUC
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("TSUC")
            nVl3SUCMFat := TSUC->VLRSUCAT
            nVlM3CusSUC := TSUC->CUSTOMPSUC
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("TSUC")
            nVl4SUCMFat := TSUC->VLRSUCAT
            nVlM4CusSUC := TSUC->CUSTOMPSUC
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("TSUC")
            nVl5SUCMFat := TSUC->VLRSUCAT
            nVlM5CusSUC := TSUC->CUSTOMPSUC
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("TSUC")
            nVl6SUCMFat := TSUC->VLRSUCAT
            nVlM6CusSUC := TSUC->CUSTOMPSUC
            DbCloseArea()
         EndIf
      EndIf
      
      
   Next nMes   
   
   /**********************************************************
   *FATURAMENTO ESPECIFICO SUCATA POR CONDIÇÃO DE FATURAMENTO
   *
   **********************************************************/

   aTSUCList := {}
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3

      IncProc("Calc. Fat.Bruto Sucata p/Cond.Pg, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      //Faturamento de Sucatas - Antes, cQuery := " SELECT SF2.F2_COND,SUM(SD2.D2_TOTAL+SD2.D2_VALIPI+SD2.D2_ICMSRET+SD2.D2_VALFRE+SD2.D2_SEGURO+SD2.D2_DESPESA) AS VLRSUCAT FROM "
      cQuery := " SELECT SF2.F2_COND,SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS VLRSUCAT FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) = '40'" //Faturamento Especifico Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
            
      cQuery += " GROUP BY SF2.F2_COND"
      cQuery += " ORDER BY SF2.F2_COND ASC"
            
      TCQuery cQuery NEW ALIAS "TSUC"
   
      If nMes <= 6 //3
         DbSelectArea("TSUC")
         While !Eof()
            nPos := aScan(aTSUCList, {|x| x[1] == TSUC->F2_COND})
            If nPos == 0
               Aadd(aTSUCList, {TSUC->F2_COND,"X",IIF(nMes==1,TSUC->VLRSUCAT,0),IIF(nMes==2,TSUC->VLRSUCAT,0),IIF(nMes==3,TSUC->VLRSUCAT,0),IIF(nMes==4,TSUC->VLRSUCAT,0),IIF(nMes==5,TSUC->VLRSUCAT,0),IIF(nMes==6,TSUC->VLRSUCAT,0)})
            Else
               aTSUCList[nPos,((nMes)+2)] := TSUC->VLRSUCAT
            EndIf
            DbSelectArea("TSUC")
            DbSkip()
         EndDo
         DbSelectArea("TSUC")
         DbCloseArea()
      EndIf
      
   Next nMes
 

   //Acrescenta demais Condições de Pagamentos(Faturamento Sucata) que ainda não foram utilizadas nas vendas - Especifico Rel.por Competencia
   cQrySE4 := " SELECT E4_CODIGO "
   cQrySE4 += "   FROM "+RetSQLName("SE4")
   cQrySE4 += "  WHERE E4_FILIAL = '"+xFilial("SE4")+"'"
   cQrySE4 += "    AND SUBSTRING(E4_CODIGO,1,1) = 'V'"
   cQrySE4 += "    AND D_E_L_E_T_ <> '*'"
   
   MemoWrite("CondicoesdeVendasSucata.SQL",cQrySE4)
   MemoWrite("C:\TEMP\CondicoesdeVendasSucata.SQL",cQrySE4)
   TCQuery cQrySE4 NEW ALIAS "TMSE4"
   DbSelectArea("TMSE4")
   While TMSE4->(!Eof())
      If aScan(aTSUCList,{|x| x[1] == TMSE4->E4_CODIGO}) == 0
         Aadd(aTSUCList, {TMSE4->E4_CODIGO,"X",0,0,0,0,0,0})
      EndIf
      DbSelectArea("TMSE4")
      DbSkip()
   EndDo
   DbSelectArea("TMSE4")
   DbCloseArea()
   
  /***********************
  * Qtd.: SUCATA Vendida
  ***********************/

  ProcRegua(6) //3)
  
  For nMes := 1 To 6 //3
  
     IncProc("Calc. Qtd. Sucatas Vendidas, Proc. "+Alltrim(Str(nMes))+" / 6")
  
     cQry2SD2 := "SELECT SUM(D2_QUANT) AS QTDSUCVEN"  //Pedidos Faturados(Mês) - Valor
     cQry2SD2 += " FROM "+RetSQLName("SD2")+" SD2,"+RetSQLName("SC5")+" SC5,"+RetSQLName("SE4")+" SE4,"+RetSQLName("SF2")+" SF2,"+RetSQLName("SB1")+" SB1"
     cQry2SD2 += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"'"
     cQry2SD2 += "    AND SF2.F2_FILIAL = '"+xFilial("SF2")+"'"
     cQry2SD2 += "    AND SE4.E4_FILIAL = '"+xFilial("SE4")+"'"
     cQry2SD2 += "    AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'
     cQry2SD2 += "    AND SC5.C5_FILIAL = '"+xFilial("SC5")+"'"
     If !lMitto
        cQry2SD2 += "    AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
     EndIf
     cQry2SD2 += "    AND SD2.D2_PEDIDO = SC5.C5_NUM"
     cQry2SD2 += "    AND SF2.F2_COND = SE4.E4_CODIGO"
     
     If nMes == 1
        cQry2SD2 += " AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
        //cQry2SD2 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
     ElseIf nMes == 2
        cQry2SD2 += " AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
        //cQry2SD2 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
     ElseIf nMes == 3
        cQry2SD2 += " AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
        //cQry2SD2 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
     ElseIf nMes == 4
        cQry2SD2 += " AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
        //cQry2SD2 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
     ElseIf nMes == 5
        cQry2SD2 += " AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
        //cQry2SD2 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
     ElseIf nMes == 6
        cQry2SD2 += " AND SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
        //cQry2SD2 += " AND SUBSTRING(SC5.C5_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
     EndIf
      
     //Ita - 12/02/2008
     cQry2SD2 += " AND SUBSTRING(SB1.B1_GRUPO,1,2) = '40'" //Faturamento Sucatas
      
     //Filtra CFOPs de Vendas - Conforme Solicitação de Patrícia(Auditoria COMAFAL)
     cQry2SD2 += "    AND SF2.F2_DOC = SD2.D2_DOC"
     cQry2SD2 += "    AND SF2.F2_SERIE = SD2.D2_SERIE"
     cQry2SD2 += "    AND SD2.D2_COD = SB1.B1_COD"
     cQry2SD2 += "    AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
     cQry2SD2 += "    AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
     cQry2SD2 += "    AND SD2.D_E_L_E_T_ <> '*'"
     cQry2SD2 += "    AND SF2.D_E_L_E_T_ <> '*'"
     cQry2SD2 += "    AND SE4.D_E_L_E_T_ <> '*'"
     cQry2SD2 += "    AND SB1.D_E_L_E_T_ <> '*'"      
     cQry2SD2 += "    AND SC5.D_E_L_E_T_ <> '*'"      
     
     MemoWrite("C:\TEMP\QtdSucataVen.SQL",cQry2SD2)
     
     TCQuery cQry2SD2 NEW ALIAS "TSUC"
  
    If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("TSUC")
            nQt1MSUCVen := TSUC->QTDSUCVEN
            DbCloseArea()      
         ElseIf nMes == 2
            DbSelectArea("TSUC")
            nQt2MSUCVen := TSUC->QTDSUCVEN
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("TSUC")
            nQt3MSUCVen := TSUC->QTDSUCVEN
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("TSUC")
            nQt4MSUCVen := TSUC->QTDSUCVEN
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("TSUC")
            nQt5MSUCVen := TSUC->QTDSUCVEN
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("TSUC")
            nQt6MSUCVen := TSUC->QTDSUCVEN
            DbCloseArea()
         EndIf
    EndIf
  
  Next nMes
    
EndIf

If lIndustria
   
   /************************
   *
   * Produção por Máquina
   *
   ************************/
   
   aMaqPrdM := {}
   
   ProcRegua(7) //4)
   
   For nMes := 1 To 7 //4
   
      IncProc("Calc. Produção Maq.Ind. Proc. "+Alltrim(Str(nMes))+" / 7") //4")
      
      //cQryPMQ := " SELECT SUBSTRING(SH6.H6_DTAPONT,1,6) AS EMISSAO,SH1.H1_DESCRI AS MAQUINA, SUM(SH6.H6_QTDPROD) AS PRODUZIDO "
      //cQryPMQ := " SELECT SH6.H6_RECURSO AS MAQUINA, SUM(SH6.H6_QTDPROD) AS MQPRODUZIDO "
      //cQryPMQ := " SELECT SH6.H6_RECURSO AS MAQUINA, SUM(SD3.D3_QUANT) AS MQPRODUZIDO "
      cQryPMQ := " SELECT SD3.D3_CC AS MAQUINA, SUM(SD3.D3_QUANT) AS MQPRODUZIDO "
      cQryPMQ += " FROM "
      //cQryPMQ += RetSqlName('SH6') + " SH6,"+RetSQLName("SD3")+" SD3"
      cQryPMQ += RetSQLName("SD3")+" SD3"
      cQryPMQ += " WHERE "
      //cQryPMQ += " SH6.H6_FILIAL = '"+xFilial("SH6")+"'  "
      cQryPMQ += " SD3.D3_FILIAL = '"+xFilial("SD3")+"'"
      //cQryPMQ += " AND SD3.D3_CF = 'PR0'"
      cQryPMQ += " AND SD3.D3_TM = '300'"
      cQryPMQ += " AND SD3.D3_LOCAL = '01'"
      cQryPMQ += " AND SD3.D3_ESTORNO = ' '"
      
      If SM0->M0_CODFIL == "06"
         cQryPMQ += " AND SD3.D3_GRUPO IN ('40','52','60','70')"
      Else
         cQryPMQ += " AND SD3.D3_GRUPO IN ('60','70')"
      EndIf
      
      If nMes == 1
         cQryPMQ += " AND SUBSTRING(D3_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"' " 
      ElseIf nMes == 2
         cQryPMQ += " AND SUBSTRING(D3_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"' " 
      ElseIf nMes == 3
         cQryPMQ += " AND SUBSTRING(D3_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"' "
      ElseIf nMes == 4
         cQryPMQ += " AND SUBSTRING(D3_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"' "
      ElseIf nMes == 5
         cQryPMQ += " AND SUBSTRING(D3_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"' "
      ElseIf nMes == 6
         cQryPMQ += " AND SUBSTRING(D3_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"' "
      EndIf
      
      cQryPMQ += " AND SD3.D_E_L_E_T_ <> '*'  "  
      cQryPMQ += " GROUP BY SD3.D3_CC "
      cQryPMQ += " ORDER BY SD3.D3_CC ASC "
      
      MemoWrite("C:\TEMP\Maquina"+Alltrim(Str(nMes))+".SQL",cQryPMQ)
      
      TCQuery cQryPMQ NEW ALIAS "TPMQ"

      DbSelectArea("TPMQ")
      While !Eof()
         nPosMQ := aScan(aMaqPrdM, { |x| x[1] == TPMQ->MAQUINA } )

         If nPosMQ == 0
            Aadd(aMaqPrdM, {TPMQ->MAQUINA,IIF(nMes==1,TPMQ->MQPRODUZIDO,0),IIF(nMes==2,TPMQ->MQPRODUZIDO,0),IIF(nMes==3,TPMQ->MQPRODUZIDO,0),IIF(nMes==4,TPMQ->MQPRODUZIDO,0),IIF(nMes==5,TPMQ->MQPRODUZIDO,0),IIF(nMes==6,TPMQ->MQPRODUZIDO,0)})
         Else
            aMaqPrdM[nPosMQ,nMes+1] := TPMQ->MQPRODUZIDO
         EndIf
         
         DbSelectArea("TPMQ")
         DbSkip()
      EndDo
      DbSelectArea("TPMQ")
      DbCloseArea()      
   
   Next nMes


   /************************
   *
   * Perdas                 
   *
   ************************/
   
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Perdas Ind. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryPMQ := " SELECT SUBSTRING(BC_DATA,1,6) BC_DATA,SUM(BC_QUANT) BC_QUANT"
      cQryPMQ += " FROM "
      cQryPMQ += RetSQLName("SBC")+" SBC"
      cQryPMQ += " WHERE "
      cQryPMQ += " SBC.BC_FILIAL = '"+xFilial("SBC")+"'"
        
      If nMes == 1
         cQryPMQ += " AND SUBSTRING(BC_DATA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"' " 
      ElseIf nMes == 2
         cQryPMQ += " AND SUBSTRING(BC_DATA,1,6) = '"+Substr(DTOS(dData02),1,6)+"' " 
      ElseIf nMes == 3
         cQryPMQ += " AND SUBSTRING(BC_DATA,1,6) = '"+Substr(DTOS(dData03),1,6)+"' "
      ElseIf nMes == 4
         cQryPMQ += " AND SUBSTRING(BC_DATA,1,6) = '"+Substr(DTOS(dData04),1,6)+"' "
      ElseIf nMes == 5
         cQryPMQ += " AND SUBSTRING(BC_DATA,1,6) = '"+Substr(DTOS(dData05),1,6)+"' "
      ElseIf nMes == 6
         cQryPMQ += " AND SUBSTRING(BC_DATA,1,6) = '"+Substr(DTOS(dData06),1,6)+"' "
      EndIf
      
      cQryPMQ += " AND SBC.D_E_L_E_T_ <> '*'  "  
      
      cQryPMQ += " GROUP BY SUBSTRING(BC_DATA,1,6)"
      
      MemoWrite("C:\TEMP\Perdas"+Alltrim(Str(nMes))+".SQL",cQryPMQ)
      
      TCQuery cQryPMQ NEW ALIAS "PDMQ"

      DbSelectArea("PDMQ")
      If nMes == 1
         DbSelectArea("PDMQ")
         nPerd1Vlr  := PDMQ->BC_QUANT
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("PDMQ")
         nPerd2Vlr  := PDMQ->BC_QUANT
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("PDMQ")
         nPerd3Vlr  := PDMQ->BC_QUANT
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("PDMQ")
         nPerd4Vlr  := PDMQ->BC_QUANT
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("PDMQ")
         nPerd5Vlr  := PDMQ->BC_QUANT
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("PDMQ")
         nPerd6Vlr  := PDMQ->BC_QUANT
         DbCloseArea()
      EndIf

   
   Next nMes
      
   /**************************
   *
   * Calculando Matéria Prima
   *
   ***************************/
   ProcRegua(6)
   
   For nMes := 1 To 6

      IncProc("Calc. Mat.Prima Ind. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryMP := " SELECT SUM(SB9.B9_QINI) AS QUANT, SUM(SB9.B9_QINI*SB1.B1_X_CST2) AS CUSTO "
      cQryMP += " FROM "
      cQryMP += RetSqlName('SB9') + " SB9, " 
      cQryMP += RetSqlName('SB1') + " SB1 "
      cQryMP += " WHERE SB9.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB9.B9_FILIAL = '"+xFilial("SB9")+"' AND "
      
      If nMes == 1
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dDataDe))+"' AND " 
      ElseIf nMes == 2
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData02))+"' AND " 
      ElseIf nMes == 3
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData03))+"' AND " 
      ElseIf nMes == 4
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData04))+"' AND " 
      ElseIf nMes == 5
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData05))+"' AND " 
      ElseIf nMes == 6
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData06))+"' AND " 
      EndIf

      cQryMP += " SUBSTRING(SB9.B9_COD,1,1) <> 'R' AND "
      cQryMP += " SB9.B9_LOCAL IN "+FormatIn(cAlmoxMP,",")+" AND "
      cQryMP += " SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND "               
      cQryMP += " SB1.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB1.B1_COD = SB9.B9_COD AND " 
      cQryMP += " (SB1.B1_TIPO = 'MP')" // OR (SB1.B1_TIPO <> 'MP' AND SUBSTRING(SB1.B1_DESC,1,4) = 'SLIT'))"
      
      //cQryMP += " GROUP BY SUBSTRING(SB9.B9_DATA,1,6) "
      
      MemoWrite("C:\TEMP\MateriaPrima"+Alltrim(Str(nMes))+".SQL",cQryMP)
      
      TCQuery cQryMP NEW ALIAS "RMP"
      
      If nMes == 1
         TcSetField("RMP","QUANT","N",14,03)
         TcSetField("RMP","CUSTO","N",12,02)
      EndIf
      
      If nMes == 1
         DbSelectArea("RMP")
         nQtdFM1MEst := RMP->QUANT
//         Alert("Peguei o Valor nQtdFM1MEst "+Alltrim(Str(nQtdFM1MEst)))
         nVlrFM1MEst := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("RMP")
         nQtdFM2MEst := RMP->QUANT
         nVlrFM2MEst := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("RMP")
         nQtdFM3MEst := RMP->QUANT
         nVlrFM3MEst := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("RMP")
         nQtdFM4MEst := RMP->QUANT
         nVlrFM4MEst := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("RMP")
         nQtdFM5MEst := RMP->QUANT
         nVlrFM5MEst := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("RMP")
         nQtdFM6MEst := RMP->QUANT
         nVlrFM6MEst := RMP->CUSTO
         DbCloseArea()
      EndIf

   Next nMes


   /**************************
   *
   * Calculando Matéria Prima por Sub-Grupo
   *
   *****************************************/
   ProcRegua(6) //3)
   aFech1MPEst := {}
   aFech2MPEst := {}
   aFech3MPEst := {}   
   For nMes := 1 To 6 //3

      IncProc("Calc. Mat.Prima p/Subgrupo Ind. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryMP := " SELECT SUBSTRING(SB9.B9_DATA,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP,SUM(SB9.B9_QINI) AS QUANT, SUM(SB9.B9_QINI*SB1.B1_X_CST2) AS CUSTO "
      cQryMP += " FROM "
      cQryMP += RetSqlName('SB9') + " SB9, " 
      cQryMP += RetSqlName('SB1') + " SB1 "
      cQryMP += " WHERE SB9.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB9.B9_FILIAL = '"+xFilial("SB9")+"' AND "               
      
      If nMes == 1
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dDataDe))+"' AND " 
      ElseIf nMes == 2
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData02))+"' AND " 
      ElseIf nMes == 3
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData03))+"' AND " 
      ElseIf nMes == 4
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData04))+"' AND " 
      ElseIf nMes == 5
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData05))+"' AND " 
      ElseIf nMes == 6
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData06))+"' AND " 
      EndIf

      cQryMP += " SUBSTRING(SB9.B9_COD,1,1) <> 'R' AND "
      cQryMP += " SB9.B9_LOCAL IN "+FormatIn(cAlmoxMP,",")+" AND "
      cQryMP += " SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND "               
      cQryMP += " SB1.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB1.B1_COD = SB9.B9_COD AND " 
      cQryMP += " (SB1.B1_TIPO = 'MP')" // OR (SB1.B1_TIPO <> 'MP' AND SUBSTRING(SB1.B1_DESC,1,4) = 'SLIT'))"
      
      cQryMP += " GROUP BY SUBSTRING(SB9.B9_DATA,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) "
      
      MemoWrite("C:\TEMP\MateriaPrimaporSubGrupo"+Alltrim(Str(nMes))+".SQL",cQryMP)
      
      TCQuery cQryMP NEW ALIAS "RMP"
      
      If nMes == 1
         TcSetField("RMP","QUANT","N",14,03)
         TcSetField("RMP","CUSTO","N",12,02)
      EndIf
      
      If nMes == 1
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP      := RMP->GRUPOMP
            nQFM1MEst := RMP->QUANT
            //nVlrFM1MEst := RMP->CUSTO
            If aScan(aFech1MPEst,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFech1MPEst,{cGrpMP     ,0         ,nQFM1MEst  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,4)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP      := RMP->GRUPOMP
            nQFM2MEst := RMP->QUANT
            //nVlrFM1MEst := RMP->CUSTO
            If aScan(aFech2MPEst,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFech2MPEst,{cGrpMP     ,0         ,nQFM2MEst  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,4)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP      := RMP->GRUPOMP
            nQFM3MEst := RMP->QUANT
            //nVlrFM1MEst := RMP->CUSTO
            If aScan(aFech3MPEst,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFech3MPEst,{cGrpMP     ,0         ,nQFM3MEst  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,4)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP      := RMP->GRUPOMP
            nQFM4MEst := RMP->QUANT
            //nVlrFM1MEst := RMP->CUSTO
            If aScan(aFech4MPEst,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFech4MPEst,{cGrpMP     ,0         ,nQFM4MEst  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,4)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP      := RMP->GRUPOMP
            nQFM5MEst := RMP->QUANT
            //nVlrFM1MEst := RMP->CUSTO
            If aScan(aFech5MPEst,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFech5MPEst,{cGrpMP     ,0         ,nQFM5MEst  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,4)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP      := RMP->GRUPOMP
            nQFM6MEst := RMP->QUANT
            //nVlrFM1MEst := RMP->CUSTO
            If aScan(aFech6MPEst,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFech6MPEst,{cGrpMP     ,0         ,nQFM6MEst  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,4)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      EndIf

   Next nMes

   /**************************
   *
   * Calculando Matéria Prima(SLITER)
   *
   ***************************/
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3

      IncProc("Calc. Mat.Prima(Sliter) Ind. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryMP := " SELECT SUM(SB9.B9_QINI) AS QUANT, SUM(SB9.B9_QINI*SB1.B1_X_CST2) AS CUSTO "
      cQryMP += " FROM "
      cQryMP += RetSqlName('SB9') + " SB9, " 
      cQryMP += RetSqlName('SB1') + " SB1 "
      cQryMP += " WHERE SB9.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB9.B9_FILIAL = '"+xFilial("SB9")+"' AND "               
      
      If nMes == 1
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dDataDe))+"' AND " 
      ElseIf nMes == 2
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData02))+"' AND " 
      ElseIf nMes == 3
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData03))+"' AND " 
      ElseIf nMes == 4
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData04))+"' AND " 
      ElseIf nMes == 5
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData05))+"' AND " 
      ElseIf nMes == 6
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData06))+"' AND " 
      EndIf

      cQryMP += " SUBSTRING(SB9.B9_COD,1,1) <> 'R' AND "
      cQryMP += " SB9.B9_LOCAL IN "+FormatIn(cAlmoxMP,",")+" AND "
      cQryMP += " SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND "               
      cQryMP += " SB1.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB1.B1_COD = SB9.B9_COD AND " 
      //cQryMP += " (SB1.B1_TIPO <> 'MP' AND SUBSTRING(SB1.B1_DESC,1,4) = 'SLIT')"
      cQryMP += " (SB1.B1_GRUPO = '20')" //Novo Conceito - 2009
      
      //cQryMP += " GROUP BY SUBSTRING(SB9.B9_DATA,1,6) "
      
      MemoWrite("C:\TEMP\MatPrimaSlit"+Alltrim(Str(nMes))+".SQL",cQryMP)
      
      TCQuery cQryMP NEW ALIAS "RMP"
      
      If nMes == 1
         TcSetField("RMP","QUANT","N",14,03)
         TcSetField("RMP","CUSTO","N",12,02)
      EndIf
      
      If nMes == 1
         DbSelectArea("RMP")
         nQt1MPSlit := RMP->QUANT
         nVl1MCSlit := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("RMP")
         nQt2MPSlit := RMP->QUANT
         nVl2MCSlit := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("RMP")
         nQt3MPSlit := RMP->QUANT
         nVl3MCSlit := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("RMP")
         nQt4MPSlit := RMP->QUANT
         nVl4MCSlit := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("RMP")
         nQt5MPSlit := RMP->QUANT
         nVl5MCSlit := RMP->CUSTO
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("RMP")
         nQt6MPSlit := RMP->QUANT
         nVl6MCSlit := RMP->CUSTO
         DbCloseArea()
      EndIf

   Next nMes


   /**************************
   *
   * Calculando Matéria Prima(SLITER) por Subgrupo
   *
   ************************************************/
   
   ProcRegua(6)
   
   For nMes := 1 To 6

      IncProc("Calc.Mat.Prima(Sliter) p/Subgrupo Ind. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryMP := " SELECT SUBSTRING(SB9.B9_DATA,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP,SUM(SB9.B9_QINI) AS QUANT, SUM(SB9.B9_QINI*SB1.B1_X_CST2) AS CUSTO "
      cQryMP += " FROM "
      cQryMP += RetSqlName('SB9') + " SB9, " 
      cQryMP += RetSqlName('SB1') + " SB1 "
      cQryMP += " WHERE SB9.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB9.B9_FILIAL = '"+xFilial("SB9")+"' AND "               
      
      If nMes == 1
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dDataDe))+"' AND " 
      ElseIf nMes == 2
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData02))+"' AND " 
      ElseIf nMes == 3
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData03))+"' AND " 
      ElseIf nMes == 4
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData04))+"' AND " 
      ElseIf nMes == 5
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData05))+"' AND " 
      ElseIf nMes == 6
         cQryMP += " SB9.B9_DATA = '"+DTOS(LastDay(dData06))+"' AND " 
      EndIf

      cQryMP += " SUBSTRING(SB9.B9_COD,1,1) <> 'R' AND "
      cQryMP += " SB9.B9_LOCAL IN "+FormatIn(cAlmoxMP,",")+" AND "
      cQryMP += " SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND "               
      cQryMP += " SB1.D_E_L_E_T_ <> '*' AND "
      cQryMP += " SB1.B1_COD = SB9.B9_COD AND " 
      //cQryMP += " (SB1.B1_TIPO <> 'MP' AND SUBSTRING(SB1.B1_DESC,1,4) = 'SLIT')"
      cQryMP += " (SB1.B1_GRUPO = '20')" //Novo Conceito - 2009
      
      cQryMP += " GROUP BY SUBSTRING(SB9.B9_DATA,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1) "
      
      MemoWrite("C:\TEMP\MatPrimaSlitSubGrupo"+Alltrim(Str(nMes))+".SQL",cQryMP)
      
      TCQuery cQryMP NEW ALIAS "RMP"
      
      If nMes == 1
         TcSetField("RMP","QUANT","N",14,03)
         TcSetField("RMP","CUSTO","N",12,02)
      EndIf
      
      If nMes == 1
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP     := RMP->GRUPOMP
            nQ1MPSlt := RMP->QUANT
            //nVl1MCSlit := RMP->CUSTO
            If aScan(aFch1MPSlt,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFch1MPSlt,{cGrpMP     ,0         ,nQ1MPSlt  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,5)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP     := RMP->GRUPOMP
            nQ2MPSlt := RMP->QUANT
            //nVl1MCSlit := RMP->CUSTO
            If aScan(aFch2MPSlt,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFch2MPSlt,{cGrpMP     ,0         ,nQ2MPSlt  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,5)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP     := RMP->GRUPOMP
            nQ3MPSlt := RMP->QUANT
            //nVl1MCSlit := RMP->CUSTO
            If aScan(aFch3MPSlt,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFch3MPSlt,{cGrpMP     ,0         ,nQ3MPSlt  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,5)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP     := RMP->GRUPOMP
            nQ4MPSlt := RMP->QUANT
            //nVl1MCSlit := RMP->CUSTO
            If aScan(aFch4MPSlt,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFch4MPSlt,{cGrpMP     ,0         ,nQ4MPSlt  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,5)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP     := RMP->GRUPOMP
            nQ5MPSlt := RMP->QUANT
            //nVl1MCSlit := RMP->CUSTO
            If aScan(aFch5MPSlt,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFch5MPSlt,{cGrpMP     ,0         ,nQ5MPSlt  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,5)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("RMP")
         While !Eof()
            cGrpMP     := RMP->GRUPOMP
            nQ6MPSlt := RMP->QUANT
            //nVl1MCSlit := RMP->CUSTO
            If aScan(aFch6MPSlt,{|x| x[1] == cGrpMP}) == 0
               aAdd(aFch6MPSlt,{cGrpMP     ,0         ,nQ6MPSlt  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,5)
            EndIf
            DbSelectArea("RMP")
            DbSkip()
         EndDo
         DbSelectArea("RMP")
         DbCloseArea()
      EndIf

   Next nMes
      
   /****************************
   *
   * Calculando Produto Acabado
   *
   ****************************/
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Prod.Acab. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryPA := " SELECT SUM(SB9.B9_QINI) as QUANTPA, SUM(SB9.B9_QINI*SB1.B1_X_CST2) AS CUSTOPA "
      cQryPA += " FROM "
      cQryPA += RetSqlName('SB9') + " SB9,"+RetSQLName("SB1")+" SB1"
      cQryPA += " WHERE SB9.D_E_L_E_T_ <> '*'  "
      cQryPA += " AND SB1.D_E_L_E_T_ <> '*'  "
      cQryPA += " AND SB9.B9_FILIAL = '"+xFilial("SB9")+"'
      cQryPA += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'
      cQryPA += " AND SB9.B9_COD = SB1.B1_COD"
      If nMes == 1
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dDataDe))+"' " 
      ElseIf nMes == 2
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData02))+"' " 
      ElseIf nMes == 3
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData03))+"' " 
      ElseIf nMes == 4
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData04))+"' " 
      ElseIf nMes == 5
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData05))+"' " 
      ElseIf nMes == 6
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData06))+"' " 
      EndIf
      cQryPA += " AND SB9.B9_LOCAL IN "+FormatIn(cAlmoxPA,",")+" "
      cQryPA += " AND SB1.B1_TIPO = 'PA'"
      //cQryPA += " AND SB1.B1_GRUPO = ''"
      
      /*
      cQryPA += " GROUP BY SUBSTRING(SB9.B9_DATA,1,6) "
      cQryPA += " ORDER BY SUBSTRING(SB9.B9_DATA,1,6) ASC "   
      */
      
      MemoWrite("C:\TEMP\ProdAcabado"+Alltrim(Str(nMes))+".SQL",cQryPA)
      
      TCQuery cQryPA NEW ALIAS "TCPA"
      
      If nMes == 1
         DbSelectArea("TCPA")
         nQt1PAM := TCPA->QUANTPA
         nCs1PAM := TCPA->CUSTOPA
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TCPA")
         nQt2PAM := TCPA->QUANTPA
         nCs2PAM := TCPA->CUSTOPA
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TCPA")
         nQt3PAM := TCPA->QUANTPA
         nCs3PAM := TCPA->CUSTOPA
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TCPA")
         nQt4PAM := TCPA->QUANTPA
         nCs4PAM := TCPA->CUSTOPA
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TCPA")
         nQt5PAM := TCPA->QUANTPA
         nCs5PAM := TCPA->CUSTOPA
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TCPA")
         nQt6PAM := TCPA->QUANTPA
         nCs6PAM := TCPA->CUSTOPA
         DbCloseArea()
      EndIf
      
   Next nMes

   /****************************
   * Novo 2009
   * Calculando Produto Acabado por Matéria Prima
   *
   ***********************************************/
   ProcRegua(6)
   
   a1MPAMP := {}   
   a2MPAMP := {}
   a3MPAMP := {}

   a4MPAMP := {}   
   a5MPAMP := {}
   a6MPAMP := {}
      
   For nMes := 1 To 6
   
      IncProc("Calc. Prod.Acab. p/Mat.Prima Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryPA := " SELECT SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP,SUM(SB9.B9_QINI) as QUANTPA, SUM(SB9.B9_QINI*SB1.B1_X_CST2) AS CUSTOPA "
      cQryPA += " FROM "
      cQryPA += RetSqlName('SB9') + " SB9,"+RetSQLName("SB1")+" SB1"
      cQryPA += " WHERE SB9.D_E_L_E_T_ <> '*'  "
      cQryPA += " AND SB1.D_E_L_E_T_ <> '*'  "
      cQryPA += " AND SB9.B9_FILIAL = '"+xFilial("SB9")+"'
      cQryPA += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'
      cQryPA += " AND SB9.B9_COD = SB1.B1_COD"
      If nMes == 1
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dDataDe))+"' " 
      ElseIf nMes == 2
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData02))+"' " 
      ElseIf nMes == 3
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData03))+"' " 
      ElseIf nMes == 4
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData04))+"' " 
      ElseIf nMes == 5
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData05))+"' " 
      ElseIf nMes == 6
         cQryPA += " AND SB9.B9_DATA = '"+DTOS(LastDay(dData06))+"' " 
      EndIf
      cQryPA += " AND SB9.B9_LOCAL IN "+FormatIn(cAlmoxPA,",")+" "
      cQryPA += " AND SB1.B1_TIPO = 'PA'"
      //cQryPA += " AND SB1.B1_GRUPO = ''"
      
      cQryPA += " GROUP BY SUBSTRING(SB1.B1_SUBGPO,1,1) " //Novo 2009
      /*
      cQryPA += " GROUP BY SUBSTRING(SB9.B9_DATA,1,6) "
      cQryPA += " ORDER BY SUBSTRING(SB9.B9_DATA,1,6) ASC "   
      */
      
      MemoWrite("C:\TEMP\ProdAcabadoporMatPrima"+Alltrim(Str(nMes))+".SQL",cQryPA)
      
      TCQuery cQryPA NEW ALIAS "TCPA"
      
      If nMes == 1
         DbSelectArea("TCPA")
         While !Eof()
            cGrpMP  := TCPA->GRUPOMP
            nXQt1PAM := TCPA->QUANTPA
            //nCs1PAM := TCPA->CUSTOPA
            If aScan(a1MPAMP,{|x| x[1] == cGrpMP}) == 0
               aAdd(a1MPAMP,{cGrpMP     ,0         ,nXQt1PAM  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,6)
            EndIf
            DbSelectArea("TCPA")
            DbSkip()
         EndDo
         DbSelectArea("TCPA")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TCPA")
         While !Eof()
            cGrpMP  := TCPA->GRUPOMP
            nXQt2PAM := TCPA->QUANTPA
            //nCs1PAM := TCPA->CUSTOPA
            If aScan(a2MPAMP,{|x| x[1] == cGrpMP}) == 0
               aAdd(a2MPAMP,{cGrpMP     ,0         ,nXQt2PAM  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,6)
            EndIf
            DbSelectArea("TCPA")
            DbSkip()
         EndDo
         DbSelectArea("TCPA")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TCPA")
         While !Eof()
            cGrpMP  := TCPA->GRUPOMP
            nXQt3PAM := TCPA->QUANTPA
            //nCs1PAM := TCPA->CUSTOPA
            If aScan(a3MPAMP,{|x| x[1] == cGrpMP}) == 0
               aAdd(a3MPAMP,{cGrpMP     ,0         ,nXQt3PAM  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,6)
            EndIf
            DbSelectArea("TCPA")
            DbSkip()
         EndDo
         DbSelectArea("TCPA")
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TCPA")
         While !Eof()
            cGrpMP  := TCPA->GRUPOMP
            nXQt4PAM := TCPA->QUANTPA
            //nCs1PAM := TCPA->CUSTOPA
            If aScan(a4MPAMP,{|x| x[1] == cGrpMP}) == 0
               aAdd(a4MPAMP,{cGrpMP     ,0         ,nXQt4PAM  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,6)
            EndIf
            DbSelectArea("TCPA")
            DbSkip()
         EndDo
         DbSelectArea("TCPA")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TCPA")
         While !Eof()
            cGrpMP  := TCPA->GRUPOMP
            nXQt5PAM := TCPA->QUANTPA
            //nCs1PAM := TCPA->CUSTOPA
            If aScan(a5MPAMP,{|x| x[1] == cGrpMP}) == 0
               aAdd(a5MPAMP,{cGrpMP     ,0         ,nXQt5PAM  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,6)
            EndIf
            DbSelectArea("TCPA")
            DbSkip()
         EndDo
         DbSelectArea("TCPA")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TCPA")
         While !Eof()
            cGrpMP  := TCPA->GRUPOMP
            nXQt6PAM := TCPA->QUANTPA
            //nCs1PAM := TCPA->CUSTOPA
            If aScan(a6MPAMP,{|x| x[1] == cGrpMP}) == 0
               aAdd(a6MPAMP,{cGrpMP     ,0         ,nXQt6PAM  ,0,0,0,0})
               fClcMPCmp(cGrpMP,nMes,6)
            EndIf
            DbSelectArea("TCPA")
            DbSkip()
         EndDo
         DbSelectArea("TCPA")
         DbCloseArea()
      EndIf
      
   Next nMes
   

   /**************************
   * Calculando PRODUTIVIDADE / Quantidade de Horas Trbalhadas
   **************************/
   ProcRegua(6) //3)
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Produtividade, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT RD_DATARQ , SUM(RD_HORAS) AS TOTALPRO FROM " 
      cQuery += RetSqlName('SRD') 
      cQuery += " WHERE "
      
      If nMes == 1
         cQuery += " SUBSTRING(RD_DATARQ,1,6) = '" + SUBSTR(DTOS(dDataDe),1,6) +"' "
      ElseIf nMes == 2
         cQuery += " SUBSTRING(RD_DATARQ,1,6) = '" + SUBSTR(DTOS(dData02),1,6) +"' "
      ElseIf nMes == 3
         cQuery += " SUBSTRING(RD_DATARQ,1,6) = '" + SUBSTR(DTOS(dData03),1,6) +"' "
      ElseIf nMes == 4
         cQuery += " SUBSTRING(RD_DATARQ,1,6) = '" + SUBSTR(DTOS(dData04),1,6) +"' "         
      ElseIf nMes == 5
         cQuery += " SUBSTRING(RD_DATARQ,1,6) = '" + SUBSTR(DTOS(dData05),1,6) +"' "
      ElseIf nMes == 6
         cQuery += " SUBSTRING(RD_DATARQ,1,6) = '" + SUBSTR(DTOS(dData06),1,6) +"' "
      EndIf
      
      //cQuery += " AND RD_CC BETWEEN '12301' AND '12322' " 
      cQuery += " AND RD_CC BETWEEN '11103011' AND '111030152'" //2009
      //cQuery += " AND RD_PD IN ('002','031','033','034','036') " 
      cQuery += " AND RD_PD IN ('001','002','007','008','009','010','011','012','013')"
      cQuery += " AND RD_FILIAL = '"+xFilial("SRD")+"'"
      cQuery += " GROUP BY RD_DATARQ " 
      cQuery += " ORDER BY RD_DATARQ ASC" 
      
      MemoWrite("C:\TEMP\Produtividade"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      
      TCQuery cQuery NEW ALIAS "PRVD"
      
      If nMes == 1
         DbSelectArea("PRVD")
         nProvd1M := PRVD->TOTALPRO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("PRVD")
         nProvd2M := PRVD->TOTALPRO
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("PRVD")
         nProvd3M := PRVD->TOTALPRO
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("PRVD")
         nProvd4M := PRVD->TOTALPRO
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("PRVD")
         nProvd5M := PRVD->TOTALPRO
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("PRVD")
         nProvd6M := PRVD->TOTALPRO
         DbCloseArea()
      EndIf
      
   Next nMes
   
   /***************************
   *
   * Custo de Produção
   *
   ***************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Custo Produção, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLCUSPROD "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cCUSTPROD,",")
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      TCQuery cQuery NEW ALIAS "TCPR"
      
      If nMes == 1
         DbSelectArea("TCPR")
         nVlr1CusPro := TCPR->VLCUSPROD
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TCPR")
         nVlr2CusPro := TCPR->VLCUSPROD
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("TCPR")
         nVlr3CusPro := TCPR->VLCUSPROD
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("TCPR")
         nVlr4CusPro := TCPR->VLCUSPROD
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("TCPR")
         nVlr5CusPro := TCPR->VLCUSPROD
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("TCPR")
         nVlr6CusPro := TCPR->VLCUSPROD
         DbCloseArea()
      EndIf
      
   Next nMes
   
   /***************************
   *
   * Gastos Gerais Indústria
   *
   ***************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Gastos Gerais Ind. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS GGERAISIND "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cGASTGERIND,",")
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\GastosGeraisInd"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "GGIND"
      
      If nMes == 1
         DbSelectArea("GGIND")
         nVGG1MInd := GGIND->GGERAISIND
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("GGIND")
         nVGG2MInd := GGIND->GGERAISIND
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("GGIND")
         nVGG3MInd := GGIND->GGERAISIND
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("GGIND")
         nVGG4MInd := GGIND->GGERAISIND
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("GGIND")
         nVGG5MInd := GGIND->GGERAISIND
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("GGIND")
         nVGG6MInd := GGIND->GGERAISIND
         DbCloseArea()
      EndIf
      
   Next nMes
    


   /***************************
   *
   * DESPESAS FINANCEIRAS IMPORTAÇÃO
   *
   ***************************/
   
   ProcRegua(54) //27)
   
   For nMes := 1 To 54 //27
   
      IncProc("Calc.Desp.Financ.Import. Proc: "+Alltrim(Str(nMes))+" / 54")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS nDSPIMPFin "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      If nMes <= 6 
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFINIMP,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFLAT,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtLIBOR,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtBANQUE,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtDISCREP,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIRIMPORT,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIOFIMP,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtHPTREG,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMNTEST,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\DespFinanceiraImportacao"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "DSPFI"

      If nMes >= 1 .And. nMEs <= 6 //3
	      If nMes == 1
	         DbSelectArea("DSPFI")
	         nFIN1IMP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 2
	         DbSelectArea("DSPFI")
	         nFIN2IMP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 3
	         DbSelectArea("DSPFI")
	         nFIN3IMP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 4
	         DbSelectArea("DSPFI")
	         nFIN4IMP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 5
	         DbSelectArea("DSPFI")
	         nFIN5IMP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 6
	         DbSelectArea("DSPFI")
	         nFIN6IMP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 7 .And. nMEs <= 12 //6
	      If nMes == 7 //4
	         DbSelectArea("DSPFI")
	         n1FLAT := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 8 //5
	         DbSelectArea("DSPFI")
	         n2FLAT := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 9 //6
	         DbSelectArea("DSPFI")
	         n3FLAT := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 10
	         DbSelectArea("DSPFI")
	         n4FLAT := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 11
	         DbSelectArea("DSPFI")
	         n5FLAT := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 12
	         DbSelectArea("DSPFI")
	         n6FLAT := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 13 .And. nMEs <= 18 //9
	      If nMes == 13 //7
	         DbSelectArea("DSPFI")
	         n1LIBOR := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 14 //8
	         DbSelectArea("DSPFI")
	         n2LIBOR := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 15 //9
	         DbSelectArea("DSPFI")
	         n3LIBOR := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 16
	         DbSelectArea("DSPFI")
	         n4LIBOR := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 17
	         DbSelectArea("DSPFI")
	         n5LIBOR := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 18
	         DbSelectArea("DSPFI")
	         n6LIBOR := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 19 .And. nMEs <= 24 //12
	      If nMes == 19 //10
	         DbSelectArea("DSPFI")
	         n1BANQUE := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 20 //11
	         DbSelectArea("DSPFI")
	         n2BANQUE := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 21 //12
	         DbSelectArea("DSPFI")
	         n3BANQUE := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 22
	         DbSelectArea("DSPFI")
	         n4BANQUE := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 23
	         DbSelectArea("DSPFI")
	         n5BANQUE := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 24
	         DbSelectArea("DSPFI")
	         n6BANQUE := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 25 .And. nMEs <= 30 //15
	      If nMes == 25 //13
	         DbSelectArea("DSPFI")
	         n1DISCREP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 26 //14
	         DbSelectArea("DSPFI")
	         n2DISCREP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 27 //15
	         DbSelectArea("DSPFI")
	         n3DISCREP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 28
	         DbSelectArea("DSPFI")
	         n4DISCREP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 29
	         DbSelectArea("DSPFI")
	         n5DISCREP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 30
	         DbSelectArea("DSPFI")
	         n6DISCREP := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 31 .And. nMEs <= 36 //18
	      If nMes == 31 //16
	         DbSelectArea("DSPFI")
	         n1IRImpor := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 32 //17
	         DbSelectArea("DSPFI")
	         n2IRImpor := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 33 //18
	         DbSelectArea("DSPFI")
	         n3IRImpor := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 34
	         DbSelectArea("DSPFI")
	         n4IRImpor := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 35
	         DbSelectArea("DSPFI")
	         n5IRImpor := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 36
	         DbSelectArea("DSPFI")
	         n6IRImpor := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 37 .And. nMEs <= 42 //21
	      If nMes == 37 //19
	         DbSelectArea("DSPFI")
	         n1OFImp := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 38 //20
	         DbSelectArea("DSPFI")
	         n2OFImp := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 39 //21
	         DbSelectArea("DSPFI")
	         n3OFImp := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 40
	         DbSelectArea("DSPFI")
	         n4OFImp := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 41
	         DbSelectArea("DSPFI")
	         n5OFImp := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 42
	         DbSelectArea("DSPFI")
	         n6OFImp := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 43 .And. nMEs <= 48 //24
	      If nMes == 43 //22
	         DbSelectArea("DSPFI")
	         n1HptReg := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 44 //23
	         DbSelectArea("DSPFI")
	         n2HptReg := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 45 //24
	         DbSelectArea("DSPFI")
	         n3HptReg := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 46
	         DbSelectArea("DSPFI")
	         n4HptReg := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 47
	         DbSelectArea("DSPFI")
	         n5HptReg := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 48
	         DbSelectArea("DSPFI")
	         n6HptReg := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 49 .And. nMEs <= 54 //27
	      If nMes == 49 //25
	         DbSelectArea("DSPFI")
	         n1MntEst := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMes == 50 //26
	         DbSelectArea("DSPFI")
	         n2MntEst := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 51 //27
	         DbSelectArea("DSPFI")
	         n3MntEst := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 52
	         DbSelectArea("DSPFI")
	         n4MntEst := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 53
	         DbSelectArea("DSPFI")
	         n5MntEst := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      ElseIf nMEs == 54
	         DbSelectArea("DSPFI")
	         n6MntEst := DSPFI->nDSPIMPFin
	         DbCloseArea()
	      EndIf
      EndIf  
      
   Next nMes
   
   /***************************
   *
   * IMPOSTOS - Rateios dos Impostos
   *
   ***************************/
   
   ProcRegua(54) //27)
   
   For nMes := 1 To 54 //27
   
      IncProc("Calc.Impostos Importação. Proc: "+Alltrim(Str(nMes))+" / 54")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS nVlsImpst "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto 
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13  .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14  .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15  .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      If nMes <= 6 //3 
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtICMIMOB,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtICMS1,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIPI,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtPIS,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtCOFI,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtCSLL,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIRPJ,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIRRF,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtII,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\Impostos"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "DSIPT"

      If nMes >= 1 .And. nMEs <= 6 //3
	      If nMes == 1
	         DbSelectArea("DSIPT")
	         n1ICMSImob := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 2
	         DbSelectArea("DSIPT")
	         n2ICMSImob := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 3
	         DbSelectArea("DSIPT")
	         n3ICMSImob := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 4
	         DbSelectArea("DSIPT")
	         n4ICMSImob := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 5
	         DbSelectArea("DSIPT")
	         n5ICMSImob := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 6
	         DbSelectArea("DSIPT")
	         n6ICMSImob := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 7 .And. nMEs <= 12 //6
	      If nMes == 7 //4
	         DbSelectArea("DSIPT")
	         n1ICMPuro := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 8 //5
	         DbSelectArea("DSIPT")
	         n2ICMPuro := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 9 //6
	         DbSelectArea("DSIPT")
	         n3ICMPuro := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 10
	         DbSelectArea("DSIPT")
	         n4ICMPuro := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 11
	         DbSelectArea("DSIPT")
	         n5ICMPuro := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 12
	         DbSelectArea("DSIPT")
	         n5ICMPuro := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 13 .And. nMEs <= 18 //9
	      If nMes == 13 //7
	         DbSelectArea("DSIPT")
	         n1IPISo := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 14 //8
	         DbSelectArea("DSIPT")
	         n2IPISo := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 15 //9
	         DbSelectArea("DSIPT")
	         n3IPISo := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 16
	         DbSelectArea("DSIPT")
	         n4IPISo := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 17
	         DbSelectArea("DSIPT")
	         n5IPISo := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 18
	         DbSelectArea("DSIPT")
	         n6IPISo := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 19 .And. nMEs <= 24 //12
	      If nMes == 19 //10
	         DbSelectArea("DSIPT")
	         n1PISUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 20 //11
	         DbSelectArea("DSIPT")
	         n2PISUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 21 //12
	         DbSelectArea("DSIPT")
	         n3PISUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 22
	         DbSelectArea("DSIPT")
	         n4PISUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 23
	         DbSelectArea("DSIPT")
	         n5PISUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 24
	         DbSelectArea("DSIPT")
	         n6PISUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 25 .And. nMEs <= 30 //15
	      If nMes == 25 //13
	         DbSelectArea("DSIPT")
	         n1COFUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 26 //14
	         DbSelectArea("DSIPT")
	         n2COFUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 27 //15
	         DbSelectArea("DSIPT")
	         n3COFUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 28
	         DbSelectArea("DSIPT")
	         n4COFUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 29
	         DbSelectArea("DSIPT")
	         n5COFUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 30
	         DbSelectArea("DSIPT")
	         n6COFUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 31 .And. nMEs <= 36 //18
	      If nMes == 31 //16
	         DbSelectArea("DSIPT")
	         n1CSLUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 32 //17
	         DbSelectArea("DSIPT")
	         n2CSLUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 33 //18
	         DbSelectArea("DSIPT")
	         n3CSLUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 34
	         DbSelectArea("DSIPT")
	         n4CSLUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 35
	         DbSelectArea("DSIPT")
	         n5CSLUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 36
	         DbSelectArea("DSIPT")
	         n6CSLUnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 37 .And. nMEs <= 42 //21
	      If nMes == 37 //19
	         DbSelectArea("DSIPT")
	         n1IRPJnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 38 //20
	         DbSelectArea("DSIPT")
	         n2IRPJnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 39 //21
	         DbSelectArea("DSIPT")
	         n3IRPJnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 40
	         DbSelectArea("DSIPT")
	         n4IRPJnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 41
	         DbSelectArea("DSIPT")
	         n5IRPJnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 42
	         DbSelectArea("DSIPT")
	         n6IRPJnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 43 .And. nMEs <= 48 //24
	      If nMes == 43 //22
	         DbSelectArea("DSIPT")
	         n1IRPFnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 44 //23
	         DbSelectArea("DSIPT")
	         n2IRPFnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 45 //24
	         DbSelectArea("DSIPT")
	         n3IRPFnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 46
	         DbSelectArea("DSIPT")
	         n4IRPFnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 47
	         DbSelectArea("DSIPT")
	         n5IRPFnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 48
	         DbSelectArea("DSIPT")
	         n6IRPFnk := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      ElseIf nMes >= 49 .And. nMEs <= 54 //27
	      If nMes == 49 //25
	         DbSelectArea("DSIPT")
	         n1IINum := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMes == 50 //26
	         DbSelectArea("DSIPT")
	         n2IINum := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 51 //27
	         DbSelectArea("DSIPT")
	         n3IINum := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 52
	         DbSelectArea("DSIPT")
	         n4IINum := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 53
	         DbSelectArea("DSIPT")
	         n5IINum := DSIPT->nVlsImpst
	         DbCloseArea()
	      ElseIf nMEs == 54
	         DbSelectArea("DSIPT")
	         n6IINum := DSIPT->nVlsImpst
	         DbCloseArea()
	      EndIf
      EndIf  
      
   Next nMes
   

   /***************************
   *
   * Imobilizado Total      
   *
   ***************************/
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Imobilizado Tot. Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLIMOBTOT "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto 
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cImobTotal,",")
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "VIMO"
      
      If nMes == 1
         DbSelectArea("VIMO")
         nVImob1MTt := VIMO->VLIMOBTOT
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("VIMO")
         nVImob2MTt := VIMO->VLIMOBTOT
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("VIMO")
         nVImob3MTt := VIMO->VLIMOBTOT
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("VIMO")
         nVImob4MTt := VIMO->VLIMOBTOT
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("VIMO")
         nVImob5MTt := VIMO->VLIMOBTOT
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("VIMO")
         nVImob6MTt := VIMO->VLIMOBTOT
         DbCloseArea()
      EndIf
      
   Next nMes

   /***************************
   *
   * Máquinas e Motores     
   *
   ***************************/
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Maq. e Motores, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLMAQMOT "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNatMaqMot,",")
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      MemoWrite("C:\TEMP\MaquinaeMotores"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "VMQMT"
      
      If nMes == 1
         DbSelectArea("VMQMT")
         nVMqMt1MTt := VMQMT->VLMAQMOT
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("VMQMT")
         nVMqMt2MTt := VMQMT->VLMAQMOT
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("VMQMT")
         nVMqMt3MTt := VMQMT->VLMAQMOT
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("VMQMT")
         nVMqMt4MTt := VMQMT->VLMAQMOT
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("VMQMT")
         nVMqMt5MTt := VMQMT->VLMAQMOT
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("VMQMT")
         nVMqMt6MTt := VMQMT->VLMAQMOT
         DbCloseArea()
      EndIf
      
   Next nMes

   /***************************
   *
   * Importado              
   *
   ***************************/
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Importados, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLIMPORT "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNatImpInd,",")
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "VLIMP"
      
      If nMes == 1
         DbSelectArea("VLIMP")
         nVlM1ImpInd := VLIMP->VLIMPORT
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("VLIMP")
         nVlM2ImpInd := VLIMP->VLIMPORT
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("VLIMP")
         nVlM3ImpInd := VLIMP->VLIMPORT
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("VLIMP")
         nVlM4ImpInd := VLIMP->VLIMPORT
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("VLIMP")
         nVlM5ImpInd := VLIMP->VLIMPORT
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("VLIMP")
         nVlM6ImpInd := VLIMP->VLIMPORT
         DbCloseArea()
      EndIf
      
   Next nMes

   /***************************
   *
   * Informatica            
   *
   ***************************/
   
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Informatica, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLINFO "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNatInfInd,",")
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "VLRINF"
      
      If nMes == 1
         DbSelectArea("VLRINF")
         nVlInfM1Ind := VLRINF->VLINFO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("VLRINF")
         nVlInfM2Ind := VLRINF->VLINFO
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("VLRINF")
         nVlInfM3Ind := VLRINF->VLINFO
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("VLRINF")
         nVlInfM4Ind := VLRINF->VLINFO
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("VLRINF")
         nVlInfM5Ind := VLRINF->VLINFO
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("VLRINF")
         nVlInfM6Ind := VLRINF->VLINFO
         DbCloseArea()
      EndIf
      
   Next nMes

   /***************************
   *
   * Moveis e Utensílios
   *
   ***************************/
   
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Mov. Utensílios, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLMOVUTENS "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf

      cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cMovUteInd,",")
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "VLMU"
      
      If nMes == 1
         DbSelectArea("VLMU")
         nVlMU1MInd := VLMU->VLMOVUTENS
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("VLMU")
         nVlMU2MInd := VLMU->VLMOVUTENS
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("VLMU")
         nVlMU3MInd := VLMU->VLMOVUTENS
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("VLMU")
         nVlMU4MInd := VLMU->VLMOVUTENS
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("VLMU")
         nVlMU5MInd := VLMU->VLMOVUTENS
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("VLMU")
         nVlMU6MInd := VLMU->VLMOVUTENS
         DbCloseArea()
      EndIf
      
   Next nMes

   /***************************
   *
   * INVESTIMENTOS (Total)
   *
   ***************************/
   
   ProcRegua(42)
   
   For nMes := 1 To 42 //  1 a  6 - Investimentos Total
                      //  7 a  12 - Empresas
                      //  13 a  18 - Máquinas
                      // 19 a 24 - Finame
                      // 25 a 30 - Leasing
                      // 31 a 36 - Benfeitorias
                      // 37 A 42 - ISO 9001 - 2000
   
      IncProc("Calc. Invest. Tot., Proc. "+Alltrim(Str(nMes))+" / 42")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLINVTOTAL "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      If nMes <= 6
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cInvTotInd,",")
      ElseIf nMes >= 7 .And. nMes <= 12
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNtEmpresas,",")
      ElseIf nMes >= 13 .And. nMes <= 18
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNtMaquinas,",")
      ElseIf nMes >= 19 .And. nMes <= 24
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNtFiname,",")
      ElseIf nMes >= 25 .And. nMes <= 30
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNtLeasing,",")
      ElseIf nMes >= 31 .And. nMes <= 36
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNtBenfeit,",")
      ElseIf nMes >= 37 .And. nMes <= 42
         cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNtISO92,",")
      EndIf
      
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      MemoWrite("C:\TEMP\Investimento"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "VITOT"
      
      If nMes <= 6
         If nMes == 1
            DbSelectArea("VITOT")
            nVl1MInvTt := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("VITOT")
            nVl2MInvTt := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("VITOT")
            nVl3MInvTt := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("VITOT")
            nVl4MInvTt := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("VITOT")
            nVl5MInvTt := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("VITOT")
            nVl6MInvTt := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12
         If nMes == 7
            DbSelectArea("VITOT")
            nVl1MEmpInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 8
            DbSelectArea("VITOT")
            nVl2MEmpInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 9
            DbSelectArea("VITOT")
            nVl3MEmpInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 10
            DbSelectArea("VITOT")
            nVl4MEmpInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 11
            DbSelectArea("VITOT")
            nVl5MEmpInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 12
            DbSelectArea("VITOT")
            nVl6MEmpInv := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18
         If nMes == 13
            DbSelectArea("VITOT")
            nVlMq1MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 14
            DbSelectArea("VITOT")
            nVlMq2MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 15
            DbSelectArea("VITOT")
            nVlMq3MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 16
            DbSelectArea("VITOT")
            nVlMq4MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 17
            DbSelectArea("VITOT")
            nVlMq5MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 18
            DbSelectArea("VITOT")
            nVlMq6MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 19 .And. nMes <= 24
         If nMes == 19
            DbSelectArea("VITOT")
            nVlFin1MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 20
            DbSelectArea("VITOT")
            nVlFin2MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 21
            DbSelectArea("VITOT")
            nVlFin3MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 22
            DbSelectArea("VITOT")
            nVlFin4MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 23
            DbSelectArea("VITOT")
            nVlFin5MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 24
            DbSelectArea("VITOT")
            nVlFin6MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 25 .And. nMes <= 30
         If nMes == 25
            DbSelectArea("VITOT")
            nVlLea1MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 26
            DbSelectArea("VITOT")
            nVlLea2MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 27
            DbSelectArea("VITOT")
            nVlLea3MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 28
            DbSelectArea("VITOT")
            nVlLea4MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 29
            DbSelectArea("VITOT")
            nVlLea5MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 30
            DbSelectArea("VITOT")
            nVlLea6MInv := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 31 .And. nMes <= 36
         If nMes == 31
            DbSelectArea("VITOT")
            nVlBenf1MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 32
            DbSelectArea("VITOT")
            nVlBenf2MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 33
            DbSelectArea("VITOT")
            nVlBenf3MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 34
            DbSelectArea("VITOT")
            nVlBenf4MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 35
            DbSelectArea("VITOT")
            nVlBenf5MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 36
            DbSelectArea("VITOT")
            nVlBenf6MI := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 37 .And. nMes <= 42
         If nMes == 37
            DbSelectArea("VITOT")
            nVlISO1MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMes == 38
            DbSelectArea("VITOT")
            nVlISO2MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 39
            DbSelectArea("VITOT")
            nVlISO3MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 40
            DbSelectArea("VITOT")
            nVlISO4MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 41
            DbSelectArea("VITOT")
            nVlISO4MI := VITOT->VLINVTOTAL
            DbCloseArea()
         ElseIf nMEs == 42
            DbSelectArea("VITOT")
            nVlISO6MI := VITOT->VLINVTOTAL
            DbCloseArea()
         EndIf      
      EndIf
      
   Next nMes

   /***************************
   *
   * MATERIA PRIMA (Total) - Indústria
   *
   ***************************/
   
   ProcRegua(60) //30)
   
   For nMes := 1 To 60 //30 // 1 a  3 - Materia Prima (Total)
                       // 4 a  6 - M. P. Nacional
                      //  7 a  9 - M. P. Importada
                      // 10 a 12 - Tributos Importação
                      // 13 a 15 - Despesas Importação
                      // 16 a 18 - Frete Importação
                      // 19 a 21 - AFRMM
                      // 22 a 24 - Operação Portuária
                      // 25 a 27 - Despesa Aduaneira
                      // 28 a 30 - Amazenagem
                      
      IncProc("Calc. Mat.Prima Ind., Proc. "+Alltrim(Str(nMes))+" / 60")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLMPTOTAL "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31  .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49 .Or. nMes == 55
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50 .Or. nMes == 56
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51 .Or. nMes == 57
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52 .Or. nMes == 58
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53 .Or. nMes == 59
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54 .Or. nMes == 60
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      If nMes <= 6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMPTotal,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtNacMP,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtImpMP,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtTrbImp,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtDespImp,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFrtImp,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtAFRMM,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtOpPort,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtAduaDesp,",")
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtARMAZ,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\MATERIA_PRIMA_Total_Industria.SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "VMPTT"
      
      If nMes <= 6
         If nMes == 1
            DbSelectArea("VMPTT")
            nMP1MVlTt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("VMPTT")
            nMP2MVlTt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("VMPTT")
            nMP3MVlTt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("VMPTT")
            nMP4MVlTt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("VMPTT")
            nMP5MVlTt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("VMPTT")
            nMP6MVlTt := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("VMPTT")
            nNacMP1MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("VMPTT")
            nNacMP2MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 9 //6
            DbSelectArea("VMPTT")
            nNacMP3MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 10
            DbSelectArea("VMPTT")
            nNacMP4MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 11
            DbSelectArea("VMPTT")
            nNacMP5MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 12
            DbSelectArea("VMPTT")
            nNacMP6MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("VMPTT")
            nImpMP1MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("VMPTT")
            nImpMP2MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 15 //9
            DbSelectArea("VMPTT")
            nImpMP3MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 16
            DbSelectArea("VMPTT")
            nImpMP4MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 17
            DbSelectArea("VMPTT")
            nImpMP5MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 18
            DbSelectArea("VMPTT")
            nImpMP6MVl := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            DbSelectArea("VMPTT")
            nTrbImp1MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 20 //11
            DbSelectArea("VMPTT")
            nTrbImp2MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 21 //12
            DbSelectArea("VMPTT")
            nTrbImp3MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 22
            DbSelectArea("VMPTT")
            nTrbImp4MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 23
            DbSelectArea("VMPTT")
            nTrbImp5MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 24
            DbSelectArea("VMPTT")
            nTrbImp6MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            DbSelectArea("VMPTT")
            nDspImp1MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 26 //14
            DbSelectArea("VMPTT")
            nDspImp2MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 27 //15
            DbSelectArea("VMPTT")
            nDspImp3MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 28
            DbSelectArea("VMPTT")
            nDspImp4MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 29
            DbSelectArea("VMPTT")
            nDspImp5MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 30
            DbSelectArea("VMPTT")
            nDspImp6MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         If nMes == 31 //16
            DbSelectArea("VMPTT")
            nFrtImp1MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 32 //17
            DbSelectArea("VMPTT")
            nFrtImp2MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 33 //18
            DbSelectArea("VMPTT")
            nFrtImp3MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 34
            DbSelectArea("VMPTT")
            nFrtImp4MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 35
            DbSelectArea("VMPTT")
            nFrtImp5MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 36
            DbSelectArea("VMPTT")
            nFrtImp6MMP := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         If nMes == 37 //19
            DbSelectArea("VMPTT")
            nNMP1AFRMM := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 38 //20
            DbSelectArea("VMPTT")
            nNMP2AFRMM := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 39 //21
            DbSelectArea("VMPTT")
            nNMP3AFRMM := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 40
            DbSelectArea("VMPTT")
            nNMP4AFRMM := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 41
            DbSelectArea("VMPTT")
            nNMP5AFRMM := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 42
            DbSelectArea("VMPTT")
            nNMP6AFRMM := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf            
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         If nMes == 43 //22
            DbSelectArea("VMPTT")
            nNMP1OpPrt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 44 //23
            DbSelectArea("VMPTT")
            nNMP2OpPrt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 45 //24
            DbSelectArea("VMPTT")
            nNMP3OpPrt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 46
            DbSelectArea("VMPTT")
            nNMP4OpPrt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 47
            DbSelectArea("VMPTT")
            nNMP5OpPrt := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 48
            DbSelectArea("VMPTT")
            nNMP6OpPrt := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf            
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         If nMes == 49 //25
            DbSelectArea("VMPTT")
            nNMP1DspAdu := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 50 //26
            DbSelectArea("VMPTT")
            nNMP2DspAdu := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 51 //27
            DbSelectArea("VMPTT")
            nNMP3DspAdu := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 52
            DbSelectArea("VMPTT")
            nNMP4DspAdu := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 53
            DbSelectArea("VMPTT")
            nNMP5DspAdu := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 54
            DbSelectArea("VMPTT")
            nNMP6DspAdu := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf            
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         If nMes == 55 //28
            DbSelectArea("VMPTT")
            n1Amazena := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 56 //29
            DbSelectArea("VMPTT")
            n2Amazena := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 57 //30
            DbSelectArea("VMPTT")
            n3Amazena := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 58
            DbSelectArea("VMPTT")
            n4Amazena := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 59
            DbSelectArea("VMPTT")
            n5Amazena := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMEs == 60
            DbSelectArea("VMPTT")
            n6Amazena := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf            
      EndIf
      
   Next nMes

   /***************************
   *
   * OUTRAS NATUREZAS - Indústria
   *
   ***************************/
   ProcRegua(150) //75)
   
   For nMes := 1 To 150 //75 // 1 a  3 - INSUMOS
                       // 4 a  6 - MÃO DE OBRA
                       // 7 a  9 -  * Desp. Fixa
                       //10 a 12 -  * Desp. Period.
                       //13 a 15 -  * Rescisões
                       //16 a 18 -  * Premiações
                      // 19 a 21 - BENEFICIAMENTO
                      // 22 a 24 - MANUTENÇÃO
                      // 25 a 27 - SERVIÇOS TERCEIRIZADOS
                      // 28 a 30 - EPI
                      // 31 a 33 - ENERGIA
                      // 33 a 36 - AGUA
                      // 37 a 39 - ALUGUEL
                      // 40 a 42 - CONSERV. PREDIO
                      // 43 a 45 - DESPESAS DE VIAGENS
                      // 46 a 48 - OUTRAS DESPESAS IND.
                      // 49 a 51 - OUTRAS NATUREZAS
                      // 52 a 54 - MÃO DE OBRA INDIRETA(* Desp. Fixa)
                      // 55 a 57 - MÃO DE OBRA INDIRETA(* Desp. Period.)
                      
      IncProc("Calc. Outras Naturezas, Proc. "+Alltrim(Str(nMes))+" / 150")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLOUTNTIMP "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49 .Or. nMes == 55 .Or. nMes == 61 .Or. nMes == 67 .Or. nMes == 73 .Or. nMes == 79 .Or. nMes == 85 .Or. nMes == 91 .Or. nMes == 97 .Or. nMes == 103  .Or. nMes == 109 .Or. nMes == 115 .Or. nMes == 121  .Or. nMes == 127 .Or. nMes == 133 .Or. nMes == 139 .Or. nMes == 145
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50 .Or. nMes == 56 .Or. nMes == 62 .Or. nMes == 68 .Or. nMes == 74 .Or. nMes == 80 .Or. nMes == 86 .Or. nMes == 92 .Or. nMes == 98 .Or. nMes == 104  .Or. nMes == 110 .Or. nMes == 116 .Or. nMes == 122 .Or. nMes == 128 .Or. nMes == 134 .Or. nMes == 140 .Or. nMes == 146
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51 .Or. nMes == 57 .Or. nMes == 63 .Or. nMes == 69 .Or. nMes == 75 .Or. nMes == 81 .Or. nMes == 87 .Or. nMes == 93 .Or. nMes == 99 .Or. nMes == 105  .Or. nMes == 111 .Or. nMes == 117 .Or. nMes == 123 .Or. nMes == 129 .Or. nMes == 135 .Or. nMes == 141 .Or. nMes == 147
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52 .Or. nMes == 58 .Or. nMes == 64 .Or. nMes == 70 .Or. nMes == 76 .Or. nMes == 82 .Or. nMes == 88 .Or. nMes == 94 .Or. nMes == 100 .Or. nMes == 106  .Or. nMes == 112 .Or. nMes == 118 .Or. nMes == 124 .Or. nMes == 130 .Or. nMes == 136 .Or. nMes == 142 .Or. nMes == 148
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53 .Or. nMes == 59 .Or. nMes == 65 .Or. nMes == 71 .Or. nMes == 77 .Or. nMes == 83 .Or. nMes == 89 .Or. nMes == 95 .Or. nMes == 101 .Or. nMes == 107  .Or. nMes == 113 .Or. nMes == 119 .Or. nMes == 125 .Or. nMes == 131 .Or. nMes == 137 .Or. nMes == 143 .Or. nMes == 149
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54 .Or. nMes == 60 .Or. nMes == 66 .Or. nMes == 72 .Or. nMes == 78 .Or. nMes == 84 .Or. nMes == 90 .Or. nMes == 96 .Or. nMes == 102 .Or. nMes == 108  .Or. nMes == 114 .Or. nMes == 120 .Or. nMes == 126 .Or. nMes == 132 .Or. nMes == 138 .Or. nMes == 144 .Or. nMes == 150
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      If nMes <= 6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtInsumos,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMaoObDInd,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMODFInd,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMODPInd,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtRecisDInd,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtPremDInd,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtBenefInd,",")      
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtELManuten,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtSerTerInd,",")
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtEPIInd,",")
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtEnergInd,",")
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtAguaInd,",")
      ElseIf nMes >= 73 .And. nMes <= 78 //39
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtAlugInd,",")
      ElseIf nMes >= 79 .And. nMes <= 84 //42
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtCoPredInd,",")
      ElseIf nMes >= 85 .And. nMes <= 90 //45
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtDespViaIn,",")
      ElseIf nMes >= 91 .And. nMes <= 96 //48
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtOutDesInd,",")
      ElseIf nMes >= 97 .And. nMes <= 102 //51
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtOutNatInd,",")
      ElseIf nMes >= 103 .And. nMes <= 108 //54
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMOIFInd,",")
      ElseIf nMes >= 109 .And. nMes <= 114 //57
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMOIPInd,",")
      ElseIf nMes >= 115 .And. nMes <= 120 //60
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(DIIndcNtRecis,",")
      ElseIf nMes >= 121 .And. nMes <= 126 //63
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtPremDIInd,",")
      ElseIf nMes >= 127 .And. nMes <= 132 //66
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtEmbalag,",")
      ElseIf nMes >= 133 .And. nMes <= 138 //69
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFEManuten,",")
      ElseIf nMes >= 139 .And. nMes <= 144 //72
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMEManuten,",")
      ElseIf nMes >= 145 .And. nMes <= 150 //75
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtImpostInd,",") 
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      If nMes >= 19 .And. nMes <= 21 //15
         MemoWrite("C:\TEMP\OutrasDespInd_Recisoes"+Alltrim(Str(nMes))+".SQL",cQuery)
      ElseIf nMes >= 22 .And. nMes <= 24 //18
         MemoWrite("C:\TEMP\OutrasDespInd_Premiacoes"+Alltrim(Str(nMes))+".SQL",cQuery)
      ElseIf nMes >= 28 .And. nMes <= 30
         MemoWrite("C:\TEMP\Manutencao"+Alltrim(Str(nMes))+".SQL",cQuery)
      EndIf

      If nMes >= 55 .And. nMes <= 57
         MemoWrite("C:\TEMP\OutrasNaturezasInd"+Alltrim(Str(nMes))+".SQL",cQuery)
      EndIf
      
      If nMes >= 52 .And. nMes <= 54
         MemoWrite("C:\TEMP\OutrasDespInd"+Alltrim(Str(nMes))+".SQL",cQuery)
      EndIf
      
      TCQuery cQuery NEW ALIAS "ONIM"
      

      If nMes <= 6
         If nMes == 1
            DbSelectArea("ONIM")
            nInsVl1MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("ONIM")
            nInsVl2MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("ONIM")
            nInsVl3MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("ONIM")
            nInsVl4MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("ONIM")
            nInsVl5MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("ONIM")
            nInsVl6MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("ONIM")
            nDMOInd1MVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("ONIM")
            nDMOInd2MVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 9 //6
            DbSelectArea("ONIM")
            nDMOInd3MVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 10
            DbSelectArea("ONIM")
            nDMOInd4MVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 11
            DbSelectArea("ONIM")
            nDMOInd5MVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 12
            DbSelectArea("ONIM")
            nDMOInd6MVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("ONIM")
            nFixMOD1MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("ONIM")
            nFixMOD2MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 15 //9
            DbSelectArea("ONIM")
            nFixMOD3MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 16
            DbSelectArea("ONIM")
            nFixMOD4MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 17
            DbSelectArea("ONIM")
            nFixMOD5MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 18
            DbSelectArea("ONIM")
            nFixMOD6MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            DbSelectArea("ONIM")
            nPerMOD1MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 20 //11
            DbSelectArea("ONIM")
            nPerMOD2MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 21 //12
            DbSelectArea("ONIM")
            nPerMOD3MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 22
            DbSelectArea("ONIM")
            nPerMOD4MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 23
            DbSelectArea("ONIM")
            nPerMOD5MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 24
            DbSelectArea("ONIM")
            nPerMOD6MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            DbSelectArea("ONIM")
            nRes1MDIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 26 //14
            DbSelectArea("ONIM")
            nRes2MDIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 27 //15
            DbSelectArea("ONIM")
            nRes3MDIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 28
            DbSelectArea("ONIM")
            nRes4MDIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 29
            DbSelectArea("ONIM")
            nRes5MDIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 30
            DbSelectArea("ONIM")
            nRes6MDIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         If nMes == 31 //16
            DbSelectArea("ONIM")
            nPrm1DIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 32 //17
            DbSelectArea("ONIM")
            nPrm2DIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 33 //18
            DbSelectArea("ONIM")
            nPrm3DIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 34
            DbSelectArea("ONIM")
            nPrm4DIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 35
            DbSelectArea("ONIM")
            nPrm5DIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 36
            DbSelectArea("ONIM")
            nPrm6DIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         If nMes == 37 //19
            DbSelectArea("ONIM")
            nBnf1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 38 //20
            DbSelectArea("ONIM")
            nBnf2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 39 //21
            DbSelectArea("ONIM")
            nBnf3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 40
            DbSelectArea("ONIM")
            nBnf4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 41
            DbSelectArea("ONIM")
            nBnf5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 42
            DbSelectArea("ONIM")
            nBnf6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      //EndIf
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         If nMes == 43 //22
            DbSelectArea("ONIM")
            nManEL1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 44 //23
            DbSelectArea("ONIM")
            nManEL2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 45 //24
            DbSelectArea("ONIM")
            nManEL3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 46
            DbSelectArea("ONIM")
            nManEL4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 47
            DbSelectArea("ONIM")
            nManEL5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 48
            DbSelectArea("ONIM")
            nManEL6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf            
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         If nMes == 49 //25
            DbSelectArea("ONIM")
            nSTc1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 50 //26
            DbSelectArea("ONIM")
            nSTc2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 51 //27
            DbSelectArea("ONIM")
            nSTc3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 52
            DbSelectArea("ONIM")
            nSTc4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 53
            DbSelectArea("ONIM")
            nSTc5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 54
            DbSelectArea("ONIM")
            nSTc6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         If nMes == 55 //28
            DbSelectArea("ONIM")
            nEPI1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 56 //29
            DbSelectArea("ONIM")
            nEPI2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 57 //30
            DbSelectArea("ONIM")
            nEPI3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 58
            DbSelectArea("ONIM")
            nEPI4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 59
            DbSelectArea("ONIM")
            nEPI5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 60
            DbSelectArea("ONIM")
            nEPI6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         If nMes == 61 //31
            DbSelectArea("ONIM")
            nEner1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 62 //32
            DbSelectArea("ONIM")
            nEner2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 63 //33
            DbSelectArea("ONIM")
            nEner3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 64
            DbSelectArea("ONIM")
            nEner4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 65
            DbSelectArea("ONIM")
            nEner5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 66
            DbSelectArea("ONIM")
            nEner6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         If nMes == 67 //34
            DbSelectArea("ONIM")
            nAgua1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 68 //35
            DbSelectArea("ONIM")
            nAgua2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 69 //36
            DbSelectArea("ONIM")
            nAgua3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 70
            DbSelectArea("ONIM")
            nAgua4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 71
            DbSelectArea("ONIM")
            nAgua5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 72
            DbSelectArea("ONIM")
            nAgua6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 73 .And. nMes <= 78 //39
         If nMes == 73 //37
            DbSelectArea("ONIM")
            nAlg1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 74 //38
            DbSelectArea("ONIM")
            nAlg2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 75 //39
            DbSelectArea("ONIM")
            nAlg3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 76
            DbSelectArea("ONIM")
            nAlg4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 77
            DbSelectArea("ONIM")
            nAlg5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 78
            DbSelectArea("ONIM")
            nAlg6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 79 .And. nMes <= 84 //42
         If nMes == 79 //40
            DbSelectArea("ONIM")
            nCPr1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 80 //41
            DbSelectArea("ONIM")
            nCPr2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 81 //42
            DbSelectArea("ONIM")
            nCPr3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 82
            DbSelectArea("ONIM")
            nCPr4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 83
            DbSelectArea("ONIM")
            nCPr5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 84
            DbSelectArea("ONIM")
            nCPr6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 85 .And. nMes <= 90 //45
         If nMes == 85 //43
            DbSelectArea("ONIM")
            nDVg1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 86 //44
            DbSelectArea("ONIM")
            nDVg2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 87 //45
            DbSelectArea("ONIM")
            nDVg3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 88
            DbSelectArea("ONIM")
            nDVg4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 89
            DbSelectArea("ONIM")
            nDVg5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 90
            DbSelectArea("ONIM")
            nDVg6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 91 .And. nMes <= 96 //48
         If nMes == 91 //46
            DbSelectArea("ONIM")
            nODp1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 92 //47
            DbSelectArea("ONIM")
            nODp2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 93 //48
            DbSelectArea("ONIM")
            nODp3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 94
            DbSelectArea("ONIM")
            nODp4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 95
            DbSelectArea("ONIM")
            nODp5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 96
            DbSelectArea("ONIM")
            nODp6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 97 .And. nMes <= 102 //51
         If nMes == 97 //49
            DbSelectArea("ONIM")
            nONt1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 98 //50
            DbSelectArea("ONIM")
            nONt2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 99 //51
            DbSelectArea("ONIM")
            nONt3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 100
            DbSelectArea("ONIM")
            nONt4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 101
            DbSelectArea("ONIM")
            nONt5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 102
            DbSelectArea("ONIM")
            nONt6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 103 .And. nMes <= 108 //54
         If nMes == 103 //52
            DbSelectArea("ONIM")
            nFixMOI1MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 104 //53
            DbSelectArea("ONIM")
            nFixMOI2MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 105 //54
            DbSelectArea("ONIM")
            nFixMOI3MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 106
            DbSelectArea("ONIM")
            nFixMOI4MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 107
            DbSelectArea("ONIM")
            nFixMOI5MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 108
            DbSelectArea("ONIM")
            nFixMOI6MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 109 .And. nMes <= 114 //57
         If nMes == 109 //55
            DbSelectArea("ONIM")
            nPerMOI1MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 110 //56
            DbSelectArea("ONIM")
            nPerMOI2MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 111 //57
            DbSelectArea("ONIM")
            nPerMOI3MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 112
            DbSelectArea("ONIM")
            nPerMOI4MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 113
            DbSelectArea("ONIM")
            nPerMOI5MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 114
            DbSelectArea("ONIM")
            nPerMOI6MInd := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf
      ElseIf nMes >= 115 .And. nMes <= 120 //60
         If nMes == 115 //58
            DbSelectArea("ONIM")
            nRes1MIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 116 //59
            DbSelectArea("ONIM")
            nRes2MIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 117 //60
            DbSelectArea("ONIM")
            nRes3MIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 118
            DbSelectArea("ONIM")
            nRes4MIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 119
            DbSelectArea("ONIM")
            nRes5MIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 120
            DbSelectArea("ONIM")
            nRes6MIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 121 .And. nMes <= 126 //63
         If nMes == 121 //61
            DbSelectArea("ONIM")
            nPrm1DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 122 //62
            DbSelectArea("ONIM")
            nPrm2DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 123 //63
            DbSelectArea("ONIM")
            nPrm3DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 124
            DbSelectArea("ONIM")
            nPrm4DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 125
            DbSelectArea("ONIM")
            nPrm5DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 126
            DbSelectArea("ONIM")
            nPrm6DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf            
      ElseIf nMes >= 127 .And. nMes <= 132 //66
         If nMes == 127 //64
            DbSelectArea("ONIM")
            nEmb1DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 128 //65
            DbSelectArea("ONIM")
            nEmb2DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 129 //66
            DbSelectArea("ONIM")
            nEmb3DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 130
            DbSelectArea("ONIM")
            nEmb4DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 131
            DbSelectArea("ONIM")
            nEmb5DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 132
            DbSelectArea("ONIM")
            nEmb6DIIndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf                   
      ElseIf nMes >= 133 .And. nMes <= 138 //69
         If nMes == 133 //67
            DbSelectArea("ONIM")
            nManFE1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 134 //68
            DbSelectArea("ONIM")
            nManFE2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 135 //69
            DbSelectArea("ONIM")
            nManFE3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 136
            DbSelectArea("ONIM")
            nManFE4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 137
            DbSelectArea("ONIM")
            nManFE5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 138
            DbSelectArea("ONIM")
            nManFE6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf                  
      ElseIf nMes >= 139 .And. nMes <= 144 //72
         If nMes == 139 //70
            DbSelectArea("ONIM")
            nManME1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 140 //71
            DbSelectArea("ONIM")
            nManME2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 141 //72
            DbSelectArea("ONIM")
            nManME3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 142
            DbSelectArea("ONIM")
            nManME4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 143
            DbSelectArea("ONIM")
            nManME5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 144
            DbSelectArea("ONIM")
            nManME6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf                  
      ElseIf nMes >= 145 .And. nMes <= 150 //75
         If nMes == 145 //73
            DbSelectArea("ONIM")
            nImp1IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMes == 146 //74
            DbSelectArea("ONIM")
            nImp2IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 147 //75
            DbSelectArea("ONIM")
            nImp3IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 148
            DbSelectArea("ONIM")
            nImp4IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 149
            DbSelectArea("ONIM")
            nImp5IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         ElseIf nMEs == 150
            DbSelectArea("ONIM")
            nImp6IndVl := ONIM->VLOUTNTIMP
            DbCloseArea()
         EndIf                  
      EndIf


   Next nMes
   

   /****************************************
   *
   * Gastos Meta Orçamento Ind. (ORÇADO)
   *
   *****************************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Gastos Metas/Orc.Industria(Orçado), Proc. "+Alltrim(Str(nMes))+" / 6")
      
      If nMes == 1
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dDataDe),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VORCMTORIND "
      ElseIf nMes == 2
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData02),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VORCMTORIND "
      ElseIf nMes == 3
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData03),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VORCMTORIND "
      ElseIf nMes == 4
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData04),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VORCMTORIND "
      ElseIf nMes == 5
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData05),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VORCMTORIND "
      ElseIf nMes == 6
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData06),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VORCMTORIND "
      EndIf
      
      cQuery += " FROM " + RetSqlName("SE7")+" SE7 "
      
      If nMes == 1
         _xANO := ALLTRIM(STR(YEAR(dDataDe)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 2 
         _xANO := ALLTRIM(STR(YEAR(dData02)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 3 
         _xANO := ALLTRIM(STR(YEAR(dData03)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 4
         _xANO := ALLTRIM(STR(YEAR(dData04)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 5
         _xANO := ALLTRIM(STR(YEAR(dData05)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 6
         _xANO := ALLTRIM(STR(YEAR(dData06)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      EndIf
      
      cQuery += "  AND SE7.E7_FILIAL = '"+xFilial("SE7")+"'"
      cQuery += "  AND SE7.E7_NATUREZ IN "+FormatIn(cNtGstMtOrInd,",")
      cQuery += "  AND SE7.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\MtOrçadoIndustria"+Alltrim(Str(nMes))+".SQL",cQuery)
             
      TCQuery cQuery NEW ALIAS "OMOI"
      
      If nMes == 1
         DbSelectArea("OMOI")
         nInd1MMtOrc := OMOI->VORCMTORIND
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("OMOI")
         nInd2MMtOrc := OMOI->VORCMTORIND
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("OMOI")
         nInd3MMtOrc := OMOI->VORCMTORIND
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("OMOI")
         nInd4MMtOrc := OMOI->VORCMTORIND
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("OMOI")
         nInd5MMtOrc := OMOI->VORCMTORIND
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("OMOI")
         nInd6MMtOrc := OMOI->VORCMTORIND
         DbCloseArea()
      EndIf

   Next nMes


   /****************************************
   *
   * Gastos Meta Orçamento Ind. (REALIZADO)
   *
   *****************************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Gastos Metas/Orc.Industria(Realizado), Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VGSTMTORIND "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtGstMtOrInd,",")
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      TCQuery cQuery NEW ALIAS "GMOI"
      
      If nMes == 1
         DbSelectArea("GMOI")
         nGst1MtOrInd := GMOI->VGSTMTORIND
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("GMOI")
         nGst2MtOrInd := GMOI->VGSTMTORIND
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("GMOI")
         nGst3MtOrInd := GMOI->VGSTMTORIND
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("GMOI")
         nGst4MtOrInd := GMOI->VGSTMTORIND
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("GMOI")
         nGst5MtOrInd := GMOI->VGSTMTORIND
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("GMOI")
         nGst6MtOrInd := GMOI->VGSTMTORIND
         DbCloseArea()
      EndIf

   Next nMes
   
EndIf

If lAdmFin
   
   /***********************
   *
   * Pedidos na Trava (Total)
   *
   ***********************/
   
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc. Pedidos na Trava, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQrySC7 := " SELECT SUM(C7_TOTAL) AS VALOR FROM "
      cQrySC7 += RetSqlName("SC7")
      cQrySC7 += " WHERE D_E_L_E_T_ <> '*' "
      cQrySC7 += " AND C7_FILIAL = '"+xFilial("SC7")+"'"
      cQrySC7 += " AND C7_X_STAT = '1' "
      If nMes <= 3
         If nMes == 1
            cQrySC7 += " AND C7_EMISSAO = '"+Substr(DTOS(dDataDe),1,6)+"'" 
         ElseIf nMes == 2
            cQrySC7 += " AND C7_EMISSAO = '"+Substr(DTOS(dData02),1,6)+"'" 
         ElseIf nMes == 3
            cQrySC7 += " AND C7_EMISSAO = '"+Substr(DTOS(dData03),1,6)+"'" 
         EndIf
      ElseIf nMes >= 4
         If nMes == 4
            cQrySC7 += " AND C7_EMISSAO < '"+Substr(DTOS(dDataDe),1,6)+"'" 
         ElseIf nMes == 5
            cQrySC7 += " AND C7_EMISSAO < '"+Substr(DTOS(dData02),1,6)+"'" 
         ElseIf nMes == 6
            cQrySC7 += " AND C7_EMISSAO < '"+Substr(DTOS(dData03),1,6)+"'" 
         EndIf      
      EndIf
      
      MemoWrite("C:\TEMP\PedidosTrava"+Alltrim(Str(nMes))+".SQL",cQrySC7)
      
      TCQuery cQrySC7 NEW ALIAS "TPTRV"
      
      If nMes <= 3
         If nMes == 1
            DbSelectArea("TPTRV")
            nPdTrv1MVlr := TPTRV->VALOR
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TPTRV")
            nPdTrv2MVlr := TPTRV->VALOR
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("TPTRV")
            nPdTrv3MVlr := TPTRV->VALOR
            DbCloseArea()
         EndIf
      ElseIf nMes >= 4
         If nMes == 4
            DbSelectArea("TPTRV")
            nPdTrv1AntM := TPTRV->VALOR
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("TPTRV")
            nPdTrv2AntM := TPTRV->VALOR
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("TPTRV")
            nPdTrv3AntM := TPTRV->VALOR
            DbCloseArea()
         EndIf
      EndIf

   Next nMes 

   /***********************
   *
   * Títulos na Trava (Total)
   *
   ***********************/
   ProcRegua(6)
   
   For nMes := 1 To 6
      
      IncProc("Calc. Títulos na Trava, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryE2 := " SELECT SUM(E2_VALOR) AS VALOR FROM "
      cQryE2 += RetSqlName("SE2")
      cQryE2 += " WHERE D_E_L_E_T_ <> '*' "                                            

      //Five Solutions Consultoria - 05/11/2009(Solicit.Patricia) - cQryE2 += "  AND E2_TIPO NOT IN ('NCF','PA ','NDF')"
      cQryE2 += "  AND E2_TIPO NOT IN ('NCF','NDF')"
      cQryE2 += "  AND SUBSTRING(E2_TIPO,3,1) <> '-'"

      If nMes <= 3
         If nMes == 1
            cQryE2 += " AND SUBSTRING(E2_VENCTO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
         ElseIf nMes == 2
            cQryE2 += " AND SUBSTRING(E2_VENCTO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
         ElseIf nMes == 3
            cQryE2 += " AND SUBSTRING(E2_VENCTO,1,6) = '"+Substr(DTOS(dData03),1,6)+"' "
         EndIf
      ElseIf nMes >= 4
         If nMes == 4
            cQryE2 += " AND SUBSTRING(E2_VENCTO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
         ElseIf nMes == 5
            cQryE2 += " AND SUBSTRING(E2_VENCTO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
         ElseIf nMes == 6
            cQryE2 += " AND SUBSTRING(E2_VENCTO,1,6) = '"+Substr(DTOS(dData03),1,6)+"' "
         EndIf
      EndIf
      cQryE2 += " AND E2_FILIAL = '"+xFilial("SE2")+"'"
      cQryE2 += " AND E2_X_STAT = '1' "
      
      TCQuery cQryE2 NEW ALIAS "TSE2"
      
      If nMes <= 3
         If nMes == 1
            DbSelectArea("TSE2")
            nTit1MTrvVlr := TSE2->VALOR
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TSE2")
            nTit2MTrvVlr := TSE2->VALOR
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("TSE2")
            nTit3MTrvVlr := TSE2->VALOR
            DbCloseArea()
         EndIf
      ElseIf nMes >= 4
         If nMes == 4
            DbSelectArea("TSE2")
            nAntTit1MTrv := TSE2->VALOR
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("TSE2")
            nAntTit2MTrv := TSE2->VALOR
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("TSE2")
            nAntTit3MTrv := TSE2->VALOR
            DbCloseArea()
         EndIf
      EndIf
      
   Next nMes   

   /***********************
   *
   * Títulos a Pagar (Mês)   
   *
   ***********************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Títulos A Pagar, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryAP := "SELECT SUM(SE2.E2_VALOR) AS TITAPAG"
      cQryAP += " FROM "+RetSQLName("SE2")+" SE2"
      cQryAP += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"

      cQryAP += "  AND SE2.E2_TIPO NOT IN ('NCF','PA ','NDF')"
      cQryAP += "  AND SUBSTRING(SE2.E2_TIPO,3,1) <> '-'"

      //25/03/2008 - Alteração do critério, conforme solicitação de Patrícia, passamos a adotar vencimento real ao invés de
      //vencimento.
      If nMes == 1
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQryAP += " AND SE2.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\TitulosAPagar"+Alltrim(Str(nMes))+".SQL",cQryAP)
      
      TCQuery cQryAP NEW ALIAS "TTPG"
      
      If nMes == 1
         DbSelectArea("TTPG")
         nAPg1MTit := TTPG->TITAPAG
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TTPG")
         nAPg2MTit := TTPG->TITAPAG
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TTPG")
         nAPg3MTit := TTPG->TITAPAG
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TTPG")
         nAPg4MTit := TTPG->TITAPAG
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TTPG")
         nAPg5MTit := TTPG->TITAPAG
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TTPG")
         nAPg6MTit := TTPG->TITAPAG
         DbCloseArea()
      EndIf
      
   Next nMes
   

   /***********************
   *
   * Pagamentos em Aberto(Mês) - Utilizando conceito definido por Patrícia em 27/03/2008   
   *
   ***********************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Pagamentos em Aberto, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryAP := "SELECT SUM(SE2.E2_SALDO) AS PAGABERTO"
      cQryAP += " FROM "+RetSQLName("SE2")+" SE2"
      cQryAP += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"

      cQryAP += "  AND SE2.E2_TIPO NOT IN ('NCF','PA ','NDF')"
      cQryAP += "  AND SUBSTRING(SE2.E2_TIPO,3,1) <> '-'"
      
      cQryAP += "  AND SE2.E2_SALDO > 0 " //Titulos com algum saldo em aberto

      //25/03/2008 - Alteração do critério, conforme solicitação de Patrícia, passamos a adotar vencimento real ao invés de
      //vencimento.
      If nMes == 1
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQryAP += " AND SE2.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\PagamentosemAberto"+Alltrim(Str(nMes))+".SQL",cQryAP)
      
      TCQuery cQryAP NEW ALIAS "TTPG"
      
      If nMes == 1
         DbSelectArea("TTPG")
         nSld1MPag := TTPG->PAGABERTO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TTPG")
         nSld2MPag := TTPG->PAGABERTO
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TTPG")
         nSld3MPag := TTPG->PAGABERTO
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TTPG")
         nSld4MPag := TTPG->PAGABERTO
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TTPG")
         nSld5MPag := TTPG->PAGABERTO
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TTPG")
         nSld6MPag := TTPG->PAGABERTO
         DbCloseArea()
      EndIf
      
   Next nMes

   /***********************
   *
   * Pagamentos em Aberto(Mês) - Utilizando conceito definido por Patrícia em 27/03/2008   
   *
   ***********************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc.Pagtos Aberto Meses Ant., Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryAP := "SELECT SUM(SE2.E2_SALDO) AS PAGABMA"
      cQryAP += " FROM "+RetSQLName("SE2")+" SE2"
      cQryAP += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"

      cQryAP += "  AND SE2.E2_TIPO NOT IN ('NCF','PA ','NDF')"
      cQryAP += "  AND SUBSTRING(SE2.E2_TIPO,3,1) <> '-'"
      
      cQryAP += "  AND SE2.E2_SALDO > 0 " //Titulos com algum saldo em aberto

      //25/03/2008 - Alteração do critério, conforme solicitação de Patrícia, passamos a adotar vencimento real ao invés de
      //vencimento.
      If nMes == 1
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) < '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) < '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) < '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) < '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) < '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQryAP += " AND SUBSTRING(SE2.E2_VENCREA,1,6) < '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQryAP += " AND SE2.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\PagtosAbertoMA"+Alltrim(Str(nMes))+".SQL",cQryAP)
      
      TCQuery cQryAP NEW ALIAS "TTPG"
      
      If nMes == 1
         DbSelectArea("TTPG")
         nSld1MAnt := TTPG->PAGABMA
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TTPG")
         nSld2MAnt := TTPG->PAGABMA
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TTPG")
         nSld3MAnt := TTPG->PAGABMA
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TTPG")
         nSld4MAnt := TTPG->PAGABMA
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TTPG")
         nSld5MAnt := TTPG->PAGABMA
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TTPG")
         nSld6MAnt := TTPG->PAGABMA
         DbCloseArea()
      EndIf
      
   Next nMes


   /************************
   *
   * Pagamentos Realizados
   *
   *************************/
   
   /* Ita - 03/03/2008
   
   ProcRegua(3)
   
   For nMes := 1 To 3
   
      IncProc("Calc. Pagtos. Realizados, Proc. "+Alltrim(Str(nMes))+" / 3")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLPGREALIZ "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')"

      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','PA ','NDF')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '" + xFilial("SE5") + "'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "PGREAL"
      
      If nMes == 1
         DbSelectArea("PGREAL")
         nPg1MRealiz := PGREAL->VLPGREALIZ
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("PGREAL")
         nPg2MRealiz := PGREAL->VLPGREALIZ
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("PGREAL")
         nPg3MRealiz := PGREAL->VLPGREALIZ
         DbCloseArea()
      EndIf
      
   Next nMes

   */
   
   /************************
   *
   * COMPESANÇÃO (Baixas por Compensação) - A Pagar
   *
   *************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Bx.p/Compensação, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS BXCOMPENSA "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      cQuery += "  AND SE5.E5_TIPODOC IN ('CP')"

      //Five Solutions Consultoria - 05/11/2009(Solicit.Patricia) - cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','PA ','NDF')"
      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','NDF')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SE5.E5_MOTBX = 'CMP'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "BXCMP"
      
      If nMes == 1
         DbSelectArea("BXCMP")
         nBx1MComp := BXCMP->BXCOMPENSA
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("BXCMP")
         nBx2MComp := BXCMP->BXCOMPENSA
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("BXCMP")
         nBx3MComp := BXCMP->BXCOMPENSA
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("BXCMP")
         nBx4MComp := BXCMP->BXCOMPENSA
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("BXCMP")
         nBx5MComp := BXCMP->BXCOMPENSA
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("BXCMP")
         nBx6MComp := BXCMP->BXCOMPENSA
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * DEBITO CC 
   *
   *************************/

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Bx.p/Debito CC, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLDEBCC "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia

      //Five Solutions Consultoria - 05/11/2009(Solicit.Patricia) - cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','PA ','NDF')"
      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','NDF')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SUBSTRING(SE5.E5_BANCO,1,1) <> ' '"
      cQuery += "  AND SE5.E5_MOTBX = 'DEB'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "DBCC"
      
      If nMes == 1
         DbSelectArea("DBCC")
         nDBT1MCC := DBCC->VLDEBCC
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("DBCC")
         nDBT2MCC := DBCC->VLDEBCC
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("DBCC")
         nDBT3MCC := DBCC->VLDEBCC
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("DBCC")
         nDBT4MCC := DBCC->VLDEBCC
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("DBCC")
         nDBT5MCC := DBCC->VLDEBCC
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("DBCC")
         nDBT6MCC := DBCC->VLDEBCC
         DbCloseArea()
      EndIf
      
   Next nMes
      
   /************************
   *
   * NORMAL - PAGAR
   *
   *************************/

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Bx. Normal, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLBXNOR "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia

      //Novo Conceito 2009 - cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','PA ','NDF')"
      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','NDF')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SUBSTRING(SE5.E5_BANCO,1,1) <> ' '"
      cQuery += "  AND SE5.E5_MOTBX = 'NOR'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "BXNOR"
      
      If nMes == 1
         DbSelectArea("BXNOR")
         nBx1MNorm := BXNOR->VLBXNOR
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("BXNOR")
         nBx2MNorm := BXNOR->VLBXNOR
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("BXNOR")
         nBx3MNorm := BXNOR->VLBXNOR
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("BXNOR")
         nBx4MNorm := BXNOR->VLBXNOR
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("BXNOR")
         nBx5MNorm := BXNOR->VLBXNOR
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("BXNOR")
         nBx6MNorm := BXNOR->VLBXNOR
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * DEVOLUÇÃO A PAGAR
   *
   *************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Bx.p/Devolução, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS BXDEVOL "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'P'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      
      //Five Solutions Consultoria - 05/11/2009(Solicit.Patricia) - cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','PA ','NDF')"
      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCF','NDF')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"
      
      //Five Solutions - 10/07/2008
      //Devoluções não registram bancos - cQuery += "  AND SUBSTRING(SE5.E5_BANCO,1,1) <> ' '"
      cQuery += "  AND SE5.E5_MOTBX = 'DEV'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "BXDEV"
      
      If nMes == 1
         DbSelectArea("BXDEV")
         nBx1MDevol := BXDEV->BXDEVOL
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("BXDEV")
         nBx2MDevol := BXDEV->BXDEVOL
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("BXDEV")
         nBx3MDevol := BXDEV->BXDEVOL
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("BXDEV")
         nBx4MDevol := BXDEV->BXDEVOL
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("BXDEV")
         nBx5MDevol := BXDEV->BXDEVOL
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("BXDEV")
         nBx6MDevol := BXDEV->BXDEVOL
         DbCloseArea()
      EndIf
      
   Next nMes


   /***********************
   *
   * Títulos a Pagar (Total)   
   *
   ***********************/
   
   ProcRegua(18) //12)
   nPAChamada := 1
   
   For nMes := 1 To 18//12  // (1A6)   1 a 3 - A pagar de 1 a 30 dias
                            // (7A12)  4 a 6 - A pagar de 31 a 60 dias
                            // (13A18) 7 a 9 - A pagar de 61 a 90 dias
                            // (19A24)10 a 12 - A pagar a mais de 90 dias
      
      IncProc("Calc. Tit.A Pagar(Fluxo), Proc. "+Alltrim(Str(nMes))+" / 18")
      
      If nMes <= 6 //3
         If nMes == 1
            
            //DbSelectArea("TTPG")
            //nAPg1M1a30 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dDataDe)
            dPA2DtParam:= LastDay(dDataDe)+1
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg1M1a30 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 2
            //DbSelectArea("TTPG")
            //nAPg2M1a30 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData02)
            dPA2DtParam:= LastDay(dData02)+1
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg2M1a30 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 3
            //DbSelectArea("TTPG")
            //nAPg3M1a30 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData03)
            dPA2DtParam:= LastDay(dData03)+1
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg3M1a30 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 4
            //DbSelectArea("TTPG")
            //nAPg3M1a30 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData04)
            dPA2DtParam:= LastDay(dData04)+1
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg4M1a30 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 5
            //DbSelectArea("TTPG")
            //nAPg3M1a30 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData05)
            dPA2DtParam:= LastDay(dData05)+1
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg5M1a30 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 6
            //DbSelectArea("TTPG")
            //nAPg3M1a30 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData06)
            dPA2DtParam:= LastDay(dData06)+1
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg6M1a30 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            //DbSelectArea("TTPG")
            //nAPg1M31a60 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dDataDe)
            dPA2DtParam:= FirstDay(LastDay(dDataDe)+32)
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg1M31a60 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 8 //5
            //DbSelectArea("TTPG")
            //nAPg2M31a60 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData02)
            dPA2DtParam:= FirstDay(LastDay(dData02)+32)
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg2M31a60 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 9 //6
            //DbSelectArea("TTPG")
            //nAPg3M31a60 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData03)
            dPA2DtParam:= FirstDay(LastDay(dData03)+32)
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg3M31a60 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 10
            //DbSelectArea("TTPG")
            //nAPg3M31a60 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData04)
            dPA2DtParam:= FirstDay(LastDay(dData04)+32)
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg4M31a60 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 11
            //DbSelectArea("TTPG")
            //nAPg3M31a60 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData05)
            dPA2DtParam:= FirstDay(LastDay(dData05)+32)
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg5M31a60 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 12
            //DbSelectArea("TTPG")
            //nAPg3M31a60 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData06)
            dPA2DtParam:= FirstDay(LastDay(dData06)+32)
            dPA3DtParam:= LastDay(dPA2DtParam)
            nAPg6M31a60 := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            //DbSelectArea("TTPG")
            dPADtParam := LastDay(dDataDe)
            dPA2DtParam:= FirstDay(LastDay(dDataDe)+63)
            dPA3DtParam:= CTOD("31/12/49")
            nAcm1M60dd := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 14 //8
            //DbSelectArea("TTPG")
            //nAPg2M61a90 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData02)
            dPA2DtParam:= FirstDay(LastDay(dData02)+63)
            dPA3DtParam:= CTOD("31/12/49")
            nAcm2M60dd := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 15 //9
            //DbSelectArea("TTPG")
            //nAPg3M61a90 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData03)
            dPA2DtParam:= FirstDay(LastDay(dData03)+63)
            dPA3DtParam:= CTOD("31/12/49")
            nAcm3M60dd := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 16
            //DbSelectArea("TTPG")
            //nAPg3M61a90 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData04)
            dPA2DtParam:= FirstDay(LastDay(dData04)+63)
            dPA3DtParam:= CTOD("31/12/49")
            nAcm4M60dd := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 17
            //DbSelectArea("TTPG")
            //nAPg3M61a90 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData05)
            dPA2DtParam:= FirstDay(LastDay(dData05)+63)
            dPA3DtParam:= CTOD("31/12/49")
            nAcm5M60dd := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         ElseIf nMes == 18
            //DbSelectArea("TTPG")
            //nAPg3M61a90 := TTPG->TITAPAG
            //DbCloseArea()
            dPADtParam := LastDay(dData06)
            dPA2DtParam:= FirstDay(LastDay(dData06)+63)
            dPA3DtParam:= CTOD("31/12/49")
            nAcm6M60dd := SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)
         EndIf
      EndIf
   Next nMes
   
   /***********************
   *
   * Títulos a Receber (Mês) 
   *
   ***********************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Tit. A Receber, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryAP := "SELECT SUM(SE1.E1_VALOR) AS TITAREC"
      cQryAP += " FROM "+RetSQLName("SE1")+" SE1"
      cQryAP += " WHERE SE1.E1_FILIAL = '"+xFilial("SE1")+"'"
      If !lMitto
         cQryAP += "    AND SE1.E1_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQryAP += "  AND SE1.E1_TIPO NOT IN ('NCC')"
      //25/03/2008 - Alteração do critério, conforme solicitação de Patrícia, passamos a adotar vencimento real ao invés de
      //vencimento.

      If nMes == 1
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQryAP += " AND SE1.D_E_L_E_T_ <> '*'"
      
      TCQuery cQryAP NEW ALIAS "TREC"
      
      If nMes == 1
         DbSelectArea("TREC")
         nARe1MTit := TREC->TITAREC
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TREC")
         nARe2MTit := TREC->TITAREC
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TREC")
         nARe3MTit := TREC->TITAREC
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TREC")
         nARe4MTit := TREC->TITAREC
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TREC")
         nARe5MTit := TREC->TITAREC
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TREC")
         nARe6MTit := TREC->TITAREC
         DbCloseArea()
      EndIf
      
   Next nMes


   /***********************
   *
   * Títulos a Receber em Aberto(Mês) - Utilizando novo conceito adotado por Patrícia em 27/03/2008
   *
   ***********************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc. Tit. A Receber, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQryAP := "SELECT SUM(SE1.E1_SALDO) AS ARECABERTO"
      cQryAP += " FROM "+RetSQLName("SE1")+" SE1"
      cQryAP += " WHERE SE1.E1_FILIAL = '"+xFilial("SE1")+"'"
      If !lMitto
         cQryAP += "    AND SE1.E1_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQryAP += "  AND SE1.E1_TIPO NOT IN ('NCC')"
      
      cQryAP += "  AND SE1.E1_SALDO > 0 " //Titulos com algum saldo em aberto.
      
      //25/03/2008 - Alteração do critério, conforme solicitação de Patrícia, passamos a adotar vencimento real ao invés de
      //vencimento.

      If nMes == 1
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQryAP += " AND SUBSTRING(SE1.E1_VENCREA,1,6) = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf
      cQryAP += " AND SE1.D_E_L_E_T_ <> '*'"
      
      TCQuery cQryAP NEW ALIAS "TREC"
      
      If nMes == 1
         DbSelectArea("TREC")
         nSld1MRec := TREC->ARECABERTO
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TREC")
         nSld2MRec := TREC->ARECABERTO
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TREC")
         nSld3MRec := TREC->ARECABERTO
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TREC")
         nSld4MRec := TREC->ARECABERTO
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TREC")
         nSld5MRec := TREC->ARECABERTO
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TREC")
         nSld6MRec := TREC->ARECABERTO
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * Títulos Recebidos      
   *
   *************************/
   
   /* Ita 03/03/2008 - Novo Conceito p/ Calcular Titulos Recebidos
   
   ProcRegua(3)

   For nMes := 1 To 3
   
      IncProc("Calc. Tit. Recebido, Proc. "+Alltrim(Str(nMes))+" / 3")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLREREALIZ "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'R'"
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')"

      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCC','RA ')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '" + xFilial("SE5") + "'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "REREAL"
      
      If nMes == 1
         DbSelectArea("REREAL")
         nRe1MRealiz := REREAL->VLREREALIZ
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("REREAL")
         nRe2MRealiz := REREAL->VLREREALIZ
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("REREAL")
         nRe3MRealiz := REREAL->VLREREALIZ
         DbCloseArea()
      EndIf
      
   Next nMes

   */
   
   /************************
   *
   * COMPESANÇÃO (Baixas por Compensação) - A Receber
   *
   *************************/

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Bx.p/Compensação(REC), Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS BXCOMPENRE "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'R'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      cQuery += "  AND SE5.E5_TIPODOC IN ('CP')"

      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCC','RA ')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SE5.E5_MOTBX = 'CMP'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "BXCMPRE"
      
      If nMes == 1
         DbSelectArea("BXCMPRE")
         nBxRE1MComp := BXCMPRE->BXCOMPENRE
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("BXCMPRE")
         nBxRE2MComp := BXCMPRE->BXCOMPENRE
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("BXCMPRE")
         nBxRE3MComp := BXCMPRE->BXCOMPENRE
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("BXCMPRE")
         nBxRE4MComp := BXCMPRE->BXCOMPENRE
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("BXCMPRE")
         nBxRE5MComp := BXCMPRE->BXCOMPENRE
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("BXCMPRE")
         nBxRE6MComp := BXCMPRE->BXCOMPENRE
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * DEVOLUÇÃO A RECEBER
   *
   *************************/
   
   ProcRegua(6) //3)

   For nMes := 1 To 6 //3
   
      IncProc("Calc.Bx.p/Devolução(REC), Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS BXDEVOLRE "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'R'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia

      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCC','RA ')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"

      cQuery += "  AND SUBSTRING(SE5.E5_BANCO,1,1) <> ' '"
      cQuery += "  AND SE5.E5_MOTBX = 'DEV'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "BXREDEV"
      
      If nMes == 1
         DbSelectArea("BXREDEV")
         nBx1MDvRE := BXREDEV->BXDEVOLRE
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("BXREDEV")
         nBx2MDvRE := BXREDEV->BXDEVOLRE
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("BXREDEV")
         nBx3MDvRE := BXREDEV->BXDEVOLRE
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("BXREDEV")
         nBx4MDvRE := BXREDEV->BXDEVOLRE
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("BXREDEV")
         nBx5MDvRE := BXREDEV->BXDEVOLRE
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("BXREDEV")
         nBx6MDvRE := BXREDEV->BXDEVOLRE
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * NORMAL - RECEBER
   *
   *************************/

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
   
      IncProc("Calc. Bx. Normal, Processo "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLBXNORRE "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'R'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.D_E_L_E_T_ <> '*'"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SUBSTRING(SE5.E5_BANCO,1,1) <> ' '"
      cQuery += "  AND SE5.E5_MOTBX = 'NOR'"
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      
      cQuery += "  AND SE5.E5_TIPO NOT IN ('NCC','RA ')"
      cQuery += "  AND SUBSTRING(SE5.E5_TIPO,3,1) <> '-'"
      
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "BXRENOR"
      
      If nMes == 1
         DbSelectArea("BXRENOR")
         nBxRE1MNorm := BXRENOR->VLBXNORRE
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("BXRENOR")
         nBxRE2MNorm := BXRENOR->VLBXNORRE
         DbCloseArea()
      ElseIf nMEs == 3
         DbSelectArea("BXRENOR")
         nBxRE3MNorm := BXRENOR->VLBXNORRE
         DbCloseArea()
      ElseIf nMEs == 4
         DbSelectArea("BXRENOR")
         nBxRE4MNorm := BXRENOR->VLBXNORRE
         DbCloseArea()
      ElseIf nMEs == 5
         DbSelectArea("BXRENOR")
         nBxRE5MNorm := BXRENOR->VLBXNORRE
         DbCloseArea()
      ElseIf nMEs == 6
         DbSelectArea("BXRENOR")
         nBxRE6MNorm := BXRENOR->VLBXNORRE
         DbCloseArea()
      EndIf
      
   Next nMes

   /************************
   *
   * TITULOS EM ABERTO (Mês)
   *
   *************************/

   //"Calculando Saldo a Receber ..."
   //RunSldRe()
   /* Comentado devido a utilização de novo conceito adotado por Patrícia em 27/03/2008
   ProcRegua(3)
   nCt := 1
   WhIle nCt <= 3
      
      IncProc("Calc. Saldo A Receber, Proc. "+Alltrim(Str(nCt))+" / 3")
      
      If nCt == 1
         nSld1MRec := ItaSldReceb(dDataDe,1,.T.,.T.)
      ElseIf nCt == 2
         nSld2MRec := ItaSldReceb(LastDay(dData02),1,.T.,.T.) 
      ElseIf nCt == 3
         nSld3MRec := ItaSldReceb(LastDay(dData03),1,.T.,.T.) 
      EndIf
      
      nCt ++
      
   EndDo
   */
   
   /******************
   *
   * TITULOS VENCIDOS (A RECEBER)
   *
   ******************/
   
   cAnoAtu    := Alltrim(Str((YEAR(dDataDe))))
   cAno1Menos := Alltrim(Str((YEAR(dDataDe)-1)))
   cAno2Menos := Alltrim(Str((YEAR(dDataDe)-2)))
   cAnoAntes  := Alltrim(Str((YEAR(dDataDe)-3)))
   
   nChamada   := 2
   ProcRegua(30) //15)
   
   
   
   For nMes := 1 To 30 //15
      
      IncProc("Calc. Tít. Vencidos, Proc. "+Alltrim(Str(nMes))+" / 30")
      
      
      If nMes <= 6 //3
         /*
         If nMes == 1
            DbSelectArea("TTVENC")
            nTt1MVc := TTVENC->SLDVENCID
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TTVENC")
            nTt2MVc := TTVENC->SLDVENCID
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("TTVENC")
            nTt3MVc := TTVENC->SLDVENCID
            DbCloseArea()
         EndIf
         */
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            //DbSelectArea("TTVENC")
            //nAAtTt1MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dDataDe) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dDataDe))))
            d3DtParam  := LastDay(dDataDe)
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nAAtTt1MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("nAAtTt1MVc "+Alltrim(Str(nAAtTt1MVc)))
         ElseIf nMes == 8 //5
            //DbSelectArea("TTVENC")
            //nAAtTt2MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData02) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData02))))
            d3DtParam  := LastDay(dData02)
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nAAtTt2MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("nAAtTt2MVc "+Alltrim(Str(nAAtTt2MVc)))
         ElseIf nMes == 9 //6
            //DbSelectArea("TTVENC")
            //nAAtTt3MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData03) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData03))))
            d3DtParam  := LastDay(dData03)
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nAAtTt3MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("nAAtTt3MVc "+Alltrim(Str(nAAtTt3MVc)))
         ElseIf nMes == 10
            dDtParam   := LastDay(dData04) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData04))))
            d3DtParam  := LastDay(dData04)
            nAAtTt4MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 11
            dDtParam   := LastDay(dData05) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData05))))
            d3DtParam  := LastDay(dData05)
            nAAtTt5MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 12
            dDtParam   := LastDay(dData06) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData06))))
            d3DtParam  := LastDay(dData06)
            nAAtTt6MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            //DbSelectArea("TTVENC")
            //nA1ATt1MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dDataDe) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dDataDe)-1)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dDataDe)-1)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nA1ATt1MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("nA1ATt1MVc "+Alltrim(Str(nA1ATt1MVc)))
         ElseIf nMes == 14 //8
            //DbSelectArea("TTVENC")
            //nA1ATt2MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData02) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData02)-1)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData02)-1)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nA1ATt2MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("nA1ATt2MVc "+Alltrim(Str(nA1ATt2MVc)))
         ElseIf nMes == 15 //9
            //DbSelectArea("TTVENC")
            //nA1ATt3MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData03) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData03)-1)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData03)-1)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nA1ATt3MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("nA1ATt3MVc "+Alltrim(Str(nA1ATt3MVc)))
         ElseIf nMes == 16
            dDtParam   := LastDay(dData04) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData04)-1)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData04)-1)))
            nA1ATt4MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 17
            dDtParam   := LastDay(dData05) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData05)-1)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData05)-1)))
            nA1ATt5MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 18
            dDtParam   := LastDay(dData06) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData06)-1)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData06)-1)))
            nA1ATt6MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            //DbSelectArea("TTVENC")
            //nA2ATt1MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dDataDe) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dDataDe)-2)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dDataDe)-2)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nA2ATt1MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 20 //11
            //DbSelectArea("TTVENC")
            //nA2ATt2MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData02) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData02)-2)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData02)-2)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nA2ATt2MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 21 //12
            //DbSelectArea("TTVENC")
            //nA2ATt3MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData03) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData03)-2)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData03)-2)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nA2ATt3MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 22
            dDtParam   := LastDay(dData04) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData04)-2)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData04)-2)))
            nA2ATt4MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 23
            dDtParam   := LastDay(dData05) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData05)-2)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData05)-2)))
            nA2ATt5MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 24
            dDtParam   := LastDay(dData06) 
            d2DtParam  := CTOD("01/01/"+ALLTRIM(STR(YEAR(dData06)-2)))
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData06)-2)))
            nA2ATt6MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            //DbSelectArea("TTVENC")
            //nAAntTt1MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dDataDe) 
            d2DtParam  := CTOD("01/01/90")
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dDataDe)-3)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nAAntTt1MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 26 //14
            //DbSelectArea("TTVENC")
            //nAAntTt2MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData02) 
            d2DtParam  := CTOD("01/01/90")
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData02)-3)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nAAntTt2MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 27 //15
            //DbSelectArea("TTVENC")
            //nAAntTt3MVc := TTVENC->SLDVENCID
            //DbCloseArea()
            dDtParam   := LastDay(dData03) 
            d2DtParam  := CTOD("01/01/90")
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData03)-3)))
            //Alert("nMes "+Alltrim(Str(nMes))+" dDtParam "+DTOC(dDtParam)+" d2DtParam "+DTOC(d2DtParam)+" d3DtParam "+DTOC(d3DtParam))
            nAAntTt3MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 28
            dDtParam   := LastDay(dData04) 
            d2DtParam  := CTOD("01/01/90")
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData04)-3)))
            nAAntTt4MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 29
            dDtParam   := LastDay(dData05) 
            d2DtParam  := CTOD("01/01/90")
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData05)-3)))
            nAAntTt5MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 30
            dDtParam   := LastDay(dData06) 
            d2DtParam  := CTOD("01/01/90")
            d3DtParam  := CTOD("31/12/"+ALLTRIM(STR(YEAR(dData06)-3)))
            nAAntTt6MVc := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      EndIf
       
   Next nMes 
   
   /***********************
   *
   * Títulos a Receber (Fluxo)
   *
   ***********************/
   
   nChamada   := 1
    
   ProcRegua(18) //12)
   
   For nMes := 1 To 18 //12  // 1 a 3 - A Receber de 1 a 30 dias
                        // 4 a 6 - A Receber de 31 a 60 dias
                        // 7 a 9 - A Receber de 61 a 90 dias
                        //10 a 12 - A Receber a mais de 90 dias
      
      IncProc("Calc. Tit. A Receber(Fluxo), Proc. "+Alltrim(Str(nMes))+" / 18")
      

      If nMes <= 6 //3
         If nMes == 1
            //DbSelectArea("REFLX")
            //nARe1M1a30 := REFLX->TFLXAREC
            //DbCloseArea()
            dMesAF := LastDay(dDataDe)+1
            //Alert("Chamando Função  SaldoSR(Data Base= "+DTOC(LastDay(dDataDe))+" Vencto de= "+DTOC(dMesAF)+" Vencto Ate= "+DTOC(LastDay(dMesAF)))
            dDtParam  := LastDay(dDataDe)
            d2DtParam := dMesAF
            d3DtParam := LastDay(dMesAF)
            //Alert("nMes "+Alltrim(Str(nMes))+" Paramentos enviados a SaldoSR, DataBase "+DTOC(dDtParam)+" Vencto De "+dtoc(d2DtParam)+" Vencto Ate "+DTOC(d3DtParam)) 
            nARe1M1a30 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
            //Alert("A Receber 1 a 30 dias "+Alltrim(Str(nARe1M1a30))+" Data em "+DTOC(FirstDay(dDataDe)-1))
         ElseIf nMes == 2
            //DbSelectArea("REFLX")
            //nARe2M1a30 := REFLX->TFLXAREC
            //DbCloseArea()
            d2MesAF := LastDay(dData02)+1
            dDtParam  := LastDay(dData02)
            d2DtParam := d2MesAF
            d3DtParam := LastDay(d2MesAF)
            
            nARe2M1a30 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 3
            //DbSelectArea("REFLX")
            //nARe3M1a30 := REFLX->TFLXAREC
            //DbCloseArea()
            d3MesAF := LastDay(dData03)+1
            dDtParam  := LastDay(dData03)
            d2DtParam := d3MesAF
            d3DtParam := LastDay(d3MesAF)           
            nARe3M1a30 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 4
            d3MesAF := LastDay(dData04)+1
            dDtParam  := LastDay(dData04)
            d2DtParam := d3MesAF
            d3DtParam := LastDay(d3MesAF)           
            nARe4M1a30 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 5
            d3MesAF := LastDay(dData05)+1
            dDtParam  := LastDay(dData05)
            d2DtParam := d3MesAF
            d3DtParam := LastDay(d3MesAF)           
            nARe5M1a30 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 6
            d3MesAF := LastDay(dData06)+1
            dDtParam  := LastDay(dData06)
            d2DtParam := d3MesAF
            d3DtParam := LastDay(d3MesAF)           
            nARe6M1a30 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            //DbSelectArea("REFLX")
            //nARe1M31a60 := REFLX->TFLXAREC
            //DbCloseArea()
            d4TMPDt := LastDay(dDataDe)+32
            //Alert("d4TMPDt "+DTOC(d4TMPDt))
            d4MesAF := LastDay(d4TMPDt)
            dDtParam  := LastDay(dDataDe)
            d2DtParam := FirstDay(d4MesAF)
            d3DtParam := LastDay(d4MesAF)          
            //Alert("nMes "+Alltrim(Str(nMes))+" Paramentos enviados a SaldoSR, DataBase "+DTOC(dDtParam)+" Vencto De "+dtoc(d2DtParam)+" Vencto Ate "+DTOC(d3DtParam)) 
            nARe1M31a60 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 8 //5
            //DbSelectArea("REFLX")
            //nARe2M31a60 := REFLX->TFLXAREC
            //DbCloseArea()
            d5TMPDt := LastDay(dData02)+32 
            d5MesAF := LastDay(d5TMPDt)
            dDtParam  := LastDay(dData02)
            d2DtParam := FirstDay(d5MesAF)
            d3DtParam := LastDay(d5MesAF)            
            nARe2M31a60 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 9 //6
            //DbSelectArea("REFLX")
            //nARe3M31a60 := REFLX->TFLXAREC
            //DbCloseArea()
            d6TMPDt := LastDay(dData03)+32  
            d6MesAF := LastDay(d6TMPDt)
            dDtParam  := LastDay(dData03)
            d2DtParam := FirstDay(d6MesAF)
            d3DtParam := LastDay(d6MesAF)             
            nARe3M31a60 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 10
            d6TMPDt := LastDay(dData04)+32  
            d6MesAF := LastDay(d6TMPDt)
            dDtParam  := LastDay(dData04)
            d2DtParam := FirstDay(d6MesAF)
            d3DtParam := LastDay(d6MesAF)             
            nARe4M31a60 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 11
            d6TMPDt := LastDay(dData05)+32  
            d6MesAF := LastDay(d6TMPDt)
            dDtParam  := LastDay(dData05)
            d2DtParam := FirstDay(d6MesAF)
            d3DtParam := LastDay(d6MesAF)             
            nARe5M31a60 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 12
            d6TMPDt := LastDay(dData06)+32  
            d6MesAF := LastDay(d6TMPDt)
            dDtParam  := LastDay(dData06)
            d2DtParam := FirstDay(d6MesAF)
            d3DtParam := LastDay(d6MesAF)             
            nARe6M31a60 := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9

         If nMes == 13 //7
            //DbSelectArea("REFLX")
            //nARe1M61a90 := REFLX->TFLXAREC
            //DbCloseArea()
            d7TMPDt := LastDay(dDataDe)+63  
            d7MesAF := LastDay(d7TMPDt)
            dDtParam  := LastDay(dDataDe)
            d2DtParam := FirstDay(d7MesAF)
            d3DtParam := CTOD("31/12/49")
            //Alert("nMes "+Alltrim(Str(nMes))+" Paramentos enviados a SaldoSR, DataBase "+DTOC(dDtParam)+" Vencto De "+dtoc(d2DtParam)+" Vencto Ate "+DTOC(d3DtParam)) 
            nARAc160dd := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 14 //8
            //DbSelectArea("REFLX")
            //nARe2M61a90 := REFLX->TFLXAREC
            //DbCloseArea()
            d8TMPDt := LastDay(dData02)+63  
            d8MesAF := LastDay(d8TMPDt)
            dDtParam  := LastDay(dData02)
            d2DtParam := FirstDay(d8MesAF)
            d3DtParam := CTOD("31/12/49")             
            nARAc260dd := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 15 //9
            //DbSelectArea("REFLX")
            //nARe3M61a90 := REFLX->TFLXAREC
            //DbCloseArea()
            d9TMPDt := LastDay(dData03)+63
            d9MesAF := LastDay(d9TMPDt)
            dDtParam  := LastDay(dData03)
            d2DtParam := FirstDay(d9MesAF)
            d3DtParam := CTOD("31/12/49")             
            nARAc360dd := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 16
            d9TMPDt := LastDay(dData04)+63
            d9MesAF := LastDay(d9TMPDt)
            dDtParam  := LastDay(dData04)
            d2DtParam := FirstDay(d9MesAF)
            d3DtParam := CTOD("31/12/49")             
            nARAc460dd := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 17
            d9TMPDt := LastDay(dData05)+63
            d9MesAF := LastDay(d9TMPDt)
            dDtParam  := LastDay(dData05)
            d2DtParam := FirstDay(d9MesAF)
            d3DtParam := CTOD("31/12/49")             
            nARAc560dd := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         ElseIf nMes == 18
            d9TMPDt := LastDay(dData06)+63
            d9MesAF := LastDay(d9TMPDt)
            dDtParam  := LastDay(dData06)
            d2DtParam := FirstDay(d9MesAF)
            d3DtParam := CTOD("31/12/49")             
            nARAc660dd := SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)
         EndIf
      EndIf      
      
   Next nMes

   /************************
   *
   * GASTOS META ORCAMENTO ADM/FIN (ORÇADO)
   *
   ************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Gastos Metas/Orc Adm/Fin.(Orçado) Proc. "+Alltrim(Str(nMes))+" / 6")
      
      If nMes == 1
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dDataDe),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VxORCMTADM "
      ElseIf nMes == 2
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData02),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VxORCMTADM "
      ElseIf nMes == 3
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData03),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VxORCMTADM "
      ElseIf nMes == 4
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData04),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VxORCMTADM "
      ElseIf nMes == 5
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData05),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VxORCMTADM "
      ElseIf nMes == 6
         _xMES := Substr(fNomeMes(Alltrim(StrZero(Month(dData06),2))),1,3)
         cQuery := " SELECT SUM(SE7.E7_VAL"+_xMES+"1) AS VxORCMTADM "
      EndIf
      
      cQuery += " FROM " + RetSqlName("SE7")+" SE7 "
      
      If nMes == 1
         _xANO := ALLTRIM(STR(YEAR(dDataDe)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 2 
         _xANO := ALLTRIM(STR(YEAR(dData02)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 3 
         _xANO := ALLTRIM(STR(YEAR(dData03)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 4
         _xANO := ALLTRIM(STR(YEAR(dData04)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 5
         _xANO := ALLTRIM(STR(YEAR(dData05)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      ElseIf nMes == 6
         _xANO := ALLTRIM(STR(YEAR(dData06)))
         cQuery += " WHERE SE7.E7_ANO = '"+_xANO+"'" 
      EndIf
      
      cQuery += "  AND SE7.E7_FILIAL = '"+xFilial("SE7")+"'"
      cQuery += "  AND SE7.E7_NATUREZ IN "+FormatIn(AdmMetasOrc,",")
      cQuery += "  AND SE7.D_E_L_E_T_ = ' '"
      
      MemoWrite("C:\TEMP\MtOrçadoAdmFin"+Alltrim(Str(nMes))+".SQL",cQuery) 
      
      TCQuery cQuery NEW ALIAS "OMOA"
      
      If nMes == 1
         DbSelectArea("OMOA")
         nAdm1MMtOrc := OMOA->VxORCMTADM
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("OMOA")
         nAdm2MMtOrc := OMOA->VxORCMTADM
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("OMOA")
         nAdm3MMtOrc := OMOA->VxORCMTADM
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("OMOA")
         nAdm4MMtOrc := OMOA->VxORCMTADM
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("OMOA")
         nAdm5MMtOrc := OMOA->VxORCMTADM
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("OMOA")
         nAdm6MMtOrc := OMOA->VxORCMTADM
         DbCloseArea()
      EndIf

   Next nMes

   /************************
   *
   * GASTOS GERAIS ADM.
   *
   ************************/
   
   ProcRegua(150) //72)
   For nMes := 1 To 150 //72 //1 A 3 - Gastos Gerais Adm.
                      //4 A 6 - Gastos com Mão de Obra
                      //7 A 9 - Gastos com Mão de Obra(Despesas Fixas)
                      //10 A 12 - Gastos com Mão de Obra(Despesas Periódicas)
                      //13 A 15 - Gastos com Mão de Obra(Rescisões)
                      //16 A 18 - Gastos com Mão de Obra(Premiações)
                      //19 A 21 - Despesas de Viagens
                      //22 A 24 - Outras Despesas Adm
                      //25 A 27 - Serviços Terceirizados
                      //28 A 30 - Outras Naturezas Adm.
                      //31 A 33 - Gastos Metas Orçamento Adm.
                      //34 A 36 - Empréstimos entre empresas
                      //37 a 39 - Fundo Fixo
                      
                      //40 a 42 - Honorários Advocatícios
                      //43 a 45 - Despesas Judiciais
                      //46 a 48 - Rescisões/Acordos
                      
      IncProc(" Calc.Gastos Gerais Adm. Proc. "+Alltrim(Str(nMes))+" / 150")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLGGADM "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49 .Or. nMes == 55 .Or. nMes == 61 .Or. nMes == 67 .Or. nMes == 73 .Or. nMes == 79 .Or. nMes == 85 .Or. nMes == 91 .Or. nMes == 97 .Or. nMes == 103 .Or. nMes == 109 .Or. nMes == 115 .Or. nMes == 121 .Or. nMes == 127 .Or. nMes == 133 .Or. nMes == 139 .Or. nMes == 145
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50 .Or. nMes == 56 .Or. nMes == 62 .Or. nMes == 68 .Or. nMes == 74 .Or. nMes == 80 .Or. nMes == 86 .Or. nMes == 92 .Or. nMes == 98 .Or. nMes == 104 .Or. nMes == 110 .Or. nMes == 116 .Or. nMes == 122 .Or. nMes == 128 .Or. nMes == 134 .Or. nMes == 140 .Or. nMes == 146
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51 .Or. nMes == 57 .Or. nMes == 63 .Or. nMes == 69 .Or. nMes == 75 .Or. nMes == 81 .Or. nMes == 87 .Or. nMes == 93 .Or. nMes == 99 .Or. nMes == 105 .Or. nMes == 111 .Or. nMes == 117 .Or. nMes == 123 .Or. nMes == 129 .Or. nMes == 135 .Or. nMes == 141 .Or. nMes == 147
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52 .Or. nMes == 58 .Or. nMes == 64 .Or. nMes == 70 .Or. nMes == 76 .Or. nMes == 82 .Or. nMes == 88 .Or. nMes == 94 .Or. nMes == 100 .Or. nMes == 106 .Or. nMes == 112 .Or. nMes == 118 .Or. nMes == 124 .Or. nMes == 130 .Or. nMes == 136 .Or. nMes == 142 .Or. nMes == 148
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53 .Or. nMes == 59 .Or. nMes == 65 .Or. nMes == 71 .Or. nMes == 77 .Or. nMes == 83 .Or. nMes == 89 .Or. nMes == 95 .Or. nMes == 101 .Or. nMes == 107 .Or. nMes == 113 .Or. nMes == 119 .Or. nMes == 125 .Or. nMes == 131 .Or. nMes == 137 .Or. nMes == 143 .Or. nMes == 149
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54 .Or. nMes == 60 .Or. nMes == 66 .Or. nMes == 72 .Or. nMes == 78 .Or. nMes == 84 .Or. nMes == 90 .Or. nMes == 96 .Or. nMes == 102 .Or. nMes == 108 .Or. nMes == 114 .Or. nMes == 120 .Or. nMes == 126 .Or. nMes == 132 .Or. nMes == 138 .Or. nMes == 144 .Or. nMes == 150
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
      
      If nMes <= 6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cGstGerADM,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cMOGstADM,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDFGstADM,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDPGstADM,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cResGstADM,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cPrmADMGst,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDspViaADM,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cOutDADMGst,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cSrvTADMGst,",")
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(OutrasADM,",")
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(AdmMetasOrc,",")
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtEmpEEmp,",")
      ElseIf nMes >= 73 .And. nMes <= 78 //39
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFundFix,",")
      ElseIf nMes >= 79 .And. nMes <= 84 //42
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cHonorAdvNt,",")
      ElseIf nMes >= 85 .And. nMes <= 90 //45
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDespJdcNt,",")
      ElseIf nMes >= 91 .And. nMes <= 96 //48
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cRescAcordNt,",")
      ElseIf nMes >= 97 .And. nMes <= 102 //51
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cCaixaNtGr,",")
      ElseIf nMes >= 103 .And. nMes <= 108 //54
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cCxnhaNtGr,",")
      ElseIf nMes >= 109 .And. nMes <= 114 //57
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cInvestNt,",")
      ElseIf nMes >= 115 .And. nMes <= 120//60
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cEmpTomNt,",")
      ElseIf nMes >= 121 .And. nMes <= 126 //63
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cEmpConNt,",")
      ElseIf nMes >= 127 .And. nMes <= 132 //66
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cImbBINt,",")
      ElseIf nMes >= 133 .And. nMes <= 138 //69
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cImbBMNt,",")
      ElseIf nMes >= 139 .And. nMes <= 144 //72
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDPFiancNt,",")
      ElseIf nMes >= 145 .And. nMes <= 150
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cCapexcNt,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      If nMes == 7
         MemoWrite("C:\TEMP\GastGerADM"+Alltrim(Str(nMes))+".SQL",cQuery)
      ElseIf nMes == 29 //31
         MemoWrite("C:\TEMP\GastGerADM"+Alltrim(Str(nMes))+".SQL",cQuery)
      EndIf
      
      TCQuery cQuery NEW ALIAS "TGADM"
      
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("TGADM")
            nVl1MAdmGG := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TGADM")
            nVl2MAdmGG := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("TGADM")
            nVl3MAdmGG := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("TGADM")
            nVl4MAdmGG := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("TGADM")
            nVl5MAdmGG := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("TGADM")
            nVl6MAdmGG := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("TGADM")
            nVGG1MMOADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("TGADM")
            nVGG2MMOADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 9 //6
            DbSelectArea("TGADM")
            nVGG3MMOADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 10
            DbSelectArea("TGADM")
            nVGG4MMOADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 11
            DbSelectArea("TGADM")
            nVGG5MMOADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 12
            DbSelectArea("TGADM")
            nVGG6MMOADM := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("TGADM")
            nVGG1MDFADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("TGADM")
            nVGG2MDFADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 15 //9
            DbSelectArea("TGADM")
            nVGG3MDFADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 16
            DbSelectArea("TGADM")
            nVGG4MDFADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 17
            DbSelectArea("TGADM")
            nVGG5MDFADM := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 18
            DbSelectArea("TGADM")
            nVGG6MDFADM := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            DbSelectArea("TGADM")
            nVGG1MDPAD := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 20 //11
            DbSelectArea("TGADM")
            nVGG2MDPAD := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 21 //12
            DbSelectArea("TGADM")
            nVGG3MDPAD := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 22
            DbSelectArea("TGADM")
            nVGG4MDPAD := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 23
            DbSelectArea("TGADM")
            nVGG5MDPAD := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 24
            DbSelectArea("TGADM")
            nVGG6MDPAD := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            DbSelectArea("TGADM")
            nVRes1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 26 //14
            DbSelectArea("TGADM")
            nVRes2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 27 //15
            DbSelectArea("TGADM")
            nVRes3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 28
            DbSelectArea("TGADM")
            nVRes4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 29
            DbSelectArea("TGADM")
            nVRes5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 30
            DbSelectArea("TGADM")
            nVRes6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         If nMes == 31 //16
            DbSelectArea("TGADM")
            nVPrm1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 32 //17
            DbSelectArea("TGADM")
            nVPrm2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 33 //18
            DbSelectArea("TGADM")
            nVPrm3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 34
            DbSelectArea("TGADM")
            nVPrm4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 35
            DbSelectArea("TGADM")
            nVPrm5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 36
            DbSelectArea("TGADM")
            nVPrm6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         If nMes == 37 //19
            DbSelectArea("TGADM")
            nVDVia1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 38 //20
            DbSelectArea("TGADM")
            nVDVia2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 39 //21
            DbSelectArea("TGADM")
            nVDVia3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 40
            DbSelectArea("TGADM")
            nVDVia4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 41
            DbSelectArea("TGADM")
            nVDVia5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 42
            DbSelectArea("TGADM")
            nVDVia6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         If nMes == 43 //22
            DbSelectArea("TGADM")
            nVOut1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 44 //23
            DbSelectArea("TGADM")
            nVOut2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 45 //24
            DbSelectArea("TGADM")
            nVOut3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 46
            DbSelectArea("TGADM")
            nVOut4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 47
            DbSelectArea("TGADM")
            nVOut5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 48
            DbSelectArea("TGADM")
            nVOut6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         If nMes == 49 //25
            DbSelectArea("TGADM")
            nVSvT1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 50 //26
            DbSelectArea("TGADM")
            nVSvT2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 51 //27
            DbSelectArea("TGADM")
            nVSvT3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 52
            DbSelectArea("TGADM")
            nVSvT4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 53
            DbSelectArea("TGADM")
            nVSvT5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 54
            DbSelectArea("TGADM")
            nVSvT6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         If nMes == 55 //28
            DbSelectArea("TGADM")
            nOut1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 56 //29
            DbSelectArea("TGADM")
            nOut2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 57 //30
            DbSelectArea("TGADM")
            nOut3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 58
            DbSelectArea("TGADM")
            nOut4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 59
            DbSelectArea("TGADM")
            nOut5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 60
            DbSelectArea("TGADM")
            nOut6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         If nMes == 61 //31
            DbSelectArea("TGADM")
            nGMt1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 62 //32
            DbSelectArea("TGADM")
            nGMt2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 63 //33
            DbSelectArea("TGADM")
            nGMt3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 64
            DbSelectArea("TGADM")
            nGMt4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 65
            DbSelectArea("TGADM")
            nGMt5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 66
            DbSelectArea("TGADM")
            nGMt6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         If nMes == 67 //34
            DbSelectArea("TGADM")
            nEmp1MAdmEE := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 68 //35
            DbSelectArea("TGADM")
            nEmp2MAdmEE := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 69 //36
            DbSelectArea("TGADM")
            nEmp3MAdmEE := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 70
            DbSelectArea("TGADM")
            nEmp4MAdmEE := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 71
            DbSelectArea("TGADM")
            nEmp5MAdmEE := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 72
            DbSelectArea("TGADM")
            nEmp6MAdmEE := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 73 .And. nMes <= 78
         If nMes == 73 //37
            DbSelectArea("TGADM")
            nFnd1MFixo := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 74 //38
            DbSelectArea("TGADM")
            nFnd2MFixo := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 75 //39
            DbSelectArea("TGADM")
            nFnd3MFixo := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 76
            DbSelectArea("TGADM")
            nFnd4MFixo := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 77
            DbSelectArea("TGADM")
            nFnd5MFixo := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 78
            DbSelectArea("TGADM")
            nFnd6MFixo := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 79 .And. nMes <= 84 //42

         If nMes == 79 //40
            DbSelectArea("TGADM")
            nHonor1MAdv := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 80 //41
            DbSelectArea("TGADM")
            nHonor2MAdv := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 81 //42
            DbSelectArea("TGADM")
            nHonor3MAdv := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 82
            DbSelectArea("TGADM")
            nHonor4MAdv := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 83
            DbSelectArea("TGADM")
            nHonor5MAdv := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 84
            DbSelectArea("TGADM")
            nHonor6MAdv := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 85 .And. nMes <= 90 //45
         If nMes == 85 //43
            DbSelectArea("TGADM")
            nDsp1MJudc := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 86 //44
            DbSelectArea("TGADM")
            nDsp2MJudc := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 87 //45
            DbSelectArea("TGADM")
            nDsp3MJudc := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 88
            DbSelectArea("TGADM")
            nDsp4MJudc := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 89
            DbSelectArea("TGADM")
            nDsp5MJudc := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 90
            DbSelectArea("TGADM")
            nDsp6MJudc := TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 91 .And. nMes <= 96 //48
         If nMes == 91 //46
            DbSelectArea("TGADM")
            nRes1MAcAd := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 92 //47
            DbSelectArea("TGADM")
            nRes2MAcAd := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 93 //48
            DbSelectArea("TGADM")
            nRes3MAcAd := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 94
            DbSelectArea("TGADM")
            nRes4MAcAd := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 95
            DbSelectArea("TGADM")
            nRes5MAcAd := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 96
            DbSelectArea("TGADM")
            nRes6MAcAd := TGADM->VLGGADM
            DbCloseArea()
         EndIf      

      ElseIf nMes >= 97 .And. nMes <= 102 //51
         If nMes == 97 //49
            DbSelectArea("TGADM")
            nCxGer1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 98 //50
            DbSelectArea("TGADM")
            nCxGer2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 99 //51
            DbSelectArea("TGADM")
            nCxGer3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 100
            DbSelectArea("TGADM")
            nCxGer4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 101
            DbSelectArea("TGADM")
            nCxGer5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 102
            DbSelectArea("TGADM")
            nCxGer6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 103 .And. nMes <= 108 //54
         If nMes == 103 //52
            DbSelectArea("TGADM")
            nCxnha1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 104 //53
            DbSelectArea("TGADM")
            nCxnha2MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 105 //54
            DbSelectArea("TGADM")
            nCxnha3MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 106
            DbSelectArea("TGADM")
            nCxnha4MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 107
            DbSelectArea("TGADM")
            nCxnha5MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 108
            DbSelectArea("TGADM")
            nCxnha6MAdm := TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 109 .And. nMes <= 114 //57
         If nMes == 109 //55
            DbSelectArea("TGADM")
            nInves1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 110 //56
            DbSelectArea("TGADM")
            nInves2MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 111 //57
            DbSelectArea("TGADM")
            nInves3MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 112
            DbSelectArea("TGADM")
            nInves4MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 113
            DbSelectArea("TGADM")
            nInves5MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 114
            DbSelectArea("TGADM")
            nInves6MAdm :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 115 .And. nMes <= 120 //60
         If nMes == 115 //58
            DbSelectArea("TGADM")
            nEmpTom1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 116 //59
            DbSelectArea("TGADM")
            nEmpTom2MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 117 //60
            DbSelectArea("TGADM")
            nEmpTom3MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 118
            DbSelectArea("TGADM")
            nEmpTom4MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 119
            DbSelectArea("TGADM")
            nEmpTom5MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 120
            DbSelectArea("TGADM")
            nEmpTom6MAdm :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 121 .And. nMes <= 126 //63
         If nMes == 121 //61
            DbSelectArea("TGADM")
            nEmpCon1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 122 //62
            DbSelectArea("TGADM")
            nEmpCon2MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 123 //63
            DbSelectArea("TGADM")
            nEmpCon3MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 124
            DbSelectArea("TGADM")
            nEmpCon4MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 125
            DbSelectArea("TGADM")
            nEmpCon5MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 126
            DbSelectArea("TGADM")
            nEmpCon6MAdm :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 127 .And. nMes <= 132 //66
         If nMes == 127 //64
            DbSelectArea("TGADM")
            nImbBI1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 128 //65
            DbSelectArea("TGADM")
            nImbBI2MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 129 //66
            DbSelectArea("TGADM")
            nImbBI3MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 130
            DbSelectArea("TGADM")
            nImbBI4MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 131
            DbSelectArea("TGADM")
            nImbBI5MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 132
            DbSelectArea("TGADM")
            nImbBI6MAdm :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 133 .And. nMes <= 138 //69
         If nMes == 133 //67
            DbSelectArea("TGADM")
            nImbBM1MAdm := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 134 //68
            DbSelectArea("TGADM")
            nImbBM2MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 135 //69
            DbSelectArea("TGADM")
            nImbBM3MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 136
            DbSelectArea("TGADM")
            nImbBM4MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 137
            DbSelectArea("TGADM")
            nImbBM5MAdm :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 138
            DbSelectArea("TGADM")
            nImbBM6MAdm :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 139 .And. nMes <= 144 //72
         If nMes == 139 //70
            DbSelectArea("TGADM")
            nDsp1Fin := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 140 //71
            DbSelectArea("TGADM")
            nDsp2Fin :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 141 //72
            DbSelectArea("TGADM")
            nDsp3Fin :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 142
            DbSelectArea("TGADM")
            nDsp4Fin :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 143
            DbSelectArea("TGADM")
            nDsp5Fin :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 144
            DbSelectArea("TGADM")
            nDsp6Fin :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      ElseIf nMes >= 145 .And. nMes <= 150
         If nMes == 145
            DbSelectArea("TGADM")
            nCap1ex := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 146
            DbSelectArea("TGADM")
            nCap2ex :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 147
            DbSelectArea("TGADM")
            nCap3ex :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 148
            DbSelectArea("TGADM")
            nCap4ex :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 149
            DbSelectArea("TGADM")
            nCap5ex :=TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 150
            DbSelectArea("TGADM")
            nCap6ex :=TGADM->VLGGADM
            DbCloseArea()
         EndIf      
      EndIf
      //EndIf
   Next nMes   

   /************************
   *
   * IMPOSTOS CONTRIB. (Total)
   *
   ************************/
   ProcRegua(72) //36)
   For nMes := 1 To 72 //36 //1 A 3 - Impostos Contribuição Total.
                      //4 A 6 - INSS
                      //7 A 9 - FGTS
                      //10 A 12 - CPMF
                      //13 A 15 - IPTU
                      //16 A 18 - IPI
                      //19 A 21 - ICMS
                      //22 A 24 - ISS
                      //25 A 27 - IR
                      //28 A 30 - TRIBUTOS IMPORTAÇÃO
                      //31 A 33 - PIS/COFINS
                      //34 A 36 - TRIBUTOS

                      
      IncProc(" Impostos e Contribuição Proc. "+Alltrim(Str(nMes))+" / 72")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLGGADM "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43 .Or. nMes == 49 .Or. nMes == 55 .Or. nMes == 61 .Or. nMes == 67
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44 .Or. nMes == 50 .Or. nMes == 56 .Or. nMes == 62 .Or. nMes == 68
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45 .Or. nMes == 51 .Or. nMes == 57 .Or. nMes == 63 .Or. nMes == 69
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46 .Or. nMes == 52 .Or. nMes == 58 .Or. nMes == 64 .Or. nMes == 70
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47 .Or. nMes == 53 .Or. nMes == 59 .Or. nMes == 65 .Or. nMes == 71
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48 .Or. nMes == 54 .Or. nMes == 60 .Or. nMes == 66 .Or. nMes == 72
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
      
      If nMes <= 6 //3
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtImpCtrbTt,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtINSS,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtFGTS,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtCPMF,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIPTU,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIPI,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtICMS,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtISS,",")
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIR,",")
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtImpImport,",")
      ElseIf nMes >= 61 .And. nMes <= 66
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtPISCOF,",")
      ElseIf nMes >= 67 .And. nMes <= 72
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtTribut,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      TCQuery cQuery NEW ALIAS "TGADM"
      
      //ww
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("TGADM")
            nImp1MCTt := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TGADM")
            nImp2MCTt := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("TGADM")
            nImp3MCTt := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("TGADM")
            nImp4MCTt := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("TGADM")
            nImp5MCTt := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("TGADM")
            nImp6MCTt := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("TGADM")
            nV1MINSS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("TGADM")
            nV2MINSS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 9 //6
            DbSelectArea("TGADM")
            nV3MINSS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 10
            DbSelectArea("TGADM")
            nV4MINSS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 11
            DbSelectArea("TGADM")
            nV5MINSS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 12
            DbSelectArea("TGADM")
            nV6MINSS := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("TGADM")
            nV1MFGTS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("TGADM")
            nV2MFGTS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 15 //9
            DbSelectArea("TGADM")
            nV3MFGTS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 16
            DbSelectArea("TGADM")
            nV4MFGTS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 17
            DbSelectArea("TGADM")
            nV5MFGTS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 18
            DbSelectArea("TGADM")
            nV6MFGTS := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            DbSelectArea("TGADM")
            nV1MCPMF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 20 //11
            DbSelectArea("TGADM")
            nV2MCPMF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 21 //12
            DbSelectArea("TGADM")
            nV3MCPMF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 22
            DbSelectArea("TGADM")
            nV4MCPMF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 23
            DbSelectArea("TGADM")
            nV5MCPMF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 24
            DbSelectArea("TGADM")
            nV6MCPMF := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            DbSelectArea("TGADM")
            nV1MIPTU := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 26 //14
            DbSelectArea("TGADM")
            nV2MIPTU := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 27 //15
            DbSelectArea("TGADM")
            nV3MIPTU := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 28
            DbSelectArea("TGADM")
            nV4MIPTU := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 29
            DbSelectArea("TGADM")
            nV5MIPTU := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 30
            DbSelectArea("TGADM")
            nV6MIPTU := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         If nMes == 31 //16
            DbSelectArea("TGADM")
            nV1MIPI := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 32 //17
            DbSelectArea("TGADM")
            nV2MIPI := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 33 //18
            DbSelectArea("TGADM")
            nV3MIPI := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 34
            DbSelectArea("TGADM")
            nV4MIPI := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 35
            DbSelectArea("TGADM")
            nV5MIPI := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 36
            DbSelectArea("TGADM")
            nV6MIPI := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         If nMes == 37 //19
            DbSelectArea("TGADM")
            nV1MICMS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 38 //20
            DbSelectArea("TGADM")
            nV2MICMS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 39 //21
            DbSelectArea("TGADM")
            nV3MICMS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 40
            DbSelectArea("TGADM")
            nV4MICMS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 41
            DbSelectArea("TGADM")
            nV5MICMS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 42
            DbSelectArea("TGADM")
            nV6MICMS := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         If nMes == 43 //22
            DbSelectArea("TGADM")
            nV1MISS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 44 //23
            DbSelectArea("TGADM")
            nV2MISS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 45 //24
            DbSelectArea("TGADM")
            nV3MISS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 46
            DbSelectArea("TGADM")
            nV4MISS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 47
            DbSelectArea("TGADM")
            nV5MISS := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 48
            DbSelectArea("TGADM")
            nV6MISS := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 49 .And. nMes <= 54 //27
         If nMes == 49 //25
            DbSelectArea("TGADM")
            nV1MIRImp := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 50 //26
            DbSelectArea("TGADM")
            nV2MIRImp := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 51 //27
            DbSelectArea("TGADM")
            nV3MIRImp := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 52
            DbSelectArea("TGADM")
            nV4MIRImp := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 53
            DbSelectArea("TGADM")
            nV5MIRImp := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 54
            DbSelectArea("TGADM")
            nV6MIRImp := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 55 .And. nMes <= 60 //30
         If nMes == 55 //28
            DbSelectArea("TGADM")
            nV1MImpImport := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 56 //29
            DbSelectArea("TGADM")
            nV2MImpImport := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 57 //30
            DbSelectArea("TGADM")
            nV3MImpImport := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 58
            DbSelectArea("TGADM")
            nV4MImpImport := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 59
            DbSelectArea("TGADM")
            nV5MImpImport := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 60
            DbSelectArea("TGADM")
            nV6MImpImport := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 61 .And. nMes <= 66 //33
         If nMes == 61 //31
            DbSelectArea("TGADM")
            nPIS1MCOF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 62 //32
            DbSelectArea("TGADM")
            nPIS2MCOF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 63 //33
            DbSelectArea("TGADM")
            nPIS3MCOF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 64
            DbSelectArea("TGADM")
            nPIS4MCOF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 65
            DbSelectArea("TGADM")
            nPIS5MCOF := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 66
            DbSelectArea("TGADM")
            nPIS6MCOF := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      ElseIf nMes >= 67 .And. nMes <= 72 //36
         If nMes == 67 //34
            DbSelectArea("TGADM")
            n1MTribut := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 68 //35
            DbSelectArea("TGADM")
            n2MTribut := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 69 //36
            DbSelectArea("TGADM")
            n3MTribut := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 70
            DbSelectArea("TGADM")
            n4MTribut := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 71
            DbSelectArea("TGADM")
            n5MTribut := TGADM->VLGGADM
            DbCloseArea()
         ElseIf nMes == 72
            DbSelectArea("TGADM")
            n6MTribut := TGADM->VLGGADM
            DbCloseArea()
         EndIf
      EndIf
      
   Next nMes   

EndIf

If lLogistica
   
   /********************************
   * FATURAMENTO FOB / CIF 
   *********************************/
   
   ProcRegua(18) //9)
   
   For nMes := 1 To 18 //9
      
      IncProc("Calc. Faturamento FOB/CIF, Processo "+Alltrim(Str(nMes))+" / 18")

      cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO, SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS TFTFOBCIF FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2,"+RetSQLName("SC5")+" SC5"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SC5.C5_FILIAL  = '"+xFilial("SC5")+"' AND  SC5.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += "    AND SC5.C5_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      //cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
      cQuery += " AND SD2.D2_PEDIDO = SC5.C5_NUM"
      
      If nMes <= 6 //3
         cQuery += " AND SC5.C5_TPFRETE = 'F'"
      ElseIf nMEs >= 7 .And. nMes <= 12 //6
         cQuery += " AND SC5.C5_TPFRETE = 'C'"
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += " AND SC5.C5_TPFRETE = ' '"
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6) "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6) ASC"
            
      MemoWrite("C:\TEMP\FatCIFFOB.SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "CFT1"
      
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("CFT1")
               nFOB1MFt := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("CFT1")
               nFOB2MFt := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("CFT1")
               nFOB3MFt := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("CFT1")
               nFOB4MFt := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("CFT1")
               nFOB5MFt := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("CFT1")
               nFOB6MFt := CFT1->TFTFOBCIF
            DbCloseArea()
         EndIf
      ElseIf nMEs >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("CFT1")
               nFt1MCIF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("CFT1")
               nFt2MCIF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 9 //6
            DbSelectArea("CFT1")
               nFt3MCIF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 10
            DbSelectArea("CFT1")
               nFt4MCIF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 11
            DbSelectArea("CFT1")
               nFt5MCIF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 12
            DbSelectArea("CFT1")
               nFt6MCIF := CFT1->TFTFOBCIF
            DbCloseArea()
         EndIf
      ElseIf nMEs >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("CFT1")
               nFt1MSDEF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("CFT1")
               nFt2MSDEF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 15 //9
            DbSelectArea("CFT1")
               nFt3MSDEF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 16
            DbSelectArea("CFT1")
               nFt4MSDEF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 17
            DbSelectArea("CFT1")
               nFt5MSDEF := CFT1->TFTFOBCIF
            DbCloseArea()
         ElseIf nMes == 18
            DbSelectArea("CFT1")
               nFt6MSDEF := CFT1->TFTFOBCIF
            DbCloseArea()
         EndIf
      EndIf
      
   Next nMes
   

   /********************************
   * Calculando Frete nas Notas Fiscais - F2_FRETE
   *********************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Cal.Fretes nas NFs Vendas, Proc.: "+Alltrim(Str(nMes))+" / 6")
      
      cQrySF2 := "SELECT SUM(SF2.F2_FRETE) AS VLRFRETE "
      cQrySF2 += " FROM "+RetSQLName("SF2")+" SF2"
      cQrySF2 += " WHERE SF2.F2_FILIAL = '"+xFilial("SF2")+"'"
      If !lMitto
         cQrySF2 += "    AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1
         cQrySF2 += " AND SUBSTRING(SF2.F2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQrySF2 += " AND SUBSTRING(SF2.F2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQrySF2 += " AND SUBSTRING(SF2.F2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQrySF2 += " AND SUBSTRING(SF2.F2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQrySF2 += " AND SUBSTRING(SF2.F2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQrySF2 += " AND SUBSTRING(SF2.F2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQrySF2 += " AND SF2.D_E_L_E_T_ <> '*'"
      
      MemoWrite("C:\TEMP\VlrFrete.SQL",cQrySF2)
      
      TCQuery cQrySF2 NEW ALIAS "F2FRT"
      
      If nMes == 1
         DbSelectArea("F2FRT")
         nVl1MsFrete := F2FRT->VLRFRETE
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("F2FRT")
         nVl2MsFrete := F2FRT->VLRFRETE
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("F2FRT")
         nVl3MsFrete := F2FRT->VLRFRETE
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("F2FRT")
         nVl4MsFrete := F2FRT->VLRFRETE
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("F2FRT")
         nVl5MsFrete := F2FRT->VLRFRETE
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("F2FRT")
         nVl6MsFrete := F2FRT->VLRFRETE
         DbCloseArea()
      EndIf
      
      
   Next nMes

   /*************************
   *
   * FRETES (Total)
   *
   *************************/

   ProcRegua(48) //24)
   
   For nMes := 1 To 48 //24
   
      IncProc("FRETES (Total), Processo "+Alltrim(Str(nMes))+" / 48")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLBAIXAS "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37 .Or. nMes == 43
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38 .Or. nMes == 44
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39 .Or. nMes == 45
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40 .Or. nMes == 46
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41 .Or. nMes == 47
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42 .Or. nMes == 48
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      EndIf
   
      If nMes <= 6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtVendFrt,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtImporFrt,",")
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtExporFrt,",")
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtBenefFrt,",")
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtTransfFrt,",")
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtComercFrt,",")
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtIndusFrt,",")
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtAdminFrt,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"
      
      TCQuery cQuery NEW ALIAS "TSE5"
      
      If nMEs <= 6 //3
         If nMes == 1
            DbSelectArea("TSE5")
            n1FrtVeMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("TSE5")
            n2FrtVeMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 3
            DbSelectArea("TSE5")
            n3FrtVeMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 4
            DbSelectArea("TSE5")
            n4FrtVeMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 5
            DbSelectArea("TSE5")
            n5FrtVeMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 6
            DbSelectArea("TSE5")
            n6FrtVeMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         If nMes == 7 //4
            DbSelectArea("TSE5")
            n1FrtImpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("TSE5")
            n2FrtImpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 9 //6
            DbSelectArea("TSE5")
            n3FrtImpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 10
            DbSelectArea("TSE5")
            n4FrtImpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 11
            DbSelectArea("TSE5")
            n5FrtImpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 12
            DbSelectArea("TSE5")
            n6FrtImpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 13 .And. nMes <= 18 //9
         If nMes == 13 //7
            DbSelectArea("TSE5")
            n1FrtExpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 14 //8
            DbSelectArea("TSE5")
            n2FrtExpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 15 //9
            DbSelectArea("TSE5")
            n3FrtExpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 16
            DbSelectArea("TSE5")
            n4FrtExpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 17
            DbSelectArea("TSE5")
            n5FrtExpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 18
            DbSelectArea("TSE5")
            n6FrtExpMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 19 .And. nMes <= 24 //12
         If nMes == 19 //10
            DbSelectArea("TSE5")
            n1FrtBenMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 20 //11
            DbSelectArea("TSE5")
            n2FrtBenMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 21 //12
            DbSelectArea("TSE5")
            n3FrtBenMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 22
            DbSelectArea("TSE5")
            n4FrtBenMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 23
            DbSelectArea("TSE5")
            n5FrtBenMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 24
            DbSelectArea("TSE5")
            n6FrtBenMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 25 .And. nMes <= 30 //15
         If nMes == 25 //13
            DbSelectArea("TSE5")
            n1FrtTrfMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 26 //14
            DbSelectArea("TSE5")
            n2FrtTrfMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 27 //15
            DbSelectArea("TSE5")
            n3FrtTrfMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 28
            DbSelectArea("TSE5")
            n4FrtTrfMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 29
            DbSelectArea("TSE5")
            n5FrtTrfMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 30
            DbSelectArea("TSE5")
            n6FrtTrfMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 31 .And. nMes <= 36 //18
         If nMes == 31 //16
            DbSelectArea("TSE5")
            n1FrtComMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 32 //17
            DbSelectArea("TSE5")
            n2FrtComMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 33 //18
            DbSelectArea("TSE5")
            n3FrtComMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 34
            DbSelectArea("TSE5")
            n4FrtComMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 35
            DbSelectArea("TSE5")
            n5FrtComMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 36
            DbSelectArea("TSE5")
            n6FrtComMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 37 .And. nMes <= 42 //21
         If nMes == 37 //19
            DbSelectArea("TSE5")
            n1FrtIndMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 38 //20
            DbSelectArea("TSE5")
            n2FrtIndMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 39 //21
            DbSelectArea("TSE5")
            n3FrtIndMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 40
            DbSelectArea("TSE5")
            n4FrtIndMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 41
            DbSelectArea("TSE5")
            n5FrtIndMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 42
            DbSelectArea("TSE5")
            n6FrtIndMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      ElseIf nMes >= 43 .And. nMes <= 48 //24
         If nMes == 43 //22
            DbSelectArea("TSE5")
            n1FrtAdmMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMes == 44 //23
            DbSelectArea("TSE5")
            n2FrtAdmMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 45 //24
            DbSelectArea("TSE5")
            n3FrtAdmMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 46
            DbSelectArea("TSE5")
            n4FrtAdmMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 47
            DbSelectArea("TSE5")
            n5FrtAdmMVl := TSE5->VLBAIXAS
            DbCloseArea()
         ElseIf nMEs == 48
            DbSelectArea("TSE5")
            n6FrtAdmMVl := TSE5->VLBAIXAS
            DbCloseArea()
         EndIf
      EndIf
      
   Next nMes
   
   /***************************
   * DESPESAS - DEMONSTRATIVO DE RESULTADOS
   *
   * Salarios - Demonstrativo de Resultados
   * TODAS AS DESPESAS DA M.O. DA INDÚSTRIA INCLUINDO A SUA AREA ADMINISTRATIVA '100301','100302','100303','100304','100305','100306','100307',
   * '100309','100310','100311','100312','100313','100317','100401','100402','100403','100404','100405','100406','100407','100409','100410','100411','100412','100417'
   *
   * //TODAS AS DESPESAS DO COMERCIAL (EXCLUI A NATUREZA DE EMPRÉSTIMO E REEMBOLSO A CLIENTE) '100201','100202','100203','100204','100205','100206',
   * //'100207','100208','100209','100210','100211','100213','100214','100215','100216','100222','200201','200202','200203','200204','200205','200206','200207','600101','600102','600303','600401'
   * 
   *
   ***************************/
   //kxx
   ProcRegua(42) //12) //4)
   
   For nMes := 1 To 42 //12 //4
   
      IncProc("Calc.Despesas DRE, Proc. "+Alltrim(Str(nMes))+" / 42")
      
      cQuery := " SELECT SUM(SE2.E2_VALOR) AS VLMPTOTAL "
      cQuery += " FROM " + RetSqlName("SE2")+" SE2 "
      cQuery += " WHERE SE2.E2_FILIAL = '"+xFilial("SE2")+"'"
      If !lMitto
         cQuery += "    AND SE2.E2_FORNECE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf

      If     nMes == 1 .Or. nMes == 7 .Or. nMes == 13 .Or. nMes == 19 .Or. nMes == 25 .Or. nMes == 31 .Or. nMes == 37
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2 .Or. nMes == 8 .Or. nMes == 14 .Or. nMes == 20 .Or. nMes == 26 .Or. nMes == 32 .Or. nMes == 38
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3 .Or. nMes == 9 .Or. nMes == 15 .Or. nMes == 21 .Or. nMes == 27 .Or. nMes == 33 .Or. nMes == 39
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4 .Or. nMes == 10 .Or. nMes == 16 .Or. nMes == 22 .Or. nMes == 28 .Or. nMes == 34 .Or. nMes == 40
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5 .Or. nMes == 11 .Or. nMes == 17 .Or. nMes == 23 .Or. nMes == 29 .Or. nMes == 35 .Or. nMes == 41
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6 .Or. nMes == 12 .Or. nMes == 18 .Or. nMes == 24 .Or. nMes == 30 .Or. nMes == 36 .Or. nMes == 42
         cQuery += "    AND  SUBSTRING(SE2.E2_EMISSAO,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      If nMes <= 6 //3
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtMOINDADM,",")
      ElseIf nMes >= 7 .And. nMes <= 12 //6
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cDspCDER,",")
      ElseIf nMes  >= 13 .And. nMes <= 18 //9
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNtAdmDER,",")
      ElseIf nMes  >= 19 .And. nMes <= 24 //12
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNDpFinDER,",")
      ElseIf nMes  >= 25 .And. nMes <= 30
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNSlAdmId,",")
      ElseIf nMes  >= 31 .And. nMes <= 36
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cNDFDsbls,",")
      ElseIf nMes  >= 37 .And. nMes <= 42
         cQuery += "  AND SE2.E2_NATUREZ IN "+FormatIn(cAdFxDsb,",")
      EndIf
      
      cQuery += "  AND SE2.D_E_L_E_T_ = ' '"

      
      TCQuery cQuery NEW ALIAS "VMPTT"
      
         If nMes <= 6 //3
            If nMes == 1
               DbSelectArea("VMPTT")
               nMPMO1IndAdm := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 2
               DbSelectArea("VMPTT")
               nMPMO2IndAdm := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 3
               DbSelectArea("VMPTT")
               nMPMO3IndAdm := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 4
               DbSelectArea("VMPTT")
               nMPMO4IndAdm := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 5
               DbSelectArea("VMPTT")
               nMPMO5IndAdm := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 6
               DbSelectArea("VMPTT")
               nMPMO6IndAdm := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         ElseIf nMes >= 7 .And. nMes <= 12 //6
            If nMes == 7 //4
               DbSelectArea("VMPTT")
               nDesp1ComDRE := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 8 //5
               DbSelectArea("VMPTT")
               nDesp2ComDRE := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 9 //6
               DbSelectArea("VMPTT")
               nDesp3ComDRE := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 10
               DbSelectArea("VMPTT")
               nDesp4ComDRE := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 11
               DbSelectArea("VMPTT")
               nDesp5ComDRE := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 12
               DbSelectArea("VMPTT")
               nDesp6ComDRE := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         ElseIf nMes >= 13 .And. nMes <= 18 //9
            If nMes == 13 //7
               DbSelectArea("VMPTT")
               nDsp1ADMDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 14 //8
               DbSelectArea("VMPTT")
               nDsp2ADMDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 15 //9
               DbSelectArea("VMPTT")
               nDsp3ADMDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 16
               DbSelectArea("VMPTT")
               nDsp4ADMDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 17
               DbSelectArea("VMPTT")
               nDsp5ADMDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 18
               DbSelectArea("VMPTT")
               nDsp6ADMDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         ElseIf nMes >= 19 .And. nMes <= 24 //12
            If nMes == 19 //10
               DbSelectArea("VMPTT")
               nDspFi1nsDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 20 //11
               DbSelectArea("VMPTT")
               nDspFi2nsDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 21 //12
               DbSelectArea("VMPTT")
               nDspFi3nsDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 22
               DbSelectArea("VMPTT")
               nDspFi4nsDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 23
               DbSelectArea("VMPTT")
               nDspFi5nsDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 24
               DbSelectArea("VMPTT")
               nDspFi6nsDER := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         ElseIf nMes >= 25 .And. nMes <= 30
            If nMes == 25
               DbSelectArea("VMPTT")
               nSalInd1Adm   := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 26
               DbSelectArea("VMPTT")
               nSalInd2Adm   := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 27
               DbSelectArea("VMPTT")
               nSalInd3Adm    := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 28
               DbSelectArea("VMPTT")
               nSalInd4Adm    := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 29
               DbSelectArea("VMPTT")
               nSalInd5Adm := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 30
               DbSelectArea("VMPTT")
               nSalInd6Adm := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         ElseIf nMes >= 31 .And. nMes <= 36 //30
            If nMes == 31
               DbSelectArea("VMPTT")
               nDsbFx1Dsp  := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 32
               DbSelectArea("VMPTT")
               nDsbFx2Dsp   := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 33
               DbSelectArea("VMPTT")
               nDsbFx3Dsp := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 34
               DbSelectArea("VMPTT")
               nDsbFx4Dsp := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 35
               DbSelectArea("VMPTT")
               nDsbFx5Dsp := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 36
               DbSelectArea("VMPTT")
               nDsbFx6Dsp := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         ElseIf nMes >= 37 .And. nMes <= 42
            If nMes == 37
               DbSelectArea("VMPTT")
               nDsbF1Ad  := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 38
               DbSelectArea("VMPTT")
               nDsbF2Ad := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 39
               DbSelectArea("VMPTT")
               nDsbF3Ad := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 40
               DbSelectArea("VMPTT")
               nDsbF4Ad := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 41
               DbSelectArea("VMPTT")
               nDsbF5Ad := VMPTT->VLMPTOTAL
               DbCloseArea()
            ElseIf nMes == 42
               DbSelectArea("VMPTT")
               nDsbF6Ad := VMPTT->VLMPTOTAL
               DbCloseArea()
            EndIf
         EndIf

   Next nMes

   /***************************
   * RECEITAS - DEMONSTRATIVO DE RESULTADOS
   ***************************/
   //kxx
   ProcRegua(6)
   
   For nMes := 1 To 6
   
      IncProc("Calc.Receitas DRE, Proc. "+Alltrim(Str(nMes))+" / 6")
      
      cQuery := " SELECT SUM(SE5.E5_VALOR) AS VLMPTOTAL "
      cQuery += " FROM " + RetSqlName("SE5")+" SE5 "
      cQuery += " WHERE SE5.E5_RECPAG = 'R'"
      If !lMitto
         cQuery += "    AND SE5.E5_CLIFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf

      If nMes == 1
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dDataDe),1,6)+ "'"
      ElseIf nMes == 2
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData02),1,6)+ "'"
      ElseIf nMes == 3
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData03),1,6)+ "'"
      ElseIf nMes == 4
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData04),1,6)+ "'"
      ElseIf nMes == 5
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData05),1,6)+ "'"
      ElseIf nMes == 6
         cQuery += "    AND  SUBSTRING(SE5.E5_DATA,1,6) = '" +Substr(DTOS(dData06),1,6)+ "'"
      EndIf
   
      cQuery += "  AND SE5.E5_NATUREZ IN "+FormatIn(cNRctFinDRE,",")
      
      cQuery += "  AND SE5.D_E_L_E_T_ = ' '"
      //cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA')" - 20/07/2009 - Acrescentado TIPODOC PA para apresentar os Pagamentos Antecipados
      cQuery += "  AND SE5.E5_TIPODOC IN ('VL','BA','PA')"
      //cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - Solicitação de Patrícia - 16/12/2009
      cQuery += "  AND SE5.E5_MOTBX <> 'CMP'" //Five Solutions Consultoria - 26/08/2010 - Solicitação de Patrícia - 26/08/2010
      cQuery += "  AND SE5.E5_MOTBX <> 'DEV'" //Five Solutions Consultoria - 25/11/2010 - Solicitação de Patrícia
      cQuery += "  AND SE5.E5_SITUACA = ' '"
      cQuery += "  AND SUBSTRING(SE5.E5_NUMERO,1,6)  <> '      '"
      cQuery += "  AND SE5.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "  AND (SELECT COUNT(*)"
      cQuery += "         FROM "+RetSQLName("SE5")+" TMP"
      cQuery += "       WHERE TMP.E5_FILIAL = '"+xFilial("SE5")+"'"
      cQuery += "         AND TMP.E5_FILIAL = SE5.E5_FILIAL"
      cQuery += "         AND TMP.E5_PREFIXO = SE5.E5_PREFIXO"
      cQuery += "         AND TMP.E5_NUMERO = SE5.E5_NUMERO"
      cQuery += "         AND TMP.E5_PARCELA = SE5.E5_PARCELA"
      cQuery += "         AND TMP.E5_TIPO = SE5.E5_TIPO"
      cQuery += "         AND TMP.E5_CLIFOR = SE5.E5_CLIFOR"
      cQuery += "         AND TMP.E5_LOJA = SE5.E5_LOJA"
      cQuery += "         AND TMP.E5_VALOR = SE5.E5_VALOR"   
      cQuery += "         AND TMP.E5_SEQ = SE5.E5_SEQ"
      cQuery += "         AND TMP.E5_TIPODOC = 'ES'"
      cQuery += "         AND TMP.D_E_L_E_T_ <> '*') = 0"
      
      TCQuery cQuery NEW ALIAS "VMPTT"
      
         If nMes == 1
            DbSelectArea("VMPTT")
            nRecDR1EFin := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("VMPTT")
            nRecDR2EFin := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("VMPTT")
            nRecDR3EFin := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("VMPTT")
            nRecDR4EFin := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("VMPTT")
            nRecDR5EFin := VMPTT->VLMPTOTAL
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("VMPTT")
            nRecDR6EFin := VMPTT->VLMPTOTAL
            DbCloseArea()
         EndIf
      
   Next nMes

EndIf

If lDemonsRes
   
   ProcRegua(12) //6)
   
   For nMes := 1 To 12 //6  //Faturamento por Condição(Pagamento) A Vista/A Prazo
      
      IncProc("Calc.Fat. A Vista/A Prazo Proc. "+Alltrim(Str(nMes))+" / 12")
      
      //Faturamento A Vista/A Prazo - Antes, cQuery := " SELECT SUM(SD2.D2_TOTAL+SD2.D2_VALIPI+SD2.D2_ICMSRET+SD2.D2_VALFRE+SD2.D2_SEGURO+SD2.D2_DESPESA) AS VALBRUTO FROM "
      cQuery := " SELECT SUM(D2_TOTAL+CASE WHEN SD2.D2_TIPO <> 'P' THEN D2_VALIPI+D2_ICMSRET+D2_VALFRE+D2_SEGURO+D2_DESPESA ELSE 0 END) AS VALBRUTO FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN "+FormatIn(cCFOPVenda,",")
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
      If     nMes == 1 .Or. nMes == 7
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2 .Or. nMes == 8
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3 .Or. nMes == 9
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4 .Or. nMes == 10
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5 .Or. nMes == 11
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6 .Or. nMes == 12
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
            
      If nMes <= 6 //3
         cQuery += " AND SF2.F2_COND = 'V01'"
      ElseIf nMes >= 7 //4
         cQuery += " AND SF2.F2_COND <> 'V01'"
      EndIf
      
      If nMes == 1
         MemoWrite("C:\TEMP\FatAVisAPrz"+Alltrim(Str(nMes))+".SQL",cQuery)
      EndIf
      
      TCQuery cQuery NEW ALIAS "CFT"
      
      //If nMes == 1
      TCSetField("CFT","VALBRUTO","N",14,02)
      //EndIf
      
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("CFT")
            nFat1AVista := CFT->VALBRUTO
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("CFT")
            nFat2AVista := CFT->VALBRUTO
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("CFT")
            nFat3AVista := CFT->VALBRUTO
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("CFT")
            nFat4AVista := CFT->VALBRUTO
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("CFT")
            nFat5AVista := CFT->VALBRUTO
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("CFT")
            nFat6AVista := CFT->VALBRUTO
            DbCloseArea()
         EndIf
      ElseIf nMes >= 7 //4
         If nMes == 7 //4
            DbSelectArea("CFT")
            nFat1APrazo := CFT->VALBRUTO  
            DbCloseArea()
         ElseIf nMes == 8 //5
            DbSelectArea("CFT")
            nFat2APrazo := CFT->VALBRUTO  
            DbCloseArea()
         ElseIf nMes == 9 //6
            DbSelectArea("CFT")
            nFat3APrazo := CFT->VALBRUTO  
            DbCloseArea()
         ElseIf nMes == 10
            DbSelectArea("CFT")
            nFat4APrazo := CFT->VALBRUTO  
            DbCloseArea()
         ElseIf nMes == 11
            DbSelectArea("CFT")
            nFat5APrazo := CFT->VALBRUTO  
            DbCloseArea()
         ElseIf nMes == 12
            DbSelectArea("CFT")
            nFat6APrazo := CFT->VALBRUTO  
            DbCloseArea()
         EndIf
      EndIf
      
   Next nMes

   /********************************
   * Calculando Impostos nas Notas Fiscais de Vendas
   *********************************/

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3 //6
      
      IncProc("Calc.Imp.(IPI/ICMS) NFs Vendas, Processo "+Alltrim(Str(nMes))+" / 6")

      If nMes <= 6 //3
         cQuery := " SELECT SUM(F3_VALIPI) AS VALIPI, SUM(F3_VALICM) AS VALICM FROM "
      //ElseIf nMes >= 4
      //   cQuery := " SELECT SUM(F3_VALCONT) AS VALORVEN FROM "
      EndIf
      cQuery += RetSqlName('SF3') + " SF3"
      cQuery += " WHERE SF3.F3_FILIAL = '"+xFilial("SF3")+"' AND  SF3.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF3.F3_CFO IN "+FormatIn(cCFOPVenda,",")
      If !lMitto
         cQuery += " AND SF3.F3_CLIEFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If     nMes == 1 //.Or. nMes == 4
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2 //.Or. nMes == 5
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3 //.Or. nMes == 6
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4 //.Or. nMes == 6
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5 //.Or. nMes == 6
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6 //.Or. nMes == 6
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " AND SF3.F3_OBSERV <> 'NF CANCELADA' "
      cQuery += " AND SF3.D_E_L_E_T_ <> '*'"
      //ElseIf nMes == 2
      //   cQuery += " AND  SUBSTRING(SF3.F3_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      //ElseIf nMes == 3
      //   cQuery += " AND  SUBSTRING(SF3.F3_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      //EndIf
      
      MemoWrite("C:\TEMP\ImpICMIPI.SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "CFT1"
      
      If nMes <= 6 //3
         If nMes == 1
            DbSelectArea("CFT1")
            nIPI1Valor := CFT1->VALIPI
            nICM1Vlor  := CFT1->VALICM
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("CFT1")
            nIPI2Valor := CFT1->VALIPI
            nICM2Vlor  := CFT1->VALICM
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("CFT1")
            nIPI3Valor := CFT1->VALIPI
            nICM3Vlor  := CFT1->VALICM
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("CFT1")
            nIPI4Valor := CFT1->VALIPI
            nICM4Vlor  := CFT1->VALICM
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("CFT1")
            nIPI5Valor := CFT1->VALIPI
            nICM5Vlor  := CFT1->VALICM
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("CFT1")
            nIPI6Valor := CFT1->VALIPI
            nICM6Vlor  := CFT1->VALICM
            DbCloseArea()
         EndIf
     
      EndIf 
      
      
   Next nMes
   


   /********************************
   * Calculando Impostos nas Notas Fiscais de Vendas
   *********************************/

   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Calc.Imp.(PIS/COFINS) NFs Vendas, Proc.: "+Alltrim(Str(nMes))+" / 6")

      cQuery := " SELECT SUM(F2_VALIMP5) AS VALCOF, SUM(F2_VALIMP6) AS VALPIS FROM "
      cQuery += RetSqlName('SF3') + " SF3,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SF3.F3_FILIAL = '"+xFilial("SF3")+"' AND  SF3.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      
      cQuery += " AND SF2.F2_DOC = SF3.F3_NFISCAL"
      cQuery += " AND SF2.F2_SERIE = SF3.F3_SERIE"
      cQuery += " AND SF2.F2_CLIENTE = SF3.F3_CLIEFOR"
      cQuery += " AND SF2.F2_LOJA = SF3.F3_LOJA"
      
      cQuery += " AND SF3.F3_CFO IN "+FormatIn(cCFOPVenda,",")
      If !lMitto
         cQuery += " AND SF3.F3_CLIEFOR <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      
      If nMes == 1 
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SF3.F3_ENTRADA,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " AND SF3.F3_OBSERV <> 'NF CANCELADA' "
      cQuery += " AND SF3.D_E_L_E_T_ <> '*'"
      //ElseIf nMes == 2
      //   cQuery += " AND  SUBSTRING(SF3.F3_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      //ElseIf nMes == 3
      //   cQuery += " AND  SUBSTRING(SF3.F3_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      //EndIf
      
      MemoWrite("C:\TEMP\ImpPISCOFINS.SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "CFT1"
      
      If nMes <= 6 //3
         //CALCULAR PIS (1,65%) E COFINS (7,60%) SOBRE O FATURAMENTO TOTAL DE VENDAS (LIVRO FISCAL DE SAÍDA)
         If nMes == 1
            DbSelectArea("CFT1")
            nPIS1Valor := CFT1->VALPIS
            nCOF1Valor := CFT1->VALCOF
            DbCloseArea()
         ElseIf nMes == 2
            DbSelectArea("CFT1")
            nPIS2Valor := CFT1->VALPIS
            nCOF2Valor := CFT1->VALCOF
            DbCloseArea()
         ElseIf nMes == 3
            DbSelectArea("CFT1")
            nPIS3Valor := CFT1->VALPIS
            nCOF3Valor := CFT1->VALCOF
            DbCloseArea()
         ElseIf nMes == 4
            DbSelectArea("CFT1")
            nPIS4Valor := CFT1->VALPIS
            nCOF4Valor := CFT1->VALCOF
            DbCloseArea()
         ElseIf nMes == 5
            DbSelectArea("CFT1")
            nPIS5Valor := CFT1->VALPIS
            nCOF5Valor := CFT1->VALCOF
            DbCloseArea()
         ElseIf nMes == 6
            DbSelectArea("CFT1")
            nPIS6Valor := CFT1->VALPIS
            nCOF6Valor := CFT1->VALCOF
            DbCloseArea()
         EndIf
      EndIf
      
   Next nMes
   
   //Calculo dos Incentivos Fiscais
   RecIncFis()   //Five Solutions Consultoria - 29/07/2010
   
EndIf

Return

/*
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe   ³ SaldoTit(ExpC1,ExpC2,ExpC3,ExpC4,ExpC5,ExpC6,ExpC7,ExpN1)  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ ExpC1=Numero do Prefixo                                    ³±±
±±³          ³ ExpC2=Numero do Titulo                                     ³±±
±±³          ³ ExpC3=Parcela                                              ³±±
±±³          ³ ExpC4=Tipo                                                 ³±±
±±³          ³ ExpC5=Natureza                                             ³±±
±±³          ³ ExpC6=Carteira  (R/P)                                      ³±±
±±³          ³ ExpC7=Fornecedor (se ExpC6 = 'R')                          ³±±
±±³          ³ ExpN1=Moeda                                                ³±±
±±³          ³ ExpD1=Data para conversao                                  ³±±
±±³          ³ ExpD2=Data data baixa a ser considerada (retroativa)       ³±±
±±³          ³ ExpC8=Loja do titulo                                       ³±±
±±³          ³ ExpC9=Filial do titulo                                     ³±±
±±³          ³ Expn2=Taxa da Moeda                                        ³±±
±±³          ³ Expn3=Tipo de data para compor saldo (baixa/dispo/digit)   ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function TitSaldo(cPrefixo,cNumero,cParcela,cTipo,cNatureza,cCart,cCliFor,nMoeda,;
						dData,dDataBaixa,cLoja,cFilTit,nTxMoeda,nTipoData)
//Tipos de Data (cTipoData ou xTipoData)
// 0 = Data Da Baixa (E5_DATA) (Default)
// 1 = Data de Disponibilidade (E5_DTDISPO)
// 2 = Data de Contabilidação (E5_DTDIGIT)

#IFDEF TOP
	Local nSaldo     := 0
	Local cxFilial   := nil
	Local cProcedure := 'FIN002'
	Local cTiPoData  := "0"
	Local cAliasTit
	
	Local lPCCBaixa := SuperGetMv("MV_BX10925",.T.,"2") == "1"  .and. (!Empty( SE5->( FieldPos( "E5_VRETPIS" ) ) ) .And. !Empty( SE5->( FieldPos( "E5_VRETCOF" ) ) ) .And. ; 
				 !Empty( SE5->( FieldPos( "E5_VRETCSL" ) ) ) .And. !Empty( SE5->( FieldPos( "E5_PRETPIS" ) ) ) .And. ;
				 !Empty( SE5->( FieldPos( "E5_PRETCOF" ) ) ) .And. !Empty( SE5->( FieldPos( "E5_PRETCSL" ) ) ) .And. ;
				 !Empty( SE2->( FieldPos( "E2_SEQBX"   ) ) ) .And. !Empty( SFQ->( FieldPos( "FQ_SEQDES"  ) ) ) )       
				 
	Local cPCCBaixa   := iif(lPCCBaixa,"1","0")  
	Local cAdiant		:= IIF( (cTipo $ MVRECANT+"/"+MVPAGANT+"/"+MV_CRNEG+"/"+MV_CPNEG), "1","0")

	DEFAULT nTxMoeda := 0
	
	dDataBaixa  := iif(dDataBaixa ==nil, dDataBase, dDataBaixa )
	dData       := iif(dData      ==nil, dDataBase, dData )
	nMoeda      := iif(nMoeda     ==nil, 1        , nMoeda )
	cLoja       := iif(cLoja      ==nil, iif(cCart=="R",SE1->E1_LOJA   ,SE2->E2_LOJA   ), cLoja )
	nTipoData	:= iif(nTipoData  ==nil, 1 , nTipoData )

	If nTipoData == 1
		cTipoData := "0"  // E5_DATA
	ElseIf nTipodata == 2
		cTipoData := "1"  // E5_DTDISPO
	Else
		cTipoData := "2"  // E5_DTDIGIT
	Endif


	If ExistProc( cProcedure ) .and. ( TcSrvType() <> "AS/400" )
	    //Alert("Executando Procedure 'FIN002' IF 1  nSld1MPag "+Alltrim(Str(nSld1MPag)))
		aResult := {}

		cCliFor:=Iif( cCliFor=NIL,Iif(cCart=="R",SE1->E1_CLIENTE,SE2->E2_FORNECE),cCliFor )
		cLoja  :=Iif( cLoja  =NIL,Iif(cCart=="R",SE1->E1_LOJA   ,SE2->E2_LOJA   ),cLoja   )

		If cCart = "R"
			cAliasTit := "SE1"
			dbSelectArea("SE1")
			nSaldo    := E1_VALOR+SE1->E1_SDACRES-SE1->E1_SDDECRE  
			nMoedaTit := SE1->E1_MOEDA
			cCliFor   := Iif(Empty(cCliFor),SE1->E1_CLIENTE,cCliFor)
			cLoja     := Iif(Empty(cLoja  ),SE1->E1_LOJA,cLoja)
		Else
			cAliasTit := "SE2"
			dbSelectArea("SE2")
			nSaldo    := E2_VALOR+SE2->E2_SDACRES-SE2->E2_SDDECRE  
			nMoedaTit := SE2->E2_MOEDA
		Endif

		nMoeda    := ((nMoeda+1.00)-1.00)
		nMoedaTit := ((nMoedaTit+1.00)-1.00)

		aResult := TCSPEXEC( xProcedures(cProcedure),;
			cPrefixo,                cNumero,;
			cParcela,                cTipo,;
			cCliFor,                 DTOS(dData),;
			DTOS(dDataBaixa),        cLoja,;
			DTOS(dDataBase),         cFilAnt,;
			nSaldo,                  nMoedaTit,;
			cPaisLoc,                cTipoData,;
			cPCCBaixa,               cCart, cAdiant )

		nSaldo := aResult[1]
		// Zera o Saldo devido problema de arredondamento nos juros, ou seja, o valor dos juros que eh gravado com
		// 2 casas decimais, gera diferena na recomposicao do saldo no titulo
		// Exemplo: Titulo com valor de 24.450, com E1_PORCJUR de 0.13 e tres dias de atraso, grava em E5_JUROS o valor 
		// de 95.36, sendo que o valor dos juros seria 95.355
		// Movimentacao no SE5:
		//	      Baixa	Juros	       Saldo
		//		 		            24.450,00
		//-------------------------------
		//		4.001,04	95,36 	20.544,32 3 dias apos vencto.
		//		2.100,95		      18.443,37 mesma data
		//		3.474,23		      14.969,14 mesma data
		//		6.000,00		       8.969,14 5 dias apos vencto
		//		5.060,00		       3.909,14 10 dias apos vencto
		//		3.919,29	10,16	        0,01 12 dias apos vencto
		If Empty((cAliasTit)->&(Right(cAliasTit,2)+"_SALDO")) .And. Abs(nSaldo) <= 0.01
			nSaldo := 0
		Else
			nSaldo := xMoeda(nSaldo,nMoedaTit,nMoeda,dData,,nTxMoeda)
		Endif
		Return (nSaldo)
	Elseif ExistProc( cProcedure ) .and. ( TcSrvType() == "AS/400" )
	    //Alert("Executando Procedure 'FIN002' IF 22222222  nSld1MPag "+Alltrim(Str(nSld1MPag)))
		aResult := {}
		cxFilial := BuildStrFil("SE5")

		cCliFor:=Iif( cCliFor=NIL,Iif(cCart=="R",SE1->E1_CLIENTE,SE2->E2_FORNECE),cCliFor )
		cLoja  :=Iif( cLoja  =NIL,Iif(cCart=="R",SE1->E1_LOJA   ,SE2->E2_LOJA   ),cLoja   )

		If cCart = "R"
			dbSelectArea("SE1")
			nSaldo    := E1_VALOR+SE1->E1_SDACRES-SE1->E1_SDDECRE  
			nMoedaTit := SE1->E1_MOEDA
			cCliFor   := Iif(Empty(cCliFor),SE1->E1_CLIENTE,cCliFor)
			cLoja     := Iif(Empty(cLoja  ),SE1->E1_LOJA,cLoja)
		Else
			dbSelectArea("SE2")
			nSaldo    := E2_VALOR+SE2->E2_SDACRES-SE2->E2_SDDECRE  
			nMoedaTit := SE2->E2_MOEDA
		Endif

		nMoeda    := ((nMoeda+1.00)-1.00)
		nMoedaTit := ((nMoedaTit+1.00)-1.00)

		aResult := TCSPEXEC( xProcedures(cProcedure), cxFilial,;
			cPrefixo,                cNumero,;
			cParcela,                cTipo,;
			cNatureza,               cCart,;
			cCliFor,                 nMoeda,;
			DTOS(dData),             DTOS(dDataBaixa),;
			cLoja,                   DTOS(dDataBase),;
			cFilAnt,                 '',;
			nSaldo,                  nMoedaTit, cTipoData)

		nSaldo := aResult[1]
		// Zera o Saldo devido problema de arredondamento nos juros, ou seja, o valor dos juros que eh gravado com
		// 2 casas decimais, gera diferena na recomposicao do saldo no titulo
		// Exemplo: Titulo com valor de 24.450, com E1_PORCJUR de 0.13 e tres dias de atraso, grava em E5_JUROS o valor 
		// de 95.36, sendo que o valor dos juros seria 95.355
		// Movimentacao no SE5:
		//	      Baixa	Juros	       Saldo
		//		 		            24.450,00
		//-------------------------------
		//		4.001,04	95,36 	20.544,32 3 dias apos vencto.
		//		2.100,95		      18.443,37 mesma data
		//		3.474,23		      14.969,14 mesma data
		//		6.000,00		       8.969,14 5 dias apos vencto
		//		5.060,00		       3.909,14 10 dias apos vencto
		//		3.919,29	10,16	        0,01 12 dias apos vencto
		If Empty((cAliasTit)->&(Right(cAliasTit,2)+"_SALDO")) .And. Abs(nSaldo) <= 0.009
			nSaldo := 0
		Else
			nSaldo := xMoeda(nSaldo,nMoedaTit,nMoeda,dData,,nTxMoeda)
		Endif
		Return (nSaldo)
	Else
	    //Alert("Executando Função TitxSaldo "+Alltrim(Str(nSld1MPag)))
		Return TitxSaldo(@cPrefixo,@cNumero,@cParcela,@cTipo,@cNatureza,@cCart,@cCliFor,@nMoeda,@dData,@dDataBaixa,@cLoja,@cFilTit,nTxMoeda,nTipoData)
	Endif

	/*/
	ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
	±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
	±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
	±±³Funo    ³ SaldoTit ³ Autor ³ Wagner Xavier         ³ Data ³ 20/08/93 ³±±
	±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
	±±³Descrio ³ Calcula o valor de um titulo em uma determinada data       ³±±
	±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
	±±³Sintaxe   ³ SaldoTit(ExpC1,ExpC2,ExpC3,ExpC4,ExpC5,ExpC6,ExpC7,ExpN1)  ³±±
	±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
	±±³Parametros³ ExpC1=Numero do Prefixo                                    ³±±
	±±³          ³ ExpC2=Numero do Titulo                                     ³±±
	±±³          ³ ExpC3=Parcela                                              ³±±
	±±³          ³ ExpC4=Tipo                                                 ³±±
	±±³          ³ ExpC5=Natureza                                             ³±±
	±±³          ³ ExpC6=Carteira  (R/P)                                      ³±±
	±±³          ³ ExpC7=Fornecedor (se ExpC6 = 'R')                          ³±±
	±±³          ³ ExpN1=Moeda                                                ³±±
	±±³          ³ ExpD1=Data para conversao                                  ³±±
	±±³          ³ ExpD2=Data data baixa a ser considerada (retroativa)       ³±±
	±±³          ³ ExpC8=Loja do titulo                                       ³±±
	±±³          ³ ExpC9=Filial do titulo                                     ³±±
	±±³          ³ ExpX10=Tipo de data para compor saldo (baixa/dispo/digit)  ³±±
	±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
	±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
	ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
	*/

	Static Function TitxSaldo(cPrefixo,cNumero,cParcela,cTipo,cNatureza,cCart,cCliFor,nMoeda,;
							 dData,dDataBaixa,cLoja,cFilTit,nTxMoeda,nTipoData)
#ENDIF

//Tipos de Data (cTipoData)
// 0 = Data Da Baixa (E5_DATA)
// 1 = Data de Disponibilidade (E5_DTDISPO)
// 2 = Data de Contabilidação (E5_DTDIGIT)

LOCAL cAlias:=Alias(),nSaldo:=0,dDataMoeda, nMoedaTit
LOCAL cCarteira
LOCAL dDtFina 
Local cAliasTit

//Controla o Pis Cofins e Csll na baixa
Local lPCCBaixa := SuperGetMv("MV_BX10925",.T.,"2") == "1"  .and. (!Empty( SE5->( FieldPos( "E5_VRETPIS" ) ) ) .And. !Empty( SE5->( FieldPos( "E5_VRETCOF" ) ) ) .And. ; 
				 !Empty( SE5->( FieldPos( "E5_VRETCSL" ) ) ) .And. !Empty( SE5->( FieldPos( "E5_PRETPIS" ) ) ) .And. ;
				 !Empty( SE5->( FieldPos( "E5_PRETCOF" ) ) ) .And. !Empty( SE5->( FieldPos( "E5_PRETCSL" ) ) ) .And. ;
				 !Empty( SE2->( FieldPos( "E2_SEQBX"   ) ) ) .And. !Empty( SFQ->( FieldPos( "FQ_SEQDES"  ) ) ) )


DEFAULT nTxMoeda := 0

cCliFor:=Iif( cCliFor=NIL,Iif(cCart=="R",SE1->E1_CLIENTE,SE2->E2_FORNECE),cCliFor )
cLoja  :=Iif( cLoja  =NIL,Iif(cCart=="R",SE1->E1_LOJA   ,SE2->E2_LOJA   ),cLoja   )
nMoeda :=IIF( nMoeda==NIL,1,nMoeda )
dDataMoeda :=IIF( dData==NIL,dDataBase,dData )
dDataBaixa :=IIF( dDataBaixa==NIL,dDataBase,dDataBaixa )
nTipoData  := IIF( nTipoData  ==nil, 0 , nTipoData )

If nTipoData == 1
	cTipoData := "0"  // E5_DATA
ElseIf nTipodata == 2
	cTipoData := "1"  // E5_DTDISPO
Else
	cTipoData := "2"  // E5_DTDIGIT
Endif


// cFiltit somente e' usado no caso de relatorios que podem ser tirados
// por empresa (opcional)
cFilTit := Iif(cFilTit==Nil,xFilial("SE5"),cFilTit)

dbSelectArea("SE5")
If xFilial() == "  "
	cFilTit := "  "
Endif

If cCart = "R"
	cAliasTit := "SE1"
	dbSelectArea("SE1")
	nSaldo := E1_VALOR+SE1->E1_SDACRES-SE1->E1_SDDECRE  
	nMoedaTit := SE1->E1_MOEDA
	cCliFor := Iif(Empty(cCliFor),SE1->E1_CLIENTE,cCliFor)
	cLoja   := Iif(Empty(cLoja  ),SE1->E1_LOJA,cLoja)
Else
	cAliasTit := "SE2"
	dbSelectArea("SE2")
	nSaldo := SE2->E2_VALOR+SE2->E2_SDACRES-SE2->E2_SDDECRE  
	nMoedaTit := SE2->E2_MOEDA
Endif

If Select("__BAIXA") == 0
	ChkFile("SE5",.F.,"__BAIXA")
Else
	dbSelectArea("__BAIXA")
Endif
dbSetOrder(7)
dbSeek(cFilTit+cPrefixo+cNumero+cParcela+cTipo)

While E5_FILIAL + E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO == ;
		cFilTit + cPrefixo + cNumero + cParcela + cTipo .and. !EOF()

	IF E5_SITUACA = "C"
		dbSkip()
		Loop
	Endif
	//Posicionar o SE5 pois dentro da TEMBXCANC condulta o SE5 e nao o __BAIXA
   SE5->(DbGoTo(__BAIXA->(Recno())))
	If TemBxCanc(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)
		dbskip()
		Loop
	EndIf

	cCarteira := cCart
	If cCart == "R"
		If (E5_TIPO$MVRECANT+"/"+MV_CRNEG).and. E5_TIPODOC $ "BA|VL|MT|JR|CM" ;
				.and. Empty(E5_DOCUMEN) .and. IIF(!(MovBcoBx(E5_MOTBX)), .T. , !Empty(E5_BANCO) )
			cCarteira := "P"        //Baixa de adiantamento (inverte)
			cLoja     := SE1->E1_LOJA
		Endif
	Endif

	If cCart == "P"
		If (E5_TIPO$MVPAGANT+"/"+MV_CPNEG).and. E5_TIPODOC $ "BA|VL|MT|JR|CM" .and. ;
				Empty(E5_DOCUMEN) .and. IIF(!(MovBcoBx(E5_MOTBX)), .T. , !Empty(E5_BANCO) )
			cCarteira := "R"        //Baixa de adiantamento (inverte)
		Endif
	Endif

	IF (cCarteira == "P" .and. E5_RECPAG == "R") .or. (cCarteira == "R" .and. E5_RECPAG == "P")
		dbSkip( )
		Loop
	Endif

	IF cCliFor + cLoja  != E5_CLIFOR + E5_LOJA
		dbSkip()
		Loop
	EndIF

	//Defino qual o tipo de data a ser utilizado para compor o saldo do titulo
	If cTipoData == "0"
		dDtFina := E5_DATA
	ElseIf cTipoData == "1"
		dDtFina := E5_DTDISPO
	Else	
		dDtFina := E5_DTDIGIT
	Endif			

	IF dDtFina <= dDataBaixa
		IF E5_TIPODOC $ "VL#BA#V2#CP#LJ"
			nSaldo -= IIF((nMoedaTit < 2.And.cPaisLoc=="BRA").Or. (cPaisLoc <>"BRA" .And. nMoedaTit > 1 .And. !Empty(E5_BANCO)),E5_VALOR,E5_VLMOED2)
			nSaldo += Round(NoRound(xMoeda(E5_VLMULTA+E5_VLJUROS-E5_VLDESCO,1,nMoedaTit,E5_DATA,3,,nTxMoeda),3),2)
			//Retencao de impostos na baixa
			If lPccBaixa .and. cCarteira == "P" .and. Empty(E5_PRETPIS) .and. !(E5_MOTBX == "PCC")
				nSaldo -= Round(NoRound(xMoeda(E5_VRETPIS+E5_VRETCOF+E5_VRETCSLL,1,nMoedaTit,E5_DATA,3,,nTxMoeda),3),2)				
			Endif			
			If nSaldo <= 0.009
				nSaldo := 0
			Endif
		Endif
	EndIF
	dbSkip()
Enddo
// Zera o Saldo devido problema de arredondamento nos juros, ou seja, o valor dos juros que eh gravado com
// 2 casas decimais, gera diferena na recomposicao do saldo no titulo
// Exemplo: Titulo com valor de 24.450, com E1_PORCJUR de 0.13 e tres dias de atraso, grava em E5_JUROS o valor 
// de 95.36, sendo que o valor dos juros seria 95.355
// Movimentacao no SE5:
//	      Baixa	Juros	       Saldo
//		 		            24.450,00
//-------------------------------
//		4.001,04	95,36 	20.544,32 3 dias apos vencto.
//		2.100,95		      18.443,37 mesma data
//		3.474,23		      14.969,14 mesma data
//		6.000,00		       8.969,14 5 dias apos vencto
//		5.060,00		       3.909,14 10 dias apos vencto
//		3.919,29	10,16	        0,01 12 dias apos vencto
If Empty((cAliasTit)->&(Right(cAliasTit,2)+"_SALDO")) .And. Abs(nSaldo) <= 0.009
	nSaldo := 0
Else
	nSaldo := xMoeda(nSaldo,nMoedaTit,nMoeda,dDataMoeda,,nTxMoeda)
Endif
dbSelectArea(cAlias)
Return ( nSaldo )







/************************************** FUNÇÕES P/ CALCULO DE SALDOS DE TITULOS *********************************/







Static Function SaldoSR(dDtParam,d2DtParam,d3DtParam,nChamada)

Private dRGDBase:= dDtParam
Private dDoVenc := d2DtParam
Private dAteVenc:= d3DtParam
Private nFunCham:= nChamada
Private nTotFil4 := 0

//Alert("Estou em SaldoSR paramentos recebidos, DataBase "+DTOC(dRGDBase)+" Vencto De "+dtoc(d2DtParam)+" Vencto Ate "+DTOC(d3DtParam))
Private nRetValor := nSldAR(dDoVenc)
Return(nRetValor) 
//Endif

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ FINR130R3³ Autor ³ Paulo Boschetti	     ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Posio dos Titulos a Receber 						 	  		  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ FINR130R3(void)									  					  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 												  				  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function nSldAR(dDoVenc)
Local cDesc1 :=OemToAnsi(STR0001)  //"Imprime a posio dos titulos a receber relativo a data ba-"
Local cDesc2 :=OemToAnsi(STR0002)  //"se do sistema."
Local cDesc3 :=""
Local wnrel
Local cString:="SE1"
Local nRegEmp:=SM0->(RecNo())
Local dOldDtBase := dDataBase
Local dOldData	:= dDatabase

//Alert("Estou em nSldAR")

Private titulo  :=""
Private cabec1  :=""
Private cabec2  :=""

Private aLinha  :={}
Private aReturn :={ OemToAnsi(STR0003), 1,OemToAnsi(STR0004), 1, 2, 1, "",1 }  //"Zebrado"###"Administracao"
Private cPerg	 :="FIN130"
Private nJuros  :=0
Private nLastKey:=0
Private nomeprog:="FINR130"
Private tamanho :="G"

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Definio dos cabealhos ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
titulo := OemToAnsi(STR0005)  //"Posicao dos Titulos a Receber"
cabec1 := OemToAnsi(STR0006)  //"Codigo Nome do Cliente      Prf-Numero         TP  Natureza    Data de  Vencto   Vencto  Banco  Valor Original |        Titulos Vencidos          | Titulos a Vencer | Num        Vlr.juros ou  Dias   Historico     "
cabec2 := OemToAnsi(STR0007)  //"                            Parcela                            Emissao  Titulo    Real                         |  Valor Nominal   Valor Corrigido |   Valor Nominal  | Banco       permanencia  Atraso               "

//Nao retire esta chamada. Verifique antes !!!
//Ela é necessaria para o correto funcionamento da pergunte 36 (Data Base)
//AjustaSx1()
//PutDtBase()

//pergunte("FIN130",.F.)

mv_par01	:= SPACE(6)	 // Do Cliente 													   ³
mv_par02	:= "zzzzzz"	 // Ate o Cliente													   ³
mv_par03    := SPACE(3)		 // Do Prefixo														   ³
mv_par04    := "zzz"		 // Ate o prefixo 												   ³
mv_par05    := "         "		 // Do Titulo													      ³
mv_par06	:= "zzzzzzzzz"	 // Ate o Titulo													   ³
mv_par07	:= SPACE(3)	 // Do Banco														   ³
mv_par08	:= "zzz"	 // Ate o Banco													   ³
mv_par09	:= dDoVenc	 // Do Vencimento 												   ³
mv_par10	:= dAteVenc	 // Ate o Vencimento												   ³
mv_par11	:= "          "	 // Da Natureza														³
mv_par12	:= "zzzzzzzzzz"	 // Ate a Natureza													³
mv_par13	:= CTOD("01/01/80")	 // Da Emissao															³
mv_par14	:= CTOD("31/12/49")	 // Ate a Emissao														³
mv_par15	:= 1	 // Qual Moeda															³
mv_par16	:= 2	 // Imprime provisorios												³
mv_par17	:= 2	 // Reajuste pelo vecto												³
mv_par18    := 2		 // Impr Tit em Descont												³
mv_par19	:= 2	 // Relatorio Anal/Sint												³
mv_par20	:= 2	 // Consid Data Base?  												³
mv_par21	:= 1	 // Consid Filiais  ?  												³
mv_par22	:= SM0->M0_CODFIL	 // da filial													      ³
mv_par23	:= SM0->M0_CODFIL	 // a flial 												         ³
mv_par24	:= "  "	 // Da loja  															³
mv_par25	:= "zz"	 // Ate a loja															³
mv_par26	:= 2	 // Consid Adiantam.?												³
mv_par27	:= CTOD("01/01/94")	 // Da data contab. ?												³
mv_par28	:= CTOD("31/12/49")	 // Ate data contab.?												³
mv_par29	:= 2	 // Imprime Nome    ?												³
mv_par30	:= 2	 // Outras Moedas   ?												³
mv_par31    := "                                        "  // Imprimir os Tipos												³
//Five 11/12/2009 - mv_par32    := "NCC;AB-                                 "   // Nao Imprimir Tipos												³
mv_par32    := "NCC;AB-;RA;NDC"   // Nao Imprimir Tipos												³
//mv_par32    := "NCC;AB-;RA;NDC"   // Nao Imprimir Tipos
mv_par33    := 3   // Abatimentos  - Lista/Nao Lista/Despreza					³
mv_par34    := 2  // Consid. Fluxo Caixa												³
mv_par35    := 2   // Salta pagina Cliente											³
//Five Solutions Consultoria - 11/12/2009 - mv_par36    := dRGDBase   // Data Base													      ³
mv_par36    := dDataBase   // Data Base
mv_par37    := 1  // Compoe Saldo por: Data da Baixa, Credito ou DtDigit  ³
MV_PAR38    := 2  // Tit. Emissao Futura												³
MV_PAR39    := 2  // Converte Valores 												³

//Alert("Definido os Parametros")

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis utilizadas para parametros												³
//³ mv_par01		 // Do Cliente 													   ³
//³ mv_par02		 // Ate o Cliente													   ³
//³ mv_par03		 // Do Prefixo														   ³
//³ mv_par04		 // Ate o prefixo 												   ³
//³ mv_par05		 // Do Titulo													      ³
//³ mv_par06		 // Ate o Titulo													   ³
//³ mv_par07		 // Do Banco														   ³
//³ mv_par08		 // Ate o Banco													   ³
//³ mv_par09		 // Do Vencimento 												   ³
//³ mv_par10		 // Ate o Vencimento												   ³
//³ mv_par11		 // Da Natureza														³
//³ mv_par12		 // Ate a Natureza													³
//³ mv_par13		 // Da Emissao															³
//³ mv_par14		 // Ate a Emissao														³
//³ mv_par15		 // Qual Moeda															³
//³ mv_par16		 // Imprime provisorios												³
//³ mv_par17		 // Reajuste pelo vecto												³
//³ mv_par18		 // Impr Tit em Descont												³
//³ mv_par19		 // Relatorio Anal/Sint												³
//³ mv_par20		 // Consid Data Base?  												³
//³ mv_par21		 // Consid Filiais  ?  												³
//³ mv_par22		 // da filial													      ³
//³ mv_par23		 // a flial 												         ³
//³ mv_par24		 // Da loja  															³
//³ mv_par25		 // Ate a loja															³
//³ mv_par26		 // Consid Adiantam.?												³
//³ mv_par27		 // Da data contab. ?												³
//³ mv_par28		 // Ate data contab.?												³
//³ mv_par29		 // Imprime Nome    ?												³
//³ mv_par30		 // Outras Moedas   ?												³
//³ mv_par31       // Imprimir os Tipos												³
//³ mv_par32       // Nao Imprimir Tipos												³
//³ mv_par33       // Abatimentos  - Lista/Nao Lista/Despreza					³
//³ mv_par34       // Consid. Fluxo Caixa												³
//³ mv_par35       // Salta pagina Cliente											³
//³ mv_par36       // Data Base													      ³
//³ mv_par37       // Compoe Saldo por: Data da Baixa, Credito ou DtDigit  ³
//³ MV_PAR38       // Tit. Emissao Futura												³
//³ MV_PAR39       // Converte Valores 												³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Envia controle para a funo SETPRINT ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

/*
wnrel:="FINR130"            //Nome Default do relatorio em Disco
aOrd :={	OemToAnsi(STR0008),;	//"Por Cliente"
	OemToAnsi(STR0009),;	//"Por Prefixo/Numero"
	OemToAnsi(STR0010),; //"Por Banco"
	OemToAnsi(STR0011),;	//"Por Venc/Cli"
	OemToAnsi(STR0012),;	//"Por Natureza"
	OemToAnsi(STR0013),; //"Por Emissao"
	OemToAnsi(STR0014),;	//"Por Ven\Bco"
	OemToAnsi(STR0015),; //"Por Cod.Cli."
	OemToAnsi(STR0016),; //"Banco/Situacao"
	OemToAnsi(STR0047) } //"Por Numero/Tipo/Prefixo"

wnrel:=SetPrint(cString,wnrel,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,,Tamanho)

If nLastKey == 27
	Return
Endif

SetDefault(aReturn,cString)

If nLastKey == 27
	Return
Endif

RptStatus({|lEnd| FA130Imp(@lEnd,wnRel,cString)},titulo)  // Chamada do Relatorio
*/
//Alert("Irei chamar CalcSAR()")

nValRet := CalcSAR(dDoVenc)
SM0->(dbGoTo(nRegEmp))
cFilAnt := SM0->M0_CODFIL

//Acerta a database de acordo com a database real do sistema
If mv_par20 == 1    // Considera Data Base
	dDataBase := dOldDtBase
Endif	
//nValRet := nTot2+nTot3
//nValRet := nTotFil4
//Alert("Retornando o Valor "+Alltrim(Str(nValRet)))
//Alert("Retorno da nSldAR - nTotFil4 "+Alltrim(Str(nTotFil4))+" nValRet "+Alltrim(Str(nValRet)))
Return(nValRet)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ FA130Imp ³ Autor ³ Paulo Boschetti		  ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Imprime relat¢rio dos T¡tulos a Receber						  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ FA130Imp(lEnd,WnRel,cString)										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ lEnd	  - AÆo do Codeblock				    					  ³±±
±±³			 ³ wnRel   - T¡tulo do relat¢rio 									  ³±±
±±³			 ³ cString - Mensagem													  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function CalcSAR(dDoVenc) //FA130Imp(lEnd,WnRel,cString)
Local CbCont
Local CbTxt
Local nOrdem
Local lContinua := .T.
Local cCond1,cCond2,cCarAnt
Local nTit0:=0
Local nTit1:=0
Local nTit2:=0
Local nTit3:=0
Local nTit4:=0
Local nTit5:=0
Local nTotJ:=0
Local nTot0:=0
Local nTot1:=0
Local nTot2:=0
Local nTot3:=0
Local nTot4:=0
Local nTotTit:=0
Local nTotJur:=0
Local nTotFil0:=0
Local nTotFil1:=0
Local nTotFil2:=0
Local nTotFil3:=0
//Local nTotFil4:=0
Local nTotFilTit:=0
Local nTotFilJ:=0
Local nAtraso:=0
Local nTotAbat:=0
Local nSaldo:=0
Local dDataReaj
Local dDataAnt := dDataBase
Local lQuebra
Local nMesTit0 := 0
Local nMesTit1 := 0
Local nMesTit2 := 0
Local nMesTit3 := 0
Local nMesTit4 := 0
Local nMesTTit := 0
Local nMesTitj := 0
Local cIndexSe1
Local cChaveSe1
Local nIndexSE1
Local dDtContab
Local cTipos  := ""
#IFDEF TOP
	Local aStru := SE1->(dbStruct()), ni
#ENDIF	
Local nTotsRec := SE1->(RecCount())
Local aTamCli  := TAMSX3("E1_CLIENTE")
Local lF130Qry := ExistBlock("F130QRY")
// variavel  abaixo criada p/pegar o nr de casas decimais da moeda
Local ndecs := Msdecimais(mv_par15)
Local nAbatim := 0
Local nDescont:= 0
Local nVlrOrig:= 0

//Alert("Estou na CalcSAR()")
Private nVoltaVlr := 0

Private nRegSM0 := SM0->(Recno())
Private nAtuSM0 := SM0->(Recno())
PRIVATE dBaixa := dDataBase
PRIVATE cFilDe,cFilAte

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Ponto de entrada para Filtrar os tipos sem entrar na tela do ³
//³ FINRTIPOS(), localizacao Argentina.                          ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄJose Lucas, Localizaes ArgentinaÄÙ
IF EXISTBLOCK("F130FILT")
	cTipos	:=	EXECBLOCK("F130FILT",.f.,.f.)
ENDIF

nOrdem:=aReturn[8]
cMoeda:=Str(mv_par15,1)

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Vari veis utilizadas para Impresso do Cabealho e Rodap ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
cbtxt 	:= OemtoAnsi(STR0046)
cbcont	:= 1
li 		:= 80
m_pag 	:= 1

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ POR MAIS ESTRANHO QUE PAREA, ESTA FUNCAO DEVE SER CHAMADA AQUI! ³
//³                                                                  ³
//³ A funo SomaAbat reabre o SE1 com outro nome pela ChkFile para  ³
//³ efeito de performance. Se o alias auxiliar para a SumAbat() no  ³
//³ estiver aberto antes da IndRegua, ocorre Erro de & na ChkFile,   ³
//³ pois o Filtro do SE1 uptrapassa 255 Caracteres.                  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
SomaAbat("","","","R")

//Alert("Passei pelo SomaAbat")

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Atribui valores as variaveis ref a filiais                ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
If mv_par21 == 2
	cFilDe  := cFilAnt
	cFilAte := cFilAnt
ELSE
	cFilDe := mv_par22	// Todas as filiais
	cFilAte:= mv_par23
Endif

//Acerta a database de acordo com o parametro
If mv_par20 == 1    // Considera Data Base
	//Five Solutions Consultoria - 11/12/2009 - dDataBase := mv_par36
	dDataBase := mv_par36
Endif	

//Alert("Preparando para entrar no While")
dbSelectArea("SM0")
cEmpAnt := SM0->M0_CODIGO
cFilAte := SM0->M0_CODFIL

dbSeek(cEmpAnt+cFilDe,.T.)

nRegSM0 := SM0->(Recno())
nAtuSM0 := SM0->(Recno())

While !Eof() .and. M0_CODIGO == cEmpAnt .and. M0_CODFIL <= cFilAte
	
	dbSelectArea("SE1")
	cFilAnt := SM0->M0_CODFIL
	Set Softseek On
//	Alert("Entrou no While do SM0")
	/*
	If mv_par19 == 1
		titulo := titulo + OemToAnsi(STR0026)  //" - Analitico"
	Else
		titulo := titulo + OemToAnsi(STR0027)  //" - Sintetico"
		cabec1 := OemToAnsi(STR0044)  //"                                                                                                               |        Titulos Vencidos          | Titulos a Vencer |            Vlr.juros ou             (Vencidos+Vencer)"
		cabec2 := OemToAnsi(STR0045)  //"                                                                                                               |  Valor Nominal   Valor Corrigido |   Valor Nominal  |             permanencia                              "
	EndIf
	*/
	#IFDEF TOP
		
		If nOrdem = 1
			cQuery := ""
			aEval(SE1->(DbStruct()),{|e| If(!Alltrim(e[1])$"E1_FILIAL#E1_NOMCLI#E1_CLIENTE#E1_LOJA#E1_PREFIXO#E1_NUM#E1_PARCELA#E1_TIPO", cQuery += ","+AllTrim(e[1]),Nil)})
			cQuery := "SELECT E1_FILIAL, E1_NOMCLI, E1_CLIENTE, E1_LOJA, E1_PREFIXO, E1_NUM,E1_PARCELA, E1_TIPO, "+ SubStr(cQuery,2)
		Else
			cQuery := "SELECT * "
		EndIf
		
		cQuery += "  FROM "+	RetSqlName("SE1") + " SE1"
		cQuery += " WHERE E1_FILIAL = '" + xFilial("SE1") + "'"
		cQuery += "   AND D_E_L_E_T_ <> '*' "
	#ENDIF
	
	IF nOrdem = 1
		cChaveSe1 := "E1_FILIAL+E1_NOMCLI+E1_CLIENTE+E1_LOJA+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO"
		#IFDEF TOP
			cOrder := SqlOrder(cChaveSe1)
		#ELSE
			cIndexSe1 := CriaTrab(nil,.f.)
			IndRegua("SE1",cIndexSe1,cChaveSe1,,Fr130IndR(),OemToAnsi(STR0022))
			nIndexSE1 := RetIndex("SE1")
			dbSetIndex(cIndexSe1+OrdBagExt())
			dbSetOrder(nIndexSe1+1)
			dbSeek(xFilial("SE1"))
		#ENDIF
		cCond1 := "E1_CLIENTE <= mv_par02"
		cCond2 := "E1_CLIENTE + E1_LOJA"
		titulo := titulo + OemToAnsi(STR0017)  //" - Por Cliente"
		
	Elseif nOrdem = 2
		SE1->(dbSetOrder(1))
		#IFNDEF TOP
			dbSeek(cFilial+mv_par03+mv_par05)
		#ELSE
			cOrder := SqlOrder(IndexKey())
		#ENDIF
		cCond1 := "E1_NUM <= mv_par06"
		cCond2 := "E1_NUM"
		titulo := titulo + OemToAnsi(STR0018)  //" - Por Numero"
	Elseif nOrdem = 3
		SE1->(dbSetOrder(4))
		#IFNDEF TOP
			dbSeek(cFilial+mv_par07)
		#ELSE
			cOrder := SqlOrder(IndexKey())
		#ENDIF
		cCond1 := "E1_PORTADO <= mv_par08"
		cCond2 := "E1_PORTADO"
		titulo := titulo + OemToAnsi(STR0019)  //" - Por Banco"
	Elseif nOrdem = 4
		SE1->(dbSetOrder(7))
		#IFNDEF TOP
			dbSeek(cFilial+DTOS(mv_par09))
		#ELSE
			cOrder := SqlOrder(IndexKey())
		#ENDIF
		cCond1 := "E1_VENCREA <= mv_par10"
		cCond2 := "E1_VENCREA"
		titulo := titulo + OemToAnsi(STR0020)  //" - Por Data de Vencimento"
	Elseif nOrdem = 5
		SE1->(dbSetOrder(3))
		#IFNDEF TOP
			dbSeek(cFilial+mv_par11)
		#ELSE
			cOrder := SqlOrder(IndexKey())
		#ENDIF
		cCond1 := "E1_NATUREZ <= mv_par12"
		cCond2 := "E1_NATUREZ"
		titulo := titulo + OemToAnsi(STR0021)  //" - Por Natureza"
	Elseif nOrdem = 6
		SE1->(dbSetOrder(6))
		#IFNDEF TOP
			dbSeek( cFilial+DTOS(mv_par13))
		#ELSE
			cOrder := SqlOrder(IndexKey())
		#ENDIF
		cCond1 := "E1_EMISSAO <= mv_par14"
		cCond2 := "E1_EMISSAO"
		titulo := titulo + OemToAnsi(STR0042)  //" - Por Emissao"
	Elseif nOrdem == 7
		cChaveSe1 := "E1_FILIAL+DTOS(E1_VENCREA)+E1_PORTADO+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO"
		#IFNDEF TOP
			cIndexSe1 := CriaTrab(nil,.f.)
			IndRegua("SE1",cIndexSe1,cChaveSe1,,Fr130IndR(),OemToAnsi(STR0022))
			nIndexSE1 := RetIndex("SE1")
			dbSetIndex(cIndexSe1+OrdBagExt())
			dbSetOrder(nIndexSe1+1)
			dbSeek(xFilial("SE1"))
		#ELSE
			cOrder := SqlOrder(cChaveSe1)
		#ENDIF
		cCond1 := "E1_VENCREA <= mv_par10"
		cCond2 := "DtoS(E1_VENCREA)+E1_PORTADO"
		titulo := titulo + OemToAnsi(STR0023)  //" - Por Vencto/Banco"
	Elseif nOrdem = 8
		SE1->(dbSetOrder(2))
		#IFNDEF TOP
			dbSeek(cFilial+mv_par01,.T.)
		#ELSE
			cOrder := SqlOrder(IndexKey())
		#ENDIF
		cCond1 := "E1_CLIENTE <= mv_par02"
		cCond2 := "E1_CLIENTE"
		titulo := titulo + OemToAnsi(STR0024)  //" - Por Cod.Cliente"
	Elseif nOrdem = 9
		cChave := "E1_FILIAL+E1_PORTADO+E1_SITUACA+E1_NOMCLI+E1_PREFIXO+E1_NUM+E1_PARCELA+E1_TIPO"
		#IFNDEF TOP
			dbSelectArea("SE1")
			cIndex := CriaTrab(nil,.f.)
			IndRegua("SE1",cIndex,cChave,,fr130IndR(),OemToAnsi(STR0022))
			nIndex := RetIndex("SE1")
			dbSetIndex(cIndex+OrdBagExt())
			dbSetOrder(nIndex+1)
			dbSeek(xFilial("SE1"))
		#ELSE
			cOrder := SqlOrder(cChave)
		#ENDIF
		cCond1 := "E1_PORTADO <= mv_par08"
		cCond2 := "E1_PORTADO+E1_SITUACA"
		titulo := titulo + OemToAnsi(STR0025)  //" - Por Banco e Situacao"
	ElseIf nOrdem == 10
		cChave := "E1_FILIAL+E1_NUM+E1_TIPO+E1_PREFIXO+E1_PARCELA"
		#IFNDEF TOP
			dbSelectArea("SE1")
			cIndex := CriaTrab(nil,.f.)
			IndRegua("SE1",cIndex,cChave,,,OemToAnsi(STR0022))
			nIndex := RetIndex("SE1")
			dbSetIndex(cIndex+OrdBagExt())
			dbSetOrder(nIndex+1)
			dbSeek(xFilial("SE1")+mv_par05)
		#ELSE
			cOrder := SqlOrder(cChave)
		#ENDIF
		cCond1 := "E1_NUM <= mv_par06"
		cCond2 := "E1_NUM"
		titulo := titulo + OemToAnsi(STR0048)  //" - Numero/Prefixo"	
	Endif
	
	If mv_par19 == 1
		titulo := titulo + OemToAnsi(STR0026)  //" - Analitico"
	Else
		titulo := titulo + OemToAnsi(STR0027)  //" - Sintetico"
		cabec1 := OemToAnsi(STR0044)  //"Nome do Cliente      |        Titulos Vencidos          | Titulos a Vencer |            Vlr.juros ou             (Vencidos+Vencer)"
		cabec2 := OemToAnsi(STR0045)  //"|  Valor Nominal   Valor Corrigido |   Valor Nominal  |             permanencia                              "
	EndIf
	
	cFilterUser:=aReturn[7]
	Set Softseek Off
	
	#IFDEF TOP
		cAnoCorr := Substr(DTOS(dDoVenc),1,4)
		cQuery += " AND E1_CLIENTE between '" + mv_par01        + "' AND '" + mv_par02 + "'"
		cQuery += " AND E1_PREFIXO between '" + mv_par03        + "' AND '" + mv_par04 + "'"
		cQuery += " AND E1_NUM     between '" + mv_par05        + "' AND '" + mv_par06 + "'"
		cQuery += " AND E1_PORTADO between '" + mv_par07        + "' AND '" + mv_par08 + "'"
		cQuery += " AND E1_VENCREA between '" + DTOS(mv_par09)  + "' AND '" + DTOS(mv_par10) + "'"
		//cQuery += " AND SUBSTRING(E1_VENCREA,1,4) = '" + cAnoCorr + "'"
		cQuery += " AND (E1_MULTNAT = '1' OR (E1_NATUREZ BETWEEN '"+MV_PAR11+"' AND '"+MV_PAR12+"'))"
		cQuery += " AND E1_EMISSAO between '" + DTOS(mv_par13)  + "' AND '" + DTOS(mv_par14) + "'"
		//cQuery += " AND E1_EMISSAO between '19800101' AND '20491231'"
		cQuery += " AND E1_LOJA    between '" + mv_par24        + "' AND '" + mv_par25 + "'"

		If MV_PAR38 == 2 //Nao considerar titulos com emissao futura
			cQuery += " AND E1_EMISSAO <=      '" + DTOS(dDataBase) + "'"
		Endif

		//Five Solutions Consultoria - 11/12/2009 - cQuery += " AND ((E1_EMIS1  Between '"+ DTOS(mv_par27)+"' AND '"+DTOS(mv_par28)+"') OR E1_EMISSAO Between '"+DTOS(mv_par27)+"' AND '"+DTOS(mv_par28)+"')"
		If !Empty(mv_par31) // Deseja imprimir apenas os tipos do parametro 31
			cQuery += " AND E1_TIPO IN "+FormatIn(mv_par31,";") 
		ElseIf !Empty(Mv_par32) // Deseja excluir os tipos do parametro 32
			cQuery += " AND E1_TIPO NOT IN "+FormatIn(mv_par32,";")
			//cQuery += " AND E1_TIPO NOT IN ('NCC','AB-','RA','NDC')"
		EndIf
		If mv_par18 == 2
			cQuery += " AND E1_SITUACA NOT IN ('2','7')"
		Endif
		If mv_par20 == 2
			cQuery += ' AND E1_SALDO <> 0'
		Endif
		If mv_par34 == 1
			cQuery += " AND E1_FLUXO <> 'N'"
		Endif               
        //ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
        //³ Ponto de entrada para inclusao de parametros no filtro a ser executado ³
        //ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	    If lF130Qry 
			cQuery += ExecBlock("F130QRY",.f.,.f.)
		Endif

		cQuery += " ORDER BY "+ cOrder
		
		MemoWrite("C:\TEMP\TitulosVencidos_AR_"+cAnoCorr+".SQL",cQuery) //Five Solutions Consultoria - 11/12/2009
		
		cQuery := ChangeQuery(cQuery)
		
		dbSelectArea("SE1")
		dbCloseArea()
		dbSelectArea("SA1")
		
		dbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), 'SE1', .F., .T.)
		
		For ni := 1 to Len(aStru)
			If aStru[ni,2] != 'C'
				TCSetField('SE1', aStru[ni,1], aStru[ni,2],aStru[ni,3],aStru[ni,4])
			Endif
		Next
	#ENDIF
	//SetRegua(nTotsRec)
	
	If MV_MULNATR .And. nOrdem == 5
		//Finr135R3(cTipos, lEnd, @nTot0, @nTot1, @nTot2, @nTot3, @nTotTit, @nTotJ )
		#IFDEF TOP
			dbSelectArea("SE1")
			dbCloseArea()
			ChKFile("SE1")
			dbSelectArea("SE1")
			dbSetOrder(1)
		#ENDIF
		If Empty(xFilial("SE1"))
			Exit
		Endif
		dbSelectArea("SM0")
		dbSkip()
		Loop
	Endif
//	Alert("Selecionei Registros")
	While &cCond1 .and. !Eof() .and. lContinua .and. E1_FILIAL == xFilial("SE1")
		
		/*
		IF	lEnd
			@PROW()+1,001 PSAY OemToAnsi(STR0028)  //"CANCELADO PELO OPERADOR"
			Exit
		Endif
		*/
		//Alert("Entrei no While da Query do SE1")
		//IncRegua()
		
		Store 0 To nTit1,nTit2,nTit3,nTit4,nTit5
		
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Carrega data do registro para permitir ³
		//³ posterior analise de quebra por mes.   ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		dDataAnt := If(nOrdem == 6 , SE1->E1_EMISSAO,  SE1->E1_VENCREA)
		
		cCarAnt := &cCond2
		
		While &cCond2==cCarAnt .and. !Eof() .and. lContinua .and. E1_FILIAL == xFilial("SE1")
			
			IF lEnd
				//@PROW()+1,001 PSAY OemToAnsi(STR0028)  //"CANCELADO PELO OPERADOR"
				lContinua := .F.
				Exit
			EndIF
			//Alert("Entrei no While da Impressao")
			//IncRegua()
			
			dbSelectArea("SE1")
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Filtrar com base no Pto de entrada do Usuario...             ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄJose Lucas, Localizaes ArgentinaÄÙ
			If !Empty(cTipos)
				If !(SE1->E1_TIPO $ cTipos)
					dbSkip()
					Loop
				Endif
			Endif
			
			 // Tratamento da correcao monetaria para a Argentina
			If  cPaisLoc=="ARG" .And. mv_par15 <> 1  .And.  SE1->E1_CONVERT=='N'
					dbSkip()
					Loop
			Endif
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Considera filtro do usuario                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If !Empty(cFilterUser).and.!(&cFilterUser)
				dbSkip()
				Loop
			Endif
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se titulo, apesar do E1_SALDO = 0, deve aparecer ou ³
			//³ nÆo no relat¢rio quando se considera database (mv_par20 = 1) ³
			//³ ou caso nÆo se considere a database, se o titulo foi totalmen³
			//³ te baixado.																  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			dbSelectArea("SE1")
			IF !Empty(SE1->E1_BAIXA) .and. Iif(mv_par20 == 2 ,SE1->E1_SALDO == 0 ,;
					IIF(mv_par37 == 1,(SE1->E1_SALDO == 0 .and. SE1->E1_BAIXA <= dDataBase),.F.))
				dbSkip()
				Loop
			EndIF
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se trata-se de abatimento ou somente titulos³
			//³ at a data base. 									 ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF (SE1->E1_TIPO $ MVABATIM .And. mv_par33 != 1) .Or.;
				(SE1->E1_EMISSAO > dDataBase .and. MV_PAR38 == 2)
				dbSkip()
				Loop
			Endif
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se ser  impresso titulos provis¢rios		 ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF E1_TIPO $ MVPROVIS .and. mv_par16 == 2
				dbSkip()
				Loop
			Endif
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se ser  impresso titulos de Adiantamento	 ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF SE1->E1_TIPO $ MVRECANT+"/"+MV_CRNEG .and. mv_par26 == 2
				dbSkip()
				Loop
			Endif
			
			// dDtContab para casos em que o campo E1_EMIS1 esteja vazio
			dDtContab := Iif(Empty(SE1->E1_EMIS1),SE1->E1_EMISSAO,SE1->E1_EMIS1)
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se esta dentro dos parametros ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			dbSelectArea("SE1")
			IF SE1->E1_CLIENTE < mv_par01 .OR. SE1->E1_CLIENTE > mv_par02 .OR. ;
				SE1->E1_PREFIXO < mv_par03 .OR. SE1->E1_PREFIXO > mv_par04 .OR. ;
				SE1->E1_NUM	 	 < mv_par05 .OR. SE1->E1_NUM 		> mv_par06 .OR. ;
				SE1->E1_PORTADO < mv_par07 .OR. SE1->E1_PORTADO > mv_par08 .OR. ;
				SE1->E1_VENCREA < mv_par09 .OR. SE1->E1_VENCREA > mv_par10 .OR. ;
				SE1->E1_NATUREZ < mv_par11 .OR. SE1->E1_NATUREZ > mv_par12 .OR. ;
				SE1->E1_EMISSAO < mv_par13 .OR. SE1->E1_EMISSAO > mv_par14 .OR. ;
				SE1->E1_LOJA    < mv_par24 .OR. SE1->E1_LOJA    > mv_par25 .OR. ;
				dDtContab       < mv_par27 .OR. dDtContab       > mv_par28 .OR. ;
				(SE1->E1_EMISSAO > dDataBase .and. MV_PAR38 == 2) .Or. !&(fr130IndR())
				dbSkip()
				Loop
			Endif
			
			If mv_par18 == 2 .and. E1_SITUACA $ "27"
				dbSkip()
				Loop
			Endif
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se deve imprimir outras moedas³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If mv_par30 == 2 // nao imprime
				if SE1->E1_MOEDA != mv_par15 //verifica moeda do campo=moeda parametro
					dbSkip()
					Loop
				endif
			Endif
			
			// Verifica se existe a taxa na data do vencimento do titulo, se nao existir, utiliza a taxa da database
			If SE1->E1_VENCREA < dDataBase
				If mv_par17 == 2 .And. RecMoeda(SE1->E1_VENCREA,cMoeda) > 0
					dDataReaj := SE1->E1_VENCREA
				Else
					dDataReaj := dDataBase
				EndIf	
			Else
				dDataReaj := dDataBase
			EndIf
						
			If mv_par20 == 1	// Considera Data Base
				//Ita - 01/04/2008 - nSaldo :=SaldoTit(SE1->E1_PREFIXO,SE1->E1_NUM,SE1->E1_PARCELA,SE1->E1_TIPO,SE1->E1_NATUREZ,"R",SE1->E1_CLIENTE,mv_par15,dDataReaj,,SE1->E1_LOJA,,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0),mv_par37)
				nSaldo :=TitSaldo(SE1->E1_PREFIXO,SE1->E1_NUM,SE1->E1_PARCELA,SE1->E1_TIPO,SE1->E1_NATUREZ,"R",SE1->E1_CLIENTE,mv_par15,dDataReaj,,SE1->E1_LOJA,,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0),mv_par37)
				
				// Subtrai decrescimo para recompor o saldo na data escolhida.
				If Str(SE1->E1_VALOR,17,2) == Str(nSaldo,17,2) .And. SE1->E1_DECRESC > 0 .And. SE1->E1_SDDECRE == 0
					nSAldo -= SE1->E1_DECRESC
				Endif
				// Soma Acrescimo para recompor o saldo na data escolhida.
				If Str(SE1->E1_VALOR,17,2) == Str(nSaldo,17,2) .And. SE1->E1_ACRESC > 0 .And. SE1->E1_SDACRES == 0
					nSAldo += SE1->E1_ACRESC
				Endif

				//Se abatimento verifico a data da baixa.
				//Por nao possuirem movimento de baixa no SE5, a saldotit retorna 
				//sempre saldo em aberto quando mv_par33 = 1 (Abatimentos = Lista)
				If SE1->E1_TIPO $ MVABATIM .and. ;
					((SE1->E1_BAIXA <= dDataBase .and. !Empty(SE1->E1_BAIXA)) .or. ;
					 (SE1->E1_MOVIMEN <= dDataBase .and. !Empty(SE1->E1_MOVIMEN))	)			
					nSaldo := 0
				Endif

			Else
				nSaldo := xMoeda((SE1->E1_SALDO+SE1->E1_SDACRES-SE1->E1_SDDECRE),SE1->E1_MOEDA,mv_par15,dDataReaj,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0))
			Endif

			//Caso exista desconto financeiro (cadastrado na inclusao do titulo), 
			//subtrai do valor principal.
			nDescont := FaDescFin("SE1",dBaixa,nSaldo,1)   
			If nDescont > 0
				nSaldo := nSaldo - nDescont
			Endif
			
			If ! SE1->E1_TIPO $ MVABATIM
				If ! (SE1->E1_TIPO $ MVRECANT+"/"+MV_CRNEG) .And. ;
						!( MV_PAR20 == 2 .And. nSaldo == 0 )  	// deve olhar abatimento pois e zerado o saldo na liquidacao final do titulo

					//Quando considerar Titulos com emissao futura, eh necessario
					//colocar-se a database para o futuro de forma que a Somaabat()
					//considere os titulos de abatimento
					If mv_par38 == 1
						dOldData := dDataBase
						dDataBase := CTOD("31/12/40")
					Endif

					nAbatim := SomaAbat(SE1->E1_PREFIXO,SE1->E1_NUM,SE1->E1_PARCELA,"R",mv_par15,dDataReaj,SE1->E1_CLIENTE,SE1->E1_LOJA)

					If mv_par38 == 1
						dDataBase := dOldData
					Endif

					If STR(nSaldo,17,2) == STR(nAbatim,17,2)
						nSaldo := 0
					ElseIf mv_par33 != 3
						nSaldo-= nAbatim
					Endif
				EndIf
			Endif	
			nSaldo:=Round(NoRound(nSaldo,3),2)
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Desconsidera caso saldo seja menor ou igual a zero   ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If nSaldo <= 0
				dbSkip()
				Loop
			Endif
			
			dbSelectArea("SA1")
			MSSeek(cFilial+SE1->E1_CLIENTE+SE1->E1_LOJA)
			dbSelectArea("SA6")
			MSSeek(cFilial+SE1->E1_PORTADO)
			dbSelectArea("SE1")
			
			IF li > 58
				nAtuSM0 := SM0->(Recno())
				SM0->(dbGoto(nRegSM0))
				//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
				SM0->(dbGoTo(nAtuSM0))
			EndIF
			
			If mv_par19 == 1
			    /*
				@li,	0 PSAY SE1->E1_CLIENTE + "-" + SE1->E1_LOJA + "-" +;
					IIF(mv_par29 == 1, SubStr(SA1->A1_NREDUZ,1,17), SubStr(SA1->A1_NOME,1,17))
				li := IIf (aTamCli[1] > 6,li+1,li)
				@li, 28 PSAY SE1->E1_PREFIXO+"-"+SE1->E1_NUM+"-"+SE1->E1_PARCELA
				If SE1->E1_TIPO$MVABATIM
					@li,46 PSAY "["
				Endif
				@li, 47 PSAY SE1->E1_TIPO
				If SE1->E1_TIPO$MVABATIM
					@li,50 PSAY "]"
				Endif
				@li, 51 PSAY SE1->E1_NATUREZ
				@li, 62 PSAY SE1->E1_EMISSAO
				@li, 73 PSAY SE1->E1_VENCTO
				@li, 84 PSAY SE1->E1_VENCREA
				@li, 95 PSAY SE1->E1_PORTADO+" "+SE1->E1_SITUACA
				*/
				nVlrOrig := Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0))* If(SE1->E1_TIPO$MVABATIM+"/"+MV_CRNEG+"/"+MVRECANT, -1,1),nDecs+1),nDecs)
				//@li,101 PSAY nVlrOrig Picture TM(nVlrOrig,15,nDecs)
			Endif
			
			If dDataBase > E1_VENCREA	//vencidos
				/*
				If mv_par19 == 1
					If ! SE1->E1_TIPO $ MVABATIM
						@li, 117 PSAY nSaldo * If(SE1->E1_TIPO$MV_CRNEG+"/"+MVRECANT, -1,1)  Picture TM(nSaldo,15,nDecs)
					EndIf
				EndIf
				*/
				nJuros:=0
				fa070Juros(mv_par15)
				dbSelectArea("SE1")
				
				/*
				If mv_par19 == 1
					@li,133 PSAY (nSaldo+nJuros)* If(SE1->E1_TIPO$MV_CRNEG+"/"+MVRECANT, -1,1) Picture TM(nSaldo+nJuros,15,nDecs)
				EndIf
				*/
				
				If SE1->E1_TIPO $ MVRECANT+"/"+MV_CRNEG
					nTit0 -= Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
					nTit1 -= (nSaldo)
					nTit2 -= (nSaldo+nJuros)
					nMesTit0 -= Round(NoRound( xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
					nMesTit1 -= (nSaldo)
					nMesTit2 -= (nSaldo+nJuros)
					nTotJur  -= nJuros
					nMesTitj -= nJuros
					nTotFilJ -= nJuros
				Else
					If !SE1->E1_TIPO $ MVABATIM
						nTit0 += Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)						
						nTit1 += (nSaldo)
						nTit2 += (nSaldo+nJuros)
						nMesTit0 += Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
						nMesTit1 += (nSaldo)
						nMesTit2 += (nSaldo+nJuros)
						nTotJur  += nJuros
						nMesTitj += nJuros
						nTotFilJ += nJuros
					Endif	
				Endif
			Else						//a vencer
				/*
				If mv_par19 == 1
					@li,149 PSAY nSaldo * If(SE1->E1_TIPO$MV_CRNEG+"/"+MVRECANT, -1,1)  Picture TM(nSaldo,15,nDecs)
				EndIf
			    */
				If ! ( SE1->E1_TIPO $ MVRECANT+"/"+MV_CRNEG)
					If !SE1->E1_TIPO $ MVABATIM
						nTit0 += Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
						nTit3 += (nSaldo-nTotAbat)
						nTit4 += (nSaldo-nTotAbat)
						nMesTit0 += Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
						nMesTit3 += (nSaldo-nTotAbat)
						nMesTit4 += (nSaldo-nTotAbat)
					EndIf
				Else
					nTit0 -= Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
					nTit3 -= (nSaldo-nTotAbat)
					nTit4 -= (nSaldo-nTotAbat)
					nMesTit0 -= Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)
					nMesTit3 -= (nSaldo-nTotAbat)
					nMesTit4 -= (nSaldo-nTotAbat)
				Endif
			Endif
			/*
			If mv_par19 == 1
				@ li, 165 PSAY SE1->E1_NUMBCO
			EndIf
			*/
			If nJuros > 0
				/*
				If mv_par19 == 1
					@ Li,182 PSAY nJuros Picture PesqPict("SE1","E1_JUROS",10,MV_PAR15)
				EndIf
				*/
				nJuros := 0
			Endif
			
			IF dDataBase > SE1->E1_VENCREA
				nAtraso:=dDataBase-SE1->E1_VENCTO
				IF Dow(SE1->E1_VENCTO) == 1 .Or. Dow(SE1->E1_VENCTO) == 7
					IF Dow(dBaixa) == 2 .and. nAtraso <= 2
						nAtraso := 0
					EndIF
				EndIF
				nAtraso:=IIF(nAtraso<0,0,nAtraso)
				IF nAtraso>0
					/*
					If mv_par19 == 1
						@li ,195 PSAY nAtraso Picture "9999"
					EndIf
					*/
				EndIF
			EndIF
			If mv_par19 == 1
				//@li,200 PSAY SubStr(SE1->E1_HIST,1,20)+ ;
					IIF(E1_TIPO $ MVPROVIS,"*"," ")+ ;
					Iif(nSaldo == Round(NoRound(xMoeda(SE1->E1_VALOR,SE1->E1_MOEDA,mv_par15,SE1->E1_EMISSAO,ndecs+1,Iif(MV_PAR39==2,Iif(!Empty(SE1->E1_TXMOEDA),SE1->E1_TXMOEDA,RecMoeda(SE1->E1_EMISSAO,SE1->E1_MOEDA)),0)),ndecs+1),ndecs)," ","P")
			EndIf
			
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Carrega data do registro para permitir ³
			//³ posterior an lise de quebra por mes.   ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			dDataAnt := Iif(nOrdem == 6, SE1->E1_EMISSAO, SE1->E1_VENCREA)
			dbSkip()
			nTotTit ++
			nMesTTit ++
			nTotFiltit++
			nTit5 ++
			If mv_par19 == 1
				li++
			EndIf
		Enddo
		
		IF nTit5 > 0 .and. nOrdem != 2 .and. nOrdem != 10
			SubTot130(nTit0,nTit1,nTit2,nTit3,nTit4,nOrdem,cCarAnt,nTotJur,nDecs)
			If mv_par19 == 1
				Li++
			EndIf
		Endif
		
		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Verifica quebra por ms	  			   ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		lQuebra := .F.
		If nOrdem == 4  .and. (Month(SE1->E1_VENCREA) # Month(dDataAnt) .or. SE1->E1_VENCREA > mv_par10)
			lQuebra := .T.
		Elseif nOrdem == 6 .and. (Month(SE1->E1_EMISSAO) # Month(dDataAnt) .or. SE1->E1_EMISSAO > mv_par14)
			lQuebra := .T.
		Endif
		If lQuebra .and. nMesTTit # 0
			//ImpMes130(nMesTit0,nMesTit1,nMesTit2,nMesTit3,nMesTit4,nMesTTit,nMesTitJ,nDecs)
			nMesTit0 := nMesTit1 := nMesTit2 := nMesTit3 := nMesTit4 := nMesTTit := nMesTitj := 0
		Endif
		nTot0+=nTit0
		nTot1+=nTit1
		nTot2+=nTit2
		nTot3+=nTit3
		nTot4+=nTit4
		nTotJ+=nTotJur
		
		nTotFil0+=nTit0
		nTotFil1+=nTit1
		nTotFil2+=nTit2
		nTotFil3+=nTit3
		nTotFil4+=nTit4
		Store 0 To nTit0,nTit1,nTit2,nTit3,nTit4,nTit5,nTotJur,nTotAbat
	Enddo
	
	//Alert("Verificação das Variaveis  neste ponto - nTot0 "+Alltrim(Str(nTot0))+" nTot1 "+Alltrim(Str(nTot1))+" nTot2 "+Alltrim(Str(nTot2))+" nTot3 "+Alltrim(Str(nTot3))+" nTot4 "+Alltrim(Str(nTot4))+" nTotJ "+Alltrim(Str(nTotJ)))
	
	//Alert("Verificação das Variaveis  neste ponto - nTotFil0 "+Alltrim(Str(nTotFil0))+" nTotFil1 "+Alltrim(Str(nTotFil1))+" nTotFil2 "+Alltrim(Str(nTot2))+" nTotFil2 "+Alltrim(Str(nTot3))+" nTotFil3 "+Alltrim(Str(nTotFil3))+" nTotFil4 "+Alltrim(Str(nTotFil4)))
	//Alert(" nTotFilTit "+Alltrim(Str(nTotFilTit))+" nTotFilJ "+Alltrim(Str(nTotFilJ)))
	//nVoltaVlr := IIF(nFunCham == 1,nTotFil4,nTotFil1)
	nVoltaVlr := IIF(nFunCham == 1,nTotFil4,(nTotFil2+nTotFil3)) //Five - 16/12/2009 - Teste
	
	dbSelectArea("SE1")		// voltar para alias existente, se nao, nao funciona
	
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Imprimir TOTAL por filial somente quan-³
	//³ do houver mais do que 1 filial.        ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	if mv_par21 == 1 .and. SM0->(Reccount()) > 1
		//ImpFil130(nTotFil0,nTotFil1,nTotFil2,nTotFil3,nTotFil4,nTotFiltit,nTotFilJ,nDecs)
	Endif
	Store 0 To nTotFil0,nTotFil1,nTotFil2,nTotFil3,nTotFil4,nTotFilTit,nTotFilJ
	If Empty(xFilial("SE1"))
		Exit
	Endif
	
	#IFDEF TOP
		dbSelectArea("SE1")
		dbCloseArea()
		ChKFile("SE1")
		dbSelectArea("SE1")
		dbSetOrder(1)
	#ENDIF
	
	dbSelectArea("SM0")
	dbSkip()

Enddo

SM0->(dbGoTo(nRegSM0))
cFilAnt := SM0->M0_CODFIL
IF li != 80
    /*
	IF li > 58
		cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	EndIF
	*/
	//TotGer130(nTot0,nTot1,nTot2,nTot3,nTot4,nTotTit,nTotJ,nDecs)
	//Roda(cbcont,cbtxt,"G")
EndIF

//Set Device To Screen

#IFNDEF TOP
	dbSelectArea("SE1")
	dbClearFil()
	RetIndex( "SE1" )
	If !Empty(cIndexSE1)
		FErase (cIndexSE1+OrdBagExt())
	Endif
	dbSetOrder(1)
#ELSE
	dbSelectArea("SE1")
	dbCloseArea()
	ChKFile("SE1")
	dbSelectArea("SE1")
	dbSetOrder(1)
#ENDIF
/*
If aReturn[5] = 1
	Set Printer TO
	dbCommitAll()
	Ourspool(wnrel)
Endif
MS_FLUSH()
*/

Return(nVoltaVlr)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³SubTot130 ³ Autor ³ Paulo Boschetti 		  ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³Imprimir SubTotal do Relatorio										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ SubTot130()																  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³																				  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso 	    ³ Generico																	  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function SubTot130(nTit0,nTit1,nTit2,nTit3,nTit4,nOrdem,cCarAnt,nTotJur,nDecs)

Local cCarteira := " "
Local cTelefone := Alltrim(Transform(SA1->A1_DDD, PesqPict("SA1","A1_DDD"))+"-"+ Transform(SA1->A1_TEL, PesqPict("SA1","A1_TEL")) )

DEFAULT nDecs := Msdecimais(mv_par15)

If mv_par19 == 1
	li++
EndIf
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF
If nOrdem = 1
	//@li,000 PSAY IIF(mv_par29 == 1,Substr(SA1->A1_NREDUZ,1,40),Substr(SA1->A1_NOME,1,40))+" "+ cTelefone + " "+ STR0054 + Right(cCarAnt,2)+Iif(mv_par21==1,STR0055+cFilAnt + " - " + Alltrim(SM0->M0_FILIAL),"") //"Loja - "###" Filial - "
Elseif nOrdem == 4 .or. nOrdem == 6
	//@li,000 PSAY OemToAnsi(STR0037)  // "S U B - T O T A L ----> "
	//@li,028 PSAY cCarAnt
	//@li,PCOL()+2 PSAY Iif(mv_par21==1,cFilAnt+ " - " + Alltrim(SM0->M0_FILIAL),"  ")
Elseif nOrdem = 3
	//@li,000 PSAY OemToAnsi(STR0037)  // "S U B - T O T A L ----> "
	//@li,028 PSAY Iif(Empty(SA6->A6_NREDUZ),OemToAnsi(STR0029),SA6->A6_NREDUZ) + " " + Iif(mv_par21==1,cFilAnt+ " - " + Alltrim(SM0->M0_FILIAL),"")
ElseIf nOrdem == 5
	dbSelectArea("SED")
	dbSeek(cFilial+cCarAnt)
	//@li,000 PSAY OemToAnsi(STR0037)  // "S U B - T O T A L ----> "
	//@li,028 PSAY cCarAnt + " "+Substr(ED_DESCRIC,1,50) + " " + Iif(mv_par21==1,cFilAnt+ " - " + Alltrim(SM0->M0_FILIAL),"")
	dbSelectArea("SE1")
Elseif nOrdem == 7
	//@li,000 PSAY OemToAnsi(STR0037)  // "S U B - T O T A L ----> "
	//@li,028 PSAY SubStr(cCarAnt,7,2)+"/"+SubStr(cCarAnt,5,2)+"/"+SubStr(cCarAnt,3,2)+" - "+SubStr(cCarAnt,9,3) + " " +Iif(mv_par21==1,cFilAnt+ " - " + Alltrim(SM0->M0_FILIAL),"")
ElseIf nOrdem = 8
	//@li,000 PSAY SA1->A1_COD+" "+Substr(SA1->A1_NOME,1,40)+" "+ cTelefone + " " + Iif(mv_par21==1,cFilAnt+ " - " + Alltrim(SM0->M0_FILIAL),"")
ElseIf nOrdem = 9
	cCarteira := Situcob(cCarAnt)
	//@li,000 PSAY SA6->A6_COD+" "+SA6->A6_NREDUZ + SubStr(cCarteira,1,2) + " "+SubStr(cCarteira,3,20) + " " + Iif(mv_par21==1,cFilAnt+ " - " + Alltrim(SM0->M0_FILIAL),"")
Endif
/*
If mv_par19 == 1
	@li,101 PSAY nTit0		  Picture TM(nTit0,15,nDecs)
Endif
@li,117 PSAY nTit1		  Picture TM(nTit1,15,nDecs)
@li,133 PSAY nTit2		  Picture TM(nTit2,15,nDecs)
@li,149 PSAY nTit3		  Picture TM(nTit3,15,nDecs)
If nTotJur > 0
	@li,180 PSAY nTotJur  Picture TM(nTotJur,12,nDecs)
Endif
@li,204 PSAY nTit2+nTit3 Picture TM(nTit2+nTit3,15,nDecs)
li++
If (nOrdem = 1 .Or. nOrdem == 8) .And. mv_par35 == 1 // Salta pag. por cliente
	cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
Endif
*/
Return .T.

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ TotGer130³ Autor ³ Paulo Boschetti       ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Imprimir total do relatorio										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ TotGer130()																  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³																				  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico																	  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
STATIC Function TotGer130(nTot0,nTot1,nTot2,nTot3,nTot4,nTotTit,nTotJ,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)

li++
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF

//@li,000 PSAY OemToAnsi(STR0038) //"T O T A L   G E R A L ----> " + " " + Iif(mv_par21==1,cFilAnt,"")
//@li,028 PSAY "("+ALLTRIM(STR(nTotTit))+" "+IIF(nTotTit > 1,OemToAnsi(STR0039),OemToAnsi(STR0040))+")"		//"TITULOS"###"TITULO"
/*
If mv_par19 == 1
	@li,101 PSAY nTot0		  Picture TM(nTot0,15,nDecs)
Endif
@li,117 PSAY nTot1		  Picture TM(nTot1,15,nDecs)
@li,133 PSAY nTot2		  Picture TM(nTot2,15,nDecs)
@li,149 PSAY nTot3		  Picture TM(nTot3,15,nDecs)
@li,177 PSAY nTotJ		  Picture TM(nTotJ,15,nDecs)
@li,204 PSAY nTot2+nTot3 Picture TM(nTot2+nTot3,15,nDecs)
li++
li++
*/
Return .T.

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ImpMes130 ³ Autor ³ Vinicius Barreira	  ³ Data ³ 12.12.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³IMPRIMIR TOTAL DO RELATORIO - QUEBRA POR MES					  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ ImpMes130() 															  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ 																			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
STATIC Function ImpMes130(nMesTot0,nMesTot1,nMesTot2,nMesTot3,nMesTot4,nMesTTit,nMesTotJ,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)
li++
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF
//@li,000 PSAY OemToAnsi(STR0041)  //"T O T A L   D O  M E S ---> "
//@li,028 PSAY "("+ALLTRIM(STR(nMesTTit))+" "+IIF(nMesTTit > 1,OemToAnsi(STR0039),OemToAnsi(STR0040))+")"  //"TITULOS"###"TITULO"
/*
If mv_par19 == 1
	@li,101 PSAY nMesTot0   Picture TM(nMesTot0,14,nDecs)
Endif
@li,116 PSAY nMesTot1	Picture TM(nMesTot1,14,nDecs)
@li,133 PSAY nMesTot2	Picture TM(nMesTot2,14,nDecs)
@li,149 PSAY nMesTot3	Picture TM(nMesTot3,14,nDecs)
@li,179 PSAY nMesTotJ	Picture TM(nMesTotJ,12,nDecs)
@li,204 PSAY nMesTot2+nMesTot3 Picture TM(nMesTot2+nMesTot3,16,nDecs)
li+=2
*/
Return(.T.)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ ImpFil130³ Autor ³ Paulo Boschetti  	  ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Imprimir total do relatorio										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ ImpFil130()																  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³																				  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso 	    ³ Generico																	  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
STATIC Function ImpFil130(nTotFil0,nTotFil1,nTotFil2,nTotFil3,nTotFil4,nTotFilTit,nTotFilJ,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)

li++
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF
/*
@li,000 PSAY OemToAnsi(STR0043)+" "+Iif(mv_par21==1,cFilAnt+" - " + AllTrim(SM0->M0_FILIAL),"")  //"T O T A L   F I L I A L ----> "
If mv_par19 == 1
	@li,101 PSAY nTotFil0        Picture TM(nTotFil0,14,nDecs)
Endif
@li,116 PSAY nTotFil1        Picture TM(nTotFil1,14,nDecs)
@li,133 PSAY nTotFil2        Picture TM(nTotFil2,14,nDecs)
@li,149 PSAY nTotFil3        Picture TM(nTotFil3,14,nDecs)
@li,179 PSAY nTotFilJ		  Picture TM(nTotFilJ,12,nDecs)
@li,204 PSAY nTotFil2+nTotFil3 Picture TM(nTotFil2+nTotFil3,16,nDecs)
li+=2
*/
Return .T.

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³fr130Indr ³ Autor ³ Wagner           	  ³ Data ³ 12.12.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³Monta Indregua para impressao do relat¢rio						  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function fr130IndR()
Local cString

cString := 'E1_FILIAL=="'+xFilial("SE1")+'".And.'
cString += 'E1_CLIENTE>="'+mv_par01+'".and.E1_CLIENTE<="'+mv_par02+'".And.'
cString += 'E1_PREFIXO>="'+mv_par03+'".and.E1_PREFIXO<="'+mv_par04+'".And.'
cString += 'E1_NUM>="'+mv_par05+'".and.E1_NUM<="'+mv_par06+'".And.'
cString += 'DTOS(E1_VENCREA)>="'+DTOS(mv_par09)+'".and.DTOS(E1_VENCREA)<="'+DTOS(mv_par10)+'".And.'
cString += '(E1_MULTNAT == "1" .OR. (E1_NATUREZ>="'+mv_par11+'".and.E1_NATUREZ<="'+mv_par12+'")).And.'
cString += 'DTOS(E1_EMISSAO)>="'+DTOS(mv_par13)+'".and.DTOS(E1_EMISSAO)<="'+DTOS(mv_par14)+'"'
If !Empty(mv_par31) // Deseja imprimir apenas os tipos do parametro 31
	cString += '.And.E1_TIPO$"'+mv_par31+'"'
ElseIf !Empty(Mv_par32) // Deseja excluir os tipos do parametro 32
	cString += '.And.!(E1_TIPO$'+'"'+mv_par32+'")'
EndIf
IF mv_par34 == 1  // Apenas titulos que estarao no fluxo de caixa
	cString += '.And.(E1_FLUXO!="N")'	
Endif
Return cString

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo    ³ PutDtBase³ Autor ³ Mauricio Pequim Jr    ³ Data ³ 18/07/02 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Acerta parametro database do relatorio                     ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Uso       ³ Finr130.prx                                                ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function PutDtBase()
Local _sAlias	:= Alias()

dbSelectArea("SX1")
dbSetOrder(1)
If MsSeek("FIN13036")
	//Acerto o parametro com a database
	RecLock("SX1",.F.)
	Replace x1_cnt01		With "'"+DTOC(dDataBase)+"'"
	MsUnlock()	
Endif

dbSelectArea(_sAlias)
Return

/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³AjustaSX1 ºAutor  ³Mauricio Pequim Jr. º Data ³29.12.2004   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Insere novas perguntas ao sx1                               º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ FINR130                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function AjustaSX1()
/*
Local aHelpPor	:= {}
Local aHelpEng	:= {}
Local aHelpSpa	:= {}
					  
Aadd( aHelpPor, 'Selecione "Sim" para que sejam         '  )
Aadd( aHelpPor, 'considerados no relatório, títulos cuja'  )
Aadd( aHelpPor, 'emissão seja em data posterior a database' )
Aadd( aHelpPor, 'do relatório, ou "Não" em caso contrário'  )

Aadd( aHelpSpa, 'Seleccione "Sí" para que se consideren en'	)
Aadd( aHelpSpa, 'el informe los títulos cuya emisión sea en')
Aadd( aHelpSpa, 'fecha posterior a la fecha base de dicho '	)
Aadd( aHelpSpa, 'informe o "No" en caso contrario'	)

Aadd( aHelpEng, 'Choose "Yes" for bills which issue date '	)
Aadd( aHelpEng, 'is posterior to the report base date in ' 	)
Aadd( aHelpEng, 'the report, otherwise "No"' 			)

PutSx1( "FIN130", "38","Tit. Emissao Futura?","Tit.Emision Futura  ","Future Issue Bill   ","mv_chs","N",1,0,2,"C","","","","","mv_par38","Sim","Si","Yes","","Nao","No","No","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

aHelpPor	:= {}
aHelpEng	:= {}
aHelpSpa	:= {}

Aadd( aHelpPor, "Selecione qual taxa sera utilizada para "  )
Aadd( aHelpPor, "conversao dos valores"   )

Aadd( aHelpSpa, "Seleccione la tasa de conversión " )
Aadd( aHelpSpa, "que se utilizara " )

Aadd( aHelpEng, "Select conversion rate to be used"   )



PutSx1( "FIN130", "39","Converte valores pela?","¿Convierte valores por?","Convert values by?","mv_cht","N",1,0,1,"C","","","","",;
	"mv_par39","Taxa do dia","Tasa del dia","Rate of the day","","Taxa do Mov.","Tasa del mov.","Movement rate","","","","","","","","","",aHelpPor,aHelpEng,aHelpSpa)

*/
Return


/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³Situcob   ºAutor  ³Mauricio Pequim Jr. º Data ³13.04.2005   º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³Retorna situacao de cobranca do titulo                      º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ FINR130                                                    º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function SituCob(cCarAnt)

Local aSituaca := {}
Local aArea		:= GetArea()
Local cCart		:= " "

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Monta a tabela de situaes de T¡tulos										 ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
dbSelectArea("SX5")
dbSeek(cFilial+"07")
While SX5->X5_FILIAL+SX5->X5_tabela == cFilial+"07"
	cCapital := Capital(X5Descri())
	AADD( aSituaca,{SubStr(SX5->X5_CHAVE,1,2),OemToAnsi(SubStr(cCapital,1,20))})
	dbSkip()
EndDo

nOpcS := (Ascan(aSituaca,{|x| Alltrim(x[1])== Substr(cCarAnt,4,1) }))
If nOpcS > 0
	cCart := aSituaca[nOpcS,1]+aSituaca[nOpcs,2]		
ElseIf Empty(SE1->E1_SITUACA)
	cCart := "0 "+STR0029
Endif
RestArea(aArea)
Return cCart

/************************************ F U N Ç Ã O    D O   S A L D O   A   P A G A R ****************************/

Static Function SaldoSP(dPADtParam,dPA2DtParam,dPA3DtParam,nPAChamada)

Private dPARGDBase:= dPADtParam
Private dPADoVenc := dPA2DtParam
Private dPAAteVenc:= dPA3DtParam
Private nFunPACham:= nPAChamada

//Alert("Estou em SaldoSP paramentos recebidos, DataBase "+DTOC(dPARGDBase)+" Vencto De "+dtoc(dPADoVenc)+" Vencto Ate "+DTOC(dPAAteVenc))
Private nRetPAValor := nSldAP()
//Alert("Valor a sert retornado da SaldoSP, nRetPAValor "+Alltrim(Str(nRetPAValor)))
Return(nRetPAValor) 



/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ FINR150R3³ Autor ³ Wagner Xavier   	     ³ Data ³ 02.10.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Posio dos Titulos a Pagar										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ FINR150R3(void)														  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parmetros³ 																			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Genrico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function nSldAP()
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Define Vari veis ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
Local cDesc1 :=OemToAnsi(STR0001)  //"Imprime a posio dos titulos a pagar relativo a data base"
Local cDesc2 :=OemToAnsi(STR0002)  //"do sistema."
LOCAL cDesc3 :=""
LOCAL wnrel
LOCAL cString:="SE2"
LOCAL nRegEmp := SM0->(RecNo())
Local dOldDtBase := dDataBase
Local dOldData := dDataBase

PRIVATE aReturn := { OemToAnsi(STR0003), 1,OemToAnsi(STR0004), 1, 2, 1, "",1 }  //"Zebrado"###"Administracao"
PRIVATE nomeprog:="FINR150"
PRIVATE aLinha  := { },nLastKey := 0
PRIVATE cPerg	 :="FIN150"
PRIVATE nJuros  :=0
PRIVATE tamanho:="G"

PRIVATE titulo  := ""
PRIVATE cabec1
PRIVATE cabec2

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Definicao dos cabealhos ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
titulo := OemToAnsi(STR0005)  //"Posicao dos Titulos a Pagar"
cabec1 := OemToAnsi(STR0006)  //"Codigo Nome do Fornecedor   PRF-Numero         Tp  Natureza    Data de  Vencto   Vencto  Banco  Valor Original |        Titulos vencidos          | Titulos a vencer | Porta-|  Vlr.juros ou   Dias   Historico     "
cabec2 := OemToAnsi(STR0007)  //"                            Parcela                            Emissao  Titulo    Real                         |  Valor nominal   Valor corrigido |   Valor nominal  | dor   |   permanencia   Atraso               "

//Nao retire esta chamada. Verifique antes !!!
//Ela é necessaria para o correto funcionamento da pergunte 36 (Data Base)
//PutDtBase()

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Verifica as perguntas selecionadas ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
//AjustaSx1()
//pergunte("FIN150",.F.)
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis utilizadas para parametros ³
//³ mv_par01	  // do Numero 			  ³
//³ mv_par02	  // at o Numero 		  ³
//³ mv_par03	  // do Prefixo			  ³
//³ mv_par04	  // at o Prefixo		  ³
//³ mv_par05	  // da Natureza  	     ³
//³ mv_par06	  // at a Natureza		  ³
//³ mv_par07	  // do Vencimento		  ³
//³ mv_par08	  // at o Vencimento	  ³
//³ mv_par09	  // do Banco			     ³
//³ mv_par10	  // at o Banco		     ³
//³ mv_par11	  // do Fornecedor		  ³
//³ mv_par12	  // at o Fornecedor	  ³
//³ mv_par13	  // Da Emisso			  ³
//³ mv_par14	  // Ate a Emisso		  ³
//³ mv_par15	  // qual Moeda			  ³
//³ mv_par16	  // Imprime Provis¢rios  ³
//³ mv_par17	  // Reajuste pelo vencto ³
//³ mv_par18	  // Da data contabil	  ³
//³ mv_par19	  // Ate data contabil	  ³
//³ mv_par20	  // Imprime Rel anal/sint³
//³ mv_par21	  // Considera  Data Base?³
//³ mv_par22	  // Cons filiais abaixo ?³
//³ mv_par23	  // Filial de            ³
//³ mv_par24	  // Filial ate           ³
//³ mv_par25	  // Loja de              ³
//³ mv_par26	  // Loja ate             ³
//³ mv_par27 	  // Considera Adiantam.? ³
//³ mv_par28	  // Imprime Nome 		  ³
//³ mv_par29	  // Outras Moedas 		  ³
//³ mv_par30     // Imprimir os Tipos    ³
//³ mv_par31     // Nao Imprimir Tipos	  ³
//³ mv_par32     // Consid. Fluxo Caixa  ³
//³ mv_par33     // DataBase             ³
//³ mv_par34     // Tipo de Data p/Saldo ³
//³ mv_par35     // Quanto a taxa		  ³
//³ mv_par36     // Tit.Emissao Futura	  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Envia controle para a funcao SETPRINT ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ

mv_par01 :=	"      "  // do Numero 			  ³
mv_par02 :=	"zzzzzz"  // at o Numero 		  ³
mv_par03 :=	"   "  // do Prefixo			  ³
mv_par04 :=	"zzz"  // at o Prefixo		  ³
mv_par05 :=	"          "  // da Natureza  	     ³
mv_par06 :=	"zzzzzzzzzz"  // at a Natureza		  ³
mv_par07 :=	dPADoVenc   // do Vencimento		  ³
mv_par08 :=	dPAAteVenc  // at o Vencimento	  ³
mv_par09 :=	"   "  // do Banco			     ³
mv_par10 :=	"zzz"  // at o Banco		     ³
mv_par11 :=	"      "  // do Fornecedor		  ³
mv_par12 :=	"zzzzzz"  // at o Fornecedor	  ³
mv_par13 :=	CTOD("01/01/90")  // Da Emisso			  ³
mv_par14 :=	CTOD("31/12/49")  // Ate a Emisso		  ³
mv_par15 :=	1  // qual Moeda			  ³
mv_par16 :=	1  // Imprime Provis¢rios  ³
mv_par17 :=	1  // Reajuste pelo vencto ³
mv_par18 :=	CTOD("01/01/90")  // Da data contabil	  ³
mv_par19 :=	CTOD("31/12/49")  // Ate data contabil	  ³
mv_par20 :=	2  // Imprime Rel anal/sint³
mv_par21 :=	1 // Considera  Data Base?³
mv_par22 :=	1  // Cons filiais abaixo ?³
mv_par23 :=	SM0->M0_CODFIL  // Filial de            ³
mv_par24 :=	SM0->M0_CODFIL  // Filial ate           ³
mv_par25 :=	"  "  // Loja de              ³
mv_par26 :=	"zz"  // Loja ate             ³
mv_par27 :=	2  // Considera Adiantam.? ³
mv_par28 :=	2  // Imprime Nome 		  ³
mv_par29 :=	2  // Outras Moedas 		  ³
mv_par30 := "                                        "   // Imprimir os Tipos    ³
mv_par31 := "NCC, AB-                                "   // Nao Imprimir Tipos	  ³
mv_par32 := 2   // Consid. Fluxo Caixa  ³
mv_par33 := dPARGDBase    // DataBase             ³
mv_par34 := 2   // Tipo de Data p/Saldo ³
mv_par35 := 1    // Quanto a taxa		  ³
mv_par36 := 2    // Tit.Emissao Futura	  ³

#IFDEF TOP
	IF TcSrvType() == "AS/400" .and. Select("__SE2") == 0
		ChkFile("SE2",.f.,"__SE2")
	Endif
#ENDIF

wnrel := "FINR150"            //Nome Default do relatorio em Disco
aOrd	:= {OemToAnsi(STR0008),OemToAnsi(STR0009),OemToAnsi(STR0010) ,;  //"Por Numero"###"Por Natureza"###"Por Vencimento"
	OemToAnsi(STR0011),OemToAnsi(STR0012),OemToAnsi(STR0013),OemToAnsi(STR0014) }  //"Por Banco"###"Fornecedor"###"Por Emissao"###"Por Cod.Fornec."
//wnrel := SetPrint(cString,wnrel,cPerg,@titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,,Tamanho)
/*
If nLastKey == 27
	Return
Endif

SetDefault(aReturn,cString)

If nLastKey == 27
	Return
Endif

RptStatus({|lEnd| Fa150Imp(@lEnd,wnRel,cString)},Titulo)
*/
nValRet := CalcSAP()
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Restaura empresa / filial original    ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
SM0->(dbGoto(nRegEmp))
cFilAnt := SM0->M0_CODFIL

//Acerta a database de acordo com a database real do sistema
If mv_par21 == 1    // Considera Data Base
	dDataBase := dOldDtBase
Endif	

Return(nValRet)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ FA150Imp ³ Autor ³ Wagner Xavier 		  ³ Data ³ 02.10.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Posio dos Titulos a Pagar										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ FA150Imp(lEnd,wnRel,cString)										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ lEnd	  - AÆo do Codeblock										  ³±±
±±³			 ³ wnRel   - T¡tulo do relat¢rio 									  ³±±
±±³			 ³ cString - Mensagem										 			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Genrico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function CalcSAP() //FA150Imp(lEnd,wnRel,cString)

LOCAL CbCont
LOCAL CbTxt
LOCAL nOrdem :=0
LOCAL nQualIndice := 0
LOCAL lContinua := .T.
LOCAL nTit0:=0,nTit1:=0,nTit2:=0,nTit3:=0,nTit4:=0,nTit5:=0
LOCAL nTot0:=0,nTot1:=0,nTot2:=0,nTot3:=0,nTot4:=0,nTotTit:=0,nTotJ:=0,nTotJur:=0
LOCAL nFil0:=0,nFil1:=0,nFil2:=0,nFil3:=0,nFil4:=0,nFilTit:=0,nFilJ:=0
LOCAL cCond1,cCond2,cCarAnt,nSaldo:=0,nAtraso:=0
LOCAL dDataReaj
LOCAL dDataAnt := dDataBase , lQuebra
LOCAL nMestit0:= nMesTit1 := nMesTit2 := nMesTit3 := nMesTit4 := nMesTTit := nMesTitj := 0
LOCAL dDtContab
LOCAL	cIndexSe2
LOCAL	cChaveSe2
LOCAL	nIndexSE2
LOCAL cFilDe,cFilAte
Local nTotsRec := SE2->(RecCount())
Local aTamFor := TAMSX3("E2_FORNECE")
Local nDecs := Msdecimais(mv_par15)
Local lFr150Flt := EXISTBLOCK("FR150FLT")
Local cFr150Flt

#IFDEF TOP
	Local nI := 0
	Local aStru := SE2->(dbStruct())
#ENDIF

Private nRegSM0 := SM0->(Recno())
Private nAtuSM0 := SM0->(Recno())
PRIVATE dBaixa := dDataBase

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Ponto de entrada para Filtrar 										  ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ Localizaes ArgentinaÄÙ
If lFr150Flt
	cFr150Flt := EXECBLOCK("Fr150FLT",.f.,.f.)
Endif

//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ Variaveis utilizadas para Impresso do Cabealho e Rodap ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
cbtxt  := OemToAnsi(STR0015)  //"* indica titulo provisorio, P indica Saldo Parcial"
cbcont := 0
li 	 := 80
m_pag  := 1

nOrdem := aReturn[8]
cMoeda := LTrim(Str(mv_par15))
Titulo += OemToAnsi(STR0035)+GetMv("MV_MOEDA"+cMoeda)  //" em "

dbSelectArea ( "SE2" )
Set Softseek On

If mv_par22 == 2
	cFilDe  := cFilAnt
	cFilAte := cFilAnt
ELSE
	cFilDe := mv_par23
	cFilAte:= mv_par24
Endif

//Acerta a database de acordo com o parametro
If mv_par21 == 1    // Considera Data Base
	dDataBase := mv_par33
Endif	

Private nVoltaPAVlr := 0

dbSelectArea("SM0")

cEmpAnt := SM0->M0_CODIGO
cFilAte := SM0->M0_CODFIL
cFilDe  := SM0->M0_CODFIL

dbSeek(cEmpAnt+cFilDe,.T.)

nRegSM0 := SM0->(Recno())
nAtuSM0 := SM0->(Recno())

While !Eof() .and. M0_CODIGO == cEmpAnt .and. M0_CODFIL <= cFilAte

	dbSelectArea("SE2")
	cFilAnt := SM0->M0_CODFIL

	#IFDEF TOP
		if TcSrvType() != "AS/400"
			cQuery := "SELECT * "
			cQuery += "  FROM "+	RetSqlName("SE2")
			cQuery += " WHERE E2_FILIAL = '" + xFilial("SE2") + "'"
			cQuery += "   AND D_E_L_E_T_ <> '*' "
		endif
	#ENDIF

	IF nOrdem == 1
		SE2->(dbSetOrder(1))
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				dbSeek(xFilial("SE2")+mv_par03+mv_par01,.T.)
			else
				cOrder := SqlOrder(indexkey())
			endif
		#ELSE
			dbSeek(xFilial("SE2")+mv_par03+mv_par01,.T.)
		#ENDIF
		cCond1 := "E2_PREFIXO <= mv_par04"
		cCond2 := "E2_PREFIXO"
		titulo += OemToAnsi(STR0016)  //" - Por Numero"
		nQualIndice := 1
	Elseif nOrdem == 2
		SE2->(dbSetOrder(2))
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				dbSeek(xFilial("SE2")+mv_par05,.T.)
			else
				cOrder := SqlOrder(indexkey())
			endif
		#ELSE
			dbSeek(xFilial("SE2")+mv_par05,.T.)
		#ENDIF
		cCond1 := "E2_NATUREZ <= mv_par06"
		cCond2 := "E2_NATUREZ"
		titulo += OemToAnsi(STR0017)  //" - Por Natureza"
		nQualIndice := 2
	Elseif nOrdem == 3
		SE2->(dbSetOrder(3))
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				dbSeek(xFilial("SE2")+Dtos(mv_par07),.T.)
			else
				cOrder := SqlOrder(indexkey())
			endif
		#ELSE
			dbSeek(xFilial("SE2")+Dtos(mv_par07),.T.)
		#ENDIF
		cCond1 := "E2_VENCREA <= mv_par08"
		cCond2 := "E2_VENCREA"
		titulo += OemToAnsi(STR0018)  //" - Por Vencimento"
		nQualIndice := 3
	Elseif nOrdem == 4
		SE2->(dbSetOrder(4))
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				dbSeek(xFilial("SE2")+mv_par09,.T.)
			else
				cOrder := SqlOrder(indexkey())
			endif
		#ELSE
			dbSeek(xFilial("SE2")+mv_par09,.T.)
		#ENDIF
		cCond1 := "E2_PORTADO <= mv_par10"
		cCond2 := "E2_PORTADO"
		titulo += OemToAnsi(STR0031)  //" - Por Banco"
		nQualIndice := 4
	Elseif nOrdem == 6
		SE2->(dbSetOrder(5))
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				dbSeek(xFilial("SE2")+DTOS(mv_par13),.T.)
			else
				cOrder := SqlOrder(indexkey())
			endif
		#ELSE
			dbSeek(xFilial("SE2")+DTOS(mv_par13),.T.)
		#ENDIF
		cCond1 := "E2_EMISSAO <= mv_par14"
		cCond2 := "E2_EMISSAO"
		titulo += OemToAnsi(STR0019)  //" - Por Emissao"
		nQualIndice := 5
	Elseif nOrdem == 7
		SE2->(dbSetOrder(6))
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				dbSeek(xFilial("SE2")+mv_par11,.T.)
			else
				cOrder := SqlOrder(indexkey())
			endif
		#ELSE
			dbSeek(xFilial("SE2")+mv_par11,.T.)
		#ENDIF			
		cCond1 := "E2_FORNECE <= mv_par12"
		cCond2 := "E2_FORNECE"
		titulo += OemToAnsi(STR0020)  //" - Por Cod.Fornecedor"
		nQualIndice := 6
	Else
		cChaveSe2 := "E2_FILIAL+E2_NOMFOR+E2_FORNECE+E2_LOJA+E2_PREFIXO+E2_NUM+E2_PARCELA+E2_TIPO"
		#IFDEF TOP
			if TcSrvType() == "AS/400"
				cIndexSe2 := CriaTrab(nil,.f.)
				IndRegua("SE2",cIndexSe2,cChaveSe2,,Fr150IndR(),OemToAnsi(STR0021))  // //"Selecionando Registros..."
				nIndexSE2 := RetIndex("SE2")
				dbSetOrder(nIndexSe2+1)
				dbSeek(xFilial("SE2"))
			else
				cOrder := SqlOrder(cChaveSe2)
			endif
		#ELSE
			cIndexSe2 := CriaTrab(nil,.f.)
			IndRegua("SE2",cIndexSe2,cChaveSe2,,Fr150IndR(),OemToAnsi(STR0021))  // //"Selecionando Registros..."
			nIndexSE2 := RetIndex("SE2")
			dbSetIndex(cIndexSe2+OrdBagExt())
			dbSetOrder(nIndexSe2+1)
			dbSeek(xFilial("SE2"))
		#ENDIF
		cCond1 := "E2_FORNECE <= mv_par12"
		cCond2 := "E2_FORNECE+E2_LOJA"
		titulo += OemToAnsi(STR0022)  //" - Por Fornecedor"
		nQualIndice := IndexOrd()
	EndIF

	If mv_par20 == 1
		titulo += OemToAnsi(STR0023)  //" - Analitico"
	Else
		titulo += OemToAnsi(STR0024)  // " - Sintetico"
		cabec1 := OemToAnsi(STR0033)  // "                                                                                          |        Titulos vencidos         |    Titulos a vencer     |           Valor dos juros ou                       (Vencidos+Vencer)"
		cabec2 := OemToAnsi(STR0034)  // "                                                                                          | Valor nominal   Valor corrigido |      Valor nominal      |            com. permanencia                                         "
	EndIf

	dbSelectArea("SE2")
	cFilterUser:=aReturn[7]

	Set Softseek Off

	#IFDEF TOP
		if TcSrvType() != "AS/400"
			cQuery += " AND E2_NUM     BETWEEN '"+ mv_par01+ "' AND '"+ mv_par02 + "'"
			cQuery += " AND E2_PREFIXO BETWEEN '"+ mv_par03+ "' AND '"+ mv_par04 + "'"
			cQuery += " AND (E2_MULTNAT = '1' OR (E2_NATUREZ BETWEEN '"+MV_PAR05+"' AND '"+MV_PAR06+"'))"
			cQuery += " AND E2_VENCREA BETWEEN '"+ DTOS(mv_par07)+ "' AND '"+ DTOS(mv_par08) + "'"
			cQuery += " AND E2_PORTADO BETWEEN '"+ mv_par09+ "' AND '"+ mv_par10 + "'"
			cQuery += " AND E2_FORNECE BETWEEN '"+ mv_par11+ "' AND '"+ mv_par12 + "'"
			cQuery += " AND E2_EMISSAO BETWEEN '"+ DTOS(mv_par13)+ "' AND '"+ DTOS(mv_par14) + "'"
			cQuery += " AND E2_LOJA    BETWEEN '"+ mv_par25 + "' AND '"+ mv_par26 + "'"

			//Considerar titulos cuja emissao seja maior que a database do sistema
			If mv_par36 == 2
				cQuery += " AND E2_EMISSAO <= '" + DTOS(dDataBase) +"'"
			Endif
	
			If !Empty(mv_par30) // Deseja imprimir apenas os tipos do parametro 30
				cQuery += " AND E2_TIPO IN "+FormatIn(mv_par30,";") 
			ElseIf !Empty(Mv_par31) // Deseja excluir os tipos do parametro 31
				cQuery += " AND E2_TIPO NOT IN "+FormatIn(mv_par31,";")
			EndIf
			If mv_par32 == 1
				cQuery += " AND E2_FLUXO <> 'N'"
			Endif
			cQuery += " ORDER BY "+ cOrder

			cQuery := ChangeQuery(cQuery)

			dbSelectArea("SE2")
			dbCloseArea()
			dbSelectArea("SA2")

			dbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), 'SE2', .F., .T.)

			For ni := 1 to Len(aStru)
				If aStru[ni,2] != 'C'
					TCSetField('SE2', aStru[ni,1], aStru[ni,2],aStru[ni,3],aStru[ni,4])
				Endif
			Next
		endif
	#ENDIF

	//SetRegua(nTotsRec)
	
	If MV_MULNATP .And. nOrdem == 2
		//Finr155R3(cFr150Flt, lEnd, @nTot0, @nTot1, @nTot2, @nTot3, @nTotTit, @nTotJ )
		#IFDEF TOP
			if TcSrvType() != "AS/400"
				dbSelectArea("SE2")
				dbCloseArea()
				ChKFile("SE2")
				dbSetOrder(1)
			endif
		#ENDIF
		If Empty(xFilial("SE2"))
			Exit
		Endif
		dbSelectArea("SM0")
		dbSkip()
		Loop
	Endif

	While &cCond1 .and. !Eof() .and. lContinua .and. E2_FILIAL == xFilial("SE2")

		/*
		IF lEnd
			@PROW()+1,001 PSAY OemToAnsi(STR0025)  //"CANCELADO PELO OPERADOR"
			Exit
		End

		IncRegua()
        */
		dbSelectArea("SE2")

		Store 0 To nTit1,nTit2,nTit3,nTit4,nTit5

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Carrega data do registro para permitir ³
		//³ posterior analise de quebra por mes.	 ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		dDataAnt := Iif(nOrdem == 3, SE2->E2_VENCREA, SE2->E2_EMISSAO)

		cCarAnt := &cCond2

		While &cCond2 == cCarAnt .and. !Eof() .and. lContinua .and. E2_FILIAL == xFilial("SE2")

			/*
			IF lEnd
				@PROW()+1,001 PSAY OemToAnsi(STR0025)  //"CANCELADO PELO OPERADOR"
				Exit
			End

			IncRegua()
            */
            
			dbSelectArea("SE2")

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Considera filtro do usuario                                  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If !Empty(cFilterUser).and.!(&cFilterUser)
				dbSkip()
				Loop
			Endif
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Considera filtro do usuario no ponto de entrada.             ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If lFr150flt
				If &cFr150flt
					DbSkip()
					Loop
				Endif
			Endif
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se trata-se de abatimento ou provisorio, ou ³
			//³ Somente titulos emitidos ate a data base				   ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF SE2->E2_TIPO $ MVABATIM .Or. (SE2 -> E2_EMISSAO > dDataBase .and. mv_par36 == 2)
				dbSkip()
				Loop
			EndIF
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se ser  impresso titulos provis¢rios		   ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF E2_TIPO $ MVPROVIS .and. mv_par16 == 2
				dbSkip()
				Loop
			EndIF

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se ser  impresso titulos de Adiantamento	 ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF SE2->E2_TIPO $ MVPAGANT+"/"+MV_CPNEG .and. mv_par27 == 2
				dbSkip()
				Loop
			EndIF

			// dDtContab para casos em que o campo E2_EMIS1 esteja vazio
			// compatibilizando com a verso 2.04 que no gerava para titulos
			// de ISS e FunRural

			dDtContab := Iif(Empty(SE2->E2_EMIS1),SE2->E2_EMISSAO,SE2->E2_EMIS1)

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se esta dentro dos parametros ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			IF E2_NUM < mv_par01      .OR. E2_NUM > mv_par02 .OR. ;
					E2_PREFIXO < mv_par03  .OR. E2_PREFIXO > mv_par04 .OR. ;
					E2_NATUREZ < mv_par05  .OR. E2_NATUREZ > mv_par06 .OR. ;
					E2_VENCREA < mv_par07  .OR. E2_VENCREA > mv_par08 .OR. ;
					E2_PORTADO < mv_par09  .OR. E2_PORTADO > mv_par10 .OR. ;
					E2_FORNECE < mv_par11  .OR. E2_FORNECE > mv_par12 .OR. ;
					E2_EMISSAO < mv_par13  .OR. E2_EMISSAO > mv_par14 .OR. ;
					(E2_EMISSAO > dDataBase .and. mv_par36 == 2) .OR. dDtContab  < mv_par18 .OR. ;
					E2_LOJA    < mv_par25  .OR. E2_LOJA    > mv_par26 .OR. ;
					dDtContab  > mv_par19  .Or. !&(fr150IndR())

				dbSkip()
				Loop
			Endif

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se titulo, apesar do E2_SALDO = 0, deve aparecer ou ³
			//³ nÆo no relat¢rio quando se considera database (mv_par21 = 1) ³
			//³ ou caso nÆo se considere a database, se o titulo foi totalmen³
			//³ te baixado.																  ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			dbSelectArea("SE2")
			IF !Empty(SE2->E2_BAIXA) .and. Iif(mv_par21 == 2 ,SE2->E2_SALDO == 0 ,;
					IIF(mv_par34 == 1,(SE2->E2_SALDO == 0 .and. SE2->E2_BAIXA <= dDataBase),.F.))
				dbSkip()
				Loop
			EndIF

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Verifica se deve imprimir outras moedas³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If mv_par29 == 2 // nao imprime
				if SE2->E2_MOEDA != mv_par15 //verifica moeda do campo=moeda parametro
					dbSkip()
					Loop
				endif	
			Endif
			
			 // Tratamento da correcao monetaria para a Argentina
			If  cPaisLoc=="ARG" .And. mv_par15 <> 1  .And.  SE2->E2_CONVERT=='N'
				dbSkip()
				Loop
			Endif
             

			dbSelectArea("SA2")
			MSSeek(xFilial("SA2")+SE2->E2_FORNECE+SE2->E2_LOJA)
			dbSelectArea("SE2")

			// Verifica se existe a taxa na data do vencimento do titulo, se nao existir, utiliza a taxa da database
			If SE2->E2_VENCREA < dDataBase
				If mv_par17 == 2 .And. RecMoeda(SE2->E2_VENCREA,cMoeda) > 0
					dDataReaj := SE2->E2_VENCREA
				Else
					dDataReaj := dDataBase
				EndIf	
			Else
				dDataReaj := dDataBase
			EndIf       

			If mv_par21 == 1
				//Ita - 03/03/2008 - nSaldo := SaldoTit(SE2->E2_PREFIXO,SE2->E2_NUM,SE2->E2_PARCELA,SE2->E2_TIPO,SE2->E2_NATUREZ,"P",SE2->E2_FORNECE,mv_par15,dDataReaj,,SE2->E2_LOJA,,If(mv_par35==1,SE2->E2_TXMOEDA,Nil),IIF(mv_par34 == 2,3,1)) // 1 = DT BAIXA    3 = DT DIGIT
				nSaldo := TitSaldo(SE2->E2_PREFIXO,SE2->E2_NUM,SE2->E2_PARCELA,SE2->E2_TIPO,SE2->E2_NATUREZ,"P",SE2->E2_FORNECE,mv_par15,dDataReaj,,SE2->E2_LOJA,,If(mv_par35==1,SE2->E2_TXMOEDA,Nil),IIF(mv_par34 == 2,3,1)) // 1 = DT BAIXA    3 = DT DIGIT
				// Subtrai decrescimo para recompor o saldo na data escolhida.
				If Str(SE2->E2_VALOR,17,2) == Str(nSaldo,17,2) .And. SE2->E2_DECRESC > 0 .And. SE2->E2_SDDECRE == 0
					nSAldo -= SE2->E2_DECRESC
				Endif
				// Soma Acrescimo para recompor o saldo na data escolhida.
				If Str(SE2->E2_VALOR,17,2) == Str(nSaldo,17,2) .And. SE2->E2_ACRESC > 0 .And. SE2->E2_SDACRES == 0
					nSAldo += SE2->E2_ACRESC
				Endif
			Else
				nSaldo := xMoeda((SE2->E2_SALDO+SE2->E2_SDACRES-SE2->E2_SDDECRE),SE2->E2_MOEDA,mv_par15,dDataReaj,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
			Endif
			If ! (SE2->E2_TIPO $ MVPAGANT+"/"+MV_CPNEG) .And. ;
			   ! ( MV_PAR21 == 2 .And. nSaldo == 0 ) // nao deve olhar abatimento pois e zerado o saldo na liquidacao final do titulo

				//Quando considerar Titulos com emissao futura, eh necessario
				//colocar-se a database para o futuro de forma que a Somaabat()
				//considere os titulos de abatimento
				If mv_par36 == 1
					dOldData := dDataBase
					dDataBase := CTOD("31/12/40")
				Endif

				nSaldo-=SomaAbat(SE2->E2_PREFIXO,SE2->E2_NUM,SE2->E2_PARCELA,"P",mv_par15,dDataReaj,SE2->E2_FORNECE,SE2->E2_LOJA)

				If mv_par36 == 1
					dDataBase := dOldData
				Endif
			EndIf

			nSaldo:=Round(NoRound(nSaldo,3),2)
			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Desconsidera caso saldo seja menor ou igual a zero   ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			If nSaldo <= 0
				dbSkip()
				Loop
			Endif

			IF li > 58
				nAtuSM0 := SM0->(Recno())
				SM0->(dbGoto(nRegSM0))
				//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
				SM0->(dbGoTo(nAtuSM0))
			EndIF

			/*
			If mv_par20 == 1
				@li,	0 PSAY SE2->E2_FORNECE+"-"+SE2->E2_LOJA+"-"+IIF(mv_par28 == 1, SubStr(SA2->A2_NREDUZ,1,15), SubStr(SA2->A2_NOME,1,15))
				li := IIf (aTamFor[1] > 6,li+1,li)
				@li, 26 PSAY SE2->E2_PREFIXO+"-"+SE2->E2_NUM+"-"+SE2->E2_PARCELA
				@li, 47 PSAY SE2->E2_TIPO
				@li, 51 PSAY SE2->E2_NATUREZ
				@li, 62 PSAY SE2->E2_EMISSAO
				@Li, 73 PSAY SE2->E2_VENCTO
				@li, 84 PSAY SE2->E2_VENCREA
				@li, 96 PSAY xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil)) * If(SE2->E2_TIPO$MV_CPNEG+"/"+MVPAGANT, -1,1) Picture PesqPict("SE2","E2_VALOR",14,MV_PAR15)
			EndIf
			*/
			#IFDEF TOP
				If TcSrvType() == "AS/400"
					dbSetOrder( nQualIndice )
				Endif
			#ELSE
				dbSetOrder( nQualIndice )
			#ENDIF

			If dDataBase > SE2->E2_VENCREA 		//vencidos
				/*
				If mv_par20 == 1
					@ li, 112 PSAY nSaldo  * If(SE2->E2_TIPO$MV_CPNEG+"/"+MVPAGANT, -1,1) Picture TM(nSaldo,14,nDecs)
				EndIf
				*/
				nJuros:=0
				dBaixa:=dDataBase
				fa080Juros(mv_par15)
				dbSelectArea("SE2")
				/*
				If mv_par20 == 1
					@li,129 PSAY (nSaldo+nJuros) * If(SE2->E2_TIPO$MV_CPNEG+"/"+MVPAGANT, -1,1) Picture TM(nSaldo+nJuros,14,nDecs)
				EndIf
				*/
				If SE2->E2_TIPO $ MVPAGANT+"/"+MV_CPNEG
					nTit0 -= xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nTit1 -= nSaldo
					nTit2 -= nSaldo+nJuros
					nMesTit0 -= xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nMesTit1 -= nSaldo
					nMesTit2 -= nSaldo+nJuros
				Else
					nTit0 += xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nTit1 += nSaldo
					nTit2 += nSaldo+nJuros
					nMesTit0 += xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nMesTit1 += nSaldo
					nMesTit2 += nSaldo+nJuros
				Endif
				nTotJur += (nJuros)
				nMesTitJ += (nJuros)
			Else				  //a vencer
				/*
				If mv_par20 == 1
					@li,147 PSAY nSaldo  * If(SE2->E2_TIPO$MV_CPNEG+"/"+MVPAGANT, -1,1) Picture TM(nSaldo,14,nDecs)
				EndIf
				*/
				If SE2->E2_TIPO $ MVPAGANT+"/"+MV_CPNEG
					nTit0 -= xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nTit3 -= nSaldo
					nTit4 -= nSaldo
					nMesTit0 -= xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nMesTit3 -= nSaldo
					nMesTit4 -= nSaldo
				Else
					nTit0 += xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nTit3 += nSaldo
					nTit4 += nSaldo
					nMesTit0 += xMoeda(SE2->E2_VALOR,SE2->E2_MOEDA,mv_par15,SE2->E2_EMISSAO,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))
					nMesTit3 += nSaldo
					nMesTit4 += nSaldo
				Endif
			Endif
			/*
			If mv_par20 == 1
				@Li,165 PSAY SE2->E2_PORTADO
			EndIf
			*/
			If nJuros > 0
				/*
				If mv_par20 == 1
					@Li,173 PSAY nJuros Picture PesqPict("SE2","E2_JUROS",12,MV_PAR15)
				EndIf
				*/
				nJuros := 0
			Endif

			IF dDataBase > E2_VENCREA
				nAtraso:=dDataBase-E2_VENCTO
				IF Dow(E2_VENCTO) == 1 .Or. Dow(E2_VENCTO) == 7
					IF Dow(dBaixa) == 2 .and. nAtraso <= 2
						nAtraso:=0
					EndIF
				EndIF
				nAtraso:=IIF(nAtraso<0,0,nAtraso)
				IF nAtraso>0
					/*
					If mv_par20 == 1
						@li,189 PSAY nAtraso Picture "9999"
					EndIf
					*/
				EndIF
			EndIF
			If mv_par20 == 1
				//@li,194 PSAY SUBSTR(SE2->E2_HIST,1,24)+ ;
					IIF(E2_TIPO $ MVPROVIS,"*"," ")+ ;
					Iif(nSaldo - SE2->E2_ACRESC + SE2->E2_DECRESC == xMoeda(E2_VALOR,E2_MOEDA,mv_par15,dDataReaj,ndecs+1,If(mv_par35==1,SE2->E2_TXMOEDA,Nil))," ","P")
			EndIf

			//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
			//³ Carrega data do registro para permitir ³
			//³ posterior analise de quebra por mes.	 ³
			//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
			dDataAnt := Iif(nOrdem == 3, SE2->E2_VENCREA, SE2->E2_EMISSAO)

			dbSkip()
			nTotTit ++
			nMesTTit ++
			nFiltit++
			nTit5 ++
			If mv_par20 == 1
				li ++
			EndIf

		EndDO

		IF nTit5 > 0 .and. nOrdem != 1
			SubTot150(nTit0,nTit1,nTit2,nTit3,nTit4,nOrdem,cCarAnt,nTotJur,nDecs)
			If mv_par20 == 1
				li++
			EndIf
		EndIF

		//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
		//³ Verifica quebra por mes					 ³
		//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
		lQuebra := .F.
		If nOrdem == 3 .and. Month(SE2->E2_VENCREA) # Month(dDataAnt)
			lQuebra := .T.
		Elseif nOrdem == 6 .and. Month(SE2->E2_EMISSAO) # Month(dDataAnt)
			lQuebra := .T.
		Endif
		If lQuebra .and. nMesTTit # 0
			ImpMes150(nMesTit0,nMesTit1,nMesTit2,nMesTit3,nMesTit4,nMesTTit,nMesTitJ,nDecs)
			nMesTit0 := nMesTit1 := nMesTit2 := nMesTit3 := nMesTit4 := nMesTTit := nMesTitj := 0
		Endif

		dbSelectArea("SE2")

		nTot0 += nTit0
		nTot1 += nTit1
		nTot2 += nTit2
		nTot3 += nTit3
		nTot4 += nTit4
		nTotJ += nTotJur

		nFil0 += nTit0
		nFil1 += nTit1
		nFil2 += nTit2
		nFil3 += nTit3
		nFil4 += nTit4
		nFilJ += nTotJur
		Store 0 To nTit0,nTit1,nTit2,nTit3,nTit4,nTit5,nTotJur
	Enddo					
    nVoltaPAVlr := IIF(nFunPACham == 1,nFil4,nFil1)
	dbSelectArea("SE2")		// voltar para alias existente, se nao, nao funciona
	//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
	//³ Imprimir TOTAL por filial somente quan-³
	//³ do houver mais do que 1 filial.        ³
	//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
	if mv_par22 == 1 .and. SM0->(Reccount()) > 1
		//ImpFil150(nFil0,nFil1,nFil2,nFil3,nFil4,nFilTit,nFilj,nDecs)
	Endif
	Store 0 To nFil0,nFil1,nFil2,nFil3,nFil4,nFilTit,nFilJ
	If Empty(xFilial("SE2"))
		Exit
	Endif

	#IFDEF TOP
		if TcSrvType() != "AS/400"
			dbSelectArea("SE2")
			dbCloseArea()
			ChKFile("SE2")
			dbSetOrder(1)
		endif
	#ENDIF

	dbSelectArea("SM0")
	dbSkip()
EndDO

SM0->(dbGoTo(nRegSM0))
cFilAnt := SM0->M0_CODFIL

IF li != 80
	If mv_par20 == 1
		li +=2
	Endif
	//ImpTot150(nTot0,nTot1,nTot2,nTot3,nTot4,nTotTit,nTotJ,nDecs)
	cbcont := 1
	roda(cbcont,cbtxt,"G")
EndIF
//Set Device To Screen

#IFNDEF TOP
	dbSelectArea( "SE2" )
	dbClearFil()
	RetIndex( "SE2" )
	If !Empty(cIndexSE2)
		FErase (cIndexSE2+OrdBagExt())
	Endif
	dbSetOrder(1)
#ELSE
	if TcSrvType() != "AS/400"
		dbSelectArea("SE2")
		dbCloseArea()
		ChKFile("SE2")
		dbSetOrder(1)
	else
		dbSelectArea( "SE2" )
		dbClearFil()
		RetIndex( "SE2" )
		If !Empty(cIndexSE2)
			FErase (cIndexSE2+OrdBagExt())
		Endif
		dbSetOrder(1)
	endif
#ENDIF	
/*
If aReturn[5] = 1
	Set Printer To
	dbCommitAll()
	ourspool(wnrel)
Endif
MS_FLUSH()
*/
Return(nVoltaPAVlr)
/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³SubTot150 ³ Autor ³ Wagner Xavier 		  ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³IMPRIMIR SUBTOTAL DO RELATORIO 									  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ SubTot150() 															  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ 																			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
Static Function SubTot150(nTit0,nTit1,nTit2,nTit3,nTit4,nOrdem,cCarAnt,nTotJur,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)

If mv_par20 == 1
	li++
EndIf

IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF

if nOrdem == 1 .Or. nOrdem == 3 .Or. nOrdem == 4 .Or. nOrdem == 6
	//@li,000 PSAY OemToAnsi(STR0026)  //"S U B - T O T A L ----> "
	//@li,028 PSAY cCarAnt
ElseIf nOrdem == 2
	dbSelectArea("SED")
	dbSeek(xFilial("SED")+cCarAnt)
	//@li,000 PSAY cCarAnt +" "+SED->ED_DESCRIC
Elseif nOrdem == 5
	//@Li,000 PSAY IIF(mv_par28 == 1,SA2->A2_NREDUZ,SA2->A2_NOME)+" "+Substr(SA2->A2_TEL,1,15)
ElseIf nOrdem == 7
	//@li,000 PSAY SA2->A2_COD+" "+SA2->A2_LOJA+" "+SA2->A2_NOME+" "+Substr(SA2->A2_TEL,1,15)
Endif
if mv_par20 == 1
	//@li,096 PSAY nTit0		 Picture TM(nTit0,14,nDecs)
endif
/*
@li,112 PSAY nTit1		 Picture TM(nTit1,14,nDecs)
@li,129 PSAY nTit2		 Picture TM(nTit2,14,nDecs)
@li,147 PSAY nTit3		 Picture TM(nTit3,14,nDecs)
If nTotJur > 0
	@li,173 PSAY nTotJur 	 Picture TM(nTotJur,12,nDecs)
Endif
@li,204 PSAY nTit2+nTit3 Picture TM(nTit2+nTit3,16,nDecs)
li++
*/
Return(.T.)


/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ImpTot150 ³ Autor ³ Wagner Xavier 		  ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³IMPRIMIR TOTAL DO RELATORIO 										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ ImpTot150() 															  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ 																			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC Function ImpTot150(nTot0,nTot1,nTot2,nTot3,nTot4,nTotTit,nTotJ,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)

li++
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF
//@li,000 PSAY OemToAnsi(STR0027)  //"T O T A L   G E R A L ----> "
//@li,028 PSAY "("+ALLTRIM(STR(nTotTit))+" "+IIF(nTotTit > 1,OemToAnsi(STR0028),OemToAnsi(STR0029))+")"  //"TITULOS"###"TITULO"
if mv_par20 == 1
//	@li,096 PSAY nTot0		 Picture TM(nTot0,14,nDecs)
endif
/*
@li,112 PSAY nTot1		 Picture TM(nTot1,14,nDecs)
@li,129 PSAY nTot2		 Picture TM(nTot2,14,nDecs)
@li,147 PSAY nTot3		 Picture TM(nTot3,14,nDecs)
@li,173 PSAY nTotJ		 Picture TM(nTotJ,12,nDecs)
@li,204 PSAY nTot2+nTot3 Picture TM(nTot2+nTot3,16,nDecs)
li+=2
*/
Return(.T.)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ImpMes150 ³ Autor ³ Vinicius Barreira	  ³ Data ³ 12.12.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³IMPRIMIR TOTAL DO RELATORIO - QUEBRA POR MES					  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ ImpMes150() 															  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³ 																			  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
STATIC Function ImpMes150(nMesTot0,nMesTot1,nMesTot2,nMesTot3,nMesTot4,nMesTTit,nMesTotJ,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)

li++
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
	//cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF
//@li,000 PSAY OemToAnsi(STR0030)  //"T O T A L   D O  M E S ---> "
//@li,028 PSAY "("+ALLTRIM(STR(nMesTTit))+" "+IIF(nMesTTit > 1,OemToAnsi(STR0028),OemToAnsi(STR0029))+")"  //"TITULOS"###"TITULO"
if mv_par20 == 1
  //	@li,096 PSAY nMesTot0   Picture TM(nMesTot0,14,nDecs)
endif
/*
@li,112 PSAY nMesTot1	Picture TM(nMesTot1,14,nDecs)
@li,129 PSAY nMesTot2	Picture TM(nMesTot2,14,nDecs)
@li,147 PSAY nMesTot3	Picture TM(nMesTot3,14,nDecs)
@li,173 PSAY nMesTotJ	Picture TM(nMesTotJ,12,nDecs)
@li,204 PSAY nMesTot2+nMesTot3 Picture TM(nMesTot2+nMesTot3,16,nDecs)
li+=2
*/
Return(.T.)

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³ ImpFil150³ Autor ³ Paulo Boschetti 	     ³ Data ³ 01.06.92 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³ Imprimir total do relatorio										  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Sintaxe e ³ ImpFil150()																  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³Parametros³																				  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso      ³ Generico				   									 			  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
STATIC Function ImpFil150(nFil0,nFil1,nFil2,nFil3,nFil4,nFilTit,nFilJ,nDecs)

DEFAULT nDecs := Msdecimais(mv_par15)

li++
IF li > 58
	nAtuSM0 := SM0->(Recno())
	SM0->(dbGoto(nRegSM0))
//	cabec(titulo,cabec1,cabec2,nomeprog,tamanho,GetMv("MV_COMP"))
	SM0->(dbGoTo(nAtuSM0))
EndIF
/*
@li,000 PSAY OemToAnsi(STR0032)+" "+cFilAnt+" - " + AllTrim(SM0->M0_FILIAL)  //"T O T A L   F I L I A L ----> " 
if mv_par20 == 1
	@li,096 PSAY nFil0        Picture TM(nFil0,14,nDecs)
endif
@li,112 PSAY nFil1        Picture TM(nFil1,14,nDecs)
@li,129 PSAY nFil2        Picture TM(nFil2,14,nDecs)
@li,147 PSAY nFil3        Picture TM(nFil3,14,nDecs)
@li,173 PSAY nFilJ		  Picture TM(nFilJ,12,nDecs)
@li,204 PSAY nFil2+nFil3 Picture TM(nFil2+nFil3,16,nDecs)
li+=2
*/
Return .T.

/*/
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±
±±³Funo	 ³fr150Indr ³ Autor ³ Wagner           	  ³ Data ³ 12.12.94 ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±
±±³Descrio ³Monta Indregua para impressao do relat¢rio						  ³±±
±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±
±±³ Uso		 ³ Generico 																  ³±±
±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
/*/
Static Function fr150IndR()
Local cString
//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
//³ ATENCAO !!!!                                               ³
//³ No adiconar mais nada a chave do filtro pois a mesma est  ³
//³ com 254 caracteres.                                        ³
//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
cString := 'E2_FILIAL="'+xFilial()+'".And.'
cString += '(E2_MULTNAT="1" .OR. (E2_NATUREZ>="'+mv_par05+'".and.E2_NATUREZ<="'+mv_par06+'")).And.'
cString += 'E2_FORNECE>="'+mv_par11+'".and.E2_FORNECE<="'+mv_par12+'".And.'
cString += 'DTOS(E2_VENCREA)>="'+DTOS(mv_par07)+'".and.DTOS(E2_VENCREA)<="'+DTOS(mv_par08)+'".And.'
cString += 'DTOS(E2_EMISSAO)>="'+DTOS(mv_par13)+'".and.DTOS(E2_EMISSAO)<="'+DTOS(mv_par14)+'"'
If !Empty(mv_par30) // Deseja imprimir apenas os tipos do parametro 30
	cString += '.And.E2_TIPO$"'+mv_par30+'"'
ElseIf !Empty(Mv_par31) // Deseja excluir os tipos do parametro 31
	cString += '.And.!(E2_TIPO$'+'"'+mv_par31+'")'
EndIf
IF mv_par32 == 1  // Apenas titulos que estarao no fluxo de caixa
	cString += '.And.(E2_FLUXO!="N")'	
Endif
		
Return cString

Static Function fClcMPCmp(cGrpMP,nMes,nOpcf)
   
   cMPGrupo := cGrpMP
   
   /**************************
   * Compras de Materia Prima
   *
   **************************/   
      
      //IncProc("Calc. Compras de Mat.Prima, Proc. "+Alltrim(Str(nMes))+" / 3")
      
      //Five Solutions Consultoria - 02/08/2011(Pegar custo da NF Mãe pois custo da NF Transf. está errado) - cQuery := "SELECT SUBSTRING(SD1.D1_DTDIGIT,1,6) AS EMISSAO, SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP, SUM(SD1.D1_TOTAL+SD1.D1_VALIPI+SD1.D1_DESPESA) AS VLRCOMPMP, SUM(SD1.D1_QUANT) QTDCOMPMP,SUM(SD1.D1_CUSTO) AS CUSCOMPMP "
      cQuery := "SELECT SUBSTRING(D1_DTDIGIT,1,6) AS EMISSAO, SUBSTRING(B1_SUBGPO,1,1) GRUPOMP, SUM(D1_TOTAL+D1_VALIPI+D1_DESPESA) AS VLRCOMPMP, SUM(D1_QUANT) QTDCOMPMP,"
      cQuery += "       SUM(D1_CUSTO) CUSCOMPMP "
      cQuery += "  FROM (SELECT SUBSTRING(D1_DTDIGIT,1,6) D1_DTDIGIT,SUBSTRING(B1_SUBGPO,1,1) B1_SUBGPO,SD1.D1_TOTAL,SD1.D1_VALIPI,SD1.D1_DESPESA,SD1.D1_QUANT,SD1.D1_NFORI,SD1.D1_SERIORI, SD1.D1_FORNECE,SD1.D1_LOJA,"
      cQuery += "               CASE WHEN SD1.D1_X_NFMAE = ' ' "
      cQuery += "                    THEN SD1.D1_CUSTO"
      cQuery += "               ELSE"
      cQuery += "                  (SELECT MAE.D1_CUSTO"
      cQuery += "                     FROM "+RetSQLName("SD1")+" MAE"
      cQuery += "                    WHERE MAE.D1_FILIAL = '"+xFilial("SD1")+"'"
      cQuery += "                      AND MAE.D1_DOC = SD1.D1_X_NFMAE"
      cQuery += "                      AND MAE.D1_SERIE = SD1.D1_X_MAESE"
      cQuery += "                      AND MAE.D1_FORNECE = SD1.D1_FORNECE"
      cQuery += "                      AND MAE.D1_LOJA = SD1.D1_LOJA"
      cQuery += "                      AND MAE.D1_TIPO = SD1.D1_TIPO "      
      cQuery += "                      AND MAE.D1_COD = SD1.D1_COD "
      cQuery += "                      AND MAE.D_E_L_E_T_ <> '*')"
      cQuery += "               END D1_CUSTO"
      cQuery += "          FROM "+RetSqlName('SD1')+" SD1, "+RetSQLName("SB1")+" SB1,"+RetSQLName("SF4")+" SF4" //Five Solutions Consultoria - 17/06/2010 - Acrescentado link no SF4 P/ Testar se TES Atualiza estoque e Credita ICMS e IPI.
      //cQuery += " WHERE SD1.D1_FILIAL = '04'" //Toda Compra é realizada através da filial PB - 19/07/2009
      cQuery += "         WHERE SD1.D1_FILIAL = '"+xFilial("SD1")+"'" //Passou a Considerar compras da própria filial - 19/08/2009
      cQuery += "           AND SF4.F4_FILIAL = '"+xFilial("SF4")+"'" //Five Solutions Consultoria - 17/06/2010 - Acrescentado link no SF4 P/ Testar se TES Atualiza estoque e Credita ICMS e IPI.
      If SM0->M0_CODFIL = '06'
         cQuery += "        AND SD1.D1_FORNECE <> '003734'"
      EndIf
      cQuery += "           AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'
      cQuery += "           AND SD1.D1_COD = SB1.B1_COD"
      cQuery += "           AND SUBSTRING(SB1.B1_SUBGPO,1,1) = '"+cMPGrupo+"'"
      cQuery += "           AND SUBSTRING(SD1.D1_TP,1,2) = 'MP'"
      cQuery += "           AND SD1.D_E_L_E_T_ <> '*' "
      cQuery += "           AND SB1.D_E_L_E_T_ <> '*' "
      
      //Five Solutions Consultoria - 17/06/2010 - Acrescentado link no SF4 P/ Testar se TES Atualiza estoque e Credita ICMS e IPI. 
      cQuery += "           AND SD1.D1_TES = SF4.F4_CODIGO"
      cQuery += "           AND SF4.F4_ESTOQUE = 'S'"
      cQuery += "           AND SF4.F4_CREDICM = 'S'"
      cQuery += "           AND SF4.F4_CREDIPI = 'S'"
      cQuery += "           AND SF4.D_E_L_E_T_ <> '*' " 
      //Fim do trecho acrescentado em 17/06/2010
      
      If nMes == 1
         cQuery += "        AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQuery += "        AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQuery += "        AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQuery += "        AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQuery += "        AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQuery += "        AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf

      //Five Solutions - 02/08/2011 - cQuery += "           AND SD1.D1_TIPO = 'N' "
      cQuery += "           AND SD1.D1_TIPO = 'N') SD1TMP "
      //Five Solutions Consultoria - 01/09/2009 - cQuery += " AND SD1.D1_CF IN ('1101','2101')"
      
      cQuery += " GROUP BY SUBSTRING(D1_DTDIGIT,1,6), SUBSTRING(B1_SUBGPO,1,1) "
      cQuery += " ORDER BY SUBSTRING(D1_DTDIGIT,1,6) DESC "
   
      //If nMes == 1
         MemoWrite("C:\TEMP\ComprasMatPrima"+Alltrim(Str(nMes))+".SQL",cQuery)
      //EndIf
      
      TCQuery cQuery NEW ALIAS "COMPMP"
      
      If nMes == 1
         DbSelectArea("COMPMP")
            nVl1MCusMP := 0
            nComp1VlMP := COMPMP->VLRCOMPMP
            nVl1MCusMP := COMPMP->CUSCOMPMP
            nQt1CompMP := COMPMP->QTDCOMPMP
            If Empty(nVl1MCusMP)
               aMPAntClc  := CalcMPAnt(cMPGrupo) 
               nVl1MCusMP := aMPAntClc[1]
               nQt1CompMP := aMPAntClc[2]
            EndIf
            If nOpcf == 1
            
               nPosGrp := aScan(aFatp1MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                //aAdd(aFatp1MP,{CFT1->GRUPOMP,nFat1MPBru,nQtd1FatMP,0,0,0,0})  
                  aFatp1MP[nPosGrp,4] := nVl1MCusMP
                  aFatp1MP[nPosGrp,5] := nQt1CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFatp1MP[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)+ Custo do Frete por Filial
                  aFatp1MP[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)+ Custo do Frete por Filial
                  If Alltrim(cMPGrupo) <> "5" 
                     aFatp1MP[nPosGrp,7] := ((aFatp1MP[nPosGrp,3]) * aFatp1MP[nPosGrp,6]) //Custo do Faturamento ((Fat.da MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFatp1MP[nPosGrp,7] := (aFatp1MP[nPosGrp,3] * ( 2683 + nCustTonel))
                     aFatp1MP[nPosGrp,7] := (aFatp1MP[nPosGrp,3] * ( 2683))
                  EndIf
               EndIf
            
            ElseIf nOpcf == 2
            
               nPosGrp := aScan(aDev1MPCli,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aDev1MPCli[nPosGrp,4] := nVl1MCusMP
                  aDev1MPCli[nPosGrp,5] := nQt1CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aDev1MPCli[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)+ Custo do Frete por Filial
                  aDev1MPCli[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aDev1MPCli[nPosGrp,7] := ((aDev1MPCli[nPosGrp,3]) * aDev1MPCli[nPosGrp,6]) //Custo da Devolução ((Qtd.Devolvida MP ) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aDev1MPCli[nPosGrp,7] := (aDev1MPCli[nPosGrp,3] * (2683 + nCustTonel))
                     aDev1MPCli[nPosGrp,7] := (aDev1MPCli[nPosGrp,3] * (2683))
                  EndIf
               EndIf
               
            ElseIf nOpcf == 3
            
               nPosGrp := aScan(aProd1MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aProd1MP[nPosGrp,4] := nVl1MCusMP
                  aProd1MP[nPosGrp,5] := nQt1CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aProd1MP[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aProd1MP[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aProd1MP[nPosGrp,7] := ((aProd1MP[nPosGrp,3] ) * aProd1MP[nPosGrp,6]) //Custo da Produção ((Qtd.Produzida MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aProd1MP[nPosGrp,7] := (aProd1MP[nPosGrp,3] * (  2683 + nCustTonel))
                     aProd1MP[nPosGrp,7] := (aProd1MP[nPosGrp,3] * (  2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 4
               nPosGrp := aScan(aFech1MPEst,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFech1MPEst[nPosGrp,4] := nVl1MCusMP
                  aFech1MPEst[nPosGrp,5] := nQt1CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFech1MPEst[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)+ Custo do Frete por Filial
                  aFech1MPEst[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFech1MPEst[nPosGrp,7] := ((aFech1MPEst[nPosGrp,3]) * aFech1MPEst[nPosGrp,6])  //Custo do Estoque(Fechamento) ((Qtd.Estoque MP ) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFech1MPEst[nPosGrp,7] := (aFech1MPEst[nPosGrp,3] * (2683 + nCustTonel))
                     aFech1MPEst[nPosGrp,7] := (aFech1MPEst[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 5
               nPosGrp := aScan(aFch1MPSlt,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFch1MPSlt[nPosGrp,4] := nVl1MCusMP
                  aFch1MPSlt[nPosGrp,5] := nQt1CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFch1MPSlt[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFch1MPSlt[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFch1MPSlt[nPosGrp,7] := ((aFch1MPSlt[nPosGrp,3]) * aFch1MPSlt[nPosGrp,6])  //Custo do Estoque Sliter(Fechamento Sliter) ((Qtd.Estoque MP(Sliter)) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFch1MPSlt[nPosGrp,7] := (aFch1MPSlt[nPosGrp,3] * (2683 + nCustTonel))
                     aFch1MPSlt[nPosGrp,7] := (aFch1MPSlt[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 6
               nPosGrp := aScan(a1MPAMP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  a1MPAMP[nPosGrp,4] := nVl1MCusMP
                  a1MPAMP[nPosGrp,5] := nQt1CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - a1MPAMP[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  a1MPAMP[nPosGrp,6] := (nVl1MCusMP / nQt1CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     a1MPAMP[nPosGrp,7] := ((a1MPAMP[nPosGrp,3]) * a1MPAMP[nPosGrp,6])  //Custo do Estoque Acabado ((Qtd.Estoque Acabado por MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - a1MPAMP[nPosGrp,7] := (a1MPAMP[nPosGrp,3] * (2683 + nCustTonel))
                     a1MPAMP[nPosGrp,7] := (a1MPAMP[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            EndIf
         DbSelectArea("COMPMP")
         DbCloseArea()
         
      ElseIf nMes == 2
         DbSelectArea("COMPMP")
            nVl2MCusMP := 0
            nComp2VlMP := COMPMP->VLRCOMPMP
            nVl2MCusMP := COMPMP->CUSCOMPMP
            nQt2CompMP := COMPMP->QTDCOMPMP
            If Empty(nVl2MCusMP)
               aMPAntClc  := CalcMPAnt(cMPGrupo) 
               nVl2MCusMP := aMPAntClc[1]
               nQt2CompMP := aMPAntClc[2]
            EndIf
            If nOpcf == 1
               nPosGrp := aScan(aFatp2MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFatp2MP[nPosGrp,4] := nVl2MCusMP
                  aFatp2MP[nPosGrp,5] := nQt2CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFatp2MP[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP) + nCustTonel//Custo da Matéria Prima por Grupo + Custo do Frete por Filial
                  aFatp2MP[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP)//Custo da Matéria Prima por Grupo
                  If Alltrim(cMPGrupo) <> "5" 
                     aFatp2MP[nPosGrp,7] := ((aFatp2MP[nPosGrp,3]) * aFatp2MP[nPosGrp,6]) //Custo do Faturamento ((Fat.da MP ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFatp2MP[nPosGrp,7] := (aFatp2MP[nPosGrp,3] * ( 2683 + nCustTonel))
                     aFatp2MP[nPosGrp,7] := (aFatp2MP[nPosGrp,3] * ( 2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 2
               nPosGrp := aScan(aDev2MPCli,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aDev2MPCli[nPosGrp,4] := nVl2MCusMP
                  aDev2MPCli[nPosGrp,5] := nQt2CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aDev2MPCli[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aDev2MPCli[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aDev2MPCli[nPosGrp,7] := ((aDev2MPCli[nPosGrp,3] ) * aDev2MPCli[nPosGrp,6]) //Custo da Devolução ((Qtd.Devolvida MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aDev2MPCli[nPosGrp,7] := (aDev2MPCli[nPosGrp,3] * (2683 + nCustTonel))
                     aDev2MPCli[nPosGrp,7] := (aDev2MPCli[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 3
            
               nPosGrp := aScan(aProd2MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aProd2MP[nPosGrp,4] := nVl2MCusMP
                  aProd2MP[nPosGrp,5] := nQt2CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aProd2MP[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP) + nCustTonel//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)  + Custo do Frete por Filial
                  aProd2MP[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aProd2MP[nPosGrp,7] := ((aProd2MP[nPosGrp,3]) * aProd2MP[nPosGrp,6]) //Custo da Produção ((Qtd.Produzida MP) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aProd2MP[nPosGrp,7] := (aProd2MP[nPosGrp,3] * (2683 + nCustTonel))
                     aProd2MP[nPosGrp,7] := (aProd2MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 4
               nPosGrp := aScan(aFech2MPEst,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFech2MPEst[nPosGrp,4] := nVl2MCusMP
                  aFech2MPEst[nPosGrp,5] := nQt2CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFech2MPEst[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP) + nCustTonel//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFech2MPEst[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFech2MPEst[nPosGrp,7] := ((aFech2MPEst[nPosGrp,3]) * aFech2MPEst[nPosGrp,6]) //Custo do Estoque(Fechamento) ((Qtd.Estoque MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFech2MPEst[nPosGrp,7] := (aFech2MPEst[nPosGrp,3] * (2683 + nCustTonel))
                     aFech2MPEst[nPosGrp,7] := (aFech2MPEst[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 5
               nPosGrp := aScan(aFch2MPSlt,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFch2MPSlt[nPosGrp,4] := nVl2MCusMP
                  aFch2MPSlt[nPosGrp,5] := nQt2CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFch2MPSlt[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFch2MPSlt[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFch2MPSlt[nPosGrp,7] := ((aFch2MPSlt[nPosGrp,3]) * aFch2MPSlt[nPosGrp,6])  //Custo do Estoque Sliter(Fechamento Sliter) ((Qtd.Estoque MP(Sliter)) * Custo da MP)  
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFch2MPSlt[nPosGrp,7] := (aFch2MPSlt[nPosGrp,3] * (2683 + nCustTonel))
                     aFch2MPSlt[nPosGrp,7] := (aFch2MPSlt[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 6
               nPosGrp := aScan(a2MPAMP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  a2MPAMP[nPosGrp,4] := nVl2MCusMP
                  a2MPAMP[nPosGrp,5] := nQt2CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - a2MPAMP[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  a2MPAMP[nPosGrp,6] := (nVl2MCusMP / nQt2CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     a2MPAMP[nPosGrp,7] := ((a2MPAMP[nPosGrp,3]) * a2MPAMP[nPosGrp,6])  //Custo do Estoque Acabado ((Qtd.Estoque Acabado por MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - a2MPAMP[nPosGrp,7] := (a2MPAMP[nPosGrp,3] * (2683 + nCustTonel))
                     a2MPAMP[nPosGrp,7] := (a2MPAMP[nPosGrp,3] * (2683))
                  EndIf
               EndIf            

            EndIf
            DbSelectArea("COMPMP") 
            DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("COMPMP")
            nVl3MCusMP := 0
            nComp3VlMP := COMPMP->VLRCOMPMP
            nVl3MCusMP := COMPMP->CUSCOMPMP
            nQt3CompMP := COMPMP->QTDCOMPMP
            If Empty(nVl3MCusMP)
               aMPAntClc  := CalcMPAnt(cMPGrupo) 
               nVl3MCusMP := aMPAntClc[1]
               nQt3CompMP := aMPAntClc[2]
            EndIf
            If nOpcf == 1 
               nPosGrp := aScan(aFatp3MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFatp3MP[nPosGrp,4] := nVl3MCusMP
                  aFatp3MP[nPosGrp,5] := nQt3CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo + Custo do Frete por Filial
                  aFatp3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)//Custo da Matéria Prima por Grupo
                  If Alltrim(cMPGrupo) <> "5" 
                     aFatp3MP[nPosGrp,7] := ((aFatp3MP[nPosGrp,3])* aFatp3MP[nPosGrp,6]) //Custo do Faturamento ((Fat.da MP ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,7] := (aFatp3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aFatp3MP[nPosGrp,7] := (aFatp3MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 2
               nPosGrp := aScan(aDev3MPCli,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aDev3MPCli[nPosGrp,4] := nVl3MCusMP
                  aDev3MPCli[nPosGrp,5] := nQt3CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aDev3MPCli[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5" 
                     aDev3MPCli[nPosGrp,7] := ((aDev3MPCli[nPosGrp,3]) * aDev3MPCli[nPosGrp,6]) //Custo da Devolução ((Qtd.Devolvida ) MP * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,7] := (aDev3MPCli[nPosGrp,3] * (2683 + nCustTonel))
                     aDev3MPCli[nPosGrp,7] := (aDev3MPCli[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 3
            
               nPosGrp := aScan(aProd3MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aProd3MP[nPosGrp,4] := nVl3MCusMP
                  aProd3MP[nPosGrp,5] := nQt3CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)  + Custo do Frete por Filial
                  aProd3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aProd3MP[nPosGrp,7] := ((aProd3MP[nPosGrp,3] ) * aProd3MP[nPosGrp,6]) //Custo da Produção ((Qtd.Produzida MP) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,7] := (aProd3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aProd3MP[nPosGrp,7] := (aProd3MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 4
               nPosGrp := aScan(aFech3MPEst,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFech3MPEst[nPosGrp,4] := nVl3MCusMP
                  aFech3MPEst[nPosGrp,5] := nQt3CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFech3MPEst[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFech3MPEst[nPosGrp,7] := ((aFech3MPEst[nPosGrp,3]) * aFech3MPEst[nPosGrp,6])  //Custo do Estoque(Fechamento) ((Qtd.Estoque MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,7] := (aFech3MPEst[nPosGrp,3] * (2683 + nCustTonel))
                     aFech3MPEst[nPosGrp,7] := (aFech3MPEst[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 5
               nPosGrp := aScan(aFch3MPSlt,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFch3MPSlt[nPosGrp,4] := nVl3MCusMP
                  aFch3MPSlt[nPosGrp,5] := nQt3CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFch3MPSlt[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFch3MPSlt[nPosGrp,7] := ((aFch3MPSlt[nPosGrp,3]) * aFch3MPSlt[nPosGrp,6])  //Custo do Estoque Sliter(Fechamento Sliter) ((Qtd.Estoque MP(Sliter) ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,7] := (aFch3MPSlt[nPosGrp,3] * (2683 + nCustTonel))
                     aFch3MPSlt[nPosGrp,7] := (aFch3MPSlt[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 6
               nPosGrp := aScan(a3MPAMP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  a3MPAMP[nPosGrp,4] := nVl3MCusMP
                  a3MPAMP[nPosGrp,5] := nQt3CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  a3MPAMP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     a3MPAMP[nPosGrp,7] := ((a3MPAMP[nPosGrp,3]) * a3MPAMP[nPosGrp,6])  //Custo do Estoque Acabado ((Qtd.Estoque Acabado por MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,7] := (a3MPAMP[nPosGrp,3] * (2683 + nCustTonel))
                     a3MPAMP[nPosGrp,7] := (a3MPAMP[nPosGrp,3] * (2683))
                  EndIf
               EndIf            

            EndIf
         DbSelectArea("COMPMP")
         DbCloseArea()
      
      ElseIf nMes == 4
         DbSelectArea("COMPMP")
            nVl4MCusMP := 0
            nComp4VlMP := COMPMP->VLRCOMPMP
            nVl4MCusMP := COMPMP->CUSCOMPMP
            nQt4CompMP := COMPMP->QTDCOMPMP
            If Empty(nVl4MCusMP)
               aMPAntClc  := CalcMPAnt(cMPGrupo) 
               nVl4MCusMP := aMPAntClc[1]
               nQt4CompMP := aMPAntClc[2]
            EndIf
            If nOpcf == 1 
               nPosGrp := aScan(aFatp4MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFatp4MP[nPosGrp,4] := nVl4MCusMP
                  aFatp4MP[nPosGrp,5] := nQt4CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo + Custo do Frete por Filial
                  aFatp4MP[nPosGrp,6] := (nVl4MCusMP / nQt4CompMP)//Custo da Matéria Prima por Grupo
                  If Alltrim(cMPGrupo) <> "5" 
                     aFatp4MP[nPosGrp,7] := ((aFatp4MP[nPosGrp,3])* aFatp4MP[nPosGrp,6]) //Custo do Faturamento ((Fat.da MP ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,7] := (aFatp3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aFatp4MP[nPosGrp,7] := (aFatp4MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 2
               nPosGrp := aScan(aDev4MPCli,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aDev4MPCli[nPosGrp,4] := nVl4MCusMP
                  aDev4MPCli[nPosGrp,5] := nQt4CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aDev4MPCli[nPosGrp,6] := (nVl4MCusMP / nQt4CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5" 
                     aDev4MPCli[nPosGrp,7] := ((aDev4MPCli[nPosGrp,3]) * aDev4MPCli[nPosGrp,6]) //Custo da Devolução ((Qtd.Devolvida ) MP * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,7] := (aDev3MPCli[nPosGrp,3] * (2683 + nCustTonel))
                     aDev4MPCli[nPosGrp,7] := (aDev4MPCli[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 3
            
               nPosGrp := aScan(aProd4MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aProd4MP[nPosGrp,4] := nVl4MCusMP
                  aProd4MP[nPosGrp,5] := nQt4CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)  + Custo do Frete por Filial
                  aProd4MP[nPosGrp,6] := (nVl4MCusMP / nQt4CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aProd4MP[nPosGrp,7] := ((aProd4MP[nPosGrp,3] ) * aProd4MP[nPosGrp,6]) //Custo da Produção ((Qtd.Produzida MP) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,7] := (aProd3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aProd4MP[nPosGrp,7] := (aProd4MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 4
               nPosGrp := aScan(aFech4MPEst,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFech4MPEst[nPosGrp,4] := nVl4MCusMP
                  aFech4MPEst[nPosGrp,5] := nQt4CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFech4MPEst[nPosGrp,6] := (nVl4MCusMP / nQt4CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFech4MPEst[nPosGrp,7] := ((aFech4MPEst[nPosGrp,3]) * aFech4MPEst[nPosGrp,6])  //Custo do Estoque(Fechamento) ((Qtd.Estoque MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,7] := (aFech3MPEst[nPosGrp,3] * (2683 + nCustTonel))
                     aFech4MPEst[nPosGrp,7] := (aFech4MPEst[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 5
               nPosGrp := aScan(aFch4MPSlt,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFch4MPSlt[nPosGrp,4] := nVl4MCusMP
                  aFch4MPSlt[nPosGrp,5] := nQt4CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFch4MPSlt[nPosGrp,6] := (nVl4MCusMP / nQt4CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFch4MPSlt[nPosGrp,7] := ((aFch4MPSlt[nPosGrp,3]) * aFch4MPSlt[nPosGrp,6])  //Custo do Estoque Sliter(Fechamento Sliter) ((Qtd.Estoque MP(Sliter) ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,7] := (aFch3MPSlt[nPosGrp,3] * (2683 + nCustTonel))
                     aFch4MPSlt[nPosGrp,7] := (aFch4MPSlt[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 6
               nPosGrp := aScan(a4MPAMP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  a4MPAMP[nPosGrp,4] := nVl4MCusMP
                  a4MPAMP[nPosGrp,5] := nQt4CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  a4MPAMP[nPosGrp,6] := (nVl4MCusMP / nQt4CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     a4MPAMP[nPosGrp,7] := ((a4MPAMP[nPosGrp,3]) * a4MPAMP[nPosGrp,6])  //Custo do Estoque Acabado ((Qtd.Estoque Acabado por MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,7] := (a3MPAMP[nPosGrp,3] * (2683 + nCustTonel))
                     a4MPAMP[nPosGrp,7] := (a4MPAMP[nPosGrp,3] * (2683))
                  EndIf
               EndIf            

            EndIf
         DbSelectArea("COMPMP")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("COMPMP")
            nVl5MCusMP := 0
            nComp5VlMP := COMPMP->VLRCOMPMP
            nVl5MCusMP := COMPMP->CUSCOMPMP
            nQt5CompMP := COMPMP->QTDCOMPMP
            If Empty(nVl5MCusMP)
               aMPAntClc  := CalcMPAnt(cMPGrupo) 
               nVl5MCusMP := aMPAntClc[1]
               nQt5CompMP := aMPAntClc[2]
            EndIf
            If nOpcf == 1 
               nPosGrp := aScan(aFatp5MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFatp5MP[nPosGrp,4] := nVl5MCusMP
                  aFatp5MP[nPosGrp,5] := nQt5CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo + Custo do Frete por Filial
                  aFatp5MP[nPosGrp,6] := (nVl5MCusMP / nQt5CompMP)//Custo da Matéria Prima por Grupo
                  If Alltrim(cMPGrupo) <> "5" 
                     aFatp5MP[nPosGrp,7] := ((aFatp5MP[nPosGrp,3])* aFatp5MP[nPosGrp,6]) //Custo do Faturamento ((Fat.da MP ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,7] := (aFatp3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aFatp5MP[nPosGrp,7] := (aFatp5MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 2
               nPosGrp := aScan(aDev5MPCli,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aDev5MPCli[nPosGrp,4] := nVl5MCusMP
                  aDev5MPCli[nPosGrp,5] := nQt5CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aDev5MPCli[nPosGrp,6] := (nVl5MCusMP / nQt5CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5" 
                     aDev5MPCli[nPosGrp,7] := ((aDev5MPCli[nPosGrp,3]) * aDev5MPCli[nPosGrp,6]) //Custo da Devolução ((Qtd.Devolvida ) MP * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,7] := (aDev3MPCli[nPosGrp,3] * (2683 + nCustTonel))
                     aDev5MPCli[nPosGrp,7] := (aDev5MPCli[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 3
            
               nPosGrp := aScan(aProd5MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aProd5MP[nPosGrp,4] := nVl5MCusMP
                  aProd5MP[nPosGrp,5] := nQt5CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)  + Custo do Frete por Filial
                  aProd5MP[nPosGrp,6] := (nVl5MCusMP / nQt5CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aProd5MP[nPosGrp,7] := ((aProd5MP[nPosGrp,3] ) * aProd5MP[nPosGrp,6]) //Custo da Produção ((Qtd.Produzida MP) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,7] := (aProd3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aProd5MP[nPosGrp,7] := (aProd5MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 4
               nPosGrp := aScan(aFech5MPEst,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFech5MPEst[nPosGrp,4] := nVl5MCusMP
                  aFech5MPEst[nPosGrp,5] := nQt5CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFech5MPEst[nPosGrp,6] := (nVl5MCusMP / nQt5CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFech5MPEst[nPosGrp,7] := ((aFech5MPEst[nPosGrp,3]) * aFech5MPEst[nPosGrp,6])  //Custo do Estoque(Fechamento) ((Qtd.Estoque MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,7] := (aFech3MPEst[nPosGrp,3] * (2683 + nCustTonel))
                     aFech5MPEst[nPosGrp,7] := (aFech5MPEst[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 5
               nPosGrp := aScan(aFch5MPSlt,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFch5MPSlt[nPosGrp,4] := nVl5MCusMP
                  aFch5MPSlt[nPosGrp,5] := nQt5CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFch5MPSlt[nPosGrp,6] := (nVl5MCusMP / nQt5CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFch5MPSlt[nPosGrp,7] := ((aFch5MPSlt[nPosGrp,3]) * aFch5MPSlt[nPosGrp,6])  //Custo do Estoque Sliter(Fechamento Sliter) ((Qtd.Estoque MP(Sliter) ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,7] := (aFch3MPSlt[nPosGrp,3] * (2683 + nCustTonel))
                     aFch5MPSlt[nPosGrp,7] := (aFch5MPSlt[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 6
               nPosGrp := aScan(a5MPAMP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  a5MPAMP[nPosGrp,4] := nVl5MCusMP
                  a5MPAMP[nPosGrp,5] := nQt5CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  a5MPAMP[nPosGrp,6] := (nVl5MCusMP / nQt5CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     a5MPAMP[nPosGrp,7] := ((a5MPAMP[nPosGrp,3]) * a5MPAMP[nPosGrp,6])  //Custo do Estoque Acabado ((Qtd.Estoque Acabado por MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,7] := (a3MPAMP[nPosGrp,3] * (2683 + nCustTonel))
                     a5MPAMP[nPosGrp,7] := (a5MPAMP[nPosGrp,3] * (2683))
                  EndIf
               EndIf            

            EndIf
         DbSelectArea("COMPMP")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("COMPMP")
            nVl6MCusMP := 0
            nComp6VlMP := COMPMP->VLRCOMPMP
            nVl6MCusMP := COMPMP->CUSCOMPMP
            nQt6CompMP := COMPMP->QTDCOMPMP
            If Empty(nVl6MCusMP)
               aMPAntClc  := CalcMPAnt(cMPGrupo) 
               nVl6MCusMP := aMPAntClc[1]
               nQt6CompMP := aMPAntClc[2]
            EndIf
            If nOpcf == 1 
               nPosGrp := aScan(aFatp6MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFatp6MP[nPosGrp,4] := nVl6MCusMP
                  aFatp6MP[nPosGrp,5] := nQt6CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo + Custo do Frete por Filial
                  aFatp6MP[nPosGrp,6] := (nVl6MCusMP / nQt6CompMP)//Custo da Matéria Prima por Grupo
                  If Alltrim(cMPGrupo) <> "5" 
                     aFatp6MP[nPosGrp,7] := ((aFatp6MP[nPosGrp,3])* aFatp6MP[nPosGrp,6]) //Custo do Faturamento ((Fat.da MP ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFatp3MP[nPosGrp,7] := (aFatp3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aFatp6MP[nPosGrp,7] := (aFatp6MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 2
               nPosGrp := aScan(aDev6MPCli,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aDev6MPCli[nPosGrp,4] := nVl6MCusMP
                  aDev6MPCli[nPosGrp,5] := nQt6CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP)  + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aDev6MPCli[nPosGrp,6] := (nVl6MCusMP / nQt6CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5" 
                     aDev6MPCli[nPosGrp,7] := ((aDev6MPCli[nPosGrp,3]) * aDev6MPCli[nPosGrp,6]) //Custo da Devolução ((Qtd.Devolvida ) MP * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aDev3MPCli[nPosGrp,7] := (aDev3MPCli[nPosGrp,3] * (2683 + nCustTonel))
                     aDev6MPCli[nPosGrp,7] := (aDev6MPCli[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 3
            
               nPosGrp := aScan(aProd6MP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aProd6MP[nPosGrp,4] := nVl6MCusMP
                  aProd6MP[nPosGrp,5] := nQt6CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)  + Custo do Frete por Filial
                  aProd6MP[nPosGrp,6] := (nVl6MCusMP / nQt6CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aProd6MP[nPosGrp,7] := ((aProd6MP[nPosGrp,3] ) * aProd6MP[nPosGrp,6]) //Custo da Produção ((Qtd.Produzida MP) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aProd3MP[nPosGrp,7] := (aProd3MP[nPosGrp,3] * (2683 + nCustTonel))
                     aProd6MP[nPosGrp,7] := (aProd6MP[nPosGrp,3] * (2683))
                  EndIf
               EndIf
            ElseIf nOpcf == 4
               nPosGrp := aScan(aFech6MPEst,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFech6MPEst[nPosGrp,4] := nVl6MCusMP
                  aFech6MPEst[nPosGrp,5] := nQt6CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFech6MPEst[nPosGrp,6] := (nVl6MCusMP / nQt6CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFech6MPEst[nPosGrp,7] := ((aFech6MPEst[nPosGrp,3]) * aFech6MPEst[nPosGrp,6])  //Custo do Estoque(Fechamento) ((Qtd.Estoque MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFech3MPEst[nPosGrp,7] := (aFech3MPEst[nPosGrp,3] * (2683 + nCustTonel))
                     aFech6MPEst[nPosGrp,7] := (aFech6MPEst[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 5
               nPosGrp := aScan(aFch6MPSlt,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  aFch6MPSlt[nPosGrp,4] := nVl6MCusMP
                  aFch6MPSlt[nPosGrp,5] := nQt6CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  aFch6MPSlt[nPosGrp,6] := (nVl6MCusMP / nQt6CompMP)//Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     aFch6MPSlt[nPosGrp,7] := ((aFch6MPSlt[nPosGrp,3]) * aFch6MPSlt[nPosGrp,6])  //Custo do Estoque Sliter(Fechamento Sliter) ((Qtd.Estoque MP(Sliter) ) * Custo da MP)
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - aFch3MPSlt[nPosGrp,7] := (aFch3MPSlt[nPosGrp,3] * (2683 + nCustTonel))
                     aFch6MPSlt[nPosGrp,7] := (aFch6MPSlt[nPosGrp,3] * (2683))
                  EndIf
               EndIf            
            ElseIf nOpcf == 6
               nPosGrp := aScan(a6MPAMP,{|x| x[1] == cMPGrupo}) 
               If nPosGrp > 0
                  a6MPAMP[nPosGrp,4] := nVl6MCusMP
                  a6MPAMP[nPosGrp,5] := nQt6CompMP
                  //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,6] := (nVl3MCusMP / nQt3CompMP) + nCustTonel //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT) + Custo do Frete por Filial
                  a6MPAMP[nPosGrp,6] := (nVl6MCusMP / nQt6CompMP) //Custo da Matéria Prima por Grupo (D1_CUSTO/D1_QUANT)
                  If Alltrim(cMPGrupo) <> "5"
                     a6MPAMP[nPosGrp,7] := ((a6MPAMP[nPosGrp,3]) * a6MPAMP[nPosGrp,6])  //Custo do Estoque Acabado ((Qtd.Estoque Acabado por MP) * Custo da MP) 
                  Else
                     //Five Solutions 22/03/2010 - Retirado Frete - a3MPAMP[nPosGrp,7] := (a3MPAMP[nPosGrp,3] * (2683 + nCustTonel))
                     a6MPAMP[nPosGrp,7] := (a6MPAMP[nPosGrp,3] * (2683))
                  EndIf
               EndIf            

            EndIf
         DbSelectArea("COMPMP")
         DbCloseArea()
                           
      EndIf      
      
Return

**********************************************************************************************************
Static Function RecIncFis

   cMPGrupo := cGrpMP
   cForMPIF := "000005,04221,006268,006558,044319,006857"
   cLjFMPIF := "01,04,06,08"
   
   /********************************************
   * Compras de Materia Prima(Incentivo Fiscais)
   *
   ***********************************************/   
   
   ProcRegua(6) //3)
      
   For nMes := 1 To 6 //3
   
      IncProc("Calculando Incentivos Fiscais "+Alltrim(Str(nMes))+" / 6")
      
      //Five 30/03/2011 - cQuery := "SELECT SUBSTRING(SD1.D1_DTDIGIT,1,6) AS EMISSAO,SD1.D1_FORNECE,SD1.D1_LOJA,SUM(SD1.D1_TOTAL) AS VLRCOMPMP, SUM(SD1.D1_QUANT) QTDCOMPMP,SUM(SD1.D1_CUSTO) AS CUSCOMPMP, SUM(SD1.D1_VALFRE) VALFRE "
      //Five Solutions Consultoria - 02/08/2011(Pegar custo da NF Mãe pois custo da NF Transf. está errado) - cQuery := "SELECT SD1.D1_DTDIGIT AS D1_DTDIGIT,SD1.D1_FORNECE,SD1.D1_LOJA,SUM(SD1.D1_TOTAL) AS VLRCOMPMP, SUM(SD1.D1_QUANT) QTDCOMPMP,SUM(SD1.D1_CUSTO) AS CUSCOMPMP, SUM(SD1.D1_VALFRE) VALFRE "
      cQuery := "SELECT SD1.D1_DTDIGIT AS D1_DTDIGIT,SD1.D1_FORNECE,SD1.D1_LOJA,SUM(SD1.D1_TOTAL) AS VLRCOMPMP, SUM(SD1.D1_QUANT) QTDCOMPMP, SUM(SD1.D1_VALFRE) VALFRE, "
      cQuery += "       CASE WHEN SD1.D1_X_NFMAE = ' ' "
      cQuery += "            THEN SUM(SD1.D1_CUSTO)"
      cQuery += "       ELSE"
      cQuery += "            (SELECT SUM(MAE.D1_CUSTO)"
      cQuery += "               FROM "+RetSQLName("SD1")+" MAE"
      cQuery += "              WHERE MAE.D1_FILIAL = '"+xFilial("SD1")+"'"
      cQuery += "                AND MAE.D1_DOC = SD1.D1_X_NFMAE"
      cQuery += "                AND MAE.D1_SERIE = SD1.D1_X_MAESE"
      cQuery += "                AND MAE.D1_FORNECE = SD1.D1_FORNECE"
      cQuery += "                AND MAE.D1_LOJA = SD1.D1_LOJA"
      cQuery += "                AND MAE.D_E_L_E_T_ <> '*')"
      cQuery += "       END  AS CUSCOMPMP "
      
      cQuery += "FROM "+RetSqlName('SD1')+" SD1, "+RetSQLName("SB1")+" SB1,"+RetSQLName("SF4")+" SF4" //Five Solutions Consultoria - 17/06/2010 - Acrescentado link no SF4 P/ Testar se TES Atualiza estoque e Credita ICMS e IPI.
      //cQuery += " WHERE SD1.D1_FILIAL = '04'" //Toda Compra é realizada através da filial PB - 19/07/2009
      cQuery += " WHERE SD1.D1_FILIAL = '"+xFilial("SD1")+"'" //Passou a Considerar compras da própria filial - 19/08/2009
      cQuery += "   AND SF4.F4_FILIAL = '"+xFilial("SF4")+"'" //Five Solutions Consultoria - 17/06/2010 - Acrescentado link no SF4 P/ Testar se TES Atualiza estoque e Credita ICMS e IPI.
      /*
      If SM0->M0_CODFIL = '06'
         cQuery += " AND SD1.D1_FORNECE <> '003734'"
      EndIf
      */
      cQuery += " AND SD1.D1_FORNECE IN "+FormatIn(cForMPIF,",")
      cQuery += " AND SD1.D1_LOJA IN "+FormatIn(cLjFMPIF,",")
      
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'"
      cQuery += " AND SD1.D1_COD = SB1.B1_COD"
      //cQuery += " AND SUBSTRING(SB1.B1_SUBGPO,1,1) = '"+cMPGrupo+"'"
      //Five Solutions - 17/05/2011 - cQuery += " AND SUBSTRING(SD1.D1_TP,1,2) = 'MP'"
      cQuery += " AND (SUBSTRING(SD1.D1_TP,1,2) = 'MP' OR (SUBSTRING(SD1.D1_TP,1,2) = 'PA' AND SUBSTRING(SD1.D1_GRUPO,1,2) = '32'))"
      cQuery += " AND SD1.D_E_L_E_T_ <> '*' "
      cQuery += " AND SB1.D_E_L_E_T_ <> '*' "
      
      //Five Solutions Consultoria - 17/06/2010 - Acrescentado link no SF4 P/ Testar se TES Atualiza estoque e Credita ICMS e IPI. 
      cQuery += " AND SD1.D1_TES = SF4.F4_CODIGO"
      //Five Solutions - 17/05/2011 - Comentado tratamento de TES
      /*
      cQuery += " AND SF4.F4_ESTOQUE = 'S'"
      cQuery += " AND SF4.F4_CREDICM = 'S'"
      cQuery += " AND SF4.F4_CREDIPI = 'S'"
      */
      cQuery += " AND SF4.D_E_L_E_T_ <> '*' " 
      //Fim do trecho acrescentado em 17/06/2010
      
      If nMes == 1
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dDataDe),1,6)+"'"
      ElseIf nMes == 2
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData02),1,6)+"'"
      ElseIf nMes == 3
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData03),1,6)+"'"
      ElseIf nMes == 4
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData04),1,6)+"'"
      ElseIf nMes == 5
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData05),1,6)+"'"
      ElseIf nMes == 6
         cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  = '"+Substr(DTOS(dData06),1,6)+"'"
      EndIf

      cQuery += " AND SD1.D1_TIPO = 'N' "
      //Five Solutions - 17/05/2011 - Comentado filtro de CFOP's
      //cQuery += " AND SD1.D1_CF IN ('1949','1101','2101','2151')"
      
      /* Five 30/03/2011
      cQuery += " GROUP BY SUBSTRING(SD1.D1_DTDIGIT,1,6),SD1.D1_FORNECE,SD1.D1_LOJA "
      cQuery += " ORDER BY SUBSTRING(SD1.D1_DTDIGIT,1,6),SD1.D1_FORNECE,SD1.D1_LOJA "
      */
      cQuery += " GROUP BY SD1.D1_DTDIGIT,SD1.D1_FORNECE,SD1.D1_LOJA,SD1.D1_X_NFMAE,SD1.D1_X_MAESE "
      cQuery += " ORDER BY SD1.D1_DTDIGIT,SD1.D1_FORNECE,SD1.D1_LOJA "
            
      //If nMes == 1
         MemoWrite("C:\TEMP\CompMatPrimaIncentFisc"+Alltrim(Str(nMes))+".SQL",cQuery)
      //EndIf
      
      TCQuery cQuery NEW ALIAS "CIFMP"
      
      TCSetField("CIFMP","VLRCOMPMP","N",17,02)
      TCSetField("CIFMP","D1_DTDIGIT","D",08,00) //Five - 30/03/2011

      If nMes == 1 
         DbSelectArea("CIFMP")
         While CIFMP->(!Eof())
            
            /* Five Solutions Consultoria - 02/08/2011 - Comentado - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
               (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")        //BRASMUND PE
               nInc1FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            */

            //Five Solutions Consultoria - 02/08/2011 - Novo Conceito - Solicit. Patricia Amaral
            If ((CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
                (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")) .And. SM0->M0_CODFIL <> "06"//COMAFAL PE
               nInc1FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            If (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01") .And. SM0->M0_CODFIL == "06"        //BRASMUND PE
               nInc1FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
                        
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "04")        //COMAFAL PB
               nInc1FisMP += CIFMP->VLRCOMPMP * (7/100)  //7% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "01")        //COMAFAL SP
               nInc1FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "006268" .And. CIFMP->D1_LOJA == "01") .Or. ; //GLOBRAL SC
               (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01")        //BWT COMERCIO IMPORTAÇÃO E EXPORTAÇÃO - SC
               If (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01") .And. ; //Five 31/03/2011
                  (CIFMP->D1_DTDIGIT >= CTOD("29/12/2010")) //13/01/2011
                  nInc1FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
               Else
                  nInc1FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
               EndIf
            EndIf
             
            //Five - 31/03/2011
            If (CIFMP->D1_FORNECE == "006857" .And. CIFMP->D1_LOJA == "01") //AC COMERCIAL IMPORTADORA E EXPORTADORA" 
               nInc1FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
            EndIf

            //Five Solutions Consultoria - 02008/2011 - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "08")        //COMAFAL RS
               nInc1FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
                                    
            nEnt1MPFI += CIFMP->VLRCOMPMP //Five Solutions - 25/11/2010
            nFr1tMP   += CIFMP->VALFRE
            
            DbSelectArea("CIFMP")
            DbSkip()
         EndDo
         DbSelectArea("CIFMP")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("CIFMP")
         While CIFMP->(!Eof())
            
            /* Five Solutions Consultoria - 02/08/2011 - Comentado - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
               (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")        //BRASMUND PE
               nInc2FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            */

            //Five Solutions Consultoria - 02/08/2011 - Novo Conceito - Solicit. Patricia Amaral
            If ((CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
                (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")) .And. SM0->M0_CODFIL <> "06" //COMAFAL PE
               nInc2FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            If (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01") .And. SM0->M0_CODFIL == "06"        //BRASMUND PE
               nInc2FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "04")        //COMAFAL PB
               nInc2FisMP += CIFMP->VLRCOMPMP * (7/100)  //7% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "01")        //COMAFAL SP
               nInc2FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "006268" .And. CIFMP->D1_LOJA == "01") .Or. ; //GLOBRAL SC
               (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01")        //BWT COMERCIO IMPORTAÇÃO E EXPORTAÇÃO - SC
               If (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01") .And. ; //Five 31/03/2011
                  (CIFMP->D1_DTDIGIT >= CTOD("29/12/2010")) //13/01/2011
                  nInc2FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
               Else
                  nInc2FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
               EndIf
            EndIf
            
            //Five - 31/03/2011
            If (CIFMP->D1_FORNECE == "006857" .And. CIFMP->D1_LOJA == "01") //AC COMERCIAL IMPORTADORA E EXPORTADORA" 
               nInc2FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
            EndIf
            
            //Five Solutions Consultoria - 02008/2011 - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "08")        //COMAFAL RS
               nInc2FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            nEnt2MPFI += CIFMP->VLRCOMPMP //Five Solutions - 25/11/2010
            nFr2tMP   += CIFMP->VALFRE
              
            DbSelectArea("CIFMP")
            DbSkip()
         EndDo
         DbSelectArea("CIFMP")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("CIFMP")
         While CIFMP->(!Eof())
            
            /* Five Solutions Consultoria - 02/08/2011 - Comentado - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
               (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")        //BRASMUND PE
               nInc3FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            */

            //Five Solutions Consultoria - 02/08/2011 - Novo Conceito - Solicit. Patricia Amaral
            If ((CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
                (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")) .And. SM0->M0_CODFIL <> "06" //COMAFAL PE
               nInc3FisMP += CIFMP->VLRCOMPMP * (8/100)  //13% Valor da Compra
            EndIf
            If (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01") .And. SM0->M0_CODFIL == "06"        //BRASMUND PE
               nInc3FisMP += CIFMP->VLRCOMPMP * (13/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "04")        //COMAFAL PB
               nInc3FisMP += CIFMP->VLRCOMPMP * (7/100)  //7% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "01")        //COMAFAL SP
               nInc3FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "006268" .And. CIFMP->D1_LOJA == "01") .Or. ; //GLOBRAL SC
               (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01")        //BWT COMERCIO IMPORTAÇÃO E EXPORTAÇÃO - SC
               If (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01") .And. ; //Five 31/03/2011
                  (CIFMP->D1_DTDIGIT >= CTOD("29/12/2010")) //13/01/2011
                  nInc3FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
               Else
                  nInc3FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
               EndIf
            EndIf
             
            //Five - 31/03/2011
            If (CIFMP->D1_FORNECE == "006857" .And. CIFMP->D1_LOJA == "01") //AC COMERCIAL IMPORTADORA E EXPORTADORA" 
               nInc3FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
            EndIf
            
            //Five Solutions Consultoria - 02008/2011 - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "08")        //COMAFAL RS
               nInc3FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            nEnt3MPFI += CIFMP->VLRCOMPMP //Five Solutions - 25/11/2010
            nFr3tMP   += CIFMP->VALFRE
             
            DbSelectArea("CIFMP")
            DbSkip()
         EndDo
         DbSelectArea("CIFMP")
         DbCloseArea()

      ElseIf nMes == 4
         DbSelectArea("CIFMP")
         While CIFMP->(!Eof())
            
            /* Five Solutions Consultoria - 02/08/2011 - Comentado - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
               (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")        //BRASMUND PE
               nInc3FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            */

            //Five Solutions Consultoria - 02/08/2011 - Novo Conceito - Solicit. Patricia Amaral
            If ((CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
                (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")) .And. SM0->M0_CODFIL <> "06" //COMAFAL PE
               nInc4FisMP += CIFMP->VLRCOMPMP * (8/100)  //13% Valor da Compra
            EndIf
            If (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01") .And. SM0->M0_CODFIL == "06"        //BRASMUND PE
               nInc4FisMP += CIFMP->VLRCOMPMP * (13/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "04")        //COMAFAL PB
               nInc4FisMP += CIFMP->VLRCOMPMP * (7/100)  //7% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "01")        //COMAFAL SP
               nInc4FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "006268" .And. CIFMP->D1_LOJA == "01") .Or. ; //GLOBRAL SC
               (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01")        //BWT COMERCIO IMPORTAÇÃO E EXPORTAÇÃO - SC
               If (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01") .And. ; //Five 31/03/2011
                  (CIFMP->D1_DTDIGIT >= CTOD("29/12/2010")) //13/01/2011
                  nInc4FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
               Else
                  nInc4FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
               EndIf
            EndIf
             
            //Five - 31/03/2011
            If (CIFMP->D1_FORNECE == "006857" .And. CIFMP->D1_LOJA == "01") //AC COMERCIAL IMPORTADORA E EXPORTADORA" 
               nInc4FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
            EndIf
            
            //Five Solutions Consultoria - 02008/2011 - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "08")        //COMAFAL RS
               nInc4FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            nEnt4MPFI += CIFMP->VLRCOMPMP //Five Solutions - 25/11/2010
            nFr4tMP   += CIFMP->VALFRE
             
            DbSelectArea("CIFMP")
            DbSkip()
         EndDo
         DbSelectArea("CIFMP")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("CIFMP")
         While CIFMP->(!Eof())
            
            /* Five Solutions Consultoria - 02/08/2011 - Comentado - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
               (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")        //BRASMUND PE
               nInc3FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            */

            //Five Solutions Consultoria - 02/08/2011 - Novo Conceito - Solicit. Patricia Amaral
            If ((CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
                (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")) .And. SM0->M0_CODFIL <> "06" //COMAFAL PE
               nInc5FisMP += CIFMP->VLRCOMPMP * (8/100)  //13% Valor da Compra
            EndIf
            If (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01") .And. SM0->M0_CODFIL == "06"        //BRASMUND PE
               nInc5FisMP += CIFMP->VLRCOMPMP * (13/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "04")        //COMAFAL PB
               nInc5FisMP += CIFMP->VLRCOMPMP * (7/100)  //7% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "01")        //COMAFAL SP
               nInc5FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "006268" .And. CIFMP->D1_LOJA == "01") .Or. ; //GLOBRAL SC
               (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01")        //BWT COMERCIO IMPORTAÇÃO E EXPORTAÇÃO - SC
               If (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01") .And. ; //Five 31/03/2011
                  (CIFMP->D1_DTDIGIT >= CTOD("29/12/2010")) //13/01/2011
                  nInc5FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
               Else
                  nInc5FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
               EndIf
            EndIf
             
            //Five - 31/03/2011
            If (CIFMP->D1_FORNECE == "006857" .And. CIFMP->D1_LOJA == "01") //AC COMERCIAL IMPORTADORA E EXPORTADORA" 
               nInc5FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
            EndIf
            
            //Five Solutions Consultoria - 02008/2011 - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "08")        //COMAFAL RS
               nInc5FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            nEnt5MPFI += CIFMP->VLRCOMPMP //Five Solutions - 25/11/2010
            nFr5tMP   += CIFMP->VALFRE
             
            DbSelectArea("CIFMP")
            DbSkip()
         EndDo
         DbSelectArea("CIFMP")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("CIFMP")
         While CIFMP->(!Eof())
            
            /* Five Solutions Consultoria - 02/08/2011 - Comentado - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
               (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")        //BRASMUND PE
               nInc3FisMP += CIFMP->VLRCOMPMP * (13/100)  //13% Valor da Compra
            EndIf
            */

            //Five Solutions Consultoria - 02/08/2011 - Novo Conceito - Solicit. Patricia Amaral
            If ((CIFMP->D1_FORNECE == "04221" .And. CIFMP->D1_LOJA == "06") .Or. ;  //COMAFAL PE
                (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01")) .And. SM0->M0_CODFIL <> "06" //COMAFAL PE
               nInc6FisMP += CIFMP->VLRCOMPMP * (8/100)  //13% Valor da Compra
            EndIf
            If (CIFMP->D1_FORNECE == "044319" .And. CIFMP->D1_LOJA == "01") .And. SM0->M0_CODFIL == "06"        //BRASMUND PE
               nInc6FisMP += CIFMP->VLRCOMPMP * (13/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "04")        //COMAFAL PB
               nInc6FisMP += CIFMP->VLRCOMPMP * (7/100)  //7% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "01")        //COMAFAL SP
               nInc6FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            If (CIFMP->D1_FORNECE == "006268" .And. CIFMP->D1_LOJA == "01") .Or. ; //GLOBRAL SC
               (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01")        //BWT COMERCIO IMPORTAÇÃO E EXPORTAÇÃO - SC
               If (CIFMP->D1_FORNECE == "006558" .And. CIFMP->D1_LOJA == "01") .And. ; //Five 31/03/2011
                  (CIFMP->D1_DTDIGIT >= CTOD("29/12/2010")) //13/01/2011
                  nInc6FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
               Else
                  nInc6FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
               EndIf
            EndIf
             
            //Five - 31/03/2011
            If (CIFMP->D1_FORNECE == "006857" .And. CIFMP->D1_LOJA == "01") //AC COMERCIAL IMPORTADORA E EXPORTADORA" 
               nInc6FisMP += CIFMP->VLRCOMPMP * ((9.5)/100)  //9,5% Valor da Compra
            EndIf
            
            //Five Solutions Consultoria - 02008/2011 - Solicit. Patricia Amaral
            If (CIFMP->D1_FORNECE == "000005" .And. CIFMP->D1_LOJA == "08")        //COMAFAL RS
               nInc6FisMP += CIFMP->VLRCOMPMP * (8/100)  //8% Valor da Compra
            EndIf
            
            nEnt6MPFI += CIFMP->VLRCOMPMP //Five Solutions - 25/11/2010
            nFr6tMP   += CIFMP->VALFRE
             
            DbSelectArea("CIFMP")
            DbSkip()
         EndDo
         DbSelectArea("CIFMP")
         DbCloseArea()

      EndIf
   
   Next nMes

   /********************************
   * Transferencia de incentivos fiscais
   *************************************/
   
   ProcRegua(6) //3)
   
   For nMes := 1 To 6 //3
      
      IncProc("Transferencias  Incentivos Fiscais  "+Alltrim(Str(nMes))+" / 6")

      cQuery := " SELECT SUBSTRING(SD2.D2_EMISSAO,1,6) AS EMISSAO,SD2.D2_CLIENTE,SD2.D2_LOJA,SUM(D2_TOTAL) AS TVALBRUTO,SUM(D2_VALICM) NTRFIFMP FROM "
      cQuery += RetSqlName('SD2') + " SD2,"+RetSQLName("SB1")+" SB1,"+RetSQLName("SF2")+" SF2"
      cQuery += " WHERE SD2.D2_FILIAL = '"+xFilial("SD2")+"' AND  SD2.D_E_L_E_T_ = ' ' "
      cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"' AND  SB1.D_E_L_E_T_ = ' ' "
      cQuery += " AND SF2.F2_FILIAL = '"+xFilial("SF2")+"' AND  SF2.D_E_L_E_T_ = ' ' "
      If !lMitto
         cQuery += " AND SF2.F2_CLIENTE <> '006629'" //Five Solutions Consultoria - 04/11/2009
      EndIf
      cQuery += " AND SD2.D2_COD = SB1.B1_COD"
      cQuery += " AND SUBSTRING(SB1.B1_GRUPO,1,2) <> '40'" //Faturamento sem Sucatas
      
      //Five Solutions - 17/05/2011 - //cQuery += " AND SUBSTRING(SD2.D2_TP,1,2) = 'MP'"
      cQuery += " AND (SUBSTRING(SD2.D2_TP,1,2) = 'MP' OR (SUBSTRING(SD2.D2_TP,1,2) = 'PA' AND SUBSTRING(SD2.D2_GRUPO,1,2) = '32'))"
      
      cQuery += " AND SF2.F2_DOC = SD2.D2_DOC"
      cQuery += " AND SF2.F2_SERIE = SD2.D2_SERIE"
      cQuery += " AND SD2.D2_CF IN ('6152')"
      cQuery += " AND (SD2.D2_TIPO <> 'I')" //Five Solutions(07/04/2008)
      
     
      If nMes == 1
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dDataDe),1,6)+"'" 
      ElseIf nMes == 2
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData02),1,6)+"'" 
      ElseIf nMes == 3
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData03),1,6)+"'" 
      ElseIf nMes == 4
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData04),1,6)+"'" 
      ElseIf nMes == 5
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData05),1,6)+"'" 
      ElseIf nMes == 6
         cQuery += " AND  SUBSTRING(SD2.D2_EMISSAO,1,6) = '"+Substr(DTOS(dData06),1,6)+"'" 
      EndIf
      
      cQuery += " GROUP BY SUBSTRING(SD2.D2_EMISSAO,1,6),SD2.D2_CLIENTE,SD2.D2_LOJA "
      cQuery += " ORDER BY SUBSTRING(SD2.D2_EMISSAO,1,6),SD2.D2_CLIENTE,SD2.D2_LOJA ASC"
            
      MemoWrite("C:\TEMP\TransfIncFisc"+Alltrim(Str(nMes))+".SQL",cQuery)
      
      TCQuery cQuery NEW ALIAS "TIFMP"
      
      TCSetField("TIFMP","NTRFIFMP","N",17,02)
      
      If nMes == 1
         DbSelectArea("TIFMP")
         While TIFMP->(!Eof())
            If TIFMP->D2_CLIENTE == "004502" //COMAFAL Lojas - 01=SP, 02=Matriz,03=RS e 04=PE.
               nTrfI1FisMP += TIFMP->TVALBRUTO * (8/100)  //8% ICMS da Transferencia
            EndIf
            DbSelectArea("TIFMP")
            DbSkip()
         EndDo
         DbSelectArea("TIFMP")
         DbCloseArea()
      ElseIf nMes == 2
         DbSelectArea("TIFMP")
         While TIFMP->(!Eof())
            If TIFMP->D2_CLIENTE == "004502" //COMAFAL Lojas - 01=SP, 02=Matriz,03=RS e 04=PE.
               nTrfI2FisMP += TIFMP->TVALBRUTO * (8/100)  //8% ICMS da Transferencia
            EndIf
            DbSelectArea("TIFMP")
            DbSkip()
         EndDo
         DbSelectArea("TIFMP")
         DbCloseArea()
      ElseIf nMes == 3
         DbSelectArea("TIFMP")
         While TIFMP->(!Eof())
            If TIFMP->D2_CLIENTE == "004502" //COMAFAL Lojas - 01=SP, 02=Matriz,03=RS e 04=PE.
               nTrfI3FisMP += TIFMP->TVALBRUTO * (8/100)  //8% ICMS da Transferencia
            EndIf
            DbSelectArea("TIFMP")
            DbSkip()
         EndDo
         DbSelectArea("TIFMP")
         DbCloseArea()
      ElseIf nMes == 4
         DbSelectArea("TIFMP")
         While TIFMP->(!Eof())
            If TIFMP->D2_CLIENTE == "004502" //COMAFAL Lojas - 01=SP, 02=Matriz,03=RS e 04=PE.
               nTrfI4FisMP += TIFMP->TVALBRUTO * (8/100)  //8% ICMS da Transferencia
            EndIf
            DbSelectArea("TIFMP")
            DbSkip()
         EndDo
         DbSelectArea("TIFMP")
         DbCloseArea()
      ElseIf nMes == 5
         DbSelectArea("TIFMP")
         While TIFMP->(!Eof())
            If TIFMP->D2_CLIENTE == "004502" //COMAFAL Lojas - 01=SP, 02=Matriz,03=RS e 04=PE.
               nTrfI5FisMP += TIFMP->TVALBRUTO * (8/100)  //8% ICMS da Transferencia
            EndIf
            DbSelectArea("TIFMP")
            DbSkip()
         EndDo
         DbSelectArea("TIFMP")
         DbCloseArea()
      ElseIf nMes == 6
         DbSelectArea("TIFMP")
         While TIFMP->(!Eof())
            If TIFMP->D2_CLIENTE == "004502" //COMAFAL Lojas - 01=SP, 02=Matriz,03=RS e 04=PE.
               nTrfI6FisMP += TIFMP->TVALBRUTO * (8/100)  //8% ICMS da Transferencia
            EndIf
            DbSelectArea("TIFMP")
            DbSkip()
         EndDo
         DbSelectArea("TIFMP")
         DbCloseArea()
      EndIf
      
   Next nMes
   
   //Tratando variaveis do Incentivo Fiscal
   nVlr1IFMP := If((nInc1FisMP - nTrfI1FisMP)<0,0,(nInc1FisMP - nTrfI1FisMP))
   nVlr2IFMP := If((nInc2FisMP - nTrfI2FisMP)<0,0,(nInc2FisMP - nTrfI2FisMP))
   nVlr3IFMP := If((nInc3FisMP - nTrfI3FisMP)<0,0,(nInc3FisMP - nTrfI3FisMP))
      
Return
************************************************************************************************************

Static Function CalcMPAnt(cMPGrupo)
   
   nCustMPAnt := 0
  
   //Five Solutions Consultoria - 02/08/2011(Pegar custo da NF Mãe pois custo da NF Transf. está errado) - cQuery := "SELECT TOP 1 SUBSTRING(SD1.D1_DTDIGIT,1,6) AS EMISSAO, SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP, SUM(SD1.D1_TOTAL+SD1.D1_VALIPI+SD1.D1_DESPESA) AS VLRCOMPMP, SUM(SD1.D1_QUANT) QTDCOMPMP,SUM(SD1.D1_CUSTO) AS CUSCOMPMP "
   cQuery := "SELECT TOP 1 SUBSTRING(SD1.D1_DTDIGIT,1,6) AS EMISSAO, SUBSTRING(SB1.B1_SUBGPO,1,1) GRUPOMP, SUM(SD1.D1_TOTAL+SD1.D1_VALIPI+SD1.D1_DESPESA) AS VLRCOMPMP, SUM(SD1.D1_QUANT) QTDCOMPMP,"
   cQuery += "       CASE WHEN SD1.D1_X_NFMAE = ' ' "
   cQuery += "            THEN SUM(SD1.D1_CUSTO)"
   cQuery += "       ELSE"
   cQuery += "            (SELECT SUM(MAE.D1_CUSTO)"
   cQuery += "               FROM "+RetSQLName("SD1")+" MAE"
   cQuery += "              WHERE MAE.D1_FILIAL = '"+xFilial("SD1")+"'"
   cQuery += "                AND MAE.D1_DOC = SD1.D1_X_NFMAE"
   cQuery += "                AND MAE.D1_SERIE = SD1.D1_X_MAESE"
   cQuery += "                AND MAE.D1_FORNECE = SD1.D1_FORNECE"
   cQuery += "                AND MAE.D1_LOJA = SD1.D1_LOJA"
   cQuery += "                AND MAE.D_E_L_E_T_ <> '*')"
   cQuery += "       END  AS CUSCOMPMP "
      
   cQuery += "FROM "+RetSqlName('SD1')+" SD1, "+RetSQLName("SB1")+" SB1"
   //cQuery += " WHERE SD1.D1_FILIAL = '04'" //Toda Compra é realizada através da filial PB - 19/07/2009
   cQuery += " WHERE SD1.D1_FILIAL = '"+xFilial("SD1")+"'" //Passou a Considerar compras da própria filial - 19/08/2009
   If SM0->M0_CODFIL = '06'
      cQuery += " AND SD1.D1_FORNECE <> '003734'"
   EndIf   
   cQuery += " AND SB1.B1_FILIAL = '"+xFilial("SB1")+"'"
   cQuery += " AND SD1.D1_COD = SB1.B1_COD"
   cQuery += " AND SUBSTRING(SB1.B1_SUBGPO,1,1) = '"+cMPGrupo+"'"
   cQuery += " AND SUBSTRING(SD1.D1_TP,1,2) = 'MP'"
   cQuery += " AND SD1.D_E_L_E_T_ <> '*' "
   cQuery += " AND SB1.D_E_L_E_T_ <> '*' "

   If nMes == 1
      cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  < '"+Substr(DTOS(dDataDe),1,6)+"' AND SUBSTRING(SD1.D1_DTDIGIT,1,8) >= '20081120'"
   ElseIf nMes == 2
      cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  < '"+Substr(DTOS(dData02),1,6)+"' AND SUBSTRING(SD1.D1_DTDIGIT,1,8) >= '20081120'"
   ElseIf nMes == 3
      cQuery += " AND SUBSTRING(SD1.D1_DTDIGIT,1,6)  < '"+Substr(DTOS(dData03),1,6)+"' AND SUBSTRING(SD1.D1_DTDIGIT,1,8) >= '20081120'"
   EndIf
      
   cQuery += " AND SD1.D1_TIPO = 'N'"
   //Five Solutions Consultoria - 01/09/2009 - cQuery += " AND SD1.D1_CF IN ('1101','2101')"
      
   cQuery += " GROUP BY SUBSTRING(SD1.D1_DTDIGIT,1,6),SUBSTRING(SB1.B1_SUBGPO,1,1),SD1.D1_X_NFMAE,SD1.D1_X_MAESE,SD1.D1_FORNECE,SD1.D1_LOJA "
   cQuery += " ORDER BY SUBSTRING(SD1.D1_DTDIGIT,1,6) DESC "

   MemoWrite("C:\TEMP\MatPrimaAnt"+Alltrim(Str(nMes))+".SQL",cQuery)
      
   TCQuery cQuery NEW ALIAS "MPANT"
   DbSelectArea("MPANT")
   nCustMPAnt :=  MPANT->CUSCOMPMP
   nQtdMPAnt  :=  MPANT->QTDCOMPMP
   DbCloseArea()
   //Alert("Executei CalcMPAnt, Retornando Valores nCustMPAnt: "+Alltrim(Str(nCustMPAnt))+" nQtdMPAnt "+Alltrim(Str(nQtdMPAnt)))
   
Return({nCustMPAnt,nQtdMPAnt})


Static Function fPrzMedio(xCondPgt)

   Private cCondicao := Posicione("SE4",1,xFilial("SE4")+xCondPgt,"E4_COND") //cCndPV //Alltrim(xCondPgt) //Alltrim(M->E4_COND)
   Private cCondClc  := STRTRAN(cCondicao,",","+")
   nPrzTMP           := &cCondClc
   nQPc              := RunPc() //(cCondicao) 
   Private nPrzTot   := nPrzTMP
   Private nQtdPc    := nQPc
   
Return({nPrzTot,nQtdPc})

Static Function RunPc//(cCondicao)
   
   nQuantPC := 1//Já iniciamos considerando o mínimo de uma parcela, então se existir a primeira vírgula
                //isto indica que temos duas parcelas, e se for encontrada uma próxima vírgula temos três
                // e assim por diante contaremos o número de parcelas de acordo com o número de vírgulas
                // encontradas.
   nIncio  := 1
   For nPc := 1 To Len(cCondicao)
      cTexto := Substr(IIF(nPC==1,cCondicao,cTexto),nIncio,Len(cCondicao)) 
      nPosVirg := At(",",cTexto)
      nIncio  := nPosVirg + 1
      If nPosVirg > 0
         nQuantPC ++
      EndIf
   Next nPC
   
Return(nQuantPC)