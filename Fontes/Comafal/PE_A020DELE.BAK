/*
ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
±±ÉÍÍÍÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍËÍÍÍÍÍÍÑÍÍÍÍÍÍÍÍÍÍÍÍÍ»±±
±±ºPrograma  ³PE_A020DELEºAutor  ³Five Solutions     º Data ³  02/07/2008 º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÊÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºDesc.     ³ PE - Ponto de Entrada na Exclusão do Cadastro de Fornecedo-º±±
±±º          ³ res para possibilitar exclusão automática da conta contábilº±±
±±º          ³  no Plano de Contas.                                       º±±
±±º          ³                                                            º±±
±±º          ³                                                            º±±
±±º          ³                                                            º±±
±±º          ³                                                            º±±
±±º          ³                                                            º±±
±±º          ³                                                            º±±
±±º          ³                                                            º±±
±±ÌÍÍÍÍÍÍÍÍÍÍØÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹±±
±±ºUso       ³ COMAFAL PE/SP/RS                                          º±±
±±ÈÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼±±
±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±
ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß
*/
User Function A020DELE
   cArea := GetArea()
   cAreaAntes := Alias()
   /************************
    Five Solutions Consultoria
    02/09/2010
    Alterado para evitar inclusão de exclusão de conta contabil
    
   cCtaCtb := SA2->A2_CONTA
   cAreaAntes := Alias()
   DbSelectArea("CT1")
   DbSetOrder(1)
   If DbSeek(xFilial("CT1")+cCtaCtb)
	  DbSelectArea(cAreaAntes)
      If MsgYESNO("Confirma Exclusão da Conta Contábil "+cCtaCtb+" do Fornecedor "+Alltrim(SA2->A2_NOME)) 
         ExcSA2()
      EndIf
   EndIf
   *******************************************************************************************************/
   /************************
    Five Solutions Consultoria
    02/09/2010
    Implementado para possibilitar exclusão do registro do item contabil referente ao fornecedor.
    *********************************************************************************************/
   DbSelectArea(cAreaAntes)
   RestArea(cArea)
Return
Static Function ExcSA2()
   lMsErroAuto := .F.
   cContaFor := SA2->A2_CONTA
   cDescCta  := Alltrim(SA2->A2_NOME)
   nOpc   := 4 
   aConta := {{"CT1_CONTA",cContaFor  ,Nil},;
              {"CT1_DESC01",cDescCta  ,Nil},;
              {"CT1_CLASSE","2"       ,Nil},; //2 - Analítica
              {"CT1_NORMAL","1"       ,Nil},; //1 - Devedora
              {"CT1_CTASUP","21102",Nil}}  //21102 - Alterado em 11/06/2009 - Antes, 21102001 - Conta Fixa para Conta Superior de Fornecedores.
   MsExecAuto({|x,y| CTBA020(x,y)},aConta,nOpc)
   If lMsErroAuto
      Alert("Ocorreu Erro Fatal na Exclusão da Conta Contábil: "+Alltrim(cContaFor)+" no Plano de Contas, Favor reportar ao Depto. de TI")
   EndIf
Return